---
title: Web - Initial Enumeration
categories:
  - Pentesting
  - Web
  - Enumeration
tags:
  - Pentesting
  - Web
  - Enumeration
toc: true
---

---
Initial enumeration of web servers.

---
<!-- more -->

<br>

# Learning resources
<table>
  <tr>
    <th style="width: 20%;">Resource name</th>
    <th style="width: 80%;">Additional description</th>
  </tr>
  <tr>
    <td><a href="#wfuzz">wfuzz</a></td>
    <td><a href="https://github.com/xmendez/wfuzz">GitHub</a> - A flexible web fuzzer that replaces any payload with `FUZZ`, known for its high level of customization.</td>
  </tr>
  <tr>
    <td><a href="#ffuf">ffuf</a></td>
    <td><a href="https://github.com/ffuf/ffuf">GitHub</a> - A fast and straightforward web fuzzer, widely praised for its speed.</td>
  </tr>
  <tr>
    <td><a href="#feroxbuster">feroxbuster</a></td>
    <td><a href="https://github.com/epi052/feroxbuster">GitHub</a> - Recursive content discovery tool with a focus on speed and efficiency.</td>
  </tr>
  <tr>
    <td><a href="#gobuster">gobuster</a></td>
    <td><a href="https://github.com/OJ/gobuster">GitHub</a> - Known for its DNS subdomain and directory brute-forcing capabilities.</td>
  </tr>
  <tr>
    <td><a href="#dirbuster">dirbuster</a></td>
    <td><a href="https://github.com/seifreed/dirbuster">GitHub</a> - A Java-based GUI tool for brute-forcing directories and files, slightly outdated but still effective.</td>
  </tr>
  <tr>
    <td><a href="#dirb">dirb</a></td>
    <td><a href="https://github.com/v0re/dirb">GitHub</a> - A straightforward and reliable web content scanner that doesn't support recursive scanning.</td>
  </tr>
  <tr>
    <td><a href="#seclists">seclists</a></td>
    <td><a href="https://github.com/danielmiessler/SecLists">GitHub</a> - A collection of multiple types of lists used during security assessments, including usernames, passwords, and URL lists.</td>
  </tr>
  <tr>
    <td><a href="#cewl">cewl</a></td>
    <td><a href="https://github.com/digininja/CeWL">GitHub</a> - Generates a custom wordlist by crawling and extracting words from a website, useful for password cracking.</td>
  </tr>
  <tr>
    <td><a href="#nikto">nikto</a></td>
    <td><a href="https://github.com/sullo/nikto">GitHub</a> - A web server scanner that detects vulnerabilities and misconfigurations, known for its extensive checks.</td>
  </tr>
  <tr>
    <td><a href="#wpscan">wpscan</a></td>
    <td><a href="https://github.com/wpscanteam/wpscan">GitHub</a> - WPScan WordPress security scanner.</td>
  </tr>
  <tr>
    <td><a href="#droopescan">droopescan</a></td>
    <td><a href="https://github.com/SamJoan/droopescan">GitHub</a> - Idenitfy vulns in Drupal & Silverstripe.</td>
  </tr>
  <tr>
    <td><a href="#joomscan">joomscan</a></td>
    <td><a href="https://github.com/OWASP/joomscan">GitHub</a> - Joomla vulnerability scanner, designed to find vulnerabilities specific to Joomla.</td>
  </tr>
  <tr>
    <td><a href="#General-scanners">CMSmap</a></td>
    <td><a href="https://github.com/dionach/CMSmap">GitHub</a> - CMS vulnerability scanner for various content management systems, identifying common security issues.</td>
  </tr>
  <tr>
    <td><a href="#General-scanners">WhatWeb</a></td>
    <td><a href="https://kalilinuxtutorials.com/whatweb/">Guide</a> - Identifies technologies used on websites, useful for understanding the tech stack.</td>
  </tr>
</table>


<br>

# Tools

<br>

## Prepare the environment
```bash
mkdir -p ~/tools/web/
```

## Initial enumeration

### Fuzz files and directories

#### `wfuzz`
```bash Install
sudo apt install wfuzz
wfuzz --help
```
```bash
wfuzz -c -z file,/usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt --hc 404 -f recon/wfuzz.files "http://$IP/FUZZ" # --basic admin:password
wfuzz -c -z file,/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt  --hc 404  -f recon/wfuzz.dirs "http://$IP/FUZZ/"
```
```bash encode payloads
wfuzz -e iterators
wfuzz -e encoders
wfuzz -e scripts

wfuzz -z file,common.txt,md5 http://$IP/FUZZ
wfuzz -z file,common.txt,hex http://$IP/FUZZ
```
| arg | description |
| - | - |
|   | `http://$IP/FUZZ` finds files, `http://$IP/FUZZ/` finds directories |
| -e | list iterator, encodings, scripts |
| -z | specify encoding such as `urlencode`, `base64`, `md5` |


<br>

#### `ffuf`
```bash Install
sudo apt install ffuf
ffuf -h
```
```bash
ffuf -c -u http://$IP/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 200 -o recon/ffuf.out
```
| arg | description |
| - | - |
| `-r` | recursive (not enabled by default) |

<br>

#### `feroxbuster`
```bash Install
sudo apt install feroxbuster
feroxbuster --help
```
```bash
feroxbuster -u http://$IP --insecure --proxy http://127.0.0.1:8080 -d 5 -t 200 -o recon/ferox.out

feroxbuster --url http://$IP -e -x .php,txt,html -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -t 200 -o recon/ferox2.out
```

<br>

#### `gobuster`
```bash Install
sudo apt install gobuster
gobuster -h
```
```bash
gobuster dir -u http://$IP -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 200 -o recon/gobuster.out
```

<br>

#### `dirbuster`
```bash Install
sudo apt install dirbuster
wget https://gitlab.com/kalilinux/packages/dirbuster/-/raw/kali/master/DirBuster-1.0-RC1.jar -O ~/tools/web/DirBuster-1.0-RC1.jar
dirbuster -h
```
```bash GUI enabled by default
sudo dirsearch -u http://$IP -f -o recon/dirsearch.out

java -jar ~/tools/web/DirBuster-1.0-RC1.jar -u http://$IP
```
| arg | description |
| - | - |
| `-H` | headless (no GUI) |
| `-f` | force to add extensions to every entry in the wordlist |

<br>

#### `dirb`
```bash Install
sudo apt install dirb
man dirb

# Generate dictionaries incrementally
dirb-gendict -h

# Dump word dictionary from html input file
man html2dic
```
```bash
dirb http://$IP /usr/share/wordlists/dirb/big.txt
```

<br>

#### `seclists`
```bash Install
sudo apt install seclists
seclists -h
```
```md
/usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt
/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
/usr/share/seclists/Discovery/Web-Content/common.txt
/usr/share/seclists/Discovery/Web-Content/big.txt
/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt
/usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt
/usr/share/seclists/Discovery/Web-Content/raft-large-extensions.txt
/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt
```

<br>

#### `cewl`
```bash Install
sudo apt install cewl
cewl -h

# Extract metadata from files
fab-cewl -h
```
```bash
cewl http://$IP -d 5 --with-numbers -w vulns/cewl.out
```

<br>

### File extensions
```bash Search supported extensions
ffuf -u http://$IP/indexFUZZ -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt -o recon/ffuf.extentions.out
```
```bash Bruteforce files with found extensions
ffuf -c -u http://$IP/cgi-bin/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -e .sh,.cgi,.pl,.py -fc 404 -o recon/ffuf.ext2.md
```

<br>

### Parameters
```bash parameter keys
ffuf -u "http://$IP?FUZZ=1" -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -fw 39 -o recon/ffuf.param-keys.out
```
```bash parameter values
for i in {0..255}; do echo $i; done | ffuf -u 'http://$IP?id=FUZZ' -c -w - -fw 33 -o recon/ffuf.param-values.out
```
> include in injection (such as an LFI/RFI/command injection) in case an ordinary fuzzing would output nothing

<br>

### Login bruteforce
```bash based on response size
# initial attempt
wfuzz -c -z file,users.txt -z file,pass.txt -d "name=FUZZ&password=FUZ2Z" http://$IP/login.php --sc 200

# exclude invalid logins
wfuzz -c -z file,users.txt -z file,pass.txt -d "name=FUZZ&password=FUZ2Z" http://$IP/login.php --sc 200 --hh 206
```
```bash hydra
hydra -I -V -F -l admin -P /usr/share/wordlists/rockyou.txt $IP http-post-form "/login.php:username=admin&password=^PASS^:Invalid Password:H=Cookie: PHPSESSID=cd892e2HNW3N"
```

<br>

### Subdomain bruteforce
```bash from URL
gobuster vhost -u http://$IP -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
```
```bash from domain
wfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u "$domain" -H "Host: FUZZ.$domain" --hl 7
```

<br>

### Vulnerability scanners
```bash nikto
nikto --host http://$IP -C all -o recon/nikto.txt
```
```bash
whatweb -a 4 http://$IP
```

<br>

### CMS scanners

#### Wordpress
Fuzz files and directories
```bash
SecLists/Discovery/Web-Content/CMS/wordpress.fuzz.txt
```
```bash
wpscan --url http://$IP --disable-tls-checks --force update --enumerate u,t,p 
wpscan --url http://$IP --disable-tls-checks --detection-mode aggressive -e ap,vt,cb  # aggressive 
```
Login bruteforce
```bash
wpscan --url $URL --password-attack wp-login -U userlist -P passlist # --max-threads 50
```
| arg | description |
| - | - |
| `--enumerate` | all/vulnerable plugins - `ap` / `vp`|
| | all/vulnerable themes - `at` / `vt` |
| | config backups - `cb` |
| `--folow-redirection` | |
| `--verbose` | |
| `--max-threads 50` | Good for login bruteforce |

<br>

#### Drupal
Scan
```bash
droopescan scan drupal -u $domain
droopescan scan moodle -u http://$IP/moodle
```
- view the version at `/CHANGELOG.txt`
- (logged in) is `PHP filter` enabled to add PHP code?

<br>

#### Joomla
```bash
joomscan --ec -u http://$IP
```

<br>

#### General scanners
```bash
whatweb -a 4 http://$IP
python3 cmsmap.py http://$IP
```

<br>

---
---